#
# insmod linux-kernel-bde.ko
linux_kernel_bde: loading out-of-tree module taints kernel.
# insmod linux-user-bde.ko
#
# insmod linux-bcm-knet.ko
#
# ./bcm.user
Broadcom Command Monitor: Copyright (c) 1998-2020 Broadcom
Release: sdk-6.5.19 built 20200510 (Sun May 10 22:05:37 2020)
From mj030910@lc-sj1-3888:/projects/ntsw-sw2/home/nmou/sdk-xgs-6.5.19
Platform: IPROC_CMICD
OS: Unix (Posix)
DMA pool size: 16777216
BDE dev 0 (AXI), Dev 0xb275, Rev 0x02, Chip BCM56275_A1, Driver BCM56275_A0
SOC unit 0 attached to PCI device BCM56275_A1
WARNING: bcm esw command CoupledMemWrite not alphabetized
rc: unit 0 device BCM56275_A1
Loading M0 Firmware located at ../../../../rc/cmicfw/linkscan_led_fw.bin
Firmware download successed (0x3c5efa3a).
Loading M0 Firmware located at ../../../../rc/cmicfw/custom_led.bin
Firmware download successed (0x4bc6bdc6).
UNIT0 CANCUN:
        CIH: LOADED
        Ver: 03.00.13

        CMH: LOADED
        Ver: 03.00.13
        SDK Ver: 06.05.19

        CCH: LOADED
        Ver: 03.00.13
        SDK Ver: 06.05.19

        CEH: LOADED
        Ver: 03.00.13
        SDK Ver: 06.05.19

rc: MMU initialized
rc: BCM driver initialized
rc: L2 Table shadowing enabled
rc: Port modes initialized
BCM.0>
BCM.0> cint knet.c
    phy_port_primary_and_offset_4=0x0103
    portmap_29.0=61:20
    portmap_4.0=4:1
    phy_port_primary_and_offset_5=0x0500
    portmap_10.0=10:1
    phy_port_primary_and_offset_6=0x0501
    phy_port_primary_and_offset_7=0x0502
    portmap_5.0=5:1
    phy_port_primary_and_offset_8=0x0503
    portmap_11.0=11:1
    portmap_65.0=65:20
    phy_port_primary_and_offset_9=0x0900
    portmap_20.0=28:10
    portmap_6.0=6:1
    portmap_12.0=12:1
    portmap_66.0=66:20
    portmap_21.0=41:10
    portmap_30.0=63:20
    portmap_7.0=7:1
    portmap_13.0=13:1
    portmap_67.0=67:20
    portmap_22.0=42:10
    portmap_8.0=8:1
    portmap_14.0=14:1
    portmap_68.0=68:20
    portmap_23.0=43:10
    pbmp_xport_xe=0x001FFFFFFE
    os=unix
    portmap_9.0=9:1
    portmap_15.0=15:1
    core_clock_to_pm_clock_factor=1
    portmap_24.0=44:10
    phy_port_primary_and_offset_10=0x0901
    portmap_16.0=16:1
    phy_port_primary_and_offset_11=0x0902
    portmap_25.0=57:10
    phy_port_primary_and_offset_12=0x0903
    core_clock_frequency=445
    phy_port_primary_and_offset_13=0x0d00
    portmap_17.0=25:10
    phy_port_primary_and_offset_14=0x0d01
    portmap_26.0=58:10
    portmap_1.0=1:1
    phy_port_primary_and_offset_15=0x0d02
    phy_port_primary_and_offset_16=0x0d03
    portmap_18.0=26:10
    portmap_27.0=59:10
    portmap_2.0=2:1
    portmap_19.0=27:10
    phy_port_primary_and_offset_1=0x0100
    portmap_28.0=60:10
    portmap_3.0=3:1
    phy_port_primary_and_offset_2=0x0101
    phy_port_primary_and_offset_3=0x0102
Attach: Unit 0 (BCM56275_A1): attached (current unit)
Broadcom Command Monitor: Copyright (c) 1998-2020 Broadcom
Release: sdk-6.5.19 built 20200510 (Sun May 10 22:05:37 2020)
From mj030910@lc-sj1-3888:/projects/ntsw-sw2/home/nmou/sdk-xgs-6.5.19
Platform: IPROC_CMICD
OS: Unix (Posix)
Chips: BCM56504_A0, BCM56504_B0, BCM56314_A0, BCM56800_A0,
       BCM56514_A0, BCM56624_A0, BCM56624_B0, BCM56680_A0,
       BCM56680_B0, BCM56224_A0, BCM56224_B0, BCM56820_A0,
       BCM56725_A0, BCM53314_A0, BCM53324_A0, BCM56634_A0,
       BCM56634_B0, BCM56524_A0, BCM56524_B0, BCM56685_A0,
       BCM56685_B0, BCM56334_A0, BCM56334_B0, BCM56840_A0,
       BCM56840_B0,

       BCM88732_A0, BCM56440_A0, BCM56440_B0,
       BCM56640_A0,
       BCM56850_A0, BCM56450_A0,
       BCM56450_B0, BCM56450_B1, BCM56340_A0, BCM56142_A0,
       BCM56150_A0, BCM53400_A0, BCM56960_A0, BCM56860_A0,
       BCM56560_A0, BCM56560_B0, BCM56260_A0, BCM56260_B0,



       BCM56160_A0, BCM56270_A0,
       BCM56965_A0, BCM56970_A0, BCM56870_A0, BCM53570_A0,
       BCM53570_B0, BCM56980_A0, BCM56980_B0, BCM53540_A0,
       BCM56670_A0, BCM56670_B0, BCM56670_C0, BCM56370_A0,
       BCM56275_A0, BCM56770_A0, BCM56470_A0, BCM56070_A0
PHYs:  BCM5218, BCM5220/21, BCM5226, BCM5228,
    BCM5238, BCM5248, BCM5400, BCM5401,
    BCM5402, BCM5404, BCM5424/34, BCM5411,
    BCM5461, BCM5464, BCM5466, BCM5478,
    BCM5488, BCM54980, BCM54980, BCM54980,
    BCM54980, BCM53314, BCM5482/801x, BCM54684,
    BCM54640, BCM54682E, BCM54684E, BCM54685,
    BCM54616, BCM54618E, BCM54618SE, BCM84707,
    BCM84073, BCM84074, BCM84728, BCM84748,
    BCM84727, BCM84747, BCM84762, BCM84764,
    BCM84042, BCM84044, BCM8806X, BCM54182,
    BCM54185, BCM54180, BCM54140, BCM54192,
    BCM54195, BCM54190, BCM54194, BCM54210,
    BCM54220, BCM54280, BCM54282, BCM54240,
    BCM54285, BCM5428X, BCM54290, BCM54292,
    BCM54294, BCM54295, BCM54296, BCM5421S
    BCM54680, BCM53324, BCM56160-GPHY, BCM53540-GPHY,
    BCM56275-GPHY, BCM54880, BCM54881, BCM54810,
    BCM54811, BCM54640E, BCM54880E, BCM54680E,
    BCM52681E, BCM8703, BCM8704, BCM8705/24/25,
    BCM8706/8726, BCM8727, BCM8728/8747, BCM8072,
    BCM8073, BCM8074, BCM8040, BCM8481X,
    BCM84812, BCM84821, BCM84822, BCM84823,
    BCM84833, BCM84834, BCM84835, BCM84836,
    BCM84844, BCM84846, BCM84848, BCM84858,
    BCM84856, BCM84860, BCM84861, BCM84864,
    BCM84868, BCM84888, BCM84884, BCM84888E,
    BCM84884E, BCM84881, BCM84880, BCM84888S,
    BCM84887, BCM84886, BCM84885, BCM8750,
    BCM8752, BCM8754, BCM84740, BCM84164,
    BCM84758, BCM84780, BCM84784, BCM84318,
    BCM84328, BCM84793, BCM82328, Furia
    Huracan, Sesto, Madura, BCM82780,
    copper sfp

Create a KNET interface to handle protocol and local station packets
bcm_knet_netif_create
bcm_knet_filter_create 1
bcm_knet_filter_create 2
DONE; don't forget "ifconfig virt-intf0 192.168.2.254 netmask 255.255.255.0 up"

User has to follow below steps to verify KNET functionality
====================================================================================
1. Go to Linux shell prompt using "shell" command from BCM diag shell
2. Configure IP address to knet interface "ifconfig virt-intf0 192.168.2.254 netmask 255.255.255.0 up"
3. Run knet_rx.exe in backround "./knet_rx.exe -vv virt-intf0 5 &"
4. Run knet_tx.exe to send 5 packets "./knet_tx.exe -vv virt-intf0 5"
=====================================================================================
Above 4 steps will demonstrate transmit and receive functionality over KNET interface
bcm_error_t $$ = BCM_E_NONE (0)
BCM.0>
BCM.0>
BCM.0> shell
#
# ifconfig virt-intf0 192.168.2.254 netmask 255.255.255.0 up
# ifconfig virt-intf0 -multicast
#
# ./knet_rx.exe -vv virt-intf0 5 &
#
Waiting on packet 1

#
# ./knet_tx.exe -vv virt-intf0 5
Dump Packet: 124 bytes
0000: 00 01 02 03 04 05 10 11 - 12 13 14 15 00 6e a5 a5
0010: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5 a5 a5 a5 a5
0020: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5 a5 a5 a5 a5
0030: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5 a5 a5 a5 a5
0040: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5 a5 a5 a5 a5
0050: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5 a5 a5 a5 a5
0060: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5 a5 a5 a5 a5
0070: a5 a5 a5 a5 a5 a5 a5 a5 - a5 a5 a5 a5
Transmitting 5 124 byte packets; payload len=110; port=1
Skipping 124 byte outgoing packet;

Waiting on packet 1

--------------------------------------------------------------------------------
Received packet 1 (124 bytes)
Dump L2 Header

L2 header:
  Dst MAC:   00:01:02:03:04:05
  Src MAC:   10:11:12:13:14:15
  Tag:       0x006ea5a5
  EtherType: 0xa5a5
Dump Raw Packet

Raw Packet Dump (124 bytes):
0x0000: 0x00 0x01 0x02 0x03 0x04 0x05 0x10 0x11 - 0x12 0x13 0x14 0x15 0x00 0x6e 0xa5 0xa5
0x0010: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0x80 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0020: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0030: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0040: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0050: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0060: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0070: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5

Waiting on packet 2
Packet #1 (124 bytes) sent successfully
Skipping 124 byte outgoing packet;

Waiting on packet 2

--------------------------------------------------------------------------------
Received packet 2 (124 bytes)
Dump L2 Header

L2 header:
  Dst MAC:   00:01:02:03:04:05
  Src MAC:   10:11:12:13:14:15
  Tag:       0x006ea5a5
  EtherType: 0xa5a5
Dump Raw Packet

Raw Packet Dump (124 bytes):
0x0000: 0x00 0x01 0x02 0x03 0x04 0x05 0x10 0x11 - 0x12 0x13 0x14 0x15 0x00 0x6e 0xa5 0xa5
0x0010: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0x81 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0020: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0030: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0040: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0050: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0060: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0070: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5

Waiting on packet 3
Packet #2 (124 bytes) sent successfully
Skipping 124 byte outgoing packet;

Waiting on packet 3

--------------------------------------------------------------------------------
Received packet 3 (124 bytes)
Dump L2 Header

L2 header:
  Dst MAC:   00:01:02:03:04:05
  Src MAC:   10:11:12:13:14:15
  Tag:       0x006ea5a5
  EtherType: 0xa5a5
Dump Raw Packet

Raw Packet Dump (124 bytes):
0x0000: 0x00 0x01 0x02 0x03 0x04 0x05 0x10 0x11 - 0x12 0x13 0x14 0x15 0x00 0x6e 0xa5 0xa5
0x0010: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0x82 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0020: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0030: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0040: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0050: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0060: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0070: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5

Waiting on packet 4
Packet #3 (124 bytes) sent successfully
Skipping 124 byte outgoing packet;

Waiting on packet 4

--------------------------------------------------------------------------------
Received packet 4 (124 bytes)
Dump L2 Header

L2 header:
  Dst MAC:   00:01:02:03:04:05
  Src MAC:   10:11:12:13:14:15
  Tag:       0x006ea5a5
  EtherType: 0xa5a5
Dump Raw Packet

Raw Packet Dump (124 bytes):
0x0000: 0x00 0x01 0x02 0x03 0x04 0x05 0x10 0x11 - 0x12 0x13 0x14 0x15 0x00 0x6e 0xa5 0xa5
0x0010: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0x83 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0020: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0030: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0040: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0050: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0060: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0070: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5

Waiting on packet 5
Packet #4 (124 bytes) sent successfully
Skipping 124 byte outgoing packet;

Waiting on packet 5

--------------------------------------------------------------------------------
Received packet 5 (124 bytes)
Dump L2 Header

L2 header:
  Dst MAC:   00:01:02:03:04:05
  Src MAC:   10:11:12:13:14:15
  Tag:       0x006ea5a5
  EtherType: 0xa5a5
Dump Raw Packet

Raw Packet Dump (124 bytes):
0x0000: 0x00 0x01 0x02 0x03 0x04 0x05 0x10 0x11 - 0x12 0x13 0x14 0x15 0x00 0x6e 0xa5 0xa5
0x0010: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0x84 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0020: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0030: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0040: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0050: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0060: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5
0x0070: 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 0xa5 - 0xa5 0xa5 0xa5 0xa5
Received 5 packets, DONE
Packet #5 (124 bytes) sent successfully
Transmitted 5 packets, DONE
[1]+  Done                       ./knet_rx.exe -vv virt-intf0 5
#
#