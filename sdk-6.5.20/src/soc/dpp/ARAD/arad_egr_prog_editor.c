/* 
 * This license is set out in https://raw.githubusercontent.com/Broadcom-Network-Switching-Software/OpenBCM/master/Legal/LICENSE file.
 * 
 * Copyright 2007-2020 Broadcom Inc. All rights reserved.
 * $
*/


#include <soc/mcm/memregs.h>
#if defined(BCM_88650_A0)

#ifdef _ERR_MSG_MODULE_NAME
  #error "_ERR_MSG_MODULE_NAME redefined"
#endif

#define _ERR_MSG_MODULE_NAME BSL_SOC_EGRESS




#include <shared/bsl.h>
#include <shared/swstate/access/sw_state_access.h>
#include <sal/appl/sal.h>

#include <soc/dcmn/error.h>
#include <soc/dcmn/dcmn_dev_feature_manager.h>
#include <soc/dpp/drv.h>

#include <soc/dpp/SAND/Utils/sand_header.h>
#include <soc/dpp/SAND/Utils/sand_os_interface.h>

#include <soc/dpp/SAND/Management/sand_general_macros.h>
#include <soc/dpp/SAND/Management/sand_error_code.h>

#include <soc/dpp/TMC/tmc_api_stack.h>

#include <soc/dpp/ARAD/arad_api_framework.h>
#include <soc/dpp/ARAD/arad_api_mgmt.h>
#include <soc/dpp/ARAD/arad_tbl_access.h>
#include <soc/dpp/ARAD/arad_ports.h>
#include <soc/dpp/ARAD/arad_sw_db.h>
#include <soc/dpp/ARAD/arad_reg_access.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_oam.h>

#include <soc/dpp/ARAD/arad_egr_prog_editor.h>

#include <soc/dpp/ARAD/arad_egr_prge_mgmt.h>
#include <soc/dpp/ARAD/arad_egr_prge_interface.h>

#include <soc/dpp/PPD/ppd_api_eg_encap.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_general.h>








#define PROG_DM_DOWN_LIST_SIZE (4)

#define IPV4_UC    (1)
#define IPV4_MC    (2)
#define IPV6_UC    (3)
#define IPV6_MC    (4)
#define CPU_TRAP    (15)



#define ARAD_PP_EG_PROG_NO_COMPARE (0x7)

#define ARAD_PP_EG_PROG_NULL_LFEM(_unit)    (ARAD_PP_EG_PROG_NOF_FEM(_unit))

typedef enum {
    ifc_10G = 0, 
    ifc_40G = 1,
    ifc_100G = 2,
    Ilaken = 3
} Ifc_mode ;

typedef enum {
    ofp_1p = 0, 
    ofp_2p = 1,
    ofp_8p = 2
}  Ofp_mode ;





#define ARAD_PP_PRGE_ENG_SIZE_REG_R0        (0)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R1        (1)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R2        (2)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R3        (3)
#define ARAD_PP_PRGE_ENG_SIZE_REG_SZ        (4)
#define ARAD_PP_PRGE_ENG_SIZE_CONST         (5)
#define ARAD_PP_PRGE_ENG_SIZE_CONSTANT      ARAD_PP_PRGE_ENG_SIZE_CONST

#define ARAD_PP_PRGE_ENG_OFFSET_REG_R0         (0)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R1         (1)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R2         (2)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R3         (3)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_SZ         (4)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_0        (5)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_64       (6)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_96       (7)

#define ARAD_PP_PRGE_ENG_OP1_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_OP1_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_OP1_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_OP1_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_OP1_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_OP1_SIZE         (5)
#define ARAD_PP_PRGE_ENG_OP1_FEM_FIELD    (6)
#define ARAD_PP_PRGE_ENG_OP1_OP_VALUE     (7)

#define ARAD_PP_PRGE_ENG_OP2_SIZE         ARAD_PP_PRGE_ENG_OP1_SIZE
#define ARAD_PP_PRGE_ENG_OP2_FEM_FIELD    ARAD_PP_PRGE_ENG_OP1_FEM_FIELD
#define ARAD_PP_PRGE_ENG_OP2_REG_SZ       ARAD_PP_PRGE_ENG_OP1_REG_SZ
#define ARAD_PP_PRGE_ENG_OP2_REG_R0       ARAD_PP_PRGE_ENG_OP1_REG_R0
#define ARAD_PP_PRGE_ENG_OP2_REG_R1       ARAD_PP_PRGE_ENG_OP1_REG_R1
#define ARAD_PP_PRGE_ENG_OP2_REG_R2       ARAD_PP_PRGE_ENG_OP1_REG_R2
#define ARAD_PP_PRGE_ENG_OP2_REG_R3       ARAD_PP_PRGE_ENG_OP1_REG_R3
#define ARAD_PP_PRGE_ENG_OP2_OP_VALUE     ARAD_PP_PRGE_ENG_OP1_OP_VALUE

#define ARAD_PP_PRGE_ENG_OP3_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_OP3_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_OP3_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_OP3_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_OP3_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_OP3_SIZE         (5)
#define ARAD_PP_PRGE_ENG_OP3_OP_VALUE     (7)
#define ARAD_PP_PRGE_ENG_OP3_ALU          (8)

#define ARAD_PP_PRGE_ENG_DST_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_DST_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_DST_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_DST_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_DST_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_DST_INST_ADDR    (5)
#define ARAD_PP_PRGE_ENG_DST_DATA_ADDR    (6)

#define ARAD_PP_PRGE_SRC_ORIGINAL (0)
#define ARAD_PP_PRGE_SRC_GENERATED (1)
#define ARAD_PP_PRGE_SRC_RESOLVED (2)

#define ARAD_PP_PRGE_ACE_VARIABLE (59)
#define ARAD_PP_PRGE_EES_DATA1 (31)
#define ARAD_PP_PRGE_EES_DATA2 (17)
#define ARAD_PP_PRGE_SYS_HEADERS_SIZE (33)

#define ARAD_PP_PRGE_CMP_PASS_ALL (7)

#define ARAD_PP_PRGE_DST_SYSTEM_PORT 39  
#define ARAD_PP_PRGE_OUT_LIF 57
#define ARAD_PP_PRGE_OUT_PP_PORT             113 

#define ARAD_PP_PRGE_PROGRAM_VAR    3 

#define ARAD_PP_PRGE_TOD_NTP 81 
#define ARAD_PP_PRGE_TOD_1588 97 

#define ARAD_PP_PRGE_NWK_HEADERS_SIZE        35  

#define ARAD_PP_PRGE_PP_PORT_VARIABLE        45  








#define PP_FWD_CODE_ETHERNET                   (0x0)
#define PP_FWD_CODE_IPV4_UC                    (0x1)
#define PP_FWD_CODE_IPV4_MC                    (0x2)
#define PP_FWD_CODE_IPV6_UC                    (0x3)
#define PP_FWD_CODE_IPV6_MC                    (0x4)
#define PP_FWD_CODE_MPLS                       (0x5)
#define PP_FWD_CODE_TRILL                      (0x6)
#define PP_FWD_CODE_ETHERNET_AFTER_TERMINATION (0x8)
#define PP_FWD_CODE_CUSTOM1                    (0x9)
#define PP_FWD_CODE_FCF                         PP_FWD_CODE_CUSTOM1
#define PP_FWD_CODE_CUSTOM2                    (0xa)
#define PP_FWD_CODE_SNOOP                      (0xb)
#define PP_FWD_CODE_2nd_PASS_OAM_UPMEP_SNOOP   (0xc)
#define PP_FWD_CODE_TM                         (0xe)

#define ETH_TYPE_IPV6     (0x86dd)

#define ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE 24




#define SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)     (SOC_DPP_DEFS_GET(unit, nof_prge_programs)-1)


#define SOC_DPP_EGR_PROG_EDITOR_NOF_ENTRY_POINTERS(unit) ((SOC_IS_JERICHO_B0(unit)||SOC_IS_QMX_B0(unit))?42:SOC_DPP_DEFS_GET(unit, nof_prge_instr_entries))


#define ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(_unit)  (SOC_DPP_DEFS_GET((_unit), egr_prge_nof_prog_sel_tcam_entries)-1)



#define ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE 9 
#define ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_BASE_SIZE 6 
#define ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE 7 

#define ARAD_EGR_PROG_EDITOR_FTMH_STACKING_EXTENSION_SIZE 2 

#define ARAD_EGR_PROG_EDITOR_FTMH_LB_EXTENSION_SIZE 1 
#define ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_LB_EXTENSION_SIZE 2 

#define ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE 2 
#define ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(_unit) \
    ((SOC_DPP_CONFIG(_unit)->arad->init.ports.is_stacking_system == 0x1) || (SOC_DPP_CONFIG(_unit)->arad->init.ports.add_dsp_extension_enable))

#define ARAD_EGR_PROG_EDITOR_CONFIG_MC_ADD_FTMH_DSP_EXTENSION(_unit) \
    (SOC_IS_JERICHO(_unit) && ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(_unit) && SOC_DPP_CONFIG(unit)->pp.routing_preserve_dscp)

#define ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE 6 

#define ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE 31

#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_NO_FHEI  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE)
#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_3_BYTE  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3)
#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_5_BYTE  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 5)

#define _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_BITS_NOF(_unit) SOC_DPP_DEFS_GET(_unit,sys_hdrs_format_code_bits)
#define _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_VALUE_1_OFFSET_BITS_NOF(_unit) SOC_DPP_DEFS_GET(_unit,value_1_offset_bits)

#define ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE  ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + \
         SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_stacking_ext_mode * ARAD_EGR_PROG_EDITOR_FTMH_STACKING_EXTENSION_SIZE +\
         (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode ? ARAD_EGR_PROG_EDITOR_FTMH_LB_EXTENSION_SIZE : 0 )

#define ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_TOTAL_SIZE ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_BASE_SIZE + \
         (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode ? ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_LB_EXTENSION_SIZE : 0 ) + 2


#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_NTP_DOWN  0x18
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_1588_DOWN  0x10

#define ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(tbl_data, index) \
    {\
        switch (index) { \
            case 1: \
                tbl_data.first_out_lif_profile_mask=0; \
                break; \
            case 2: \
                tbl_data.second_out_lif_profile_mask=0; \
                break; \
            case 3: \
                tbl_data.third_out_lif_profile_mask=0; \
                break; \
            case 4: \
                tbl_data.forth_out_lif_profile_mask=0; \
                break; \
            case 5: \
                if (SOC_IS_JERICHO_PLUS(unit)) tbl_data.fifth_out_lif_profile_mask=0; \
                break; \
            case 6: \
                if (SOC_IS_JERICHO_PLUS(unit)) tbl_data.sixth_out_lif_profile_mask=0; \
                break; \
            default: \
                break; \
        }\
    }

#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_EGR_INJECT_WA  0x20


#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_MASK  3

#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_SUBTYPE_MASK  0x03


#define ARAD_EGR_PROG_EDITOR_ACE_BFD_CLEAR_FLAGS                1
#define ARAD_EGR_PROG_EDITOR_ACE_REFLECTOR_1PASS                2
#define ARAD_EGR_PROG_EDITOR_ACE_END_TLV                        3


#define ARAD_EGR_PROG_EDITOR_FRR_LABEL_DEFAULT_TTL 255


#define ARAD_EGR_PRGE_MIM_BSA_REPLACE_LSB           0


#define ARAD_EGR_PRGE_UDP_TUNNEL_IPV4_DEFAULT_PORT ARAD_PP_UDP_IPV4_DST_PORT
#define ARAD_EGR_PRGE_UDP_TUNNEL_IPV6_DEFAULT_PORT ARAD_PP_UDP_IPV6_DST_PORT
#define ARAD_EGR_PRGE_UDP_TUNNEL_MPLS_DEFAULT_PORT ARAD_PP_UDP_MPLS_DST_PORT

#define ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK 0xd










typedef struct
{
  uint32 val1;
  uint32 val2;
} lfem_map;

 







STATIC uint8
    lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS][34] = {

        

        
        {ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS, 1,0, 1,0, 1,0, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS, 1,0, 1,0, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS_SWAPPED, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0, 0,1},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_8_MSBS, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8,   1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_12_MSBS, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4,   1,0, 1,0, 1,0, 1,0},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_2, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_8, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1,  0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10, 0,15, 0,14, 0,13, 0,12, 0,11, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10,  0,15, 0,14, 0,13, 0,12, 0,11, 1,1, 1,1, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_MASK_HEX_81, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT1, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT2, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT3, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT12_TO_BIT13, 0,15, 0,14, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,1, 1,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_CENTRAL_BITS, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_PERIPHERAL_BITS, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT1_CLR_BIT0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 1,0},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_3_M, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_0_M, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_0_M, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0, 1,0},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_2, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_12, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_2,  1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},
	{ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_1_FIRST_BIT_ONLY, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4_BITOR_RSHIFT_4, 1,1, 1,0, 1,1, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 0,7, 0,6, 0,5, 0,4},
		
                                       
        {ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP     ,  1,0,  1,0,  1,0,  1,0,     0,11, 0,10, 0,9,     1,0,    0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP_COMP,  0,15, 0,14, 0,13, 0,12,    1,0,  1,0,  1,0,     0,8,    1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB, 1,1, 1,1, 1,1,  1,1, 1,1, 1,1, 0,6, 0,5, 0,3, 0,2 ,0,11, 0,10, 0,9 ,0,8 ,0,7, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB, 1,0 ,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,9, 0,8, 0,11, 0,10, 0,4, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB, 0,15, 0,14, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4},

        {ARAD_EGR_PROG_EDITOR_LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,1, 0,2, 1,1, 0,0},


        
        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,10, 0,9, 0,3, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,23, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,29, 0,28, 0,27, 0,2, 0,1, 1,1, 1,1, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC_JER, 1,0, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,0, 0,29, 0,28, 0,27, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 1,0, 1,1, 1,0, 1,1, 1,1, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 1,1, 1,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 1,1, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8,  0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,1, 1,0, 1,1, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,6},

        {ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,21, 0,20, 0,19, 0,18, 0,17, 0,16},

        {ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A, 0,15, 0,14, 0,13, 0,12, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE, 1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES,  1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES,   0,15, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 1,0, 1,0, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC, 1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,1, 1,1, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,18, 0,17, 0,16},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH, 1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD,       1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,1, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,1, 1,1, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS,  0,16, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXCLUDE_TOD,       0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_EGR_INJ_OPCODE,       0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC, 1,0, 0,5, 0,4, 0,3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0, 1,0, 1,0, 1,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,1, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS,    1,0 ,1,0 ,1,0 ,1,0 ,0,11 ,0,10 ,0,9 ,1,0 ,0,7 ,0,6 ,0,5 ,0,4 ,0,3 ,0,2 ,0,1 ,0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS,    0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        
		{ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1},
		
		{ARAD_EGR_PROG_EDITOR_LFEM_SET_BITS_7_8, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 1,0, 1,1, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SVID, 1,0, 1,0, 1,0, 1,0, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_EID, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_FAP_ID, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SA_FAP, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SA_LAG, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IS_LAG, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,15},

        {ARAD_EGR_PROG_EDITOR_LFEM_4_MSB_AND_LSB, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TOS, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_MASK_BIT_2_3, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC_AS_MSB, 0,5, 0,4, 0,3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IN_DSCP_TO_EXP, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_MPLS_CLEAR_EXP, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        
        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_OUT, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_PPH_VSI, 1,0, 1,0, 1,0, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_TAG_NUM, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_OUTFP_MSB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,24},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_DEL_LEN, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_VLAN_STATUS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_IN, 0,17, 0,16, 0,15, 0,14, 0,13, 0,12, 0,11, 0,18, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_COS_COLOR, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,21, 0,29, 0,28, 0,27, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 1,0, 1,0, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_LAG, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE, 1,0, 1,0, 1,0,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP, 1,1, 1,1, 1,0, 1,1, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,29, 0,2, 0,1, 1,0, 1,0, 1,0},
        
        {ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP_MC, 1,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,29, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE_MC, 1,0, 1,0, 1,0,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0, 1,0, 0,3, 0,2, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_MC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,4, 0,3, 0,2, 1,0, 1,0, 1,0, 1,0},
            
        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_FROM_CUD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,11, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_H_S, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 1,0, 1,0, 0,6, 1,0, 1,0, 1,0},
           
        
        {ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S_TTL, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 1,0, 1,1, 1,1, 1,1, 1,1, 1,1, 1,1, 1,1, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_ESI_LSB, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_TTL, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_BOS_TTL, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,19, 0,18, 0,17, 0,16, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 3, 1, 0 },

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_PPH_TYPE_2, 1, 0, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0 },

        {ARAD_EGR_PROG_EDITOR_LFEM_SPB_STAMP_LEFT_NIBBLE_8, 1,1, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SPB_READ_BITS_FROM_BTAG_FIELD, 0,13, 1,0, 1,0, 1,0, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SPB_READ_BDA_WITHOUT_ORIENTATION, 1,0, 0,14, 0,13, 0,12, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        
        {ARAD_EGR_PROG_EDITOR_LFEM_DW0_TAGGED, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,29},

        {ARAD_EGR_PROG_EDITOR_LFEM_DW0_TAG, 0,15, 0,14, 0,13, 0,16, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_DSA_TPID, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_DSA_PCP_VID, 0,15, 0,14, 0,13, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_DSA_CFI, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,12},

        {ARAD_EGR_PROG_EDITOR_LFEM_DSA_SRC_4_0, 1,1, 1,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_DSA_SRC_5, 1,0, 1,0, 0,5, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
 
        {ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN,    1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3},
        {ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN_JER,    1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4},
        {ARAD_EGR_PROG_EDITOR_LFEM_GPON_STAG_PCP,    1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,15, 0,14, 0,13, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_GPON_GEM_ID,    1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IPV6_VXLAN_NH_HL, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8},
        {ARAD_EGR_PROG_EDITOR_LFEM_IPV6_VXLAN_FL, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_3, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0 },
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_1_M_5, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1 },
        {ARAD_EGR_PROG_EDITOR_LFEM_COE_TAG_TC_DP, 0,29, 0,28, 0,27, 0,2, 0,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_COE_TAG_TC, 0,29, 0,28, 0,27, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_2_M_6, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 2, 0, 2, 1, 0 },
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_17_RSHIFT_2, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2 },
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_6, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0 },

        {ARAD_EGR_PROG_EDITOR_LFEM_CH_PPH_TYPE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_CH_OTSH_TYPE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,3, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_AND_D_CLEAR, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_UP, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 1,1, 1,1, 0,5, 0,4, 0,3, 0,2, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_SBFD_UDH_0_15_LSB,	0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_SBFD_UDH_16_BIT,	1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,16},
        {ARAD_EGR_PROG_EDITOR_LFEM_OUT_LIF_MSB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_SHIFT_BIT4_TO_BIT1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_4, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0, 1,0, 1,0},
    }; 



lfem_maps_shadow_t lfem_maps_shadow[SOC_MAX_NUM_DEVICES];


ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INFO programs_usage[SOC_MAX_NUM_DEVICES];


int last_program_id[SOC_MAX_NUM_DEVICES];


int last_tm_profile[SOC_MAX_NUM_DEVICES];


int last_program_pointer[SOC_MAX_NUM_DEVICES];


int tm_profiles_available[SOC_MAX_NUM_DEVICES];


int lfem_stacking_8_index[SOC_MAX_NUM_DEVICES];


int lfem_stacking_8_map[SOC_MAX_NUM_DEVICES];


int lfem_stacking_10_index[SOC_MAX_NUM_DEVICES];


int lfem_stacking_10_map[SOC_MAX_NUM_DEVICES];


int last_branch_entry[SOC_MAX_NUM_DEVICES];


int branch_entries[SOC_MAX_NUM_DEVICES][ARAD_EGR_PROG_EDITOR_BRANCH_IDS_NOF];






void
  lfem_map_arr_to_lfem_field_select_map(
    SOC_SAND_IN  lfem_map lfem_arr[],
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  );


void
  lfem_map_action_to_lfem_field_select_map(
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_LFEM lfem_action,
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  );

uint32 
  arad_egr_prog_editor_basic_epni_tm_config(
    SOC_SAND_IN  int unit
  ); 

void 
  header_editing_size_to_reg_val(
    SOC_SAND_IN  soc_reg_above_64_val_t val, 
    SOC_SAND_OUT soc_reg_above_64_val_t dest
  );


#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_LEARN_EXT_EXISTS_BIT 0x1
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_EEI_EXT_EXISTS_BIT 0x2
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS 0xc
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_EXISTS_BIT 0x10
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT 0x20
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT 0x40

#define COE_TYPE_2_TPID 0x8100


STATIC uint32 arad_egr_prg_editor_set_value_1_offset(int unit) {
	uint8 sys_header_format_code_key;
	soc_reg_above_64_val_t reg_above64_val; 
	uint32 value_1_key;
	uint32 value_1_offset[8] = {0};
	int i;
	uint32 res;
	int profile_used=0;
    uint8 value_1_offset_first_profile;
    uint8 num_value_1_offset_profiles;
    uint32 format_code_bits_nof = _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_BITS_NOF(unit);
    uint32 value_1_offset_bits_nof = _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_VALUE_1_OFFSET_BITS_NOF(unit);
    uint8 dscp_preserve_set_value_1;
    uint8 is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);


	SOC_REG_ABOVE_64_CLEAR(reg_above64_val);

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , READ_EPNI_SYSTEM_HEADERS_FORMAT_CODEr(unit, REG_PORT_ANY, reg_above64_val));

	
	if (programs_usage[unit].oam_dm_down) {
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);
		profile_used += num_value_1_offset_profiles;
	}

	if (programs_usage[unit].egr_inj_wa) {
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);
		profile_used += num_value_1_offset_profiles;
	}

    if (programs_usage[unit].vmac_enable) {
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 30, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 40, exit);
		profile_used += num_value_1_offset_profiles;
    }

    if (programs_usage[unit].delay_based_ecn2) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 50, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 60, exit);
		profile_used += num_value_1_offset_profiles;
    }

    dscp_preserve_set_value_1 = (SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_INLIF_CTRL_EN;
    if (dscp_preserve_set_value_1) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 50, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 60, exit);
		profile_used += num_value_1_offset_profiles;
    }

    if (programs_usage[unit].oam_1711) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 50, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 60, exit);
		profile_used += num_value_1_offset_profiles;
    }

	
	for (sys_header_format_code_key = 0; sys_header_format_code_key < 0x80 ; ++sys_header_format_code_key) {
        value_1_key=0;
		if ((programs_usage[unit].oam_dm_down || programs_usage[unit].egr_inj_wa || programs_usage[unit].oam_1711)
            && (sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT)) {

            
            if(programs_usage[unit].oam_dm_down){
                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                    get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, &value_1_offset_first_profile);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 70, exit);
                value_1_key = value_1_offset_first_profile +
                     ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT) > 0);

            }
            
            else if (programs_usage[unit].oam_1711 && ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 4)) {
                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                    get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &value_1_offset_first_profile);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 80, exit);
                value_1_key = value_1_offset_first_profile;
            }

            
            if(programs_usage[unit].egr_inj_wa && ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 8)){
                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                    get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, &value_1_offset_first_profile);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 70, exit);
                value_1_key = value_1_offset_first_profile +
                     ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT) > 0);
            }
            
        } else if (programs_usage[unit].delay_based_ecn2
                   && (sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT)) {

            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 80, exit);
            value_1_key = value_1_offset_first_profile;

		} else if (programs_usage[unit].vmac_enable) {

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 90, exit);
            if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) ==0) {
                
                value_1_key = value_1_offset_first_profile;
            } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0x4 ) {
                
                value_1_key = value_1_offset_first_profile + 1;
            } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0x8 ) {
                
                value_1_key = value_1_offset_first_profile + 2;
            }

		} else if (dscp_preserve_set_value_1) {
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 91, exit);
            if (((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 0xC)
                ||((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 0x4)) {
                value_1_key = value_1_offset_first_profile
                    + ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT)?2:0)
                    + (((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 0xC)?1:0);
            }
        }

        SHR_BITCOPY_RANGE(reg_above64_val, (format_code_bits_nof * sys_header_format_code_key), &value_1_key, 0, format_code_bits_nof);
	}

    
    if (is_petrab_in_system && programs_usage[unit].oam_dm_down) {
        SOC_REG_ABOVE_64_CLEAR(reg_above64_val);
    }
    
	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit ,  WRITE_EPNI_SYSTEM_HEADERS_FORMAT_CODEr(unit, REG_PORT_ANY, reg_above64_val));


    
    if (programs_usage[unit].oam_dm_down || programs_usage[unit].egr_inj_wa) {
        
        if (programs_usage[unit].oam_dm_down) {
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 100, exit);
            value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
            value_1_offset[value_1_offset_first_profile + 1] = 
                ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
        }
        
        if (programs_usage[unit].egr_inj_wa) {
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 100, exit);
            value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
            value_1_offset[value_1_offset_first_profile + 1] = 
                ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
        }
    }

    if (programs_usage[unit].vmac_enable) {
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 110, exit);
        value_1_offset[value_1_offset_first_profile] = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_NO_FHEI; 

        value_1_offset[value_1_offset_first_profile + 1] = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_3_BYTE;

        value_1_offset[value_1_offset_first_profile + 2] = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_5_BYTE;
    }

    if (programs_usage[unit].delay_based_ecn2) {

        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 120, exit);
        value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE - 1;
    }


    if (dscp_preserve_set_value_1) {
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 130, exit);

        
        value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
        if (ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit)) {
            value_1_offset[value_1_offset_first_profile] += ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
        }
        value_1_offset[value_1_offset_first_profile+1] = value_1_offset[value_1_offset_first_profile] + 5;
        value_1_offset[value_1_offset_first_profile+2] = value_1_offset[value_1_offset_first_profile] + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
        value_1_offset[value_1_offset_first_profile+3] = value_1_offset[value_1_offset_first_profile+2] + 5;
    }

    if (programs_usage[unit].oam_1711) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 140, exit);
        value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3 - 1;
    }

	SOC_REG_ABOVE_64_CLEAR(reg_above64_val);
	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , READ_EPNI_SYSTEM_HEADERS_VALUE_1_OFFSETr(unit, SOC_CORE_ALL, reg_above64_val));

    if (is_petrab_in_system && programs_usage[unit].oam_dm_down) {
        value_1_offset[0] = ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_TOTAL_SIZE;
    }

	
	for (i=0 ; i <8  ; ++i) {
		if (value_1_offset[i]) {
			SHR_BITCOPY_RANGE(reg_above64_val, (value_1_offset_bits_nof * i), &value_1_offset[i], 0, value_1_offset_bits_nof);
		}
	}

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , WRITE_EPNI_SYSTEM_HEADERS_VALUE_1_OFFSETr(unit, SOC_CORE_ALL,  reg_above64_val));

exit: 
    SOC_SAND_EXIT_AND_SEND_ERROR_SOCDNX((_BSL_SOCDNX_SAND_MSG("Something went wrong")));
}


STATIC void arad_egr_prog_editor_next_mem_and_entry_find(SOC_SAND_INOUT int * prge_entry, SOC_SAND_INOUT int * prge_mem)
{
    if(*prge_entry % 2 != 0) {
        
        *prge_mem = *prge_mem+1;
        *prge_entry = *prge_entry-1;
    }
    else {
        *prge_entry = *prge_entry+1;
    }
}



uint32
  arad_egr_prog_editor_supply_lfem_idx(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem,
     SOC_SAND_IN    int                             mem,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog,
     SOC_SAND_OUT   uint32                         *index
  ) {

    int i;
    int lfem_arr_idx = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    uint32 res;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);
    
    if (NULL == index) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("NULL supplied for out parameter\n\r")));
    }

    if (lfem == ARAD_EGR_PROG_EDITOR_LFEM_NULL) {
        
        *index = ARAD_PP_EG_PROG_NULL_LFEM(unit);
        
    }
    else
    {
        *index = -1; 

        for (i = 0; i < ARAD_PP_EG_PROG_NOF_FEM(unit); i++) {
            if (lfem_maps_shadow[unit][lfem_arr_idx][i] == ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                
                lfem_maps_shadow[unit][lfem_arr_idx][i] = lfem;
                *index = i;
                break;
            }
            else if (lfem_maps_shadow[unit][lfem_arr_idx][i] == lfem) {
                
                *index = i;
                break;
            }
        }

        if (*index == -1) 
        {
            
            arad_egr_prog_editor_print_lfem_duplicates(unit);
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error - Not enough LFEMs to load all programs needed.\n\r")));
        }
        else
        {
            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.lfem_bk.set(
                unit, prog, lfem_arr_idx, *index, lfem);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        }
    }

exit: 
    SOC_SAND_EXIT_AND_SEND_ERROR_SOCDNX((_BSL_SOCDNX_SAND_MSG("Error while loading LFEMs")));
}

STATIC uint32
    arad_egr_prog_editor_validate_lfem_action_array(
       SOC_SAND_IN  int     unit
    )
{
    int i;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        if (i != lfem_actions[i][0]) {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Static error - LFEM actions array is out of order. First occurance in entry %d\n\r"),i));
        }
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_validate_lfem_action_array()",0,0);   
}



uint32
  arad_egr_prog_editor_branch_pointer_allocate(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_BRANCH     branch_id,
     SOC_SAND_OUT   uint32                         *entry
  ) {


    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    
    SOC_SAND_CHECK_NULL_INPUT(entry);
    if (branch_id >= ARAD_EGR_PROG_EDITOR_BRANCH_IDS_NOF) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error: Unknown branch ID: %d\n\r"),branch_id));
    }
    

    if (branch_entries[unit][branch_id] == -1 ) {
        
        if (last_branch_entry[unit] > last_program_pointer[unit] + 1) {
            
            branch_entries[unit][branch_id] = (--last_branch_entry[unit]);
        }
        else {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error: Not enough instruction entries to load branch with ID: %d"),branch_id));
        }
    }

    *entry = branch_entries[unit][branch_id];

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_branch_pointer_allocate()",0,0);
}



STATIC int
  arad_egr_prog_editor_programs_init(
     SOC_SAND_IN  int                                 soc_petrab_cfg,
     SOC_SAND_IN  int                              unit
  )
{
    int i, j;
    soc_error_t rv;

    SOCDNX_INIT_FUNC_DEFS;

    last_program_id[unit] = 0;
    last_tm_profile[unit] = 0;
    last_program_pointer[unit] = 0; 

    lfem_stacking_8_index[unit] = -1;
    lfem_stacking_10_index[unit] = -1;

    
    last_branch_entry[unit] = SOC_DPP_EGR_PROG_EDITOR_NOF_ENTRY_POINTERS(unit);
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_BRANCH_IDS_NOF; i++) {
        branch_entries[unit][i] = -1;
    }

    for (i = 0; i < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; i++) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.set(
            unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.set(
            unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
            unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
    }
    for (i = 0; i < ARAD_EGR_PRGE_MAX_NOF_LFEM_TABLES; i++) {
        
        
        for (j = 0; j < ARAD_EGR_PRGE_MAX_NOF_LFEMS; j++) {
            lfem_maps_shadow[unit][i][j] = ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS;
        }
    }
    for (i = 0; i < ARAD_PRGE_TM_SELECT_NOF_PROFILES; i++) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
    }
            
    
     
    
    if (!SOC_IS_ARAD_B1_AND_BELOW(unit)) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
            unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG);
        SOCDNX_IF_ERR_EXIT(rv);
    }

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP, 2); 
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, 2); 
    SOCDNX_IF_ERR_EXIT(rv);


    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, 2); 
    SOCDNX_IF_ERR_EXIT(rv);

    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, 1);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, ARAD_PRGE_TM_SELECT_OTMH_BASE);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, ARAD_PRGE_TM_SELECT_OTMH_BASE);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE, ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD_OVER_OUTER_FTMH);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, ARAD_PRGE_TM_SELECT_STACKING);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, ARAD_PRGE_TM_SELECT_STACKING);
    SOCDNX_IF_ERR_EXIT(rv);

        
    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, ARAD_PRGE_TM_SELECT_PP_RCY_PORT);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU);
    SOCDNX_IF_ERR_EXIT(rv);

	
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, 3); 
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, 3); 
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);

    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, ARAD_PRGE_TM_SELECT_FCOE_N_PORT);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, ARAD_PRGE_TM_SELECT_REFLECTOR_IP_AND_ETH);  
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, ARAD_PRGE_TM_SELECT_REFLECTOR_ETH);  
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, ARAD_PRGE_TM_SELECT_TM_MODE_HW_PROCESSING);  
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, ARAD_PRGE_TM_SELECT_PP_MODE_HW_PROCESSING);  
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW, ARAD_PRGE_TM_SELECT_RAW_MPLS);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW, ARAD_PRGE_TM_SELECT_RAW_MPLS);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW, ARAD_PRGE_TM_SELECT_RAW_MPLS);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, ARAD_PRGE_TM_SELECT_RAW_MPLS);
    SOCDNX_IF_ERR_EXIT(rv);
    
    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0, ARAD_PRGE_TM_SELECT_GENERALIZED_RCY_HEADER_0);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1, ARAD_PRGE_TM_SELECT_GENERALIZED_RCY_HEADER_1);
    SOCDNX_IF_ERR_EXIT(rv);



    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, 1);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, 4); 
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, 4); 
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, ARAD_PRGE_TM_SELECT_TIMESTAMP_AND_SSP);  
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING, ARAD_PRGE_TM_SELECT_EGRESS_ACL_TWO_PASS_EDITING);  
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_RX, ARAD_PRGE_TM_SELECT_DSA_RX);
    SOCDNX_IF_ERR_EXIT(rv);

    
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_TX, ARAD_PRGE_TM_SELECT_DSA_TX);
    SOCDNX_IF_ERR_EXIT(rv);


exit:
    SOCDNX_FUNC_RETURN; 
}


STATIC uint32
  arad_egr_prog_editor_programs_usage_init(
      SOC_SAND_IN  int                                 unit
  )
{
  uint8 is_petrab_in_system;
  uint32 port_idx, res;
  soc_pbmp_t pbmp;
  SOC_TMC_PORTS_FTMH_EXT_OUTLIF outlif_ext_en;
  char *propval;
  uint8 soc_value;
  bcm_port_t port_i;
  

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INIT);

  sal_memset(&programs_usage[unit], 0, sizeof(ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INFO));

  if (SOC_DPP_CONFIG(unit)->tm.otmh_header_used) {
      programs_usage[unit].otmh_base = 1;
  }

  if (SOC_DPP_CONFIG(unit)->tm.l2_encap_external_cpu_used) {
   programs_usage[unit].l2_encap_external_cpu = 1;
  }

  
  if (SOC_DPP_CONFIG(unit)->arad->init.pp_enable == TRUE) { 

      if (SOC_DPP_CONFIG(unit)->pp.xgs_port_exists) {
          programs_usage[unit].xgs_pp = 1;
      }  
      
      if (SOC_IS_JERICHO_PLUS(unit) && (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_encap_mode == SOC_DPP_IP4_TUNNEL_ENCAP_MODE_LARGE)) {
          programs_usage[unit].ipv4_tunnel_tor = 1;
      }

      programs_usage[unit].ipv6_tunnel = SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_enable;

      if (SOC_DPP_CONFIG(unit)->pp.oam_enable) {
          programs_usage[unit].oam_ts_ccm = 1;
		  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", SOC_IS_JERICHO_PLUS_AND_BELOW(unit))) {
			  programs_usage[unit].oam_dm_down =1;
		  }
                  
          programs_usage[unit].egr_inj_wa = 0;
          if (SOC_IS_QAX(unit)) {
              programs_usage[unit].egr_inj_wa = 1;
          }
          programs_usage[unit].egr_inj_opcode = 0;
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "enable_ccm_pkt_counting", 0) && SOC_IS_JERICHO(unit)) {
              programs_usage[unit].egr_inj_opcode = 1;
          } 

          if (soc_property_get(unit, spn_OAM_DM_NTP_ENABLE, 1)) {
              programs_usage[unit].oam_dm_ntp = 1;
          }
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_upmep_rx_enable", 1) == 1) {
              programs_usage[unit].oam_dm_up_rx = 1;
          }
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_lm_upmep_enable", 1) == 1) {
              programs_usage[unit].oam_lm_upmep = 1;
          }
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_upmep_enable", 1) == 1) {
              programs_usage[unit].oam_upmep = 1;
          }
          if (SOC_IS_QAX(unit) && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_1711_enable", 0) == 1)) {
              programs_usage[unit].oam_1711 = 1;
          }
      }
      
      programs_usage[unit].bfd_chan_override = SOC_IS_QAX(unit) && (SOC_DPP_CONFIG(unit)->pp.bfd_enable);

      programs_usage[unit].erspan = soc_property_get(unit, spn_BCM886XX_ERSPAN_TUNNEL_ENABLE, 0) ? 1 : 0;
      programs_usage[unit].rspan = soc_property_get(unit, spn_BCM886XX_RSPAN_TUNNEL_ENABLE, 0) ? 1 : 0;
      
      programs_usage[unit].vxlan = (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_VXLAN) ? 1 : 0; 
      if ((programs_usage[unit].vxlan) && (SOC_IS_ARAD_A0(unit))) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  VXLAN supported only on ARAD_B0 device and above. \n\r")));
      }
        
      programs_usage[unit].epon = SOC_DPP_CONFIG(unit)->pp.pon_application_enable;
      programs_usage[unit].dsa_rx = SOC_DPP_CONFIG(unit)->pp.dsa_tag_custom_enable;
      programs_usage[unit].dsa_tx = SOC_DPP_CONFIG(unit)->pp.dsa_tag_custom_enable;

      programs_usage[unit].generalized_rcy_header_0 = SOC_DPP_CONFIG(unit)->pp.rch_port0_out_exists;
      programs_usage[unit].generalized_rcy_header_1 = SOC_DPP_CONFIG(unit)->pp.rch_port1_out_exists;
  }
  else { 
      programs_usage[unit].xgs_tm = 1; 
  }

  
  if (soc_property_get(unit, spn_OAM_RCY_PORT, -1)!= -1) {
      programs_usage[unit].oam_loopback = 1; 
  }

  SOC_SAND_SOC_IF_ERROR_RETURN(res, 9, exit,dcmn_property_get_str(unit,spn_FAP_TDM_BYPASS,&propval));
  if (propval != NULL) {
      if (sal_strcmp(propval, "0") != 0) {
          programs_usage[unit].tdm = 1;
      }
  }

  
  is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);
  if (is_petrab_in_system) {
     programs_usage[unit].tdm_pmm = 1;
  }

  programs_usage[unit].tdm_stamp_cud = SOC_DPP_CONFIG(unit)->tdm.is_bypass ? 1 : 0;

  programs_usage[unit].stacking = SOC_DPP_CONFIG(unit)->arad->init.ports.is_stacking_system ? 1 : 0; 

  programs_usage[unit].two_hop_scheduling = 0;

  SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, soc_port_sw_db_valid_ports_get(unit, 0, &pbmp));

  SOC_PBMP_ITER(pbmp,port_idx) {
      res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.outlif_ext_en.get(unit, port_idx, &outlif_ext_en);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 15, exit);
      if (outlif_ext_en == SOC_TMC_PORTS_FTMH_EXT_OUTLIF_DOUBLE_TAG) {
          programs_usage[unit].two_hop_scheduling = 1;
          break;
      }
  }

  if ((SOC_DPP_CONFIG(unit)->arad->init.pp_enable == TRUE)&&
	  (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "88650L23C", 0))) 
  {
      
      programs_usage[unit].xgs_tm = 0;
      programs_usage[unit].xgs_pp=0;
      programs_usage[unit].l2_remote_cpu=1;
  }
  else
  {
      programs_usage[unit].l2_remote_cpu=0;
  }

  if ((SOC_DPP_CONFIG(unit)->arad->init.pp_enable == FALSE) && (SOC_DPP_CONFIG(unit)->tm.ftmh_outlif_enlarge == TRUE))
  {
      programs_usage[unit].otmh_cud = 1;
  }
  else
  {
      programs_usage[unit].otmh_cud = 0;
  }

  programs_usage[unit].trill = SOC_DPP_CONFIG(unit)->trill.mode; 

  programs_usage[unit].vmac_enable = soc_property_get(unit, spn_VMAC_ENABLE, 0) ? 1 : 0;

  programs_usage[unit].bfd_echo = soc_property_get(unit, spn_BFD_ECHO_ENABLED, 0) ? 1 : 0;

  programs_usage[unit].olp_petra = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "olp_petra", 0) ? 1 : 0;
  
  programs_usage[unit].sbfd_reflector = soc_property_get(unit, spn_SEAMLESS_BFD_ENABLE, 0) ? 1 : 0;

   
  programs_usage[unit].user_header_always_remove = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "user_header_always_remove", 0) ? 1 : 0;

  programs_usage[unit].size_header = 0;
  for (port_idx = 0; port_idx < ARAD_NOF_FAP_PORTS; port_idx++) 
  {
      if(soc_property_port_suffix_num_get(unit, port_idx, -1, spn_CUSTOM_FEATURE, "add_size_header", 0)) {
          programs_usage[unit].size_header = 1;
          break;
      }
  }

  programs_usage[unit].mpls_raw = soc_property_get(unit, spn_PORT_RAW_MPLS_ENABLE, 0); 


  
  programs_usage[unit].npv_without_my_mac = soc_property_get(unit, spn_FCOE_NPV_BRIDGE_MODE, 0);

  programs_usage[unit].delay_based_ecn2 = soc_property_get(unit, spn_ECN_DM_ENABLE, 0);

  if (SOC_IS_JERICHO(unit)) {
      
      if (!SOC_IS_JERICHO_PLUS(unit) || soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "el_eli_jr_mode", 0)) {
          programs_usage[unit].mpls_eli  = soc_property_get(unit, spn_MPLS_EGRESS_LABEL_ENTROPY_INDICATOR_ENABLE, 0);
      }
      programs_usage[unit].mpls_extended  = soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0);
  }

  if (SOC_IS_JERICHO(unit)) {
      programs_usage[unit].evpn = soc_property_get(unit, spn_EVPN_ENABLE, 0);
      
      
      programs_usage[unit].evpn_frr = (soc_property_get(unit, spn_ROO_EXTENSION_LABEL_ENCAPSULATION, 0) && !SOC_IS_JERICHO_PLUS(unit))
                           || (programs_usage[unit].evpn && programs_usage[unit].mpls_extended && SOC_IS_JERICHO_PLUS(unit));
  }

  if (SOC_IS_JERICHO(unit)) {
      programs_usage[unit].mim_spb   = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0);
  }

  
  if (SOC_IS_JERICHO(unit)) {
      
      programs_usage[unit].customer_conn_to_np_enable = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "conn_to_np_enable", 0);
  }
  if(SOC_IS_QAX(unit))
  {
      
      programs_usage[unit].ipsec = SOC_DPP_CONFIG(unit)->qax->ipsec;
  }
  if (SOC_IS_JERICHO(unit)) {
      SOC_PBMP_ITER(PBMP_RCY_ALL(unit), port_i) {
        soc_value = soc_property_port_suffix_num_get(unit, port_i, -1,spn_CUSTOM_FEATURE,"recycle_with_ptch2", 0);
        if (soc_value != 0) {
            programs_usage[unit].recycle_with_ptch2 = soc_value;
            break;
        } else {
            programs_usage[unit].recycle_with_ptch2 = 0;
        }
      }
  }

  if (SOC_IS_QUX(unit) && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ch_enable", 0)) {
      programs_usage[unit].ch_enable = 1;
  } else {
      programs_usage[unit].ch_enable = 0;
  }
  
  programs_usage[unit].prefix_20byte = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "20byte_prefix_header_enable", 0);

  if (SOC_IS_JERICHO(unit)) {
      programs_usage[unit].ioam_mpls = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ioam_enable", 0);
      programs_usage[unit].ioam_copy_dscp = ((SOC_DPP_CONFIG(unit)->pp.routing_preserve_dscp)
                                              && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mixed_qos_model_enable", 0)));
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_programs_usage_init()",0,0);
}

void
  arad_egr_prog_editor_prog_name_get_by_id(uint32 program_id, char** prog_name)
{
    switch(program_id) {
        case ARAD_EGR_PROG_EDITOR_PROG_VXLAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VXLAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_RSPAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RSPAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_2CPU:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_2CPU";
        break;        
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP_2CPU:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP_2CPU";
        break;        
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP";
        break;
          case ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR";
        break;       
          case ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_STACKING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_STACKING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION";    
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST1:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST2:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST2";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_END_TLV:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_END_TLV";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_DSA_RX:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DSA_RX";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_DSA_TX:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DSA_TX";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC";
        break;        
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS_1PLUS1:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS_1PLUS1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_LI:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_LI";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP";
            break;
        case ARAD_EGR_PROG_EDITOR_PROG_L2TP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2TP";
            break;
        case ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL";
        break;
        default:
            *prog_name = "Unknown program";
    }
}

void
  arad_egr_prog_editor_branch_name_get_by_id(uint32 branch_id, char** branch_name)
{
    switch (branch_id) {
    case ARAD_EGR_PROG_EDITOR_BRANCH_DROP_PACKET:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_DROP_PACKET";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_AND_SOURCE_PORT:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_AND_SOURCE_PORT";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_MC:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_BFD_ECHO:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_BFD_ECHO";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_UDH_BFD_ECHO:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_UDH_BFD_ECHO";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_PP_COPY_HEADER:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_PP_COPY_HEADER";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_2_HOP_SCHEDULING:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_2_HOP_SCHEDULING";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_STACKING:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_STACKING";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_DELAY_BASE_ECN2:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_DELAY_BASE_ECN2";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_OAM_STRING_MAID:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_OAM_STRING_MAID";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_OAM_LB_UP:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_OAM_LB_UP";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_IP_OVER_UDP:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_IP_OVER_UDP";
        break;
    default:
        *branch_name = "Unknown branch";
        break;
    }
}

void
  arad_egr_prog_editor_lfem_name_get_by_id(uint32 lfem_id, char** lfem_name)
{
    switch(lfem_id)                                                
    {                                                                 
    case ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_8_MSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_MSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_12_MSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_12_MSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS_SWAPPED:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS_SWAPPED";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_0";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_3:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_3";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_1_FIRST_BIT_ONLY:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_1_FIRST_BIT_ONLY";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4_BITOR_RSHIFT_4:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4_BITOR_RSHIFT_4";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC_JER:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC_JER";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_PPH_TYPE_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_PPH_TYPE_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXCLUDE_TOD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXCLUDE_TOD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_8_CENTRAL_BITS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_CENTRAL_BITS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_8_PERIPHERAL_BITS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_PERIPHERAL_BITS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_BIT1_CLR_BIT0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT1_CLR_BIT0";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_MASK_HEX_81:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MASK_HEX_81";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT1";
        break;
       case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT3:
       *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT3";
       break;
	case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT12_TO_BIT13:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT12_TO_BIT13";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ESI_LSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ESI_LSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S_TTL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S_TTL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_TTL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_TTL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_BOS_TTL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_BOS_TTL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SET_BITS_7_8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SET_BITS_7_8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SVID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SVID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FAP_ID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FAP_ID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SA_FAP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SA_FAP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SA_LAG:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SA_LAG";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IS_LAG:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IS_LAG";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_3_M:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_3_M";
        break;   
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_0_M:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_0_M";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_0_M:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_0_M";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_12:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_12";
        break;   
    case ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP";
        break; 
    case ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP_COMP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP_COMP";
        break; 
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC_AS_MSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC_AS_MSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MPLS_CLEAR_EXP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MPLS_CLEAR_EXP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IN_DSCP_TO_EXP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IN_DSCP_TO_EXP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_OUT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_OUT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_PPH_VSI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_PPH_VSI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_TAG_NUM:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_TAG_NUM";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_OUTFP_MSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_OUTFP_MSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_DEL_LEN:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_DEL_LEN";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_VLAN_STATUS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_VLAN_STATUS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_IN:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_IN";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_COS_COLOR:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_COS_COLOR";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_LAG:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_LAG";
    break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_FROM_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_FROM_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_H_S:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_H_S";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN_JER:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN_JER";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_GPON_STAG_PCP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_GPON_STAG_PCP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_GPON_GEM_ID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_GPON_GEM_ID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_EGR_INJ_OPCODE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_EGR_INJ_OPCODE";
        break;
        case ARAD_EGR_PROG_EDITOR_LFEM_IPV6_VXLAN_NH_HL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IPV6_VXLAN_NH_HL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IPV6_VXLAN_FL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IPV6_VXLAN_FL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_3:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_3";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_1_M_5:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_1_M_5";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_COE_TAG_TC_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_COE_TAG_TC_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_COE_TAG_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_COE_TAG_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_2_M_6:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_2_M_6";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_17_RSHIFT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_17_RSHIFT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_6:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_0_M_6";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_CH_PPH_TYPE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_CH_PPH_TYPE";
        break;     
    case ARAD_EGR_PROG_EDITOR_LFEM_CH_OTSH_TYPE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_CH_OTSH_TYPE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_AND_D_CLEAR:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_AND_D_CLEAR";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SBFD_UDH_0_15_LSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SBFD_UDH_0_15_LSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SBFD_UDH_16_BIT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SBFD_UDH_16_BIT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OUT_LIF_MSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OUT_LIF_MSB";
        break;
    default:
        *lfem_name = "Unknown LFEM";
        break;
    }
}


void
  arad_egr_prog_editor_print_lfem_duplicates(
     int unit
  ) {

    uint8
        lfems[ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS][2];
    int
        i,j,k;
    char
        *lfem_name,
        array_num_buf[8];

    
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        lfems[i][0] = 0; 
        lfems[i][1] = 0; 
    }

    
    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; j < ARAD_PP_EG_PROG_NOF_FEM(unit); j++) {
            if (lfem_maps_shadow[unit][i][j] == ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                
                break;
            }
            else {
                lfems[lfem_maps_shadow[unit][i][j]][0]++;
                lfems[lfem_maps_shadow[unit][i][j]][1] |= (0x01 << i);
            }
        }
    }

    LOG_CLI((BSL_META_U(unit,
                        "\n\r\n\r")));

    
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        if (lfems[i][0] > 1) {
            

            
            arad_egr_prog_editor_lfem_name_get_by_id(i, &lfem_name);

            
            k = 0;
            for (j = 0; j < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); j++) {
                if (lfems[i][1] & (0x01 << j)) {
                    array_num_buf[k++] = ' ';
                    array_num_buf[k++] = '0' + j;
                }
            }
            array_num_buf[k] = '\0';

            LOG_CLI((BSL_META_U(unit,
                                "FIX HINT: Duplicate load of %s to:%s\n\r"), lfem_name, array_num_buf));
        }
    }

    LOG_CLI((BSL_META_U(unit,
                        "\n\r\n\r")));

}


STATIC uint32
  arad_egr_prog_editor_allocate_program(
    SOC_SAND_IN int unit ,
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_PROGRAMS                                 prog
  )
{
  int i,j;
  int tm_profile_already_allocated = 0;
  int tm_profiles;
  uint32 tm_profile;
  soc_error_t rv;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_ALLOCATE_PROGRAM_AND_ITS_LFEMS);

  
  if (prog == ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT) {
      SOC_SAND_EXIT_NO_ERROR;
  }

  
  for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
      for (j = 0; j < ARAD_PP_EG_PROG_NOF_FEM(unit); j++) {
          rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.lfem_bk.set(
              unit, prog, i, j, ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
      }
  }

  
  rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.set(
    unit, prog, ++last_program_id[unit]);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
  if (last_program_id[unit] > SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)) {
     SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_PROGRAMS_ERR, 10, exit);
  }

  if (prog == ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH) {
      goto exit; 
  }

  if (prog == ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER) {
      goto exit; 
  }

  if ((prog == ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1) ||
        (prog == ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1) ||
        (prog == ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS_1PLUS1)) {
      goto exit;
  }

  
  rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.set(
    unit, prog, ++last_program_pointer[unit]);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
  if (last_program_pointer[unit] > SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)) {
      SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_INSTRUCTION_ENTRIES_ERR, 40, exit);
  }

  
  if(programs_usage[unit].user_header_always_remove) {
      
      rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(
        unit, prog, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
      if (tm_profile == ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG) {
          tm_profile_already_allocated = 1;
      }
  }

  rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(
    unit, prog, &tm_profile);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
  if ((tm_profile != -1) && (!tm_profile_already_allocated)) {
      rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 40, exit);
      if (tm_profiles == -1) {
          
          rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, tm_profile, ++last_tm_profile[unit]);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 50, exit);

          if (last_tm_profile[unit] > tm_profiles_available[unit]) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_TM_PROFILES_ERR, 60, exit);
          }
      }
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_allocate_program()",0,0);
}


STATIC uint32
  arad_egr_prog_editor_programs_alloc(
     SOC_SAND_IN  int                                 soc_petrab_cfg,
     SOC_SAND_IN  int                                 unit,
     uint32                                           user_header_size
  )
{
  uint32 res;
  int arad_prog_editor_otmh_keep_pph_port_present;
  int pp_port, tm_rm_hdrs;
  int pp_port_program_loaded=0, tm_port_program_loaded=0;
  uint32 port_idx,timestamp_ssp = 0,is_valid;
  char *propval;
  uint32 is_pon_dpp_load;
  soc_pbmp_t pbmp;
  uint8 allocate_eth_reflector = 0;
  uint8 lb_ext_enable;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_ALLOCATE_PROGRAMS_AND_LFEMS_ALLOC);

  is_pon_dpp_load=0;
  propval = soc_property_get_str(unit, spn_PON_APPLICATION_SUPPORT_ENABLED);
  if (propval) {      
      if (sal_strcmp(propval, "TRUE") == 0) {
          is_pon_dpp_load = 1;
      } else {
          is_pon_dpp_load = 0;
      }
  }

  if ((propval = soc_property_get_str(unit, "system_ftmh_load_balancing_ext_mode")) != NULL) {
    if (sal_strcmp(propval,"ENABLED") == 0) {
        lb_ext_enable = 1;    
    } else {
        lb_ext_enable = 0;
    }
  } else {
    lb_ext_enable = 0;
  }

  
  tm_rm_hdrs = (1 << (soc_mem_field_length(unit, EPNI_PRGE_PROGRAM_SELECTION_CAMm, PRGE_TM_PROFILEf)-1));

  if (SOC_IS_QUX(unit) && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ipfpm_enable", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 300, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 300, exit);
  }  

  if (SOC_IS_JERICHO(unit) && SOC_DPP_PPPOE_IS_ENABLE(unit)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }

  if (SOC_IS_JERICHO(unit) && SOC_DPP_L2TP_IS_ENABLE(unit)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_L2TP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }

  if(programs_usage[unit].user_header_always_remove) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS, tm_rm_hdrs);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, tm_rm_hdrs - 1);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

      tm_profiles_available[unit] = tm_rm_hdrs - 1;

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);


  }
  else {
      tm_profiles_available[unit] = 2 * tm_rm_hdrs - 1;
  }

  if (programs_usage[unit].otmh_base) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  arad_prog_editor_otmh_keep_pph_port_present=0;
  for (pp_port = 0; pp_port < ARAD_PORT_NOF_PP_PORTS; pp_port++) {
      if (soc_property_suffix_num_get(unit, pp_port, spn_CUSTOM_FEATURE, "otmh_keep_pph_", 0) == 1) {
          arad_prog_editor_otmh_keep_pph_port_present = 1;
      }
      if (soc_property_port_suffix_num_get(unit, pp_port, -1, spn_CUSTOM_FEATURE, "vendor_custom_tm_port", FALSE) == 1) {
          if (!tm_port_program_loaded) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING); 
              SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
              tm_port_program_loaded = 1;
          }
      }
      if (soc_property_port_suffix_num_get(unit, pp_port, -1, spn_CUSTOM_FEATURE, "vendor_custom_pp_port", FALSE) == 1) {
          if (!programs_usage[unit].customer_conn_to_np_enable) {
              if (!pp_port_program_loaded) {
                  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
                  pp_port_program_loaded = 1;
              }
          }
      }

  }

  if (arad_prog_editor_otmh_keep_pph_port_present) {
      if (!soc_petrab_cfg) { 
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
  }

  if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) { 
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 16, exit);
  }

  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  if (programs_usage[unit].ch_enable) {

      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

      
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "rfc2544_reflector_mac_swap_1pass", 0) == 2) 
      {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
      }

      
      if (programs_usage[unit].rspan) 
      {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN);
          SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
      }

  }

  if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
  }

   
  if((soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ext_ipv4_mpls_extended_fwd_table_size", 0)) ||
	 (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ext_ipv6_extended_fwd_table_size", 0))){
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);

      if (SOC_IS_JERICHO(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW);
          SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW);
          SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW);
          SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
      }
  }

  
  if (SOC_DPP_CONFIG(unit)->pp.custom_ip_route) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
  }
  
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "lsr_manipulation", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION);
      SOC_SAND_CHECK_FUNC_RESULT(res, 27, exit);
  }  

    
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ip_tunnel_preserve_dscp", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
  }

    
  if (SOC_DPP_CONFIG(unit)->pp.pon_dscp_remarking) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6);
      SOC_SAND_CHECK_FUNC_RESULT(res, 27, exit);
  }

  
  SOC_SAND_SOC_IF_ERROR_RETURN(res, 26, exit, soc_port_sw_db_valid_ports_get(unit, 0, &pbmp));
  SOC_PBMP_ITER(pbmp, port_idx) {
      if (soc_property_port_suffix_num_match_port_get(unit, port_idx, -1, spn_CUSTOM_FEATURE, "dedicated_recycle_port", 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
          break;
      }
  }


  if (SOC_DPP_CONFIG(unit)->pp.test1) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }  
  
  if(SOC_DPP_CONFIG(unit)->pp.test2){
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TEST2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

  } else if (SOC_DPP_CONFIG(unit)->pp.mim_bsa_lsb_from_ssp){
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TEST2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  
  if ((SOC_DPP_CONFIG(unit)->pp.udh_port_exists))
  {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  if ((!SOC_IS_ARADPLUS(unit) && (SOC_DPP_CONFIG(unit)->pp.next_hop_mac_extension_enable))
      || (SOC_IS_ARADPLUS(unit) && (SOC_IS_NEXT_HOP_MAC_EXT_ARAD_COMPATIBLE(unit))))
    {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

      if (programs_usage[unit].xgs_pp) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 21, exit);
    }
  }

  if (SOC_IS_JERICHO(unit) && (lb_ext_enable == 1)
        && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "tdm_coe_conn", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);
  }
  
  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER);
  SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);



  
  if (SOC_IS_ARAD_B1_AND_BELOW(unit) && programs_usage[unit].vxlan) {
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VXLAN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);
  }

  if (programs_usage[unit].rspan) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);

      if (programs_usage[unit].xgs_pp) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }
  }

  if (programs_usage[unit].erspan) {
      if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }
      else {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }

      if (programs_usage[unit].xgs_pp) {
          if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
              res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
          }
          else {
              res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
          }
      }
  }

  if (programs_usage[unit].xgs_tm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
  }

  if (programs_usage[unit].xgs_pp) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 95, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 98, exit);
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 100, exit);
  }  
  
  if (programs_usage[unit].epon || is_pon_dpp_load) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 105, exit);
  }

  if (programs_usage[unit].dsa_rx) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_DSA_RX);
      SOC_SAND_CHECK_FUNC_RESULT(res, 106, exit);
  }
  
  if (programs_usage[unit].dsa_tx) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_DSA_TX);
      SOC_SAND_CHECK_FUNC_RESULT(res, 107, exit);
   }

  if (programs_usage[unit].ipv4_tunnel_tor) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR);
      SOC_SAND_CHECK_FUNC_RESULT(res, 115, exit);
  }
  
  if (programs_usage[unit].ipv6_tunnel) {
      if ((SOC_IS_JERICHO(unit) && 
        ((SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_NORMAL) ||
        (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LARGE))) ||
          (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LEGACY)) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
          SOC_SAND_CHECK_FUNC_RESULT(res, 115, exit);
      }
  }

  if (programs_usage[unit].egr_inj_wa) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }
  if (programs_usage[unit].egr_inj_opcode) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  if (programs_usage[unit].oam_loopback) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit); 
  }

  if (programs_usage[unit].oam_ts_ccm) {

      if (SOC_IS_JERICHO_PLUS(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
      
      if (programs_usage[unit].oam_dm_ntp &&
          soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_up_rx_ntp_enable", 1)) {
          if (!(SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable && 
            (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) && SOC_IS_JERICHO(unit)))) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
          }
      }

      if (user_header_size && SOC_IS_JERICHO(unit) && programs_usage[unit].bfd_echo) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      } else {
          if (user_header_size && SOC_IS_JERICHO(unit)) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH);
              SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
          }

          
          if ((programs_usage[unit].bfd_echo) && SOC_IS_ARADPLUS(unit)) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
              SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
          }
      }
        
      if (programs_usage[unit].oam_dm_up_rx) {
          if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
              
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
          }
      }
      if (programs_usage[unit].oam_lm_upmep) {
        if (!(SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable && 
          (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) && SOC_IS_JERICHO(unit)))) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
        }
      }
      if (programs_usage[unit].oam_upmep) {
          if (!(SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable && 
            (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) && SOC_IS_JERICHO(unit)))) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
              SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
          } else if (SOC_IS_JERICHO(unit) && soc_property_get(unit, spn_SAT_ENABLE, 1)) {
              
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
              SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
          }
          
          if (SOC_IS_JERICHO(unit) && soc_property_get(unit, spn_SAT_ENABLE, 1)) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT);
              SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
          }
      }
      if (programs_usage[unit].oam_dm_down) {
          if (programs_usage[unit].oam_dm_ntp &&
          soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_up_rx_ntp_enable", 1) ) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);

              if(SOC_DPP_CONFIG(unit)->pp.dm_down_trap_enable_udh_2cpu && user_header_size){
                res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP_2CPU);
                SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
              }

          }
          if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
              
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
              if(SOC_DPP_CONFIG(unit)->pp.dm_down_trap_enable_udh_2cpu && user_header_size){
                res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_2CPU);
                SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
              }
          }
      }
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "egress_snooping_advanced", 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }

      if (programs_usage[unit].bfd_chan_override || (SOC_DPP_CONFIG(unit)->pp.bfd_masked_flags_bitfield != 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }

      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "eg_pwe_counting", 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }

      if (SOC_DPP_CONFIG(unit)->pp.oam_use_double_outlif_injection) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }
  }

  if (programs_usage[unit].oam_1711) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }
  if ((programs_usage[unit].sbfd_reflector) && SOC_IS_JERICHO(unit)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  if (programs_usage[unit].tdm_pmm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 165, exit);
  }

  if (programs_usage[unit].tdm_stamp_cud) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 175, exit);
      if (SOC_IS_JERICHO(unit) && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "tdm_eg_editing_is_cud_stamping", 0) == 1)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 175, exit);
      }
  }

  if (programs_usage[unit].tdm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 185, exit);
  }

  if (programs_usage[unit].stacking) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_STACKING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 205, exit);
  }

  if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == ARAD_MGMT_FTMH_LB_EXT_MODE_FULL_HASH) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 205, exit);
  }

  if (programs_usage[unit].two_hop_scheduling) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 215, exit);
  }

  if (programs_usage[unit].l2_remote_cpu) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU);
      SOC_SAND_CHECK_FUNC_RESULT(res, 225, exit);
  }

   if (programs_usage[unit].l2_encap_external_cpu) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
  }
  if (programs_usage[unit].otmh_cud) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }

  if (programs_usage[unit].size_header) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }

  if (programs_usage[unit].npv_without_my_mac) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (SOC_IS_ROO_ENABLE(unit)) {
      if (SOC_IS_ARADPLUS_A0(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN);
          SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
      }
      else if (SOC_IS_JERICHO_AND_BELOW(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY);
          SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
      }
  }

  
  if ((SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp) {
      if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
          
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      } else {
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "dscp_preserve_with_extend_label", 0)) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER);
              SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
              
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS);
              SOC_SAND_CHECK_FUNC_RESULT(res, 292, exit);
              
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER);
              SOC_SAND_CHECK_FUNC_RESULT(res, 293, exit);
          }

          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mixed_qos_model_enable", 0)) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL);
              SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
          }

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 292, exit);

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 293, exit);
      }
  }

  
  if (programs_usage[unit].trill || (SOC_DPP_CONFIG(unit)->arad->pp_op_mode.mim_enable) ||
      (SOC_DPP_CONFIG(unit)->pp.ipv6_with_rpf_2pass_exists) || (SOC_DPP_CONFIG(unit)->pp.add_ptch2_header) || programs_usage[unit].recycle_with_ptch2) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 245, exit);
  }

  if (programs_usage[unit].vmac_enable) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (programs_usage[unit].olp_petra) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 275, exit);
  }

  if (programs_usage[unit].oam_ts_ccm && SOC_IS_ARADPLUS(unit)) {
      if (soc_property_get(unit, spn_OAM_MAID_11_BYTES_ENABLE,0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
      else if (SOC_IS_ARADPLUS_A0(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  for (port_idx = 0; port_idx < SOC_MAX_NUM_PORTS; ++port_idx) {
      if (soc_property_port_get(unit, port_idx, spn_RFC2544_REFLECTOR_MAC_AND_IP_SWAP_PORT, 0)) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
          break; 
      }
  }

  
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "rfc2544_reflector_mac_swap_1pass", 0) == 1) {
      allocate_eth_reflector = 1;
  }
  else {
      for (port_idx = 0; port_idx < SOC_MAX_NUM_PORTS; ++port_idx) {
          if (soc_property_port_get(unit, port_idx, spn_RFC2544_REFLECTOR_MAC_SWAP_PORT, 0)) {
              allocate_eth_reflector = 1;
              break; 
          }
      }
  }

  if (allocate_eth_reflector) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "rfc2544_reflector_mac_swap_1pass", 0) == 2) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (programs_usage[unit].mpls_raw) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }

  if (programs_usage[unit].delay_based_ecn2) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }

  if (programs_usage[unit].evpn) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      if (programs_usage[unit].evpn_frr) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }
  if (programs_usage[unit].evpn_frr) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }
  if (programs_usage[unit].mpls_eli) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);

      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "egress_mpls_entropy_label_on_non_bos_enable", 1)) {
         res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER);
         SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
         res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER);
         SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "four_independent_mpls_encapsulation_enable", 0) == 1) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);

  }

  if (programs_usage[unit].mpls_extended) {
      if(SOC_IS_JERICHO_PLUS(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      } else {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (programs_usage[unit].mim_spb) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      if (SOC_IS_JERICHO_B0_AND_ABOVE(unit)) {
          
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (SOC_DPP_CONFIG(unit)->pp.udp_tunnel_enable && SOC_IS_JERICHO_B0_AND_ABOVE(unit)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }
  
  
  if (SOC_IS_JERICHO(unit) && programs_usage[unit].customer_conn_to_np_enable) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS_1PLUS1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
  }

  
  if (soc_property_get(unit, spn_EGRESS_ACL_TWO_PASS_ENABLE, 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 286, exit);
  }

  if(SOC_IS_JERICHO_PLUS(unit))
  {
      if (programs_usage[unit].ipsec)
      {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          LOG_ERROR(BSL_LS_BCM_FP,
                    (BSL_META_U(unit,
                                "____________IPSEC - program allocated  \n")));
      }
  }
  if ((SOC_IS_JERICHO(unit))) { 
    for (port_idx = 0; port_idx < SOC_MAX_NUM_PORTS; ++port_idx) {

        res = soc_port_sw_db_is_valid_port_get(unit, port_idx, &is_valid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 286, exit);
        if (!is_valid) {
          continue;
        }
        res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.timestamp_and_ssp.get(unit, port_idx, &timestamp_ssp);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 287, exit);
        if (timestamp_ssp) {
            res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP);
            SOC_SAND_CHECK_FUNC_RESULT(res, 288, exit);
            break;
        }
    }
  }
 
  if (SOC_DPP_CONFIG(unit)->pp.lawful_interception_enable) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_LI);
      SOC_SAND_CHECK_FUNC_RESULT(res, 300, exit);

      if (SOC_IS_QAX(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6);
          SOC_SAND_CHECK_FUNC_RESULT(res, 300, exit);
      }
  }
 
  if (SOC_DPP_CONFIG(unit)->pp.l2_src_encap_enable) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 300, exit);
  }

  if (programs_usage[unit].generalized_rcy_header_0) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  if (programs_usage[unit].generalized_rcy_header_1) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "vxlan_roo_copy_dscp", 0)
        && SOC_IS_JERICHO_PLUS(unit)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }

  if (programs_usage[unit].prefix_20byte) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }

  if(SOC_IS_JERICHO(unit))
  {
      if (programs_usage[unit].ioam_mpls)
      {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }

      if (programs_usage[unit].ioam_copy_dscp)
      {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mixed_qos_model_enable", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_programs_alloc()",0,0);
}


uint32
  arad_egr_prog_editor_unsafe(
    SOC_SAND_IN  int                                 unit
  )
{
    uint32
      res = SOC_SAND_OK;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_UNSAFE);

  SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_LINK_FILTER_ENABLEr, SOC_CORE_ALL, 0, TM_OR_CPU_EEDB_FILTER_ENABLEf,  0x0));

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_unsafe()", 0, 0);
}

 

uint32
  arad_egr_prog_editor_invalidate_program_by_id(
    SOC_SAND_IN  uint32                          unit ,
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_PROGRAMS   prog ,
    SOC_SAND_IN  int                             prog_selection_valid
  )
{
    uint32 res;
    uint32 program_pointer_id = 0;
    int program_sel;
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA prog_sel_tbl_data;
    int set_valid, found_flg=0;
    char* prog_name;
    int prog_used;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    arad_egr_prog_editor_prog_name_get_by_id(prog, &prog_name);
        LOG_CLI((BSL_META_U(unit,
                            "program %d: %s\n"), prog, prog_name));

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, prog, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        program_pointer_id = prog_used;
        LOG_CLI((BSL_META_U(unit,
                            "arad_egr_prog_editor_invalidate_program_by_id, map program_id to %d\n"), program_pointer_id));
    } 
    else {
        soc_sand_os_printf("ERROR, arad_egr_prog_editor_invalidate_program_by_id, failed to map program_id \n");
        res = SOC_E_NOT_FOUND;
        SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);
    }

    set_valid = (prog_selection_valid == 0)? 0:1;

    for (program_sel = 0; program_sel < ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); program_sel++) {

        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, program_sel, &prog_sel_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 255+2, exit);
        if (prog_sel_tbl_data.program == program_pointer_id) {
            prog_sel_tbl_data.valid = set_valid;
            found_flg++;

            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, program_sel, &prog_sel_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 255+3, exit); 
        }
    }
    
    res = (found_flg==0)? SOC_E_NOT_FOUND: SOC_E_NONE;
    SOC_SAND_CHECK_FUNC_RESULT(res, 255+4, exit); 

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_invalidate_program_by_id()",0,0);
}


uint32
  arad_egr_prog_editor_null_prog_init(
    SOC_SAND_IN int unit,
    SOC_SAND_IN int entry_even,
    SOC_SAND_IN int entry_odd
  )
{
    uint32 
        res;
    int
        mem = EPNI_PRGE_INSTRUCTION_0m,   
        entry = entry_even;
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) { 

        
        prge_instruction_tbl_data.src_select  = 2;    
        prge_instruction_tbl_data.offset_base = 53; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; 
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, 
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = 0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value    = 0;
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action  = 0;
        prge_instruction_tbl_data.dst_select  = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = 0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 0x7; 
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; 
        
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = 0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.offset_base = 113; 
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; 
        prge_instruction_tbl_data.size_base   = 0; 
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value    = 0;
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action  = 0;  
        prge_instruction_tbl_data.dst_select  = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    } 
    else { 
        
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, EPNI_PRGE_INSTRUCTION_0m, 0, 0, 1) );
    }
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_null_prog_init()", mem, entry);

}



uint32
  arad_egr_prog_editor_cat_nops(
    SOC_SAND_IN int unit,
    SOC_SAND_IN int first_mem,
    SOC_SAND_IN int first_entry,
    SOC_SAND_IN int entry_even,
    SOC_SAND_IN int entry_odd
  )
{

    uint32 
        res;
    int
        mem = first_mem,
        entry = first_entry;
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    
    prge_instruction_tbl_data.src_select  = 0;
    prge_instruction_tbl_data.offset_base = 0;
    prge_instruction_tbl_data.offset_src  = 0;
    prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.size_base   = 0;
    prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value    = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action  = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action  = 0;
    prge_instruction_tbl_data.dst_select  = 0;

    while (mem < EPNI_PRGE_INSTRUCTION_0m + ARAD_PP_EG_PROG_NOF_INSTR_MEMS(unit)) {
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data); 
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_cat_nops()", mem, entry);
}


uint32
  arad_egr_prog_editor_load_required_lfems(
    SOC_SAND_IN int unit
  )
{
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  
        lfem_field_select_map_tbl_data;
    int
        i = 0, 
        j = 0, 
        res = 0;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; (j < ARAD_PP_EG_PROG_NOF_FEM(unit)) ; j++ )
        {
            if (lfem_maps_shadow[unit][i][j] < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                
                lfem_map_action_to_lfem_field_select_map(lfem_maps_shadow[unit][i][j], &lfem_field_select_map_tbl_data);
                res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, i, j, &lfem_field_select_map_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
            }
            else {
                
                break;
            }
        }
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_load_required_lfems()", i, j);
}

uint32
  lfem_map_to_uint32(
    SOC_SAND_IN  lfem_map lfem
  )
{
    return ((lfem.val1 << 5) | lfem.val2);
}

void
  lfem_map_arr_to_lfem_field_select_map(
    SOC_SAND_IN  lfem_map lfem_arr[],
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  )
{
    tbl_data->lfem_field_select_map[0] = lfem_map_to_uint32(lfem_arr[15]) | 
                                         (lfem_map_to_uint32(lfem_arr[14]) << 6) | 
                                         (lfem_map_to_uint32(lfem_arr[13]) << 12) | 
                                         (lfem_map_to_uint32(lfem_arr[12]) << 18) | 
                                         (lfem_map_to_uint32(lfem_arr[11]) << 24) | 
                                         ((lfem_map_to_uint32(lfem_arr[10]) & 0x3) << 30);
    tbl_data->lfem_field_select_map[1] = ((lfem_map_to_uint32(lfem_arr[10]) & 0x3c) >> 2) | 
                                         (lfem_map_to_uint32(lfem_arr[9]) << 4) | 
                                         (lfem_map_to_uint32(lfem_arr[8]) << 10) | 
                                         (lfem_map_to_uint32(lfem_arr[7]) << 16) | 
                                         (lfem_map_to_uint32(lfem_arr[6]) << 22) | 
                                         ((lfem_map_to_uint32(lfem_arr[5]) & 0xf) << 28);
    tbl_data->lfem_field_select_map[2] = ((lfem_map_to_uint32(lfem_arr[5]) & 0x30) >> 4) | 
                                         (lfem_map_to_uint32(lfem_arr[4]) << 2) | 
                                         (lfem_map_to_uint32(lfem_arr[3]) << 8) | 
                                         (lfem_map_to_uint32(lfem_arr[2]) << 14) | 
                                         (lfem_map_to_uint32(lfem_arr[1]) << 20) | 
                                         (lfem_map_to_uint32(lfem_arr[0]) << 26);
}


uint32
  lfem_couple_to_uint32(
    SOC_SAND_IN  uint8  value,
    SOC_SAND_IN  uint8  idx_or_val_bit
  )
{
    return ((idx_or_val_bit << 5) | value);
}


void
  lfem_map_action_to_lfem_field_select_map(
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_LFEM lfem_action,
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  )
{
    uint8* lfem_arr = &lfem_actions[lfem_action][1];
    tbl_data->lfem_field_select_map[0] = lfem_couple_to_uint32(lfem_arr[31], lfem_arr[30]) | 
                                         (lfem_couple_to_uint32(lfem_arr[29], lfem_arr[28]) << 6) | 
                                         (lfem_couple_to_uint32(lfem_arr[27], lfem_arr[26]) << 12) | 
                                         (lfem_couple_to_uint32(lfem_arr[25], lfem_arr[24]) << 18) | 
                                         (lfem_couple_to_uint32(lfem_arr[23], lfem_arr[22]) << 24) | 
                                         ((lfem_couple_to_uint32(lfem_arr[21], lfem_arr[20]) & 0x3) << 30);
    tbl_data->lfem_field_select_map[1] = ((lfem_couple_to_uint32(lfem_arr[21], lfem_arr[20]) & 0x3c) >> 2) | 
                                         (lfem_couple_to_uint32(lfem_arr[19], lfem_arr[18]) << 4) | 
                                         (lfem_couple_to_uint32(lfem_arr[17], lfem_arr[16]) << 10) | 
                                         (lfem_couple_to_uint32(lfem_arr[15], lfem_arr[14]) << 16) | 
                                         (lfem_couple_to_uint32(lfem_arr[13], lfem_arr[12]) << 22) | 
                                         ((lfem_couple_to_uint32(lfem_arr[11], lfem_arr[10]) & 0xf) << 28);
    tbl_data->lfem_field_select_map[2] = ((lfem_couple_to_uint32(lfem_arr[11], lfem_arr[10]) & 0x30) >> 4) | 
                                         (lfem_couple_to_uint32(lfem_arr[9], lfem_arr[8]) << 2) | 
                                         (lfem_couple_to_uint32(lfem_arr[7], lfem_arr[6]) << 8) | 
                                         (lfem_couple_to_uint32(lfem_arr[5], lfem_arr[4]) << 14) | 
                                         (lfem_couple_to_uint32(lfem_arr[3], lfem_arr[2]) << 20) | 
                                         (lfem_couple_to_uint32(lfem_arr[1], lfem_arr[0]) << 26);
}

void 
  header_editing_size_to_reg_val(
    SOC_SAND_IN  soc_reg_above_64_val_t val, 
    SOC_SAND_OUT soc_reg_above_64_val_t dest
  )
{
    SOC_REG_ABOVE_64_CLEAR(dest);

    dest[0] = val[0] | (val[1] << 7) | (val[2] << 14) | (val[3] << 21) | ((val[4] & 0xf) << 28);
    dest[1] = ((val[4] & 0x70) >> 4) | (val[5] << 3) | (val[6] << 10) | (val[7] << 17) | (val[8] << 24) | ((val[9] & 0x1) << 31);
    dest[2] = ((val[9] & 0x7E) >> 1) | (val[10] << 6) | (val[11] << 13) | (val[12] << 20) | ((val[13] & 0x1f) << 27);
    dest[3] = ((val[13] & 0x60) >> 5) | (val[14] << 2) | (val[15] << 9);  
}







uint32
    arad_egr_prog_editor_add_custom_sa(int unit,
                                       int *entry_ ,
                                       int entry_odd ,
                                       int entry_even,
                                       int *mem_) 
{
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;
    int res,entry,mem;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    entry = *entry_;
    mem = *mem_;

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
    prge_instruction_tbl_data.offset_base     = 46; 
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES, 
                                               mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0; 
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    

    mem   = (entry == entry_odd) ? (mem + 1) : mem;                                                  
    entry = (entry == entry_even) ? entry_odd : entry_even;                                          
                                                                                                     
    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;                           
    prge_instruction_tbl_data.offset_base     = 52;                                                  
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;                     
    prge_instruction_tbl_data.size_base       = 3;                                                    
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;                         
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);                       
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;                    
    prge_instruction_tbl_data.op_value        = 0;                                                   
    prge_instruction_tbl_data.op_2_field_select = 0;                                                 
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;                             
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;                          
    prge_instruction_tbl_data.cmp_action      = 0x0;                                                 
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;                         
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);  

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
    prge_instruction_tbl_data.offset_base     = 59;  
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 1; 
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
    prge_instruction_tbl_data.offset_base     = 41; 
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 2; 
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 

    *entry_ = entry;
    *mem_ = mem;

    exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_custom_sa()",0,0);
}



uint32
  arad_egr_prog_editor_sbfd_reflector_status_update(
    SOC_SAND_IN int unit,
    SOC_SAND_IN int status
  )
{
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA lfem_field_select_map_tbl_data;
    int i = 0, j = 0, res = 0;
    ARAD_EGR_PROG_EDITOR_LFEM lfem_action;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if(status == 0){
        lfem_action = ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_AND_D_CLEAR;
    }
    else if(status == 3){
        lfem_action = ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_UP;
    }
    else{
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG(" Sta isn't supported\n\r")));
    }
    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; (j < ARAD_PP_EG_PROG_NOF_FEM(unit)) ; j++ )
        {
            if (lfem_maps_shadow[unit][i][j] == ARAD_EGR_PROG_EDITOR_LFEM_SBFD_STA_AND_D_CLEAR) {
                
                lfem_map_action_to_lfem_field_select_map(lfem_action, &lfem_field_select_map_tbl_data);
                res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, i, j, &lfem_field_select_map_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
                break;
            }
        }
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_sbfd_reflector_status_update()", i, j);
}


uint32 arad_egr_prog_editor_sbfd_reflector(int unit, uint32 user_header_size)
{
    int prog_used;
    uint32 res;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "bfd_debug", 0) == 1) {
        CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR);
    }
    else {
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

            
            INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS),    ALU_SET(0, REG_OP(1)),              " Get PPH-Base.Forwarding-Header-Offset's to FEM, NOP");
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),    ALU_NOP,                            "NOP");
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),    ALU_SUB(FEM, CNST(4), REG_OP(2)) ,  "Read System header size, R2 = network_size + UDH+ 16(BFD-> Desired_tx)");
            INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(2)),              ALU_ADD(FEM,CNST(user_header_size), REG_OP(3)),                            "copy 4bytes 0 for rx echo min,  R3-> UDH  ");
            INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(2)),              ALU_ADD(FEM,REG_OP(2), REG_OP(SZ)), "copy 4bytes 0 for rx echo min,  Rsz ->Min TX Interval   ");
            INSTR( CE_FCOPY( PrgeDataFieldProgVar, 0, C_SIZE(4) ),        ALU_NOP,                            "Copy Required min Rx;  System header size + network_size + 16  ");
            INSTR( CE_COPY(PKT, R_OFST(SZ,0), C_SIZE(4)) ,                ALU_SUB(REG_OP(SZ), CNST(4), REG_OP(SZ)), "Copy Desired Min TX Interval;  sz-> You dis ");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-16), C_SIZE(4)) ,              ALU_NOP,                             " Copy your dis from my dis, SZ->TX, offset 8bytes is my dis; ALU_NOP ");
            INSTR( CE_COPY(PKT, R_OFST(SZ,0),C_SIZE(4)) ,                 ALU_NOP,                             " Copy my dis from you dis, SZ->You dis;   ");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-16), C_SIZE(2)) ,              ALU_SUB(REG_OP(SZ), CNST(12), REG_OP(SZ))  ,   " Copy Detect Mult  & Length (2bytes),  offset = SZ->You dis -16 ; ALU_NOP ");
 
            
            INSTR( CE_LCOPY(PKT, R_OFST(SZ,-20),C_SIZE(2), LFEM_SBFD_STA_AND_D_CLEAR) ,ALU_NOP,    " FEM (vers -- Mbit);ALU_NOP");

            
            INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(2)),             ALU_NOP,                              "copy 2bytes 0 for checksum,  ALU_NOP   ");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-4), C_SIZE(2)) ,              ALU_NOP ,                              " Copy UDP lenth & checksum (sz point on UDP tail)	; ALU_NOP");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-12), C_SIZE(2)),              ALU_SUB(REG_OP(SZ), CNST(8), REG_OP(SZ)) , " Copy UDP  dport, offset = upd tail + 6bytes,  Make zs -> Ipv4 DIP");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-8),C_SIZE(2)),                ALU_NOP,                               " Copy UDP  sport ,offset = upd tail + 4bytes ");

            
            INSTR( CE_LREAD(PKT,  R_OFST(3,0), LFEM_SBFD_UDH_0_15_LSB),   ALU_NOP,              " Get UDH[15:0], NOP");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-8),C_SIZE(4)),                 ALU_NOP,              " Copy 4bytes DIP from SIP , offset = SZ->dip+4bytes,  ");
            INSTR( CE_LREAD(PKT,  R_OFST(3,0), LFEM_SBFD_UDH_16_BIT),     ALU_SUB(CNST(0xffff ), FEM, REG_OP(2)),   " CE_NOP, R2 = 0xffff - UDH[16] - UDH[15:0]");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -8, C_SIZE(4)) ,        ALU_SUB(REG_OP(SZ), CNST(8), REG_OP(SZ)), " Copy SIP from Program Vars[63:32], Make SZ-> checksum");
            INSTR( CE_LREAD(PKT, R_OFST(SZ,-12), LFEM_STACKING_8),       ALU_SUB(REG_OP(2), FEM, REG_OP(2)),      "SZ ->DIP (to SIP[31:16] , offset is 6bytes, R2 = 0xffff - UDH[16] - UDH[15:0]");
            INSTR( CE_NOP,                                               ALU_NOP,              "CE_NOP , NOP");
            INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(2)),             ALU_SUB(CNST(0xffff ), FEM, REG_OP(3)),   " Copy checksum from R2,   Identification = 0xffff - SIP[31:16]  ");

            
            INSTR( CE_COPY(PKT, R_OFST(SZ,-4),C_SIZE(4)) ,               ALU_NOP,                                " Copy 4bytes from flags to protocol ");
            
            INSTR( CE_FCOPY(PrgeDataFieldR3,  0, C_SIZE(2)),             ALU_NOP,                                " Copy checksum from R2, ");
            INSTR( CE_COPY(PKT, R_OFST(SZ,-16), C_SIZE(4)) ,             ALU_NOP,                                " Copy 4bytes from ver to length ");

            
            INSTR( CE_COPY(GEN, R_OFST(0,0),  R_SIZE(0,0)) ,             ALU_SUB(REG_OP(0), CNST(16), REG_OP(0)), " Copy 8bytes from R0 ");
            INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8)) ,           ALU_NOP ,                                "PP-Copy with R0");
            INSTR( CE_COPY(GEN, R_OFST(0,0),  R_SIZE(0,0)) ,             ALU_NOP ,                                " Copy 8bytes from R0 ");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_ch_header()",0,0);
}

uint32 arad_egr_prog_editor_mixed_qos_model(int unit)
{
    int prog_used;
    uint32 res;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        int ftmh_pph_fhei_total_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;
        int ii = 0;

        ftmh_pph_fhei_total_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        
         INSTR( CE_NOP                                        , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " -- ; Rsz = R3-R2 ");
         INSTR( CE_NOP                                        , ALU_SET( 0, REG_OP(1)),     "--- ; R1 = 0"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,4))     , ALU_SUB( REG_OP(3), CNST(16)     , REG_OP(3) ),    "Copy 8B from offset R3    ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,-4))  , ALU_SUB( REG_OP(SZ), CNST(12)     , REG_OP(SZ)  ), "Copy 8B from offset R3-16    ; RSZ = FEM");
         INSTR( CE_LREAD(PKT, C_OFST(12)  , LFEM_BIT_2)       , ALU_NOP                         ,     "load FTMH.tsh-present, ;--"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))     , ALU_NOP                          ,  "Copy 8B from offset R3    ; R1 = tsh size");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))    , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(6), REG_OP(1)),  "Copy 8B from offset R3-32 ;--- "  );
         INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-16)) , ALU_NOP                          ,  "Copy 8B from offset R3    ; R1 = tsh size");        
        
        
         INSTR( CE_LREAD(GEN, R_OFST(2,-8)  , LFEM_MPLS_CLEAR_EXP)  , ALU_ADD(REG_OP(1),CNST(ftmh_pph_fhei_total_size),REG_OP(1)), "Copy 16 lsb;R1 = FHEI-offset"   );
         INSTR( CE_NOP                                          , ALU_NOP, " -- ;--)");

         INSTR( CE_LREAD(PKT, R_OFST(1,-2)  , LFEM_IN_DSCP_TO_EXP)  , ALU_ADD(FEM, CNST(0),REG_OP(1)), "copy fhei.exp  ;--"   );
         INSTR( CE_NOP                                          , ALU_NOP, " -- ;--");
         INSTR( CE_NOP                                          , ALU_ADD(FEM, REG_OP(1), REG_OP(1)), " -- ;--)");
         INSTR( CE_NOP                                          , ALU_SUB(REG_OP(2),CNST(6),REG_OP(2)), " -- ;R2=R2-6)");        
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))        , ALU_NOP, "Copy 16lsb of EL;");
        for (ii = 0;ii<6;ii++) {
            
             INSTR( CE_COPY( GEN, R_OFST(2,0), R_SIZE(2,0))                   , ALU_SUB( REG_OP(2) , CNST(16)     , REG_OP(2))  , "Copy ETH ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(2,-16), R_SIZE(2,-8))                , ALU_NOP                                         , "Copy ETH");
        }
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_ch_header()",0,0);
}

uint32 arad_egr_prog_editor_copy_dscp_mixed_qos_model(int unit)
{
    int prog_used;
    uint32 res;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        int ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        int ftmh_pph_fhei_total_size = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;
        ftmh_pph_fhei_total_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        
          INSTR( CE_NOP,                                                ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ)),        "0: -- ; Rsz = R3-R2 ");
          INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),    ALU_SET(0, REG_OP(0)),                            "1: FEM=sys_hdr_size; R0 = 0");
          INSTR( CE_NOP,                                                ALU_SET(0, REG_OP(1)),                            "2: -- ; R1 = 0");
          INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET),
                                                                              ALU_SUB(FEM, CNST(0), REG_OP(0)),                 "3: FEM=fwd_hdr_offset, R0=sys_hdr_size");
          INSTR( CE_NOP,                                                ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ)),          "4: -- ; Rsz = Rsz-2 ");
          INSTR( CE_NOP,                                                ALU_ADD(FEM, REG_OP(0), REG_OP(0)),                "5: -- ; R0 = fwd_hdr_offset+sys_hdr_size ");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0)),               ALU_SUB( REG_OP(3), CNST(16), REG_OP(3)),          "6: Copy 8B from offset R3; R3 = R3-16 ");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)),            ALU_SUB( REG_OP(SZ), CNST(16), REG_OP(SZ)),        "7: Copy 8B from offset R3-16; RSZ = Rsz -16 ");
          INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2),                 ALU_NOP,                                            "8: load FTMH.tsh-present, ;-- ");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0)),               ALU_NOP,                                            "9: Copy 8B from offset R3; --");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)),            ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(6), REG_OP(1)),"10: Copy 8B from offset R3-32 ; -- ");
         INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2)),                 ALU_NOP,                                            "12: Copy PKT.tos; --");
         INSTR( CE_COPY(GEN, R_OFST(2,0), C_SIZE(4)),                  ALU_NOP,                                             "11: Copy 8B from offset R2; -- ");
        
         INSTR( CE_LREAD(GEN, R_OFST(2,-8), LFEM_MPLS_CLEAR_EXP),      ALU_ADD(REG_OP(1),CNST(ftmh_pph_fhei_total_size),REG_OP(1)), "13: Copy 16 lsb;R1 = FHEI-offset");
         INSTR( CE_NOP,                                                 ALU_NOP,                                            "14: -- ;--)");
         INSTR( CE_LREAD(PKT, R_OFST(1,-2)  , LFEM_IN_DSCP_TO_EXP),    ALU_ADD(FEM, CNST(0),REG_OP(1)),                     "15: copy fhei.exp  ;--");
         INSTR( CE_NOP,                                                 ALU_NOP,                                             "16: -- ;--");
         INSTR( CE_NOP,                                                ALU_ADD(FEM, REG_OP(1), REG_OP(1)),                  "17: -- ; --)");
         INSTR( CE_NOP,                                                ALU_SUB(REG_OP(2),CNST(6),REG_OP(2)),                "18: -- ; R2=R2-6)");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)),               ALU_NOP,                                             "19: Copy 16lsb of EL; -- ");
        
         INSTR( CE_COPY( GEN, R_OFST(2,0), R_SIZE(2,0)),           ALU_SUB( REG_OP(2) , CNST(16), REG_OP(2)),               "20: Copy ETH ; R2 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(2,-16), R_SIZE(2,-8)),        ALU_NOP,                                                 "21: Copy ETH");
         INSTR( CE_COPY( GEN, R_OFST(2,0), R_SIZE(2,0)),           ALU_SUB( REG_OP(2) , CNST(16), REG_OP(2)),               "22: Copy ETH ; R2 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(2,-16), R_SIZE(2,-8)),        ALU_NOP,                                                 "23: Copy ETH");
         INSTR( CE_COPY( GEN, R_OFST(2,0), R_SIZE(2,0)),           ALU_SUB( REG_OP(2) , CNST(16), REG_OP(2)),               "24: Copy ETH ; R2 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(2,-16), R_SIZE(2,-8)),        ALU_NOP,                                                 "25: Copy ETH");
         INSTR( CE_COPY( GEN, R_OFST(2,0), R_SIZE(2,0)),           ALU_SUB( REG_OP(2) , CNST(16), REG_OP(2)),               "26: Copy ETH ; R2 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(2,-16), R_SIZE(2,-8)),        ALU_NOP,                                                 "27: Copy ETH");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL()",0,0);
}

uint32 arad_egr_prog_editor_add_ch_header(
            int unit,
            int ftmh_size,
            int debug) 
{
    int prog_used;
    uint32 res;
    uint32 fld_val;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if (debug) {
        CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP);
    } else {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

            fld_val = (ftmh_size << 1) + 1;
            
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),               ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),        "0: copy Gen Header");
            
            INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ),             ALU_ADD(REG_OP(3), CNST(2), REG_OP(0)),         "1: copy Gen Header, new length include CRC while not CH");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),               ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),        "2: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ),             ALU_SET(0x08, REG_OP(1)),                       "3: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),               ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),        "4: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ),             ALU_NOP,                                        "5: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),               ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),        "6: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ),             ALU_NOP,                                        "7: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),               ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),        "8: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ),             ALU_NOP,                                        "9: copy Gen Header");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),               ALU_NOP,                                        "10: copy Gen Header");

            
            INSTR(CE_LCOPY(PKT, C_OFST(4), C_SIZE(0), LFEM_EXTRACT_FTMH_SIZE),ALU_NOP,                                    "11: Extract old packet size");
            INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS),     ALU_SET(0x08, REG_OP(3)),                       "12: Extract nwk header size");
            INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),     ALU_ADD(FEM, REG_OP(0), REG_OP(0)),             "13: Extract sys header size, R0=R0+old_pkt_size");
            INSTR(CE_NOP,                                                 ALU_ADD(FEM, CNST(0), REG_OP(SZ)),              "14: RSZ=nwk_hdr_size");
            INSTR(CE_LCOPY(PKT, C_OFST(5), C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC), ALU_ADD(FEM, CNST(0),   REG_OP(2)),     "15: R2=sys_hdr_size, Extract TC");
            INSTR(CE_NOP,                                                 ALU_SUB(REG_OP(0), REG_OP(SZ), REG_OP(0)),      "16: R0=R0-RSZ");
            INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(0), LFEM_CH_PPH_TYPE), ALU_ADD(FEM, CNST(0), REG_OP(2)),               "17: Extract PPH type, R2=TC mapped value");

            INSTR(CE_LCOPY(PKT, C_OFST(fld_val), C_SIZE(0), LFEM_CH_OTSH_TYPE),ALU_SUB(REG_OP(0), REG_OP(2), REG_OP(0)),  "18: R0 = R0-R2, new total length, Extract OTSH.type");
            INSTR(CE_NOP,                                                 ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(3)),"19:R3: first stage of 1588 indication");
            INSTR(CE_NOP,                                                 ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(1)),"20: R1: Second stage of 1588 indication");

            
            INSTR(CE_NOP,                                                 ALU_SET_IF(REG_OP(0), LT, CNST(64), CNST(64), REG_OP(0)),"21: CE_NOP, if R0 < 64 then R0=64");

            INSTR(CE_NOP,                                                 ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(1)), "22: Update R1 with R3 condition");

            INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2)),           ALU_NOP,                                        "23: Copy FT");
            INSTR(CE_NOP,                                                 ALU_ADD(REG_OP(1), REG_OP(2), REG_OP(1)),       "24: R1=R1+R2");
            INSTR(CE_NOP,                                                 ALU_NOP,                                        "25: ");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)),                ALU_NOP,                                        "26: Copy R1");
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),                ALU_NOP,                                        "27: Copy R0 for new length");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

            
            fld_val = (ftmh_size << 1) + 1;

            
       INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),              ALU_ADD(REG_OP(3), CNST(2), REG_OP(0)),                 "Read sys header size, R0=R3+2=0+2=2");
       INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS),              ALU_NOP,                                                "Read sys header size, ALU_NOP");
       INSTR(CE_NOP,                                                          ALU_ADD(FEM, CNST(0), REG_OP(1)),                       "CE_NOP, R1=sys header size");
       INSTR(CE_NOP,                                                          ALU_ADD(FEM, CNST(0), REG_OP(SZ)),                      "CE_NOP, Rsz=Nwk header size");
       INSTR(CE_COPY(PKT, R_OFST(1,12), C_SIZE(6)),                           ALU_SET(0x08, REG_OP(3)),                               "Copy DA to packet (for reflector logic), R3=0x08 which will be later compared to PPH.Type to check if type is OAM-TS or PPH Base+OAM-TS");
       INSTR(CE_COPY(PKT, R_OFST(1,24), C_SIZE(6)),                           ALU_NOP,                                                "Copy SA to packet (for reflector logic), ALU_NOP");

       INSTR(CE_LCOPY(PKT, C_OFST(4), C_SIZE(0), LFEM_EXTRACT_FTMH_SIZE),     ALU_SET(0x08, REG_OP(1)),                               "Extract packet size from FTMH, R1=0x08 which will be later compared to OTSH.type to check if 1588 exists");
       INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),              ALU_NOP,                                                "Read sys header size, ALU_NOP");
       INSTR(CE_NOP,                                                          ALU_ADD(FEM, REG_OP(0), REG_OP(0)),                     "CE_NOP, R0=R0+packet size (from FTMH header)=2B+packet size (from FTMH header)");
      INSTR(CE_LCOPY(PKT, C_OFST(5), C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC),  ALU_ADD(FEM, CNST(0),   REG_OP(2)),                     "Extract TC from FTMH, R2=Sys header size");
      INSTR(CE_NOP,                                                          ALU_SUB(REG_OP(0), REG_OP(SZ), REG_OP(0)),              "CE_NOP, R0=R0-Rsz=[2B+packet size (from FTMH header)] - [Nwk header size]");
      INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(0), LFEM_CH_PPH_TYPE),          ALU_ADD(FEM, CNST(0), REG_OP(2)),                       "Read PPH type, R2=TC (from FTMH header)");
      INSTR(CE_LCOPY(PKT, C_OFST(fld_val), C_SIZE(0), LFEM_CH_OTSH_TYPE),    ALU_SUB(REG_OP(0), REG_OP(2), REG_OP(0)),               "Read OTSH.type for 1588 indication, R0=R0-R2=[2B+packet size (from FTMH header)] - [Nwk header size] - [sys header size]");
      INSTR(CE_NOP,                                                          ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(3)),       "CE_NOP, if ((PPH.type == PPH base+OAM-TS) | (PPH.type == OAM-TS)) -> R3=0x08, otherwise R3=0");
      INSTR(CE_NOP,                                                          ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(1)),    "CE_NOP, if (OTSH.type != 1) -> R1=0, otherwise R1=0x08. used for 1588 indication");

      
      INSTR(CE_NOP,                                                          ALU_SET_IF(REG_OP(0), LT, CNST(64), CNST(64), REG_OP(0)),"CE_NOP, if R0 < 64 then R0=64");

      INSTR(CE_NOP,                                                          ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(1)), "CE_NOP, if (R3==0) -> R1=0. if pph.type is not PPH Base+OAM-TS or OAM-TS only, then no 1599 indication");

      INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2)),                    ALU_NOP,                                                "PrgeDataFieldProgVar hold zeros. copy 2B zeros for FT(1B) + reserved(1B), ALU_NOP");
      INSTR(CE_NOP,                                                          ALU_ADD(REG_OP(1), REG_OP(2), REG_OP(1)),               "CE_NOP, R1=R1+R2=(1588 bit indication) + TC");
      INSTR(CE_NOP,                                                          ALU_NOP,                                                "CE_NOP, ALU_NOP");
      INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)),                         ALU_NOP,                                                "Copy R1, ALU_NOP");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),                         ALU_NOP,                                                "Copy R0 - new packet length for Ceragon RH, ALU_NOP");
          
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
        }

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        
        fld_val = (ftmh_size << 1) + 1;

        
       INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),              ALU_SET(0x06, REG_OP(0)),                               "Read sys header size, R0=0x06. 6B=4B(RSPAN vlan)+ 2B(new CRC(4B) - old CRC(2B))");
       INSTR(CE_NOP,                                                          ALU_SET(0x08, REG_OP(3)),                               "CE_NOP, R3=0x08 which will be later compared to PPH.Type to check if type is OAM-TS or PPH Base+OAM-TS");
       INSTR(CE_LCOPY(PKT, C_OFST(4), C_SIZE(0), LFEM_EXTRACT_FTMH_SIZE),     ALU_ADD(FEM, CNST(0), REG_OP(2)),                       "Extract packet size from FTMH, R2=sys header size");
       INSTR(CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(4)),                  ALU_NOP,                                                "Copy RSPAN vlan tag, ALU_NOP");
       INSTR(CE_COPY(PKT, R_OFST(2,24), C_SIZE(6)),                           ALU_ADD(FEM, REG_OP(0), REG_OP(0)),                     "Copy SA, R0=R0+packet size (from FTMH header)=6B+packet size (from FTMH header)");
       INSTR(CE_COPY(PKT, R_OFST(2,12), C_SIZE(6)),                           ALU_SET(0x08, REG_OP(1)),                               "Copy DA, R1=0x08 which will be later compared to OTSH.type to check if 1588 exists");

       INSTR(CE_LCOPY(PKT, C_OFST(5), C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC),  ALU_NOP,                                                "Extract TC from FTMH, ALU_NOP");
       INSTR(CE_NOP,                                                          ALU_NOP,                                                "CE_NOP, ALU_NOP");
       INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(0), LFEM_CH_PPH_TYPE),          ALU_ADD(FEM, CNST(0), REG_OP(2)),                       "Read PPH type, R2=TC (from FTMH header)");
      INSTR(CE_LCOPY(PKT, C_OFST(fld_val), C_SIZE(0), LFEM_CH_OTSH_TYPE),    ALU_SUB(REG_OP(0), REG_OP(2), REG_OP(0)),               "Read OTSH.type for 1588 indication, R0=R0-R2=[6B+packet size (from FTMH header)] - [sys header size]");
      INSTR(CE_NOP,                                                          ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(3)),       "CE_NOP, if ((PPH.type == PPH base+OAM-TS) | (PPH.type == OAM-TS)) -> R3=0x08, otherwise R3=0");
      INSTR(CE_NOP,                                                          ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(1)),    "CE_NOP, if (OTSH.type != 1) -> R1=0, otherwise R1=0x08. used for 1588 indication");

      
      INSTR(CE_NOP,                                                          ALU_SET_IF(REG_OP(0), LT, CNST(64), CNST(64), REG_OP(0)),"CE_NOP, if R0 < 64 then R0=64");

      INSTR(CE_NOP,                                                          ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(1)), "CE_NOP, if (R3==0) -> R1=0. if pph.type is not PPH Base+OAM-TS or OAM-TS only, then no 1599 indication");

      INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2)),                    ALU_NOP,                                                "PrgeDataFieldProgVar hold zeros. copy 2B zeros for FT(1B) + reserved(1B), ALU_NOP");
      INSTR(CE_NOP,                                                          ALU_ADD(REG_OP(1), REG_OP(2), REG_OP(1)),               "CE_NOP, R1=R1+R2=(1588 bit indication) + TC");
      INSTR(CE_NOP,                                                          ALU_NOP,                                                "CE_NOP, ALU_NOP");
      INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)),                         ALU_NOP,                                                "Copy R1, ALU_NOP");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),                         ALU_NOP,                                                "Copy R0 - new packet length for Ceragon RH, ALU_NOP");
          
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
        }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_ch_header()",0,0);
}

uint32 arad_egr_prog_editor_ptag_mpls_raw(
            int unit,
            int prog) 
{
    int prog_used;
    uint32 res;
    uint32 prge_ptagged_load;
    int canonical_tpid;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, prog, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, prog);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        prge_ptagged_load = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0);
        canonical_tpid = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "canonical_tpid", 0);
    
        if (prog == ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW) {
            if (prge_ptagged_load == 1){
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))  , "0: ");
                INSTR(CE_NOP                                        , ALU_NOP                                    , "1: ");
                INSTR(CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))   , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))   , "2: ");
                INSTR(CE_NOP                                        , ALU_NOP                                    , "3: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_NOP                                    , "4: ");
                INSTR(CE_NOP                                        , ALU_NOP                                    , "5: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))  , ALU_NOP                                    , "6: ");
                INSTR(CE_NOP                                        , ALU_NOP                                    , "7: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16)) , ALU_SET(0, REG_OP(SZ))                     , "8: ");
                INSTR(CE_READ(GEN, R_OFST(2,28))                    , ALU_NOP                                    , "9: ");
                INSTR(CE_NOP                                        , ALU_SET(2, REG_OP(SZ))                     , "10: ");
                INSTR(CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(SZ), REG_OP(SZ)) , "11: ");
                INSTR(CE_LREAD(GEN, R_OFST(2,29), LFEM_LSHIFT_12)   , ALU_NOP                                    , "12: " );
                INSTR(CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_NOP                                    , "13: " );
                
                INSTR(CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(SZ,0))    , ALU_SUB(FEM,CNST(0) ,REG_OP(3))            , "14: " );
                INSTR(CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)      , ALU_SUB(CNST(64),FEM,REG_OP(SZ))           , "15: ");
                INSTR(CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)   , ALU_SUB(CNST(2), REG_OP(SZ), REG_OP(3))    , "16: ");
                INSTR(CE_NOP                                        , ALU_ADD(REG_OP(3),FEM, REG_OP(3))          , "17: "   );
                
                INSTR( CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ))          , "18: ");                                                
                INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_NOP                                    , "19: ");
                    
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ))   ," 20: ");                                                     
                INSTR(CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))         , ALU_NOP                                    ," 21: ");
                     
                
                INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8))     , ALU_NOP                                    , "22: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
                INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0))      , ALU_SUB(REG_OP(1), REG_OP(0), REG_OP(SZ))  , "23: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
                INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8))     , ALU_NOP                                    , "24: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");
                    
                
                INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))    , "25: ");
                INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))   , ALU_NOP                                    , "26: ");
                INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16))  , ALU_NOP                                    , "27: ");
            } else if (prge_ptagged_load == 2) {
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ)) , "0: ");
                INSTR(CE_READ(GEN, R_OFST(2,28))                    , ALU_SET(0, REG_OP(1))                     , "1: ");
                INSTR(CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))   , ALU_SET(2, REG_OP(1))                     , "2: ");
                INSTR(CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(1)) , "3: ");
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "4: ");
                INSTR(CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M) , ALU_NOP                                   , "5: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_NOP                                   , "6: ");
                INSTR(CE_LREAD(GEN, R_OFST(2,29),  LFEM_LSHIFT_12)  , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "7: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))  , ALU_NOP                                   , "8: ");
                INSTR(CE_LREAD(GEN, R_OFST(2,-11), LFEM_12_LSBS)    , ALU_SUB(FEM,CNST(0) ,REG_OP(3))           , "9: priority in R3");
                INSTR(CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_1_0_M) , ALU_SET_IF(REG_OP(1), NEQ, CNST(2), CNST(2), REG_OP(1)) , "10: ");
                INSTR(CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(1,0))     , ALU_ADD(REG_OP(3),FEM, REG_OP(3))         , "11: ");
                INSTR(CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))       , ALU_SUB(CNST(64),FEM, REG_OP(SZ))         , "12: ");
                INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))       , ALU_NOP                                   , "13: ");
                INSTR(CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))         , ALU_NOP                                   , "14: ");
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(2),CNST(8), REG_OP(SZ))    , "15: ");
                
                
                INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8))        , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))    , "16: copy DA + SA + PWE");          
                INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8))         , ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "17: copy DA + SA + PWE");
                
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(SZ),REG_OP(0), REG_OP(SZ)) , "18: "   );
                INSTR(CE_NOP                                        , ALU_NOP                                   , "19: ");
                
                
                INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))     , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))   , "20: ");
                INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8))  , ALU_NOP                                   , "21: ");
                INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))   , ALU_NOP                                   , "22: ");
            }

        } else if (prog == ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW) {
            if (prge_ptagged_load == 1) {
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "0: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "1: ");
                INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "2: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "3: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))     , ALU_NOP                                       , "4: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "5: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))    , ALU_NOP                                       , "6: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "7: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))   , ALU_SET(0, REG_OP(SZ))                        , "8: ");
                INSTR(CE_READ(GEN, R_OFST(2,28))                    , ALU_NOP                                       , "9: ");
                INSTR(CE_NOP                                        , ALU_SET(2, REG_OP(SZ))                        , "10: ");
                INSTR(CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(SZ), REG_OP(SZ)) , "11: ");
                
                INSTR(CE_NOP                                        , ALU_SET(0 ,REG_OP(3))                         , "12: ");   
                INSTR(CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_NOP                                       , "13: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "14: ");
                INSTR(CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)      , ALU_SUB(CNST(64),FEM,REG_OP(SZ))              , "15: ");
                INSTR(CE_COPY(GEN, R_OFST(2,28), R_SIZE(SZ,0))      , ALU_SUB(CNST(2), REG_OP(SZ), REG_OP(3))       , "16: ");
                INSTR(CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)   , ALU_ADD(REG_OP(3),FEM, REG_OP(3))             , "17: ");
                INSTR(CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))       , ALU_NOP                                       , "18: ");                                                
                INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))       , ALU_SUB(CNST(64),FEM, REG_OP(SZ))             , "19: ");    
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ))      , "20: ");                                                     
                INSTR(CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))         , ALU_NOP                                       , "21: ");         
                
                INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8))     , ALU_NOP                                       , "22: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
                INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0))      , ALU_SUB(REG_OP(1),REG_OP(0), REG_OP(SZ))      , "23: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
                INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8))     , ALU_NOP                                       , "24: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");
                    
                
                INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))       , "25: ");
                INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))   , ALU_NOP                                       , "26: ");
                INSTR(CE_COPY(GEN, R_OFST(1, 0), R_SIZE(SZ, -16))   , ALU_NOP                                       , "27: ");

            } else if (prge_ptagged_load == 2) {
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "0: ");
                INSTR(CE_NOP                                        , ALU_SET(0, REG_OP(1))                         , "1: ");                
                INSTR(CE_READ(GEN, R_OFST(2,28))                    , ALU_NOP                                       , "2: ");                
                INSTR(CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))   , ALU_SET(2, REG_OP(1))                         , "3: ");
                INSTR(CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(1)), "4: ");                
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "5: " );
                INSTR(CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M) , ALU_NOP                                       , "6: " );                
                INSTR(CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_NOP                                       , "7: ");                
                INSTR(CE_NOP                                        , ALU_SUB(CNST(64),FEM,REG_OP(SZ))              , "8: " );
                INSTR(CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))  , ALU_NOP                                       , "9: " );
                
                INSTR(CE_LREAD(GEN, R_OFST(2,-11), LFEM_12_LSBS)    , ALU_SET(0 ,REG_OP(3))                         , "10: priority in R3");
                
                INSTR(CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_1_0_M) , ALU_SET_IF(REG_OP(1), NEQ, CNST(2), CNST(2), REG_OP(1)), "11: ");                        
                INSTR(CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(1,0))     , ALU_ADD(REG_OP(3),FEM, REG_OP(3))             , "12: ");   
                
                INSTR(CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))       , ALU_SUB(CNST(64),FEM, REG_OP(SZ))             , "13: ");                                                
                INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))       , ALU_NOP                                       , "14: ");                
                INSTR(CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))         , ALU_NOP                                       , "15: ");                                                     
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(2),CNST(8), REG_OP(SZ))        , "16: ");
                
                
                INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8))        , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))        , "17: copy DA + SA + PWE");          
                INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8))         , ALU_NOP                                       , "18: copy DA + SA + PWE");
                
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(SZ),REG_OP(0), REG_OP(SZ))     , "19: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "20: ");                
                
                INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))     , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "21: ");
                INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8))  , ALU_NOP                                       , "22: ");
                INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))   , ALU_NOP                                       , "23: ");

            }
        } else if (prog == ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW) {
            if (prge_ptagged_load == 1) {
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "0: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "1: ");
                INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "2: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "3: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))     , ALU_NOP                                       , "4: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "5: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))    , ALU_NOP                                       , "6: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "7: ");
                INSTR(CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))   , ALU_NOP                                       , "8: ");
                INSTR(CE_READ(GEN, R_OFST(2,28))                    , ALU_SET(0, REG_OP(SZ))                        , "9: ");
                INSTR(CE_NOP                                        , ALU_SET(2, REG_OP(SZ))                        , "10: ");
                INSTR(CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(SZ), REG_OP(SZ)) , "11: ");
                INSTR(CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_NOP                                       , "12: ");    
                INSTR(CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)   , ALU_SUB(CNST(2), REG_OP(SZ), REG_OP(3))       , "13: ");                        
                INSTR(CE_COPY(GEN, R_OFST(2,28), R_SIZE(SZ,0))      , ALU_SUB(CNST(64),FEM,REG_OP(SZ))              , "14: ");
                INSTR(CE_NOP                                        , ALU_NOP                                       , "15: ");
                INSTR(CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))       , ALU_SUB(CNST(64),FEM, REG_OP(SZ))             , "16: ");                                                
                INSTR(CE_NOP                                        , ALU_NOP                                       , "17: ");
                INSTR(CE_NOP                                        , ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ))      , "18: ");                                                     
                INSTR(CE_NOP                                        , ALU_NOP                                       , "19: ");
                
                INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8))     , ALU_NOP                                       , "20: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
                INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0))      , ALU_SUB(REG_OP(1),REG_OP(0), REG_OP(SZ))      , "21: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
                INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8))     , ALU_NOP                                       , "22: copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");
                
                INSTR(CE_COPY(GEN, R_OFST(1, 0), R_SIZE(SZ, 0))     , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))       , "23: ");
                INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))   , ALU_NOP                                       , "24: ");
                INSTR(CE_COPY(GEN, R_OFST(1, 0), R_SIZE(SZ, -16))   , ALU_NOP                                       , "25: ");
            } else if (prge_ptagged_load == 2) {
                INSTR( CE_NOP                                       , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "0: ");
                INSTR( CE_READ(GEN, R_OFST(2,28))                   , ALU_SET(0, REG_OP(1))                         , "1: ");
                INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))  , ALU_SET(2, REG_OP(1))                         , "2: ");
                INSTR( CE_NOP                                       , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(1)) , "3: ");
                INSTR( CE_NOP                                       , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "4: ");
                INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M), ALU_NOP                                       , "5: ");
                INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0)) , ALU_NOP                                       , "6: ");
                INSTR( CE_NOP                                       , ALU_SUB(CNST(64),FEM,REG_OP(SZ))              , "7: ");
                INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8)) , ALU_NOP                                       , "8: ");
                INSTR(  CE_NOP                                      , ALU_NOP                                       , "9: priority in R3");
                INSTR(  CE_NOP                                      , ALU_SET_IF(REG_OP(1), NEQ, CNST(2), CNST(2), REG_OP(1)), "10: ");                        
                INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(1,0))   , ALU_NOP                                       , "11: ");   
                INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))     , ALU_NOP                                       , "12: ");                                                
                INSTR(  CE_NOP                                      , ALU_NOP                                       , "13: "); 
                INSTR(  CE_NOP                                      , ALU_NOP                                       , "14: ");
                INSTR(  CE_NOP                                      , ALU_SUB(REG_OP(2),CNST(8), REG_OP(SZ))        , "15: ");
                
                INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8))        , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))        , "16: copy DA + SA + PWE");          
                INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8))         , ALU_SUB(REG_OP(SZ),REG_OP(0), REG_OP(SZ))     , "17: copy DA + SA + PWE");
                INSTR(  CE_NOP                                      , ALU_NOP                                       , "18: ");
                
                INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))     , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "19: ");
                INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8))  , ALU_NOP                                       , "20: ");
                INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))   , ALU_NOP                                       , "21: ");
            }
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_ptag_mpls_raw()",0,0);
}


uint32 arad_egr_prog_editor_tdm_coe_inter_conn(
            int unit,
            int user_header_size,
            int prog) 
{
    int prog_used;
    uint32 res;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, prog, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, prog);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
    
        if (prog == ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE) {
                    
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(1))                               , "Extract TM-Port-Variable ; R1 = 2");
            INSTR(CE_NOP                                             , ALU_SET(0, REG_OP(SZ))                              , "RSZ = 0");
            INSTR(CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(SZ)) , "If TM-Port-Variable==1 RSZ=R1(=2)");
            INSTR(CE_NOP                                             , ALU_NOP                                             , "NOP");
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ,0))  , ALU_NOP                                             , "Copy PP-Port-Variable");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(SZ,0))    , ALU_NOP                                             , "Copy Program-Variable");
            INSTR(CE_COPY(PKT, R_OFST(3,26+(2*user_header_size)), C_SIZE(8)) , ALU_NOP                                     , "Copy SA & DA");
            INSTR(CE_COPY(PKT, R_OFST(3,10+(2*user_header_size)), C_SIZE(4)) , ALU_NOP                                     , "Copy SA & DA");
        } else if (prog == ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE) {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SET(2, REG_OP(0))                          ,"0: For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_NOP                                            ,ALU_NOP                                        ,"1: NOP");
            INSTR(CE_NOP                                            ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)),"2: R0 will be 2 if we are pushing coe tag, 0 otherwise");
            
            
            
            if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "coe_tag_mapping_mode", 0)) {
                INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC), ALU_NOP,                              "3: ");
            } else {
                INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC_DP), ALU_NOP,                              "3: ");
            }
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_1) ,ALU_NOP,                                        "4: extract TC/DP set indication");
            INSTR(CE_NOP                                           ,ALU_ADD(FEM, CNST(0), REG_OP(1)),               "5: ");
            INSTR(CE_FREAD(PrgeDataFieldPpPortVar, 0)              ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)), "6: ");
            INSTR(CE_NOP                                           ,ALU_NOP,                                        "7: ");
            INSTR(CE_NOP                                           ,ALU_ADD(FEM, REG_OP(1), REG_OP(1)),             "8: Calc the COE_TAG.16LSB");
            INSTR(CE_NOP                                           ,ALU_NOP,                                        "9:NOP");
            
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(0, 0))       ,ALU_NOP,                                        "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(0, 0))  ,ALU_NOP,                                        "Copy Program-Variable(2bytes) only if R0 == 2 ");  
            
            INSTR(CE_NOP                                           ,ALU_ADD(REG_OP(3), CNST(user_header_size-1), REG_OP(SZ)), "Point to start of MAC address");        
            INSTR(CE_NOP                                           ,ALU_NOP,                                        "NOP");
            INSTR(CE_COPY(PKT, R_OFST(SZ,24), C_SIZE(8))           ,ALU_NOP,                                        "Copy DMAC+SMAC[5~4]");
            INSTR(CE_COPY(PKT, R_OFST(SZ,8), C_SIZE(4))            ,ALU_NOP,                                        "Copy SMAC[3~0]");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_ch_header()",0,0);
}


uint32 arad_egr_prog_editor_mpls_extended_4_jer(int unit)
{
    int prog_used;
    uint32 res;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_NOP                                         , "Read ExtLabel2-Valid");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
            if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
                 INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
                 INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
                 INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_ADD( FEM       , CNST(0), REG_OP(3))        , "Copy ExtLabel1 2MSB");
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel2 2LSB");
                 INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel2 2MSB");

                
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
                 INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(3,0) )        , ALU_NOP                                         , "Copy Additional 1B based on the REG_SZ size");

            } else {
                 INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
                 INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
                 INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel2 2LSB");
                 INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel2 2MSB");

                
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
            }
        } else {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_SET(2, REG_OP(2))                           , "Read ExtLabel2-Valid, R2=2");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
             INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "Copy ExtLabel2 2LSB, R1=0x8100");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel2 2MSB, RSZ=R0-12");

             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
            
             INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
             INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
             INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
             INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_NOP                                         , "Read ExtLabel2-Valid");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
            if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
                 INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
                 INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
                 INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_ADD( FEM       , CNST(0), REG_OP(3))        , "Copy ExtLabel1 2MSB");
                 INSTR( CE_NOP                                                    , ALU_NOP                                         , "NOP");
                 INSTR( CE_NOP                                                    , ALU_NOP                                         , "NOP");

                
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
                 INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(3,0) )        , ALU_NOP                                         , "Copy Additional 1B based on the REG_SZ size");

            } else {
                 INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
                 INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
                 INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
                 INSTR( CE_NOP                                                    , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2LSB");
                 INSTR( CE_NOP                                                    , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2MSB");

                
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
                 INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
                 INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
            }
        } else {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_SET(2, REG_OP(2))                           , "Read ExtLabel2-Valid, R2=2");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
             INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "RSZ=R0-12");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , "NOP");

             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
            
             INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
             INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
             INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
             INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      
            
        }

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }



exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_ch_header()",0,0);
}

uint32 arad_egr_prog_editor_ipsec_programs_instr_load(
            int unit)
{
    int prog_used;
    uint32 res;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "Instruction  0: ---; rsz = r3-r2 (calc the size of fwd hdr)"         );
        INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(2))      , "Instruction  1: extract sys hdr size; r2 = r3-r0 (calc the size of hdr up to link layer)");
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), CNST(8), REG_OP(3))        , "Instruction  2: ---; r3 = r3-8 "                                     );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,0))               , ALU_SUB(FEM, CNST(0), REG_OP(1))              , "Instruction  3: copy gen hdr size r2, pointer r3   ; store sys hdr size (fem) in r1");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(2), CNST(24), REG_OP(2))       , "Instruction  4: copy gen hdr size r2-8, pointer r3; r2 = r2-24"      );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,-16))           , ALU_SUB(REG_OP(3), CNST(24), REG_OP(3))       , "Instruction  5: copy gen hdr size r2-16, pointer r3-16; r3 = r3-24"  );
        INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction  6: copy gen hdr size r2 , pointer r3-32; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction  7: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction  8: copy gen hdr size r2 , pointer r3-16; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction  9: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction 10: copy gen hdr size r2 , pointer r3-16; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction 11: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))      , "Instruction 12: extract nwk hdr size; rsz -= 2"                      );
        INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_2_LSBS)                , ALU_NOP                                       , "Instruction 13: extract ftmh.tc; ---"                                );
        INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_RSHIFT_2)              , ALU_SUB(FEM, REG_OP(SZ), REG_OP(2))           , "Instruction 14: extract ftmh.psize, r2 = fem-rsz"                    );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-2))              , ALU_SUB(FEM, CNST(0), REG_OP(3))              , "Instruction 15: copy the system headers, size/offset r1; r3=fem"     );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-10))           , ALU_SUB(FEM, REG_OP(2), REG_OP(2))            , "Instruction 16: copy the system headers, size/offset r1; r2=fem-r2"  );
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))       , "Instruction 17: --------; r1 = r1-16"                                );
        INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_LSHIFT_2)         , ALU_NOP                                       , "Instruction 18: shift r2 ; ---"                                      );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-2))              , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))       , "Instruction 19: copy the system headers, size/offset r1;r1=r1-16"    );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-10))           , ALU_ADD(FEM, REG_OP(3), REG_OP(3))            , "Instruction 20: copy the system headers, size/offset r1, r3=r3+fem"  );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-2))              , ALU_NOP                                       , "Instruction 21: copy the system headers, size/offset r1"             );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-10))           , ALU_NOP                                       , "Instruction 22: copy the system headers, size/offset r1, r3=r3+fem"  );
        INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))              , ALU_NOP                                       , "Instruction 23: copy r3 (ftmh.PSize,Ftmh.TC[2:1])"                   );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))               , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "Instruction 24: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "Instruction 25: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))               , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "Instruction 26: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "Instruction 27: copy the link layer, size/offset r0"                 );

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 402, exit);
    }



    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        int otsh_size = ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
        int ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "Instruction  0: ---; rsz = r3-r2 (calc the size of fwd hdr)"         );
        INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(2))      , "Instruction  1: extract sys hdr size; r2 = r3-r0 (calc the size of hdr up to link layer)");
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), CNST(8), REG_OP(3))        , "Instruction  2: ---; r3 = r3-8 "                                     );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,0))               , ALU_SUB(FEM, CNST(0), REG_OP(1))              , "Instruction  3: copy gen hdr size r2, pointer r3; store sys-hdrs size in r1");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(2), CNST(24), REG_OP(2))       , "Instruction  4: copy gen hdr size r2-8, pointer r3; r2 = r2-24"      );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,-16))           , ALU_SUB(REG_OP(3), CNST(24), REG_OP(3))       , "Instruction  5: copy gen hdr size r2-16, pointer r3-16; r3 = r3-24"  );
        INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction  6: copy gen hdr size r2 , pointer r3-32; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction  7: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction  8: copy gen hdr size r2 , pointer r3-16; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction  9: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction 10: copy gen hdr size r2 , pointer r3-16; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction 11: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(SZ), CNST(8), REG_OP(SZ))      , "Instruction 12: extract nwk hdr size; rsz -= 8"                      );
        INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_2_LSBS)                , ALU_SUB(REG_OP(1), CNST(ftmh_size+otsh_size), REG_OP(SZ)), "Instruction 13: extract ftmh.tc; rsz = r1 - |FTMH+OTSH|"  );
        INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_RSHIFT_2)              , ALU_SUB(FEM, REG_OP(SZ), REG_OP(2))           , "Instruction 14: extract ftmh.psize, r2 = fem-rsz"                    );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0))              , ALU_SUB(FEM, CNST(0), REG_OP(3))              , "Instruction 15: copy pph, size/offset rsz/r1; r3=fem"                );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(SZ,-8))           , ALU_SUB(FEM, REG_OP(2), REG_OP(2))            , "Instruction 16: copy pph, size/offset rsz/r1; r2=fem-r2"             );
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Instruction 17: --------; rsz -= 16"                                 );
        INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_LSHIFT_2)         , ALU_NOP                                       , "Instruction 18: shift r2;"                                           );
        INSTR( CE_COPY(PKT, R_OFST(1,-32), R_SIZE(SZ,0))            , ALU_NOP                                       , "Instruction 19: copy pph, size/offset rsz/r1;"                       );
        INSTR( CE_COPY(PKT, C_OFST(ftmh_size*2), C_SIZE(ftmh_size-6)), ALU_ADD(FEM, REG_OP(3), REG_OP(3))           , "Instruction 20: copy ftmh[23:...]; r3=r3+fem"                        );
        INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(2), LFEM_ZERO_BIT2) , ALU_NOP                                       , "Instruction 21: copy ftmh[39:24] clear OAM-TS bit;"                  );
        INSTR( CE_COPY(PKT, C_OFST(8), C_SIZE(2))                   , ALU_NOP                                       , "Instruction 22: copy ftmh[55:40];"                                   );
        INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))              , ALU_NOP                                       , "Instruction 23: copy r3 (ftmh.PSize,Ftmh.TC[2:1])"                   );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))               , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "Instruction 24: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "Instruction 25: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))               , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "Instruction 26: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "Instruction 27: copy the link layer, size/offset r0"                 );

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 402, exit);
    }
exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_ipsec_programs_instr_load()",0,0);
}


uint32 arad_egr_prog_editor_set_tcam_sel(
            SOC_SAND_IN int unit,
            SOC_SAND_IN int prog,
            SOC_SAND_IN int same_prog_tcam_idx,
            SOC_SAND_INOUT int *tcam_line)
{

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA 
        prge_program_selection_cam_tbl_data;
    int prog_used;
    uint32 res;
    int tm_profiles;
    int i = 0;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, prog, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

    switch (prog) { 
            case ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_CH_CONN_TO_FPGA;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
                prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
                prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
                prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
                prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
                prge_program_selection_cam_tbl_data.data_entry_cnt             = 0x1;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
                prge_program_selection_cam_tbl_data.program                    = prog_used;
                prge_program_selection_cam_tbl_data.valid                      = 0x1;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
        }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CH_CONN_TO_FPGA;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
                prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_REFLECTOR_1PASS;
                prge_program_selection_cam_tbl_data.ace_variable_mask = 0;           
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
        }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CH_CONN_TO_FPGA;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;            
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
            }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    
                prge_program_selection_cam_tbl_data.fwd_code_mask               = 0x7;
                prge_program_selection_cam_tbl_data.first_enc                   = 0x1; 
                prge_program_selection_cam_tbl_data.first_enc_mask              = 0x0;
                prge_program_selection_cam_tbl_data.program                     = prog_used;
                prge_program_selection_cam_tbl_data.valid                       = 0x1;
                prge_program_selection_cam_tbl_data.learn_ext_exist             = 0x0;
                prge_program_selection_cam_tbl_data.learn_ext_exist_mask        = 0;    
                prge_program_selection_cam_tbl_data.routing_over_overlay        = 0x1;
                prge_program_selection_cam_tbl_data.routing_over_overlay_mask   = 0x1;

                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_RAW_MPLS, &tm_profiles);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
                if (tm_profiles == -1) {
                    SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_RAW_MPLS is not allocated. \n")));
                }
                prge_program_selection_cam_tbl_data.prge_tm_profile             = tm_profiles;
                prge_program_selection_cam_tbl_data.prge_tm_profile_mask        = 0x0;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
            }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                if (same_prog_tcam_idx == 0) {
                    prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;  
                    prge_program_selection_cam_tbl_data.fwd_code_mask               = 0x7;
                    prge_program_selection_cam_tbl_data.first_enc                   = 0x1;  
                    prge_program_selection_cam_tbl_data.first_enc_mask              = 0x0;
                    prge_program_selection_cam_tbl_data.program                     = prog_used;
                    prge_program_selection_cam_tbl_data.valid                       = 0x1;
                    prge_program_selection_cam_tbl_data.learn_ext_exist             = 0x1;
                    prge_program_selection_cam_tbl_data.learn_ext_exist_mask        = 1;
                    prge_program_selection_cam_tbl_data.routing_over_overlay        = 0x1;
                    prge_program_selection_cam_tbl_data.routing_over_overlay_mask   = 0x1;
                } else if (same_prog_tcam_idx == 1) {
                    prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;
                    prge_program_selection_cam_tbl_data.fwd_code_mask               = 0x7;
                    prge_program_selection_cam_tbl_data.first_enc                   = 0x1;
                    prge_program_selection_cam_tbl_data.first_enc_mask              = 0x0;
                    prge_program_selection_cam_tbl_data.program                     = prog_used;
                    prge_program_selection_cam_tbl_data.valid                       = 0x1;
                    prge_program_selection_cam_tbl_data.learn_ext_exist             = 0x1;
                    prge_program_selection_cam_tbl_data.learn_ext_exist_mask        = 0;    
                    prge_program_selection_cam_tbl_data.routing_over_overlay        = 0x1;
                    prge_program_selection_cam_tbl_data.routing_over_overlay_mask   = 0x1;
                }

                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_RAW_MPLS, &tm_profiles);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
                if (tm_profiles == -1) {
                    SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_RAW_MPLS is not allocated. \n")));
                }
                prge_program_selection_cam_tbl_data.prge_tm_profile             = tm_profiles;
                prge_program_selection_cam_tbl_data.prge_tm_profile_mask        = 0x0;

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
            }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
                }

                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.prge_pp_profile          = ARAD_PRGE_PP_SELECT_SBFD_REFLECTOR;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask     = 0x0;
                prge_program_selection_cam_tbl_data.program               = prog_used;
                prge_program_selection_cam_tbl_data.valid                  = 0x1;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
            }
        break;

        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.first_enc                   = 0x1;  
                prge_program_selection_cam_tbl_data.first_enc_mask              = 0x0;
                prge_program_selection_cam_tbl_data.program                     = prog_used;
                prge_program_selection_cam_tbl_data.valid                       = 0x1;
                prge_program_selection_cam_tbl_data.learn_ext_exist             = 0x1;
                prge_program_selection_cam_tbl_data.learn_ext_exist_mask        = 1;
                prge_program_selection_cam_tbl_data.routing_over_overlay        = 0x1;
                prge_program_selection_cam_tbl_data.routing_over_overlay_mask   = 0x1;

                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_RAW_MPLS, &tm_profiles);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
                if (tm_profiles == -1) {
                    SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_RAW_MPLS is not allocated. \n")));
                }
                prge_program_selection_cam_tbl_data.prge_tm_profile             = tm_profiles;
                prge_program_selection_cam_tbl_data.prge_tm_profile_mask        = 0x0;

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
            }
        break;
        
        
        case ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER, &tm_profiles);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
                if (tm_profiles == -1) {
                    SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER is not allocated. \n\r")));
                }
                prge_program_selection_cam_tbl_data.prge_tm_profile         = tm_profiles;
                prge_program_selection_cam_tbl_data.prge_tm_profile_mask    = 0x0;
                prge_program_selection_cam_tbl_data.prge_pp_profile         = ARAD_PRGE_PP_SELECT_TDM_COE_INTER_CONN;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask    = 0x0;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
            }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE:
            if (prog_used != -1) {
                *tcam_line = *tcam_line + 1;
                if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

                prge_program_selection_cam_tbl_data.prge_pp_profile         = ARAD_PRGE_PP_SELECT_TDM_COE_INTER_CONN;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask    = 0x0;
                prge_program_selection_cam_tbl_data.pph_type                = 0x0;   
                prge_program_selection_cam_tbl_data.pph_type_mask           = 0x2;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
            }
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER:
            if (prog_used != -1) {
                
            
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
                prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
            
                prge_program_selection_cam_tbl_data.valid                   = 1 ;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;
            
                for (i = 1; i <= 4; i++) {
                    *tcam_line = *tcam_line+1;
                    if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
                    }
                    
            
                    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
                }
            }
        break;

        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR:
            if (prog_used != -1) {

                

                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
                prge_program_selection_cam_tbl_data.valid                   = 1 ;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;

                for (i = 1; i <= 2; i++) {
                    *tcam_line = *tcam_line+1;
                    if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
                    }
                    

                    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
                }
            }
        break;

        case ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL:
            if (prog_used != -1) {
                for (i = 0; i < 2; i++) {
                   *tcam_line = *tcam_line + 1;
                    if (*tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 10, exit);
                    }

                    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

                    prge_program_selection_cam_tbl_data.fwd_code                  = (i == 0) ? PP_FWD_CODE_IPV4_UC : PP_FWD_CODE_IPV6_UC;
                    prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    

                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIXED_QOS_MODEL;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    

                    prge_program_selection_cam_tbl_data.program                    = prog_used;
                    prge_program_selection_cam_tbl_data.valid                      = 0x1;

                    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, *tcam_line, &prge_program_selection_cam_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
                }
            }
        break;

        default:
        break;
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_set_tcam_sel()",prog,0);

}

uint32 arad_egr_prog_editor_set_prog_attr(
            SOC_SAND_IN int unit,
            SOC_SAND_IN int prog,
            SOC_SAND_IN uint32 register_src,
            SOC_SAND_IN uint32 remove_system_header,
            SOC_SAND_IN uint32 remove_network_header,
            SOC_SAND_IN uint32 bytes_to_remove,
            SOC_SAND_IN uint32 prgeVarHigh,
            SOC_SAND_IN uint32 prgeVarLow)
{
    int prog_used;
    uint32 res;
    ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA
        prge_program_tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, prog, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

    if (prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, prog, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

        prge_program_tbl_data.register_src          = register_src;
        prge_program_tbl_data.remove_system_header  = remove_system_header;
        prge_program_tbl_data.remove_network_header = remove_network_header;
        prge_program_tbl_data.bytes_to_remove       = bytes_to_remove;

        COMPILER_64_SET(prge_program_tbl_data.program_var, prgeVarHigh, prgeVarLow);

        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_set_prog_attr()", prog, 0);
}


uint32 
  arad_egr_prog_editor_basic_epni_tm_config(
    SOC_SAND_IN  int unit
  ) 
{
  int soc_petrab_cfg = 0; 
  int tcam_line;
  int program_line;
  int mem;
  int entry=0,entry_odd, entry_even;
  int tdm_arad_opt, tdm_arad_std;
  ARAD_MGMT_TDM_MODE tdm_mode;
  uint8 is_petrab_in_system;
  int i, j;
  uint32 res;
  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA 
      prge_program_selection_cam_tbl_data;
  ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA 
      prge_program_tbl_data;
  ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
      prge_instruction_tbl_data;
  soc_reg_above_64_val_t 
      header_editing_size, 
      header_editing_size_val;
  uint64 ethernet_header_editing_size_val;
  int is_1588 ; 
  int ftmh_size = 0;
  int canonical_tpid = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "canonical_tpid", 0);
  int test1_tpid_1 =  soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "pbb_test1_tpid_1", 0x81a8);
  int test1_tpid_2 =  soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "pbb_test1_tpid_2", 0x88e7);
  int prog_dm_down_list[PROG_DM_DOWN_LIST_SIZE] = {ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP,ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP,
                                ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP_2CPU,ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_2CPU};
                                
  uint32 prgeVarLow;
  uint32 prgeVarHigh;
  
  uint32 fld_val;
  
  
  uint32 branch_pointer;

  uint32 nof_dynamic_members;

  uint32 user_header_size, user_header_0_size, user_header_1_size;
  uint32 user_header_egress_pmf_offset_0_dummy, user_header_egress_pmf_offset_1_dummy;
  int tm_profiles;
  uint32 program_pointer;
  int prog_used;
  uint32 tm_profile;
  uint32 routing_preserve_dscp;
  uint32 dscp_preserve_outlif_sel;
  uint8 outlif_profile_index;

  
  uint32 customer_conn_to_np_debug;
  uint32 customer_ftmh_dsp_extension_add;
  uint32 customer_ftmh_lb_extension_add;
  uint32 customer_disable_xtmh;
  uint32 outrif_range_lower_limit = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "outrif_range_lower_limit", 0x1000);
  uint32 rfc2544_reflector_mac_swap_1pass = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "rfc2544_reflector_mac_swap_1pass", 0);
  char *propval;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  customer_conn_to_np_debug = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "conn_to_np_debug", 0);
  customer_ftmh_dsp_extension_add = soc_property_get(unit, "ftmh_dsp_extension_add", 0);
  if ((propval = soc_property_get_str(unit, "system_ftmh_load_balancing_ext_mode")) != NULL) {
    if (sal_strcmp(propval,"ENABLED") == 0) {
        customer_ftmh_lb_extension_add = 1;    
    } else {
        customer_ftmh_lb_extension_add = 0;
    }
  } else {
    customer_ftmh_lb_extension_add = 0;
  }
  customer_disable_xtmh = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "disable_xtmh", 0);

  res = arad_egr_prog_editor_validate_lfem_action_array(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  prgeVarHigh = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_3", 0);
  prgeVarHigh = prgeVarHigh << 16;
  prgeVarHigh |= soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_2", 0);

  prgeVarLow = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_1", 0);
  prgeVarLow = prgeVarLow << 16;
  prgeVarLow |= soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_0", 0);

  res = arad_pmf_db_fes_user_header_sizes_get(
             unit,
             &user_header_0_size,
             &user_header_1_size,
             &user_header_egress_pmf_offset_0_dummy,
             &user_header_egress_pmf_offset_1_dummy
           );
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  user_header_size = (user_header_0_size + user_header_1_size) / 8;

  ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE ;
   
  if (SOC_IS_ARADPLUS(unit)) {
    if (soc_property_get(unit, spn_SCHEDULER_COMPENSATION_ENABLE, 0)) { 
      
      user_header_size = 0;
    }
  }

  tdm_mode = SOC_DPP_CONFIG(unit)->arad->init.tdm_mode;
  is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);

  if (is_petrab_in_system) 
  {
    soc_petrab_cfg = 1;
  }

  tdm_arad_opt = (tdm_mode == ARAD_MGMT_TDM_MODE_TDM_OPT);
  tdm_arad_std = (tdm_mode != ARAD_MGMT_TDM_MODE_TDM_OPT);

  
  if (SOC_IS_JERICHO_PLUS(unit)) {
      
      uint32 databuf[1] = {0}, progbuf[1] = {0};
      uint32 outlif_profiles_nof = 1 << soc_mem_field_length(unit,
                                                             EPNI_PRGE_PROGRAM_SELECTION_CAMm,
                                                             FIRST_OUT_LIF_PROFILE_MASKf);
      for (fld_val = 0; fld_val < outlif_profiles_nof; fld_val++) {
          soc_EPNI_OUTLIF_PROFILE_TO_PRGE_DATAm_field32_set(unit, databuf, OUTLIF_PROFILE_TO_PRGE_DATAf, fld_val);
          SOC_SAND_CHECK_FUNC_RESULT(soc_mem_write(unit, EPNI_OUTLIF_PROFILE_TO_PRGE_DATAm, MEM_BLOCK_ALL, fld_val, databuf), 10, exit);
          soc_EPNI_OUTLIF_PROFILE_TO_PRGE_PROGRAMm_field32_set(unit, progbuf, OUTLIF_PROFILE_TO_PRGE_PROGRAMf, fld_val);
          SOC_SAND_CHECK_FUNC_RESULT(soc_mem_write(unit, EPNI_OUTLIF_PROFILE_TO_PRGE_PROGRAMm, MEM_BLOCK_ALL, fld_val, progbuf), 10, exit);
      }
  }

  
  for (i = 0; i<=ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); i++) 
  {
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, i, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 
        prge_program_selection_cam_tbl_data.valid = 0;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, i, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 
  }

  
  res = arad_egr_prog_editor_programs_init(soc_petrab_cfg, unit);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  
  arad_egr_prog_editor_programs_usage_init(unit);

  
  res = arad_egr_prog_editor_programs_alloc(soc_petrab_cfg, unit, user_header_size);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 

  
  res = arad_egr_prg_editor_set_value_1_offset(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 

  
  SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  11,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_PMC_PARITY_ENr, SOC_CORE_ALL, 0, PMC_PARITY_ENf,  0));

  
  res = arad_egr_prge_mgmt_init(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  tcam_line = -1;

    
  
  if(programs_usage[unit].user_header_always_remove) {

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x7;

          prge_program_selection_cam_tbl_data.pph_type                  = 0x0;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x0;

          prge_program_selection_cam_tbl_data.program                   = prog_used;
          prge_program_selection_cam_tbl_data.valid                     = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x7;

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_TM;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;

          prge_program_selection_cam_tbl_data.program                   = prog_used;
          prge_program_selection_cam_tbl_data.valid                     = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
      }

  }

  if (SOC_IS_JERICHO(unit) && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "egress_snooping_advanced", 0)) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_2nd_PASS_OAM_UPMEP_SNOOP;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;

          prge_program_selection_cam_tbl_data.program                   = prog_used;
          prge_program_selection_cam_tbl_data.valid                     = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
      }
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.value_1              = ARAD_PRGE_PP_SELECT_VALUE_1_VMAC_DOWN_ADD;
    prge_program_selection_cam_tbl_data.value_1_mask              =0;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.value_1              =ARAD_PRGE_PP_SELECT_VALUE_1_VMAC_UP_ADD;
    prge_program_selection_cam_tbl_data.value_1_mask              =0;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_RCY_OVERLAY;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
  
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FRC_LITE;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  if (tm_profiles == -1) {
		  SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU is not allocated. \n\r")));
	  }
	  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles; 
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

      
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;    
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH_ERSPAN;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;    
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.data_entry_lsbs            =ARAD_PRGE_DATA_ENTRY_LSBS_ERSPAN;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      =0;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code                 = PP_FWD_CODE_SNOOP;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x0;
        prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code  = PP_FWD_CODE_SNOOP;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH_SPAN; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code = 1 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x01;
        prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
        prge_program_selection_cam_tbl_data.eei_valid                 = 0x1;
        prge_program_selection_cam_tbl_data.eei_valid_mask            = 0;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x01;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  if (prog_used != -1) {  
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x01;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);

  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      for (i=0; i<=SOC_IS_QAX(unit)*2; ++i) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.prge_tm_profile      = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask = (programs_usage[unit].user_header_always_remove)?
                                                                         (1 << (soc_mem_field_length(unit, EPNI_PRGE_PROGRAM_SELECTION_CAMm, PRGE_TM_PROFILEf)-1))
                                                                         :0;

          if (i == 0) { 
              
              prge_program_selection_cam_tbl_data.eei_valid            = 0x0;
              prge_program_selection_cam_tbl_data.eei_valid_mask       = 0x0;

              prge_program_selection_cam_tbl_data.learn_ext_exist      = 0x1;
              prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0x0;

              prge_program_selection_cam_tbl_data.fwd_code             = PP_FWD_CODE_ETHERNET; 
              prge_program_selection_cam_tbl_data.fwd_code_mask        = 0x0;
          }
          else { 
              prge_program_selection_cam_tbl_data.fwd_code             = (i==1)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC; 
              prge_program_selection_cam_tbl_data.fwd_code_mask        = 0x0;
          }

          prge_program_selection_cam_tbl_data.data_entry_lsbs      = ARAD_PRGE_DATA_ENTRY_LSBS_PON_DSCP_RE;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask = 0x0;

          prge_program_selection_cam_tbl_data.program              = prog_used;
          prge_program_selection_cam_tbl_data.valid                = 0x1;

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      for (i=0; i<=SOC_IS_QAX(unit)*2; ++i) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.prge_tm_profile      = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask = (programs_usage[unit].user_header_always_remove)?
                                                                         (1 << (soc_mem_field_length(unit, EPNI_PRGE_PROGRAM_SELECTION_CAMm, PRGE_TM_PROFILEf)-1))
                                                                         :0;
          if (i == 0) { 
              
              prge_program_selection_cam_tbl_data.eei_valid            = 0x1;
              prge_program_selection_cam_tbl_data.eei_valid_mask       = 0x0;

              prge_program_selection_cam_tbl_data.learn_ext_exist      = 0x0;
              prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0x0;

              prge_program_selection_cam_tbl_data.fwd_code             = PP_FWD_CODE_ETHERNET; 
              prge_program_selection_cam_tbl_data.fwd_code_mask        = 0x0;
          }
          else { 
              prge_program_selection_cam_tbl_data.fwd_code             = (i==1)?PP_FWD_CODE_IPV6_UC:PP_FWD_CODE_IPV6_MC; 
              prge_program_selection_cam_tbl_data.fwd_code_mask        = 0x0;
          }
          prge_program_selection_cam_tbl_data.data_entry_lsbs      = ARAD_PRGE_DATA_ENTRY_LSBS_PON_DSCP_RE;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask = 0x0;

          prge_program_selection_cam_tbl_data.program              = prog_used;
          prge_program_selection_cam_tbl_data.valid                = 0x1;

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_LI, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_LI;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;

      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; 
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit); 
  }

  if (SOC_IS_QAX(unit)) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_LI;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;

          prge_program_selection_cam_tbl_data.data_entry_cnt             = 2; 
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0;

          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
      }
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs            = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }
      else {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.fwd_code                  = 0x0;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x7;
          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit); 
  }
  

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                        unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 1; 
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 2;

      prge_program_selection_cam_tbl_data.pph_type                  = 2; 
      prge_program_selection_cam_tbl_data.pph_type_mask             = 1; 

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_IPSEC_ENC_DEC;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                        unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 1; 
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 2;

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_IPSEC_ENC_DEC;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.third_out_lif_profile      = 0x00; 
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f; 
      prge_program_selection_cam_tbl_data.second_enc                 = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
      prge_program_selection_cam_tbl_data.second_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay       = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask  = 0x1; 
      prge_program_selection_cam_tbl_data.program                    = prog_used;
      prge_program_selection_cam_tbl_data.valid                      = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
  }
  
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_NORMAL)) {
          prge_program_selection_cam_tbl_data.third_out_lif_profile      = 0x00; 
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f; 
          prge_program_selection_cam_tbl_data.second_enc                 = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
          prge_program_selection_cam_tbl_data.second_enc_mask            = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay       = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask  = 0x0;
          prge_program_selection_cam_tbl_data.program                    = prog_used;
          prge_program_selection_cam_tbl_data.valid                      = 0x1;
      } else if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LARGE)){
          prge_program_selection_cam_tbl_data.third_out_lif_profile      = 0x00; 
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f; 
          prge_program_selection_cam_tbl_data.second_enc                 = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
          prge_program_selection_cam_tbl_data.second_enc_mask            = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay       = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask  = 0x1; 
          prge_program_selection_cam_tbl_data.program                    = prog_used;
          prge_program_selection_cam_tbl_data.valid                      = 0x1;
      } else {
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_IPV6_TUNNEL;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0; 
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code      = 0x5; 
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;

      

      prge_program_selection_cam_tbl_data.program       = prog_used;
      prge_program_selection_cam_tbl_data.valid         = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.pph_type                  = 0x3; 
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x0;

      prge_program_selection_cam_tbl_data.value_1                   = ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_EGR_INJECT_WA; 
      prge_program_selection_cam_tbl_data.value_1_mask              = ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_SUBTYPE_MASK;

      prge_program_selection_cam_tbl_data.program       = prog_used;
      prge_program_selection_cam_tbl_data.valid         = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.pph_type                  = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x0;

      prge_program_selection_cam_tbl_data.oam_sub_type              = 7; 
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0;

      prge_program_selection_cam_tbl_data.program       = prog_used;
      prge_program_selection_cam_tbl_data.valid         = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_ETH_OAM_LOOPBACK;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;

      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }


   if ( SOC_DPP_CONFIG(unit)->pp.upmep_lbm_is_configured ){

      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_ETH_LOOPBACK;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          if (SOC_IS_JERICHO(unit)) {
              prge_program_selection_cam_tbl_data.eei_valid = 1;
              prge_program_selection_cam_tbl_data.eei_valid_mask = 0;
          }
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }


      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_ETH_OAM_LOOPBACK_UP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;

          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }
  


    	
    for (is_1588 = 0; is_1588 <= 1; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP; 
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            prge_program_selection_cam_tbl_data.oam_sub_type              = (is_1588 == 1)? _ARAD_PP_OAM_SUBTYPE_DM_1588 : _ARAD_PP_OAM_SUBTYPE_DM_NTP;
            prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0;

            prge_program_selection_cam_tbl_data.mirror_enable = 1 ;
            prge_program_selection_cam_tbl_data.mirror_enable_mask = 0 ;
            prge_program_selection_cam_tbl_data.fwd_enable = 0; 
            prge_program_selection_cam_tbl_data.fwd_enable_mask = 0;
            
            prge_program_selection_cam_tbl_data.valid = 1;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
        }

    }

	
	for (is_1588 = PROG_DM_DOWN_LIST_SIZE-1; is_1588 >= 0; is_1588--) { 
		
        int prog_index = prog_dm_down_list[is_1588];

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		if (prog_used != -1) {
			tcam_line++;
			if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
				SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
			}
			ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
            prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;      
            
            if(is_1588 >=2){ 
                prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0; 
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;  
            }

			prge_program_selection_cam_tbl_data.pph_type = 0x2; 
			prge_program_selection_cam_tbl_data.pph_type_mask = 0x1; 

			prge_program_selection_cam_tbl_data.value_1_mask              = ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_MASK;
			prge_program_selection_cam_tbl_data.value_1              = (is_1588%2) ? ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_1588_DOWN :
																				     ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_NTP_DOWN;
                                                                                                 

            prge_program_selection_cam_tbl_data.valid = 1;
			prge_program_selection_cam_tbl_data.program                 = prog_used;
			res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
		}
	}

	
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
       unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
       
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

       
       prge_program_selection_cam_tbl_data.fwd_code_mask = 0x7;

       prge_program_selection_cam_tbl_data.fhei_size =  1;
       prge_program_selection_cam_tbl_data.fhei_size_mask =  SOC_IS_JERICHO(unit) ? 0 : 3;

       prge_program_selection_cam_tbl_data.oam_sub_type = _ARAD_PP_OAM_SUBTYPE_LM;
       prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0;

       prge_program_selection_cam_tbl_data.mirror_enable = 1; 
       prge_program_selection_cam_tbl_data.mirror_enable_mask = 0;
       prge_program_selection_cam_tbl_data.fwd_enable = 0; 
       prge_program_selection_cam_tbl_data.fwd_enable_mask = 0;
       prge_program_selection_cam_tbl_data.valid = 1;
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

       if (SOC_IS_JERICHO(unit)) {
          
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
             SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          prge_program_selection_cam_tbl_data.fhei_size =  2;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
       }
       if (SOC_IS_JERICHO_PLUS(unit)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
             SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
          prge_program_selection_cam_tbl_data.oam_sub_type =  _ARAD_PP_OAM_SUBTYPE_SLM; 
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
       }
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.oam_sub_type              = ARAD_PP_OAM_SUBTYPE_EGRESS_SNOOP;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.oam_sub_type            = _ARAD_PP_OAM_SUBTYPE_CCM;
        if (SOC_IS_QUX(unit)) {
            
            prge_program_selection_cam_tbl_data.oam_sub_type_mask       = 0x2;
        } else {
            prge_program_selection_cam_tbl_data.oam_sub_type_mask       = 0x0;
        }

        prge_program_selection_cam_tbl_data.mirror_enable = 1;
        prge_program_selection_cam_tbl_data.mirror_enable_mask = 0;

        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
       unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.oam_sub_type            = _ARAD_PP_OAM_SUBTYPE_ETH_LOOPBACK;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask       = 0x0;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;

        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_END_TLV;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_BFD_CLEAR_FLAGS;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_END_TLV;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        for (i = 0; i < 2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            prge_program_selection_cam_tbl_data.fwd_code              = (i == 0) ? PP_FWD_CODE_IPV4_UC : PP_FWD_CODE_IPV6_UC;
            prge_program_selection_cam_tbl_data.fwd_code_mask         = 0;

        
            prge_program_selection_cam_tbl_data.learn_ext_exist       = 1;
            prge_program_selection_cam_tbl_data.learn_ext_exist_mask  = 0;

            prge_program_selection_cam_tbl_data.first_enc             = 0x1;
            prge_program_selection_cam_tbl_data.first_enc_mask        = 0x0;

            prge_program_selection_cam_tbl_data.program                    = prog_used;
            prge_program_selection_cam_tbl_data.valid                      = 0x1;

            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
        }
    }


    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
      for (i=0; i<2; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.fwd_code                   = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
          prge_program_selection_cam_tbl_data.fwd_code_mask              = 0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP; 
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
          prge_program_selection_cam_tbl_data.pph_type                  = 0x3;
          prge_program_selection_cam_tbl_data.data_entry_cnt             = 0;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }
   

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }

            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
            prge_program_selection_cam_tbl_data.fwd_code                   = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask              = 0;
            prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP; 
            prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;     
            prge_program_selection_cam_tbl_data.data_entry_cnt             = 0;
            prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
        }
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }

            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
            prge_program_selection_cam_tbl_data.fwd_code                   = (i==0)?PP_FWD_CODE_IPV6_UC:PP_FWD_CODE_IPV6_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask              = 0;
            prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP; 
            prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
            prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
            prge_program_selection_cam_tbl_data.pph_type                  = 0x1;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
            prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
        }
    }
    
    routing_preserve_dscp = (SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp;
    dscp_preserve_outlif_sel = (routing_preserve_dscp >> SOC_DPP_DSCP_PRESERVE_OUTLIF_SEL_SHIFT) & SOC_DPP_DSCP_PRESERVE_OUTLIF_SEL_MASK;

    for (outlif_profile_index=0; outlif_profile_index<=ARAD_EGR_PROG_MAX_OUTLIF_PROFILE_INDEX; outlif_profile_index++) {
        if (((outlif_profile_index == 0) && (dscp_preserve_outlif_sel !=0))
            || ((outlif_profile_index > 0) && ((dscp_preserve_outlif_sel & (0x1 << (outlif_profile_index-1))) == 0))) {
            
            continue;
        }

        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                    unit, ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
        if (prog_used != -1) {
            for (i = 0; i < 2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

                      
                  if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                      prge_program_selection_cam_tbl_data.first_enc             = 0x1;        
                      prge_program_selection_cam_tbl_data.first_enc_mask        = 0x0;
                  } else {
                      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIXED_QOS_MODEL;
                      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                  }

                  prge_program_selection_cam_tbl_data.fwd_code                  = (i == 0) ? PP_FWD_CODE_IPV4_UC : PP_FWD_CODE_IPV6_UC;
                  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                  prge_program_selection_cam_tbl_data.program                 = prog_used;
                  prge_program_selection_cam_tbl_data.valid                   = 0x1;

                  ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);

                  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
              }
        }

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
        if (prog_used != -1) {
            for (i=0; i<2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        
                if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                }
        
                prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
                prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
                prge_program_selection_cam_tbl_data.pph_type                  = 0x3;
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                

                ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);
                
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
            }
        }
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
        if (prog_used != -1) {
            for (i=0; i<2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        
                if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                }
        
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
                prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                

                ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
            }
        }
        
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 134, exit);
        if (prog_used != -1) {
            for (i=0; i<2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 135, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        
                if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                }
        
                prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV6_UC:PP_FWD_CODE_IPV6_MC;
                prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;
                

                ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 136, exit);
            }
        }


        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
        if (prog_used != -1) {
            for (i=0; i<2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

                
                if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                }

                if (SOC_IS_JERICHO_AND_BELOW(unit)) { 
                    
                    prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
                    prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
                }

                prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
                prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
                prge_program_selection_cam_tbl_data.pph_type                  = 0x3;
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.fhei_size                 = 1;
                prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x2;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;

                ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
            }
        }

        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
        if (prog_used != -1) {
            for (i=0; i<2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

                
                if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                }

                if (SOC_IS_JERICHO_AND_BELOW(unit)) { 
                    
                    prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
                    prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
                }

                prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
                prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.fhei_size                 = 1;
                prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x2;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;

                ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
            }
        }
        
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 134, exit);
        if (prog_used != -1) {
            for (i=0; i<2; i++) {
                tcam_line++;
                if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                    SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 135, exit);
                }
                ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

                
                if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
                }

                if (SOC_IS_JERICHO_AND_BELOW(unit)) { 
                    
                    prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
                    prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
                }

                prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV6_UC:PP_FWD_CODE_IPV6_MC;
                prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt            = 0;
                prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
                prge_program_selection_cam_tbl_data.program                 = prog_used;
                prge_program_selection_cam_tbl_data.valid                   = 0x1;

                ARAD_EGR_PROG_SELECTION_CAM_TBL_OUTLIF_PROFILE_MASK_CLEAR(prge_program_selection_cam_tbl_data, outlif_profile_index);

                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 136, exit);
            }
        }


        if ((outlif_profile_index == 0) && (dscp_preserve_outlif_sel ==0)) {
            break;
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x0;

        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_OAM_PORT; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
       prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x0;

       prge_program_selection_cam_tbl_data.oam_sub_type = _ARAD_PP_OAM_SUBTYPE_SLM;
       prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0x0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
       prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.fwd_code = 7;    
       prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
       
       prge_program_selection_cam_tbl_data.value_1 = 0;    
       prge_program_selection_cam_tbl_data.value_1_mask = 0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.fwd_code = 7;    
       prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
       
       prge_program_selection_cam_tbl_data.value_1 = 0;    
       prge_program_selection_cam_tbl_data.value_1_mask = 0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }



  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ERSPAN;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
      
      
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt             = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_ERSPAN;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
      prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }



  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_SPAN;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
        prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_OLP_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x0;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      

      prge_program_selection_cam_tbl_data.routing_over_overlay = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      

      prge_program_selection_cam_tbl_data.first_enc = 1; 
      prge_program_selection_cam_tbl_data.first_enc_mask = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code  = 0 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 3 ;

      
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          
      }

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;

      prge_program_selection_cam_tbl_data.fwd_code  = 4 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;

      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;
      prge_program_selection_cam_tbl_data.fwd_code  = 0 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 3 ;


      
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);


      if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          
      }

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);


      
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;

      prge_program_selection_cam_tbl_data.fwd_code  = 4 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;

      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          
      }
  }
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_MPLS ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;
      prge_program_selection_cam_tbl_data.fwd_code  = 0 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 3 ;


      
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);


      if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          
      }

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);


      
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_MPLS ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.fwd_code  = 4 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;

      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      

      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      

      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc                        = 0 ;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      prge_program_selection_cam_tbl_data.fwd_code     =   0 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask  = 3 ; 
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      prge_program_selection_cam_tbl_data.fwd_code     =   4 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0 ; 
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc                        = 0 ;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      prge_program_selection_cam_tbl_data.fwd_code     =   PP_FWD_CODE_MPLS ;
      prge_program_selection_cam_tbl_data.fwd_code_mask  = 0 ; 
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc                        = 3 ;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.fwd_code     =    PP_FWD_CODE_MPLS;
      prge_program_selection_cam_tbl_data.fwd_code_mask                          = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 2 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      }

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      int ps_rule_num = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "frr_label_in_mpls_tunnel", 0)?5:4;

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;

      for (i = 1; i <= ps_rule_num; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;

      for (i = 1; i <= 2; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = ARAD_EGR_EDITOR_PP_PROFILE_EXTEND_LEBAL_MASK;

      for (i = 1; i <= 2; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code      = PP_FWD_CODE_IPV4_UC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0;

      prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

      
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code      = PP_FWD_CODE_IPV6_UC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0;

      prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_ETHERNET;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      if (SOC_IS_JERICHO_B0_AND_ABOVE(unit) && !(SOC_IS_JERICHO_PLUS(unit))) {
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x1f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile = 0x20;
      }

      prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.system_mc                 = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0;

      prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.system_mc                 = 1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0;

      prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_MPLS;
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.first_enc = 0x1; 
        prge_program_selection_cam_tbl_data.first_enc_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV4_MC;
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }
  
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV4_UC;
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
      prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV6_MC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
      prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
      prge_program_selection_cam_tbl_data.second_enc_mask = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
      prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV6_UC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
      prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
      prge_program_selection_cam_tbl_data.second_enc_mask = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
	  prge_program_selection_cam_tbl_data.fwd_code                  = 1; 
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x2; 
        prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
	  prge_program_selection_cam_tbl_data.fwd_code                  = 2; 
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 14, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 4; 
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);


  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1)  {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  
	  prge_program_selection_cam_tbl_data.fwd_code                 = 1; 
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ROO_VXLAN; 
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

	  
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  prge_program_selection_cam_tbl_data.fwd_code                 = 2; 
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ROO_VXLAN; 
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                   = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; 
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV4_UC;
	prge_program_selection_cam_tbl_data.fwd_code_mask = 0;
	prge_program_selection_cam_tbl_data.pph_type = 2 ; 
	prge_program_selection_cam_tbl_data.pph_type_mask = 1 ;
	prge_program_selection_cam_tbl_data.valid = 1 ;
	prge_program_selection_cam_tbl_data.value_1                  =0x03;
	prge_program_selection_cam_tbl_data.value_1_mask              =0xf8;
	prge_program_selection_cam_tbl_data.program                 = prog_used;
	res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      

      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code              = 0x1;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.eei_valid                 = 0x1;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_WITH_USER_HEADERS;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.pph_type                  = 0x0;   
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x2;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_WITH_USER_HEADERS;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  for (i = 0; i < SOC_MAX_NUM_PORTS; ++i) {
      if (soc_property_port_get(unit, i, spn_RFC2544_REFLECTOR_MAC_SWAP_PORT, 0)) {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (prog_used != -1) {
              tcam_line++;
              if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
              }
              ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      
              res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &tm_profile);
              SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
              res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
              SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
              prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
              prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
              prge_program_selection_cam_tbl_data.valid = 1;
              prge_program_selection_cam_tbl_data.program                 = prog_used;
              res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
          }
          break; 
      }
  }

  
  if (rfc2544_reflector_mac_swap_1pass == 1) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &tm_profile);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
          prge_program_selection_cam_tbl_data.valid = 1;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  if (rfc2544_reflector_mac_swap_1pass) {
      if (rfc2544_reflector_mac_swap_1pass == 1) {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      }
      else {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      }

      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_REFLECTOR_1PASS;
          prge_program_selection_cam_tbl_data.ace_variable_mask = 0;

          prge_program_selection_cam_tbl_data.valid = 1;
          prge_program_selection_cam_tbl_data.program = prog_used;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_selection_cam_tbl_data.prge_tm_profile = tm_profiles; 
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_selection_cam_tbl_data.prge_tm_profile = tm_profiles; 
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_EGRESS_ACL_TWO_PASS_EDITING, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_EGRESS_ACL_TWO_PASS_EDITING is not allocated. \n\r")));
      }

      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV6_UC;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles; 
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;     
      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

    
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.program                 = 0x0;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_ETHERNET; 
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.eei_valid                = 0x1; 
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x0;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x0; 
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; 
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      for (i=0; i<2; ++i) { 
          if (i==1) {
              res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                  unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6, &prog_used);
          }

          for (j=0; j<2; ++j) { 
              tcam_line++;
              if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
              }
              ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
              prge_program_selection_cam_tbl_data.fwd_code                   = (j==0)?(PP_FWD_CODE_IPV4_UC+i*2):(PP_FWD_CODE_IPV4_MC+i*2); 
              prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
              prge_program_selection_cam_tbl_data.second_enc                 = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
              prge_program_selection_cam_tbl_data.second_enc_mask            = 0;
              prge_program_selection_cam_tbl_data.routing_over_overlay       = 1;
              prge_program_selection_cam_tbl_data.routing_over_overlay_mask  = 0x0;
              prge_program_selection_cam_tbl_data.program                 = prog_used;
              prge_program_selection_cam_tbl_data.valid                   = 0x1;
              res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
          }
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_INTO_BACKCONE_WITH_TTL_PORT;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  
  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW, 1, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);  
  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; 
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x0;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;    
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; 
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      
      prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }





  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; 
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      
      prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;  
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; 
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      
      prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                   = 0x7;    
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
          
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1; 

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = SOC_PPD_EG_ENCAP_TEST2_PROG_VAR;
      if(SOC_IS_JERICHO(unit)){
         prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      } else { 
         prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      }
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }



  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = SOC_PPD_EG_ENCAP_TEST2_PROG_VAR;
      if(SOC_IS_JERICHO(unit) || SOC_DPP_CONFIG(unit)->pp.mim_bsa_lsb_from_ssp){
         prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      } else { 
         prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      }
      if(SOC_IS_JERICHO(unit) && SOC_DPP_CONFIG(unit)->pp.mim_bsa_lsb_from_ssp){
          prge_program_selection_cam_tbl_data.pph_type = 0x1;
          prge_program_selection_cam_tbl_data.pph_type_mask = 0x2;
      }
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  if (SOC_IS_JERICHO(unit) && SOC_DPP_CONFIG(unit)->pp.mim_bsa_lsb_from_ssp) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
          prge_program_selection_cam_tbl_data.pph_type                  = 0x0; 
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x2;
          prge_program_selection_cam_tbl_data.program                   = prog_used;
          prge_program_selection_cam_tbl_data.valid                     = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_FCOE_N_PORT, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_FCOE_N_PORT is not allocated. \n\r")));
      }

      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_FCF;   
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;

      prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_FCF;   
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

	  prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_RAW_MPLS, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  if (tm_profiles == -1) {
		  SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_RAW_MPLS is not allocated. \n\r")));
	  }
	  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  res = arad_egr_prog_editor_set_tcam_sel(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE, 0, &tcam_line);
  SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.pph_type                  = 0x0;   
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x2;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

      
      if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
          prge_program_selection_cam_tbl_data.pph_type                  = 0x0;   
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x2;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 7;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

      
      if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          prge_program_selection_cam_tbl_data.fwd_code                  = 7;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_RX, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_DSA_RX, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_DSA_RX is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_TX, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_DSA_TX, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_DSA_TX is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TIMESTAMP_AND_SSP, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TIMESTAMP_AND_SSP is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0; 
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x2;
      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_L2_SRC_ENCAP;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x0;
      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable = 0x1;    
      prge_program_selection_cam_tbl_data.ace_variable_mask = 0;

      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable = 0x3;    
      prge_program_selection_cam_tbl_data.ace_variable_mask = 0;

      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      if (SOC_IS_JERICHO_PLUS(unit)) {        
          prge_program_selection_cam_tbl_data.sixth_out_lif_profile     =0;
          prge_program_selection_cam_tbl_data.sixth_out_lif_profile_mask=0;
      } else {
          prge_program_selection_cam_tbl_data.second_out_lif_profile     =0;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask=0;
      }

      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_L2TP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                            = PP_FWD_CODE_CUSTOM1;      
      prge_program_selection_cam_tbl_data.fwd_code_mask                        = 0 ;
      
      prge_program_selection_cam_tbl_data.data_entry_cnt                    = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                = 0x0;

      if (SOC_IS_JERICHO_PLUS(unit)) {        
          prge_program_selection_cam_tbl_data.third_out_lif_profile         = 0;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask    = 0;
      } else {
          prge_program_selection_cam_tbl_data.first_out_lif_profile         = 0;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask    = 0;
      }
      
      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.data_entry_cnt             = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;

      prge_program_selection_cam_tbl_data.program                    = prog_used;
      prge_program_selection_cam_tbl_data.valid                      = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
  }

  if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1){   
      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.fwd_code                  = (PP_FWD_CODE_ETHERNET | PP_FWD_CODE_ETHERNET_AFTER_TERMINATION);   
          prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x8;  
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.second_enc               = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_NONE;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x0;

          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
	  
	  
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0)) {
              tcam_line++;
              if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
              }
              prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
              prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
              res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
	  }
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  } else { 

            
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

	  
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0)) {
              tcam_line++;
              if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
              }
              prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
              prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
              res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
	  }
      }
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_OTMH_BASE, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_BASE is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE_KEEP_PPH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }



  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_OTMH_BASE, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_BASE is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_REMOVE_SYSTEM_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                 = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_REMOVE_TDM_OPT_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 160, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_TDM_PMM_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 170, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD_OVER_OUTER_FTMH, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD_OVER_OUTER_FTMH is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_PP_RCY_PORT, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_PP_RCY_PORT is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_STACKING, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_STACKING is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_TDM_STAMP_CUD;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);
  }

  	
	
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1)
	{
		tcam_line++;
		if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
		{
			SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		}
		ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
		
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_STACKING, &tm_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (tm_profiles == -1) {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_STACKING is not allocated. \n\r")));
        }
        prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
		prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0x0;
		prge_program_selection_cam_tbl_data.prge_pp_profile           =0x0;
		prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x0;
		prge_program_selection_cam_tbl_data.system_mc = 0 ;
		prge_program_selection_cam_tbl_data.system_mc_mask = 0 ;
		prge_program_selection_cam_tbl_data.oam_sub_type              =_ARAD_PP_OAM_SUBTYPE_DEFAULT;
		prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
		prge_program_selection_cam_tbl_data.valid = 1 ;
		prge_program_selection_cam_tbl_data.program                 = prog_used;
		res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	}


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  
  if(SOC_IS_JERICHO(unit) && programs_usage[unit].customer_conn_to_np_enable) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;   
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;  
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;   
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;  
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 2;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;   
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;  
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 00;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 3;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 01;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }


      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_MPLS;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS_1PLUS1, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_MPLS;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 3;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }
	  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_UC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_UC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

	  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_UC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 2;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }


      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_MC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_MPLS;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 2;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP - 1;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
          
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }


      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }  
  }

  
  if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
      if (SOC_IS_JERICHO(unit)) {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      }
      else { 
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      }

      if (prog_used != -1) {
          for (i = 0; i < 2; i++) {
              tcam_line++;
              if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
              }

              if (i == 0) {
                  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
                  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
              } else {
                  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
                  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
             }

             ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
             prge_program_selection_cam_tbl_data.fwd_code                = (i == 0) ? PP_FWD_CODE_SNOOP : 0;
             prge_program_selection_cam_tbl_data.fwd_code_mask           = (i == 0) ? 0 : 0xf;
             prge_program_selection_cam_tbl_data.prge_pp_profile         = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
             prge_program_selection_cam_tbl_data.prge_pp_profile_mask    = 0x0;
             prge_program_selection_cam_tbl_data.program                 = prog_used;
             prge_program_selection_cam_tbl_data.valid                   = 0x1;
             res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
             SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
          }
      }
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_GENERALIZED_RCY_HEADER_0, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_GENERALIZED_RCY_HEADER_0 is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;

      

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_GENERALIZED_RCY_HEADER_1, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_GENERALIZED_RCY_HEADER_1 is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;

      

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  
  tcam_line++;
  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
      SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
  }
  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
  prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
  prge_program_selection_cam_tbl_data.valid                   = 0x1;
  prge_program_selection_cam_tbl_data.program                 = 0x0;
  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 200, exit);

  

  
  program_line = 0; 
  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
  prge_program_tbl_data.program_pointer       = 0;
  COMPILER_64_ZERO(prge_program_tbl_data.program_var);
  prge_program_tbl_data.register_src          = 1;
  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, program_line, &prge_program_tbl_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, 0, 1, 0, user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.set(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, 0, 0, 0, user_header_size + ftmh_size, 0, 0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, 0, 1, 0, user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);


  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE, 0, 0, 0, (user_header_size+12+9), 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, 0, 1, 0, (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) ? 12 : 0) + user_header_size, 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      if (SOC_IS_JERICHO_PLUS(unit) && tdm_arad_std) {
          res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, 0, 1, 0, ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE, 0, 0);
          SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
      } else {
          sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
          COMPILER_64_ZERO(prge_program_tbl_data.program_var);
          prge_program_tbl_data.bytes_to_remove       = (soc_petrab_cfg && tdm_arad_opt) ? 2:4; ;

          res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 240, exit);
      }
  }

  res = arad_egr_prog_editor_set_prog_attr(
            unit, 
            ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE, 
            0, 
            0, 
            0, 
            (user_header_size + (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) ? 12 : 0) + 10), 
            0, 
            0x8100);
    SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);


  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, 0, 1, 0, user_header_size + 12, 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x8100); 
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = user_header_size + 12;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, 1, 1, 1, 0, SOC_PPD_EG_ENCAP_BFD_IPV4_PROG_VAR, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  if (customer_conn_to_np_debug) {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP, 1, 0, 0, 0, 0, 0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  } else {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP, 1, 1, 1, 0, 0, 0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

    
    res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_REFLECTOR, 1, 1, 1, 12, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

      
    res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_CH_CONN_TO_NP_RSPAN, 1, 1, 0, 12, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, 1, 1, 1, 0, SOC_PPD_EG_ENCAP_BFD_IPV4_PROG_VAR, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, 1, 1, 1, user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, 1, 1, 0, user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, 1, 1, 1, 0, 0x08000000, 0x00000000);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_RX, 0, 1, 0, 20, 0x0, 0x00008100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_TX, 0, 1, 0, 16, 0x0, 0x00008100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
 
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, 1, 1, 1, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION, 1, 1, 1, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, 1, 1, 1, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, 1, 1, 1, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO, 0, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, 0, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, 1, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, 1, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, 1, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, 0, 1, 1, 2, 0x0, 0x7);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER, 0, 1, 0, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, 1, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, 1, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, 1, 1, 1, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, 0, 1, 0, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, 0, 1, 0, 10 + user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, 1, 1, 1, 0, 0x0, 0x010100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, 1, 0, 0, user_header_size, 0x0, 0x010100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, 1, 1, 1, 0, 0x0, 0x010100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  for (is_1588=0; is_1588<PROG_DM_DOWN_LIST_SIZE ; ++is_1588) {
      
      res = arad_egr_prog_editor_set_prog_attr(unit, prog_dm_down_list[is_1588], 0, 1, 0, user_header_size, 0x0, 0xe000e0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, 0, 1, 0, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, 0, 1, 0, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, 0, 1, 1, 31, 0x0, 43);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, 0, 1, 1, 31, 0x0, 43);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  } else {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, 0, 0, 0, 0, 0, 0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, 0, 0, 0, 0, 0, 0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  
  for (is_1588=0; is_1588<=1 ; ++is_1588) {
      int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                        ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP;

      res = arad_egr_prog_editor_set_prog_attr(unit, prog_index, (soc_petrab_cfg ? 0 : 1), 1, (soc_petrab_cfg ? 0 : 1), 0, 0, 0xe000e0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, (soc_petrab_cfg ? 0 : 1), 1, (soc_petrab_cfg ? 0 : 1), 0, 0x0, 0xe0000c);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, 0, 0, 0, (tdm_arad_opt ? 4 : (tdm_arad_std  ? 9 : 0)), 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, 0, 0, 0, 2, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, 1, 1, 1, 0, 0x86dd6000, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, (soc_petrab_cfg ? 0 : 1), 1, (soc_petrab_cfg ? 0 : 1), 0, 0xe0, 0xe0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, 0, 1, 0, 24 + user_header_size, 0x0, 0x2);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  if (SOC_IS_JERICHO(unit) && ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2)) {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, 1, 1, 0, user_header_size, SOC_PPD_EG_ENCAP_BFD_IPV4_PROG_VAR, 0x8100);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  } else {
     res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, 1, 1, 0, user_header_size, 0x0, 0x0);
     SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, 1, 1, 1, 0, 0x0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE, 1, 1, 1, 0, 0x0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);


  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, 0, 1, 0, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, 0, 0, 0, 0, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, 1, 1, 0, user_header_size, 0x0, 0x100088be);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, 1, 1, 0, user_header_size, 0x0, 0x1000);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, 0, 1, 0, 12 + user_header_size + SOC_DPP_CONFIG(unit)->pp.pon_application_enable*4, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, 1, 1, 1, 0, 0x55550800, 0x00001100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, 0, 1, 0, 4 + user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, 1, 0, 0, 0, 0x0, ARAD_PRGE_DATA_MEMORY_ENTRY_L2_REMOTE_CPU);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, 1, 1, 0, user_header_size, 0x5550100, 18);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, 1, 1, 0, user_header_size, 0, 0x101000);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, 0, 1, 0, 12 + user_header_size, 0, 0x10100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, 1, 1, 0, user_header_size, 0, 0x10100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, 1, 1, 0, user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, 0, 1, 0, 6, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, 1, 1, 1, user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);


  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, 1, 1, 1, 12, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, 0, 1, 0, 12 + user_header_size, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, 1, 1, 1, 6, 0, 0x80);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, 0, 1, 0, 2 + user_header_size, 0, 0x8000);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, 1, 1, 1, 0, 0, 0x4000);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_SBFD_REFLECTOR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MIXED_QOS_MODEL, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_COPY_DSCP_MIXED_QOS_MODEL, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW, 1, 1, 1, 0, prgeVarHigh, prgeVarLow);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, 1, 1, 1, 12, 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, 0, 1, 1, 26, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  if (SOC_IS_JERICHO(unit)) {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, 0, 1, 1, 27, 0, 0x01200d00);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit)
  } else {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, 0, 1, 1, 26, 0, 0x01200d00);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  if (SOC_DPP_CONFIG(unit)->pp.udp_tunnel_enable && SOC_IS_JERICHO_B0_AND_ABOVE(unit)) {
      int prog_index[] = {ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP ,ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP ,ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP};
      int dest_port[] = {ARAD_EGR_PRGE_UDP_TUNNEL_MPLS_DEFAULT_PORT ,ARAD_EGR_PRGE_UDP_TUNNEL_IPV4_DEFAULT_PORT ,ARAD_EGR_PRGE_UDP_TUNNEL_IPV6_DEFAULT_PORT};
      for (i = 0 ; i < 3 ; i++) {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, prog_index[i], &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (prog_used != -1) {
              sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
              res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prge_program_tbl_data.program_pointer);
              SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
              COMPILER_64_SET(prge_program_tbl_data.program_var, 0, dest_port[i]);
              prge_program_tbl_data.register_src          = 1;
              prge_program_tbl_data.remove_system_header  = 1; 
              prge_program_tbl_data.remove_network_header = 1;
              res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
          }
      }
  }

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_SR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, 0, 0, 0, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, 1, 1, 1, 0, 0, 0xFFFFFF);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC_OTSH_REMOVE, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS_1PLUS1, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, 0, 1, 0, user_header_size + SOC_DPP_ARAD_INJECTED_HEADER_SIZE_BYTES_VENDOR_PP_2, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, 1, 1, 1, 0, 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, 1, 1, 1, 0, 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, 1, 1, 1, 0, 0, 0x8100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_LI, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  if (SOC_IS_QAX(unit)) {
      res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6, 1, 1, 1, 0, 0, 0);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING, 0, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP, 1, 1, 1, 0, 0x0021, 0x88641100);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_L2TP, 1, 1, 1, 0, 0x06a506a5, 0x00000002);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1, 1, 1, 1, 0, 0, 0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  
  res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER, 1, 1, 0, user_header_size, 0x0, 0x0);
  SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);

  {
    uint32 ioam_eli_label;

    ioam_eli_label = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ioam_eli_label", 12);

    res = arad_egr_prog_editor_set_prog_attr(unit, ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS, 1, 1, 1, 0, 0, ioam_eli_label);
    SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  

  
  SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_null_prog_init(unit, 0, 1) );

  
  mem   = EPNI_PRGE_INSTRUCTION_0m - 1;

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 79;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 57; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 1;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 76;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x2;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 1;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; 
            prge_instruction_tbl_data.offset_base = 5; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; 
            prge_instruction_tbl_data.offset_base = 13; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select   = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2; 
            prge_instruction_tbl_data.offset_base = 113; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2; 
            prge_instruction_tbl_data.offset_base = 55; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1){ 

      
      uint32 branch_ptr_cud_sp, branch_ptr_cud_mc;
      res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_AND_SOURCE_PORT, &branch_ptr_cud_sp);
      SOC_SAND_IF_ERR_EXIT(res);
      res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_MC, &branch_ptr_cud_mc);
      SOC_SAND_IF_ERR_EXIT(res);



          
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
          
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  
            prge_instruction_tbl_data.offset_base = 53; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  
            prge_instruction_tbl_data.offset_base = 50; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 2;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 13;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; 
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_3,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x2;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);

          
            
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_ptr_cud_sp);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_ptr_cud_sp);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            }
            else if (programs_usage[unit].two_hop_scheduling) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 17; 
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            else {
                prge_instruction_tbl_data.offset_base = 57; 
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; 
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.offset_base = 55; 
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1-4; 
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            else if (programs_usage[unit].two_hop_scheduling) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 13; 
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            else if (SOC_IS_JERICHO(unit)) {
                
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_96;
                prge_instruction_tbl_data.offset_base = 19 - (5*SOC_IS_JERICHO_PLUS(unit));
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            prge_instruction_tbl_data.op_value    = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                            entry==entry_odd);
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_ptr_cud_mc);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_ptr_cud_mc);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            }
            else {
                prge_instruction_tbl_data.offset_base = 57; 
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0;
            if (is_petrab_in_system && SOC_IS_JERICHO(unit)) {
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
            }
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; 
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1-4; 
            }
            else {
                prge_instruction_tbl_data.offset_base = 55; 
            }
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0x1f; 
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            else {
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            }

            if (is_petrab_in_system && SOC_IS_JERICHO(unit)) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 16;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 2;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            }

            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            prge_instruction_tbl_data.op_value    = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                            entry==entry_odd);
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; 
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            prge_instruction_tbl_data.op_value    = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                            entry==entry_odd);
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_ptr_cud_sp);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_ptr_cud_sp);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 43; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;  
            prge_instruction_tbl_data.offset_base = 5;  
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;  
            prge_instruction_tbl_data.offset_base = 13; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 45;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  =  0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;  
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  
            prge_instruction_tbl_data.offset_base = 113; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            if ((SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_EGR_17B_CUDS_127_PORTS_MODE) != 0) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }

            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;   
            prge_instruction_tbl_data.offset_base = 55; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;   
            prge_instruction_tbl_data.offset_base = 3; 
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

  if (soc_petrab_cfg)
  {
      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {

          mem   = EPNI_PRGE_INSTRUCTION_0m-1;

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
          entry = entry_odd;

          
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 8;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 13;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          for (i = mem; i<12+EPNI_PRGE_INSTRUCTION_0m; i++)
          {
            for (j = entry_even; j<=entry_odd; j++)
            {
                if (entry == entry_odd && i == mem)
                {
                    j = entry_odd;
                }

                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = 0;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, i, j, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            }
          }

          
          mem   = EPNI_PRGE_INSTRUCTION_0m + 11;
          entry = entry_odd;

          prge_instruction_tbl_data.src_select  = 2;
          prge_instruction_tbl_data.offset_base = 59;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 4;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
      }
  }

  res = arad_egr_prog_editor_tdm_coe_inter_conn(unit, user_header_size, ARAD_EGR_PROG_EDITOR_PROG_RM_SYS_HDR_TDM_COE);
  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

      
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) { 

          INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)   , ALU_SET(0, REG_OP(SZ))                              , "Extract TM-Port-Variable 1b lsb; RSZ = 0");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_NOP                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                   , "If TM-Port-Variable==1 RSZ=R1(=2)");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0))  , ALU_NOP                                             , "Copy Out-PP-Port");

      } 

      

      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) { 

          INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                              , "Extract TM-Port-Variable ; R1 = 2");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , "If TM-Port-Variable==0 RSZ=0");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ,0))  , ALU_NOP                                             , "Copy PP-Port-Variable");
          INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(SZ,0))    , ALU_NOP                                             , "Copy Program-Variable");
          INSTR( CE_COPY(PKT, R_OFST(3,24+(2*user_header_size)), C_SIZE(8)) , ALU_NOP                                     , "Copy SA & DA");
          INSTR( CE_COPY(PKT, R_OFST(3,8+(2*user_header_size)), C_SIZE(4))  , ALU_NOP                                     , "Copy SA & DA");
      }

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
  }

  if (SOC_IS_JERICHO_PLUS(unit)) {

      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          int total_bytes_removed = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE+ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE;

          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

          INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_BIT_3)              , ALU_SET(0, REG_OP(2))                               , "0: FEM=DSP_EXT_PRESENT, R2=0");
          INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2)              , ALU_SET(0, REG_OP(3))                               , "1: FEM=OAM_TS_PRESENT, R3=0");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(2), CNST(2), REG_OP(2)) , "2: if DSP_EXT_PRESENT, R2=2");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(3), CNST(6), REG_OP(3)) , "3: if OAM_TS_PRESENT, R3=6");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(1), REG_OP(2), REG_OP(1))            , "4: R1 += R2 (R1=(FTMH+LB_EXT+STACKING_EXT)+DSP_EXT)");
          INSTR( CE_NOP                                             , ALU_SET(0, REG_OP(SZ))                              , "5: Rsz = 0");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(1), REG_OP(3), REG_OP(1))            , "6: R1 += R3 (R1 now points to PPH)");
          INSTR( CE_NOP                                             , ALU_SET(0, REG_OP(0))                               , "7: R0 = 0");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_3)            , ALU_SET(0, REG_OP(2))                               , "8: FEM = EEI_EXT_PRESENT, R2=0");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_2)            , ALU_SET(0, REG_OP(3))                               , "9: FEM = LEARN_EXT_PRESENT, R3=0");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_1)            , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(3), REG_OP(0)), "10: FEM = FHEI.5B, if EEI_EXT_PRESENT, R0=3");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_0)            , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(5), REG_OP(2)), "11: FEM = FHEI.3B, if LEARN_EXT_PRESENT, R2=5");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(5), REG_OP(3)), "12: if FHEI.5B, R3=5");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(3), REG_OP(SZ)), "13: if FHEI.3B, Rsz=3");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(0), REG_OP(2), REG_OP(0))            , "14: R0 += R2");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(3), REG_OP(SZ), REG_OP(3))           , "15: R3 += Rsz");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(0), REG_OP(1), REG_OP(0))            , "16: R0 += R1");
          INSTR( CE_NOP                                             , ALU_SET(ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE, REG_OP(2)),
                                                                                                                            "17: R2=31");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(0), REG_OP(3), REG_OP(0))            , "18: R0 += R3 (R0=total_ftmh_size+total_pph_ext_size)");
          INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_1)              , ALU_SUB(CNST(total_bytes_removed), REG_OP(1), REG_OP(1)),
                                                                                                                            "19: R1 = 40 - R1 (R1=total_bytes_removed - total_ftmh_size)");
          INSTR( CE_NOP, ALU_SUB(CNST(total_bytes_removed-ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE-user_header_size), REG_OP(0), REG_OP(SZ)),
                                                                                                                            "20: Rsz = total_bytes_removed - (pph_size+udh_size+total_ftmh_size+total_pph_ext_size)");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), REG_OP(2), REG_OP(SZ)) , "21: if !PPH_EXT_PRESENT, Rsz=R2(31, only remove FTMH base header)");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "22: NOP");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "23: Copy from original packet");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2-16), R_SIZE(SZ, -8)), ALU_NOP                                  , "24: Copy from original packet");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2-32), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "25: Copy from original packet");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2-48), R_SIZE(SZ, -8)), ALU_NOP                                  , "26: Copy from original packet");

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
      }
  }


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

 INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ))                 , "0; ALU: RSZ=R3-12, calc Generated Header size - (Native Eth DA:SA size)");
 INSTR( CE_NOP                                                 , ALU_NOP                                                   , "1: NOP");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,0))               , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)     , ALU_NOP                                                   , "12: Read System header size (offset 161NB = 33+64B) using LFEM_8_LSBS; NOP ALU");
 INSTR( CE_NOP                                                 , ALU_NOP                                                   , "13: NOP");
 INSTR( CE_NOP                                                 , ALU_ADD(FEM, CNST(12), REG_OP(2))                         , "14: NOP CE; ALU: R2=FEM(System Header Size) + 12 (Eth DA;SA size)");
 INSTR( CE_NOP                                                 , ALU_NOP                                                   , "15: NOP");
 INSTR( CE_COPY(PKT, R_OFST(2,0), C_SIZE(6))                   , ALU_NOP                                                   , "16: Copy SA from Original Packet, ALU: NOP");
 INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                    , ALU_NOP                                                   , "17: Copy DA from generated Header, OFFSET_CONST_0 Point to head of packet, ALU: NOP");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

 INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3),  CNST(6), REG_OP(SZ))                  , "0; ALU: RSZ=R3-6, calc Generated Header size - (Native Eth DA size)");
 INSTR( CE_NOP                                                 , ALU_NOP                                                   , "1: NOP");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,0))               , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
 INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)     , ALU_NOP                                                   , "12: Read System header size (offset 161NB = 33+64B) using LFEM_8_LSBS; NOP ALU");
 INSTR( CE_NOP                                                 , ALU_NOP                                                   , "13: NOP");
 INSTR( CE_NOP                                                 , ALU_ADD(FEM, CNST(6), REG_OP(2))                          , "14: NOP CE; ALU: R2=FEM(System Header Size) + 6 (Eth DA size)");
 INSTR( CE_NOP                                                 , ALU_NOP                                                   , "15: NOP");
 INSTR( CE_COPY(PKT, R_OFST(2,0), C_SIZE(6))                   , ALU_NOP                                                   , "16: Copy DA from Original Packet, ALU: NOP");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                  , "R0 = R3 - R2 ");
     INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3), REG_OP(1), REG_OP(SZ))                 , "SZ = R3 - R1 ");
     INSTR( CE_NOP                                                 , ALU_SET_IF(REG_OP(0), EQ, CNST(4), CNST(4), REG_OP(SZ))  , "If R0=4 (mpls is the fowarding) then SZ=4");

     INSTR( CE_NOP                                                 , ALU_SET_IF(REG_OP(0), EQ, CNST(4), REG_OP(2), REG_OP(1)) , "If R0=4 then R1<-R2 (R1 will point to the end of the BOS label)");
     INSTR( CE_NOP                                                 , ALU_SET_IF(REG_OP(0), EQ, CNST(4), REG_OP(3), REG_OP(2)) , "If R0=4 then R2<-R3 (R2 will point to the start of the BOS label)");
     INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                    , "copy from generated header, fowarding header + mpls bos label ; Copy generated header RSZ = RSZ - 16");
     INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                  , "copy from generated header, fowarding header + mpls bos label ; Copy generated header R3 = R3 - 16");
     INSTR( CE_FREAD(PrgeDataFieldSysHdrSize, 0)                   , ALU_NOP                                                    , "Extract System header Size");
     INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                    , "copy from generated header, fowarding header + mpls bos label ; Copy generated header R3 = R3 - 16");
     INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(FEM, CNST(0), REG_OP(2))                          , "Copy generated header SZ = SZ - 16 & SZ = Network Header Size");
     INSTR( CE_LREAD(GEN, R_OFST(1,8), LFEM_LSB_MPLS)              , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))                                                   , "Build 12 lsb of the new mpls header");
     INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-16))              , ALU_NOP                                                    , "NOP");
     INSTR( CE_LREAD(PKT, R_OFST(2,0), LFEM_MSB_MPLS)             , ALU_SUB(FEM, CNST(0), REG_OP(0))                           , "Extract 4 bit LSB of the label Save Fem in R0");
     INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                                         , ALU_NOP                                                    , "NOP");
     INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))             , ALU_ADD(FEM, REG_OP(0), REG_OP(0))                         , "R0=R0+FEM");
     INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)       , ALU_NOP                                                    , "For port Ex. Extract Resolved.Data.tm-port-var");
     INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                , ALU_NOP                                                    , "write R0 to header");
     INSTR( CE_COPY(PKT, R_OFST(2, -1), C_SIZE(2)) , ALU_SUB(FEM, CNST(0), REG_OP(2))                          , "write to header 16 msb of the mpls label - For port ex. Copy fem to SZ"); 
     for(i=0; i<2; i++)
     { 
         INSTR( CE_COPY(GEN, R_OFST(1,0), R_SIZE(1,0))                 , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))                    , "Copy generated header R1 = R1 - 16");
         INSTR( CE_COPY(GEN, R_OFST(1,-16), R_SIZE(1,-8))              , ALU_NOP                                                    , "Copy generated header");
     }
     INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(2,0))      , ALU_NOP                                                    , "Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

     res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP);
     SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
     SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
         
        INSTR( CE_READ(GEN, R_OFST(2,44)) , ALU_SET(0x0800, REG_OP(1))                           , "extract ethertype for double tagged packet R2+22bytes,");
        INSTR( CE_READ(GEN, R_OFST(2,36)) , ALU_ADD(REG_OP(0), CNST(6), REG_OP(0))               , "extract ethertype for single tagged packet R2+18bytes, R0+=6 will point 6 bytes in outer IP header");
        INSTR( CE_READ(GEN, R_OFST(2,28)) , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(24), REG_OP(SZ)) , "extract ethertype for non    tagged packet R2+14bytes,");
        INSTR( CE_NOP                     , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(20), REG_OP(SZ)) , "");
        INSTR( CE_NOP                     , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(16), REG_OP(SZ)) , "last 3 instructions hopefully calculated the offset rom R2 to inner IP TOS");

        



        
        
        
         INSTR( CE_LREAD(GEN, R_OFST(0,-8), LFEM_8_MSBS), ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ)) , "extract version/IHL fields from outer IP, RSZ = R3-R0 for copying");
         INSTR( CE_COPY(GEN, R_OFST(3,0),  C_SIZE(8))   , ALU_ADD(REG_OP(SZ), REG_OP(2), REG_OP(2)) , "extract outer ip TOS higher 2 bytes 8 msbs,R2=R2+RSZ,poiting to the TOS of the native IP");
         INSTR( CE_COPY(GEN, R_OFST(3,-16),  C_SIZE(8)) , ALU_ADD(FEM,CNST(0), REG_OP(1))           , "RSZ = RSZ-6 for copying");
         INSTR( CE_LREAD(GEN, R_OFST(2,0), LFEM_8_LSBS) , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))   , "");
         INSTR( CE_NOP                                  , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "R1 = higher byte of new OUTER IP");
         INSTR( CE_NOP                                  , ALU_ADD(FEM,CNST(0), REG_OP(2))           , "R2 = native TOS");


        
         INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,0))               , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
         INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
         INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");


        
        
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)) , ALU_SUB(CNST(0xffff), REG_OP(2), REG_OP(1))    , "R1 = Inverse(native TOS)");
        INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16)) , ALU_ADD(REG_OP(2), REG_OP(1), REG_OP(2))       , "R2 = 2 first bytes of new outer IP");


        
        INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)), ALU_NOP, "copy inverse TOS to identification field of outer IP");


        
         INSTR( CE_COPY(GEN, R_OFST(0,-4), C_SIZE(2))        , ALU_SUB(REG_OP(0), CNST(6), REG_OP(0))  , "take the Total Length field from the Gen header, R0 is 6 bytes into the IP header");


        
         INSTR(  CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))    , ALU_NOP    , "copy the TOS from native IP"   );


        
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))     , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0)) , "");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))  , ALU_NOP                                 , "");

        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))     , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0)) , "");
    }else {
        
        INSTR( CE_READ(GEN, R_OFST(2,44))                   , ALU_SET(0x0800, REG_OP(SZ))                                 , "0: FEM=Ethertype of double tagged packet, Rsz=IP Ethertype");
        INSTR( CE_READ(GEN, R_OFST(2,36))                   , ALU_SET(16, REG_OP(1))                                      , "1: FEM=Ethertype of single tagged packet");
        INSTR( CE_LREAD(GEN, R_OFST(0,4), LFEM_8_LSBS)      , ALU_SET_IF(FEM, EQ, REG_OP(SZ), CNST(24), REG_OP(1))        , "2: FEM=ENCAP.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))         , ALU_SET_IF(FEM, EQ, REG_OP(SZ), CNST(20), REG_OP(1))        , "3: Copy 0, R1=offset of PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(8))       , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                           , "4: Copy 1, Rsz=ENCAP.tos");
        INSTR( CE_READ(GEN, R_OFST(0,24))                   , ALU_ADD(REG_OP(2), REG_OP(1), REG_OP(1))                    , "5: FEM=ENCAP.check_sum, R1=R2+R1(points to PAYLOAD.tos)");
        INSTR( CE_COPY(GEN, R_OFST(3,-32), C_SIZE(8))       , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ))                   , "6: Coyp 2, Rsz=R3-R0(IP tunnel size)");
        INSTR( CE_COPY(GEN, R_OFST(3,-48), C_SIZE(8))       , ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))                         , "7: Copy 3, R2=ENCAP.check_sum+ENCAP.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-64), C_SIZE(8))       , ALU_SUB(REG_OP(SZ), CNST(52), REG_OP(SZ))                   , "8: Copy 4, Rsz-=52(5*8+12)");
        INSTR( CE_LREAD(GEN, R_OFST(1,0), LFEM_8_LSBS)      , ALU_NOP                                                     , "9: FEM=PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ, 0))   , ALU_NOP                                                     , "10:Copy 5");
        INSTR( CE_LREAD(GEN, R_OFST(0,24), LFEM_IS_LAG)     , ALU_SUB(REG_OP(2), FEM, REG_OP(1))                          , "11:FEM=MSB(ENCAP.check_sum), MSB(1); R1=R2-PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-96), R_SIZE(SZ, -8))  , ALU_SUB(REG_OP(1), CNST(0), REG_OP(SZ))                     , "12:Copy 6, Rsz=R1(Rsz points to PAYLOAD.tos)");
        INSTR( CE_COPY(GEN, R_OFST(3,-112), R_SIZE(SZ, -16)), ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "13:R1+=MSB(1)");
        INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)   , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "14:FEM=MSB(R1), MSB(3); R2=R1");
        INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)   , ALU_NOP                                                     , "15:FEM=MSB(R2), MSB(2);");
        INSTR( CE_NOP                                       , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "16:R1-=MSB(3)");
        INSTR( CE_NOP                                       , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "17:(MSB(2)==1)? R1=R2");
        INSTR( CE_NOP                                       , ALU_NOP                                                     , "18:NOP");
        INSTR( CE_NOP                                       , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "19:(R1 == 0xFFFF)? R1=0 (ALU)");
        INSTR( CE_NOP                                       , ALU_NOP                                                     , "20:NOP");
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))      , ALU_NOP                                                     , "21:Copy R1(new check_sum)");
        INSTR( CE_COPY(GEN, R_OFST(0, 20), C_SIZE(8))       , ALU_NOP                                                     , "22:Copy ENCAP IP header, byte2-byte9");
        INSTR( CE_COPY(GEN, R_OFST(SZ, 0), C_SIZE(2))       , ALU_NOP                                                     , "23:Copy PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))       , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                     , "24:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))    , ALU_NOP                                                     , "25:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))       , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                     , "26:Cooy GEN");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))    , ALU_NOP                                                     , "27:Copy GEN");
    }

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

    res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

#if (ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE != 24)
#error "ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE is not 24"
#endif

    

    INSTR( CE_READ(GEN, C_OFST(36))                         , ALU_SET(0x0800, REG_OP(1))                          , "extract ether-type for single tagged packet offset 36 nibbles");
    INSTR( CE_READ(GEN, C_OFST(28))                         , ALU_SET(34    , REG_OP(0))                          , "extract ether-type for non    tagged packet offset 28 nibbles");
    INSTR( CE_NOP                                           , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(30), REG_OP(0)) , "if single tagged packet checksum is at offset 30 bytes");
    INSTR( CE_FLREAD( PrgeDataFieldEesData1,-1,LFEM_8_LSBS) , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(26), REG_OP(0)) , "if non    tagged packet checksum is at offset 26 bytes");
    INSTR( CE_NOP                                           , ALU_NOP                                             , "");

    
    
    

     INSTR( CE_READ(GEN, R_OFST(0,0))                       , ALU_SUB(FEM ,CNST(0),REG_OP(1))                        , "extract checksum ,R1 = TOS1(extracted two instructions up) ");
     INSTR( CE_NOP                                          , ALU_SUB(REG_OP(3),REG_OP(0),REG_OP(SZ) )               , "                                                           ");
     INSTR( CE_LREAD(GEN, R_OFST(0,-20), LFEM_8_LSBS)       , ALU_SUB(FEM,REG_OP(1), REG_OP(2))                      , "extract TOS2     ,R2 = checksum - TOS1(R1)                 ");
     INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_NOP                                                , "                                                           ");
     INSTR( CE_LREAD(GEN, R_OFST(0,0), LFEM_IS_LAG)         , ALU_ADD(REG_OP(2) ,FEM,REG_OP(1))                      , "extract MSB(1)   ,R1 = R2 + TO2                            ");
     INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,-8))    , ALU_NOP                                                , "                                                           ");
     INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)      , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                      , "extract MSB(3)   ,R1 = R1 + MSB(1)                         ");
     INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)      , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                 , "extract MSB(2)   ,R2 = R1                                  ");
     INSTR( CE_NOP                                          , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                       , "                 ,R1 = R1 - MSB(3)                         ");
     INSTR( CE_FLREAD( PrgeDataFieldEesData2,0,LFEM_4_LSBS) , ALU_SET_IF(FEM, EQ, CNST(0x0), REG_OP(2), REG_OP(1))   , "                 ,(MSB(2)==1)? R1 = R2                     ");
                   INSTR( CE_NOP                                          , ALU_NOP                                                , "                                                           ");
     INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))         , ALU_SUB(FEM ,CNST(0),REG_OP(2))                        , "copy R1(new checksum)                                      ");

    
    
    
    

     INSTR(CE_COPY(GEN, R_OFST(0,-4), C_SIZE(8))             , ALU_NOP                               , "copy everything between IPv4 checksum and TOS fields, total of 8 bytes");
     INSTR(CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(1))    , ALU_SUB(REG_OP(0),CNST(26),REG_OP(SZ)), "copy new TOS from EES_DATA1, total of 1 bytes");
     INSTR(CE_COPY(GEN, R_OFST(0,-22), C_SIZE(3))            , ALU_NOP                               , "copy IPv4 first byte and Ether-type of ETHERNET header, total of 3 bytes");
     INSTR(CE_COPY(GEN, R_OFST(0,-28), R_SIZE(SZ,0))         , ALU_NOP                               , "copy ETHERNET tags, it can RSZ can be anything from 0-8 bytes");
     INSTR(CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(2,0))  , ALU_NOP, "copy LLID label from EES_DATA2");
     INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6))               , ALU_NOP, "copy SA from generated header");
     INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))               , ALU_NOP, "copy DA from generated header");

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

     res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6);
     SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
     SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        

        INSTR( CE_READ(GEN, C_OFST(36))                                , ALU_SET(0x86dd, REG_OP(1))                          , "extract ether-type for single tagged packet offset 36 nibbles");
        INSTR( CE_READ(GEN, C_OFST(28))                                , ALU_SET(24    , REG_OP(0))                          , "extract ether-type for non    tagged packet offset 28 nibbles");
        INSTR( CE_NOP                                                  , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(20), REG_OP(0)) , "if single tagged packet checksum is at offset 30 bytes");
        INSTR( CE_FLREAD( PrgeDataFieldEesData1,0,LFEM_8_CENTRAL_BITS) , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(16), REG_OP(0)) , "if non    tagged packet checksum is at offset 26 bytes");
        INSTR( CE_NOP                                                  , ALU_NOP                                             , "");
        


        
        INSTR( CE_LREAD(GEN, R_OFST(0,0), LFEM_8_PERIPHERAL_BITS)  , ALU_SUB(FEM ,CNST(0),REG_OP(1))                        , "R1 = NEW_TOS(extracted two instructions up)                ");
        INSTR( CE_NOP                                              , ALU_SUB(REG_OP(3) ,REG_OP(0),REG_OP(SZ))               , "RSZ=R3-R0 this is for copying everything from R3 to R0     ");
        INSTR( CE_NOP                                              , ALU_ADD(FEM ,REG_OP(1),REG_OP(1))                      , "R1 = first 2 bytes of IPV6 header(with updated TOS)        ");

        
        
        INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
        INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
        INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),  ALU_SUB(REG_OP(0), CNST(2), REG_OP(0)), "4: Copy 8B from offset R3");
        INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),  ALU_SUB(REG_OP(0), CNST(14), REG_OP(SZ)), "5: Copy 8B from offset R3-8B(16NB)");

        
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))             , ALU_NOP                                 , "copy R1 which holds updated first 2 bytes of IPV6 header");

        
        INSTR( CE_FLREAD( PrgeDataFieldEesData2,0,LFEM_4_LSBS)     , ALU_NOP                                 , "                                                        ");
        INSTR( CE_NOP                                              , ALU_NOP                                 , "                                                        ");

        
        INSTR( CE_COPY(GEN, R_OFST(0, 0),  R_SIZE(SZ, 0))          , ALU_SUB(FEM ,CNST(0),REG_OP(2))         , "                                                        ");
        INSTR( CE_COPY(GEN, R_OFST(0, -16), R_SIZE(SZ, -8))        , ALU_NOP                                 , "                                                        ");



         INSTR(CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(2,0))  , ALU_NOP, "copy LLID label from EES_DATA2");
         INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6))               , ALU_NOP, "copy SA from generated header");
         INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))               , ALU_NOP, "copy DA from generated header");

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

     res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS);
     SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
     SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
    
    if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "append_ace_var_to_sys_header", 0)) {
        INSTR( CE_FCOPY(PrgeDataFieldAceVar, 0, C_SIZE(1)),            ALU_NOP,    "");
    }

     
    INSTR( CE_COPY(PKT, C_OFST(96), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(80), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(64), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(48), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(32), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(16), C_SIZE(8))  , ALU_NOP  , "");

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

      
      INSTR(CE_NOP,                                               ALU_SUB(REG_OP(3),  CNST(22), REG_OP(SZ)), "");
      INSTR(CE_NOP,                                               ALU_SUB(REG_OP(3),  CNST(8), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, 0)),            ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)),           ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)),          ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)),           ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)),          ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)),           ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)),          ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)),           ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)),          ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)),           ALU_SET(0x0800, REG_OP(1)),                "");
      INSTR(CE_LREAD(GEN, R_OFST(2, 1), LFEM_4_LSBS),             ALU_SET(4, REG_OP(3)),                     "FEM = IP_Version; R3 = 4");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)),          ALU_NOP,                                   "");

      
      INSTR(CE_NOP,                                      ALU_SET_IF(FEM, NEQ, REG_OP(3), CNST(0X86DD), REG_OP(1)), "; If IP_version != 4, set ethtype = 0x86dd");
      INSTR(CE_NOP,                                      ALU_NOP, "");
      INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)),     ALU_NOP, "");

      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0) && (soc_property_get(unit, spn_SPLIT_HORIZON_FORWARDING_GROUPS_MODE, 1) == 1)) {
          
          INSTR(CE_LREAD(GEN, C_OFST(28), LFEM_SPB_READ_BITS_FROM_BTAG_FIELD), ALU_SET(0, REG_OP(2)), "");
          INSTR(CE_COPY(GEN, C_OFST(32), C_SIZE(2)), ALU_NOP, "");
          INSTR(CE_LREAD(GEN, C_OFST(4), LFEM_SPB_READ_BDA_WITHOUT_ORIENTATION), ALU_ADD(FEM, REG_OP(2), REG_OP(2)), "");
          INSTR(CE_LCOPY(GEN, C_OFST(28), C_SIZE(2), LFEM_SPB_STAMP_LEFT_NIBBLE_8), ALU_NOP, "");
          
          INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(6)), ALU_ADD(FEM, REG_OP(2), REG_OP(2)), "");
          
          INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(4)), ALU_NOP, "");
          INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)), ALU_NOP, "");
      } else {
          
          INSTR(CE_COPY(GEN, C_OFST(32), C_SIZE(4)), ALU_NOP, "");
          
          INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(6)), ALU_NOP, "");
          
          INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");
      }

      res = arad_egr_prge_mgmt_build_program_end(unit); 
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 2) {
     INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
     INSTR( CE_READ(GEN, R_OFST(2,28))    , ALU_SET(0, REG_OP(1))                             , "");

     INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SET(2, REG_OP(0))                                           , "");
     INSTR( CE_NOP                    , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(0)) , "");

     INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "" );
     INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M)  , ALU_NOP          , "" );

     INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET_IF(REG_OP(0), NEQ, CNST(2), CNST(2), REG_OP(1))  , ""   );

     INSTR(CE_LREAD(GEN, R_OFST(2,29),  LFEM_LSHIFT_12)   , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
     INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , "" );

     INSTR(  CE_LREAD(GEN, R_OFST(2,-11), LFEM_12_LSBS)     , ALU_SUB(FEM,CNST(0) ,REG_OP(3))                         , "priority in R3"   );

     INSTR(  CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_1_0_M)  , ALU_NOP                            , ""   );
     INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );

     INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ))    , ""   );
     INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(1))                , ""   );

     INSTR(  CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))              , ALU_SET(0, REG_OP(3))   , ""   );
     INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SUB(REG_OP(2),CNST(20), REG_OP(SZ))   , ""   );

    
    INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8)), ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))            , "copy DA + SA + PWE");          
    INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8)), ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "copy DA + SA + PWE");


      
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8)) , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))  , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }


      
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

} else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 1){
    INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
    INSTR( CE_NOP                        , ALU_SET(0, REG_OP(0))                            , "");

    INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "");
    INSTR( CE_READ(GEN, R_OFST(2,28))                      , ALU_NOP , "");

    INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET(2, REG_OP(0))  , "" );
    INSTR( CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(0), REG_OP(0))  , "" );

    INSTR(  CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , ""   );

    INSTR(CE_LREAD(GEN, R_OFST(2,29),  LFEM_LSHIFT_12)   , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
    INSTR( CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16))   , ALU_NOP  , "" );

    INSTR(  CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)     , ALU_SUB(FEM,CNST(0) ,REG_OP(3))                         , "priority in R3"   );

    INSTR(  CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)  , ALU_SUB(CNST(2), REG_OP(0), REG_OP(3)), ""   );                        
    INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

    INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ)), "");                                                
    INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(3))            , "");

    INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ)),"");                                                     
    INSTR( CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))             ,ALU_SET(0, REG_OP(3))                   ,"");
    

    
    INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8)), ALU_SET_IF(FEM,EQ, CNST(1), REG_OP(3), REG_OP(3)), "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
    INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0)) , ALU_SUB(REG_OP(1),CNST(12), REG_OP(SZ))          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
    INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8)), ALU_NOP                                          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");


      
      INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))   , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1)), "");
      INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))  , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16)) , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


       
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
                 
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");
}

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 2) {
     INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
     INSTR( CE_READ(GEN, R_OFST(2,28))    , ALU_SET(0, REG_OP(1))                             , "");

     INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SET(2, REG_OP(0))                                           , "");
     INSTR( CE_NOP                                          , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(0)) , "");

     INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "" );
     INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M)                                         , ALU_NOP          , "" );

     INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET_IF(REG_OP(0), NEQ, CNST(2), CNST(2), REG_OP(1))  , ""   );

     INSTR( CE_NOP                                          , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
     INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))    , ALU_NOP  , "" );

     INSTR(  CE_LREAD(GEN, R_OFST(2,-11), LFEM_12_LSBS)    , ALU_SET(0 ,REG_OP(3))                                   , "priority in R3"   );

     INSTR(  CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_1_0_M)  , ALU_NOP                            , ""   );                        
     INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

     INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ))    , ""   );                                                
     INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(1))                , ""   ); 

     INSTR(  CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))              , ALU_SET(0, REG_OP(3))   , ""   );                                                     
     INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SUB(REG_OP(2),CNST(20), REG_OP(SZ))   , ""   );
    
    
    INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8)), ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))            , "copy DA + SA + PWE");          
    INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8)), ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "copy DA + SA + PWE");
      

      
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8)) , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))  , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


       
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
                 
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

} else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 1){

    INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
    INSTR( CE_NOP                        , ALU_SET(0, REG_OP(0))                            , "");

    INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "");
    INSTR( CE_READ(GEN, R_OFST(2,28))                      , ALU_NOP , "");

    INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET(2, REG_OP(0))  , "" );
    INSTR( CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(0), REG_OP(0))  , "" );

    INSTR(  CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , ""   );

    INSTR( CE_NOP                      , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
    INSTR( CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16))   , ALU_NOP  , "" );

    INSTR(  CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)     , ALU_SET(0 ,REG_OP(3))            , "priority in R3"   );

    INSTR(  CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)  , ALU_SUB(CNST(2), REG_OP(0), REG_OP(3)), ""   );                        
    INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

    INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ)), "");                                                
    INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(3))            , "");

    INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ)),"");                                                     
    INSTR( CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))             ,ALU_SET(0, REG_OP(3))                   ,"");
    

    
    INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8)), ALU_SET_IF(FEM,EQ, CNST(1), REG_OP(3), REG_OP(3)), "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
    INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0)) , ALU_SUB(REG_OP(1),CNST(12), REG_OP(SZ))          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
    INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8)), ALU_NOP                                          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");


      
      INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))   , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1)), "");
      INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))  , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16)) , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


       
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
                 
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");
}
      
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 2) {
     INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
     INSTR( CE_READ(GEN, R_OFST(2,28))    , ALU_SET(0, REG_OP(1))                             , "");

     INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))   , ALU_SET(2, REG_OP(0))                                           , "");
     INSTR( CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(0)) , "");

     INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "" );
     INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M)                                         , ALU_NOP          , "" );

     INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET_IF(REG_OP(0), NEQ, CNST(2), CNST(2), REG_OP(1))  , ""   );

     INSTR( CE_NOP                                       , ALU_SUB(CNST(64),FEM,REG_OP(SZ)) , "" );
     INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8)) , ALU_NOP                          , "" );

     INSTR(  CE_NOP    , ALU_SET(0 ,REG_OP(3))                                   , "priority in R3"   );

     INSTR(  CE_NOP  , ALU_NOP                            , ""   );                        
     INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

     INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))            , ALU_SUB(CNST(64),FEM, REG_OP(SZ))    , ""   );                                                
     INSTR(  CE_NOP                                             , ALU_SET(2, REG_OP(1))                , ""   ); 

     INSTR(  CE_NOP                                             , ALU_SET(0, REG_OP(3))   , ""   );                                                     
     INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SUB(REG_OP(2),CNST(20), REG_OP(SZ))   , ""   );
    
    
    INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8)), ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))            , "copy DA + SA + PWE");          
    INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8)), ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "copy DA + SA + PWE");
      

      
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8)) , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))  , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


       
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
                 
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

} else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 1){

    INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
    INSTR( CE_NOP                        , ALU_SET(0, REG_OP(0))                            , "");

    INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "");
    INSTR( CE_READ(GEN, R_OFST(2,28))                      , ALU_NOP , "");

    INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET(2, REG_OP(0))  , "" );
    INSTR( CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(0), REG_OP(0))  , "" );

    INSTR(  CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , ""   );

    INSTR( CE_NOP                                          , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
    INSTR( CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16))   , ALU_NOP  , "" );

    INSTR(  CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)     , ALU_SET(0 ,REG_OP(3))                         , "priority in R3"   );

    INSTR(  CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)  , ALU_SUB(CNST(2), REG_OP(0), REG_OP(3)), ""   );                        
    INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

    INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ)), "");                                                
    INSTR(  CE_NOP                                       , ALU_SET(2, REG_OP(3))            , "");

    INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ)),"");                                                     
    INSTR( CE_NOP                                            ,ALU_SET(0, REG_OP(3))                   ,"");
    

    
    INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8)), ALU_SET_IF(FEM,EQ, CNST(1), REG_OP(3), REG_OP(3)), "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
    INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0)) , ALU_SUB(REG_OP(1),CNST(12), REG_OP(SZ))          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
    INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8)), ALU_NOP                                          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");


      
      INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))   , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1)), "");
      INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))  , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16)) , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


       
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
                 
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

}

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }
  

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

      INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3),  REG_OP(1), REG_OP(SZ))             , "Read System header size , RSZ = R3-R1");
      INSTR(CE_NOP                                            , ALU_NOP                                                , "Read System header size , RSZ=RSZ -4 -8");
      INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(FEM,  CNST(0), REG_OP(2))                      , "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -4))        , ALU_SUB(REG_OP(SZ),  CNST(20), REG_OP(SZ))             , "R2 = System header size");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -12))     , ALU_ADD(FEM, CNST(30), REG_OP(0))                      , "");
      INSTR(CE_READ(PKT, R_OFST(2, 36)), ALU_ADD(REG_OP(2)    , CNST(26), REG_OP(2))                                   , "");
      INSTR(CE_READ(PKT, R_OFST(2, 28)), ALU_ADD(REG_OP(2)    , CNST(22), REG_OP(2))                                   , "");
      INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(SZ, 0))       , ALU_SET_IF(FEM, EQ, CNST(0x8847), REG_OP(2), REG_OP(0)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -48), R_SIZE(SZ, -8))      , ALU_SET_IF(FEM, EQ, CNST(0x8847), REG_OP(2), REG_OP(0)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -64), R_SIZE(SZ, -16))     , ALU_SET(2, REG_OP(SZ))                                 , "");

      
      
      

      INSTR(CE_LREAD(PKT, R_OFST(0, 0),    LFEM_TTL_EXP)                 , ALU_SET(0, REG_OP(2))                           , "");
      INSTR(CE_LREAD(PKT, R_OFST(0, -8),  LFEM_TTL_EXP)                  , ALU_NOP                                         , "");
      INSTR(CE_LREAD(GEN, R_OFST(1, 8),   LFEM_TTL_EXP_COMP)             , ALU_SUB(FEM  ,CNST(1), REG_OP(SZ))              , "");
      INSTR(CE_LREAD(GEN, R_OFST(1, 0),    LFEM_TTL_EXP_COMP)            , ALU_SUB(FEM  ,CNST(1), REG_OP(3))               , "");
      INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS_SWAPPED)    , ALU_ADD(FEM, REG_OP(SZ), REG_OP(0))             , "");
      INSTR(CE_NOP                                                       , ALU_ADD(FEM, REG_OP(3), REG_OP(3))              , "");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                      , ALU_SET_IF(FEM, EQ, CNST(2), CNST(2), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(1, 4),    C_SIZE(2))                     , ALU_SUB(REG_OP(1),  CNST(16), REG_OP(0))        , "");
      INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                      , ALU_SUB(REG_OP(1),  CNST(4), REG_OP(1))         , "");
      INSTR(CE_COPY(GEN, R_OFST(1, -4),   C_SIZE(2))                     , ALU_NOP                                         , "");

      
      INSTR(CE_COPY(GEN, R_OFST(1, 0), R_SIZE(0, 0)), ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(0, -8)), ALU_SET(COE_TYPE_2_TPID, REG_OP(0)), "");

      
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0), LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(2, 0)),                        ALU_NOP, "Copy Program-Variable");

      
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
          INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");
      } else { 
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }

      
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);  

          

      
       INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(20), REG_OP(SZ)), "0; ALU: RSZ=R3-20, calc Generated Header size - (Native Eth DA:SA size)");
       INSTR(CE_NOP, ALU_NOP, "1: NOP");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");


      
      INSTR( CE_READ(GEN, C_OFST(40 + (user_header_size*2)))                , ALU_SET(0, REG_OP(1))              , "Extract res2 and ttl from generated");
      INSTR( CE_LREAD(GEN, C_OFST(40 + (user_header_size*2)), LFEM_BIT_8)   , ALU_NOP                            , " Extract res2 from generated packet");
      INSTR( CE_READ(GEN, C_OFST(28 + (user_header_size*2)))                , ALU_SUB(FEM, CNST(0), REG_OP(3))   , " R3=Res2 from generated");
      INSTR( CE_READ(GEN, C_OFST(36 + (user_header_size*2)))                , ALU_SUB(FEM, CNST(0), REG_OP(SZ))  , " R3=Res2 from generated");

      
      INSTR( CE_READ(GEN, C_OFST(40 + (user_header_size*2)))                , ALU_SET_IF(FEM, NEQ, CNST(test1_tpid_1), REG_OP(1), REG_OP(SZ)) , "");
      INSTR( CE_READ(GEN, C_OFST(40 + (user_header_size*2)))                , ALU_SET_IF(FEM, NEQ, CNST(test1_tpid_2), REG_OP(1), REG_OP(SZ)) , "");


      
      INSTR(  CE_NOP                                   ,  ALU_NOP                                    , " NOP");
      INSTR( CE_NOP                                    ,  ALU_SUB(REG_OP(3), REG_OP(SZ), REG_OP(3))  , " R3= TTL - SZ(0/1)");
      INSTR(  CE_NOP                                   ,  ALU_NOP                                    , " NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))   , ALU_NOP                                     , "Append res 2 and ttl to the packet");
 
 
      
      INSTR( CE_COPY(GEN, C_OFST(36+(user_header_size*2)), C_SIZE(8))               , ALU_NOP  , "Copy generated header ");
      INSTR( CE_COPY(GEN, C_OFST(20+(user_header_size*2)), C_SIZE(8))               , ALU_NOP  , "Copy generated header ");
      INSTR( CE_COPY(GEN, C_OFST(4+(user_header_size*2)), C_SIZE(2))               , ALU_NOP  , "Copy generated header "); 
     
      
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


  }






  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1_ENCAPSULATION);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
       INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(20), REG_OP(SZ)), "0; ALU: RSZ=R3-20, calc Generated Header size - (Native Eth DA:SA size)");
       INSTR(CE_NOP, ALU_NOP, "1: NOP");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
       INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
       INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");


      
      INSTR(CE_LCOPY(GEN, C_OFST(40 + (user_header_size * 2)), C_SIZE(2),LFEM_SET_BITS_7_8),  ALU_NOP, "conatenate bytes 19,20 after setting RES2");


      
      INSTR(CE_COPY(GEN, C_OFST(36 + (user_header_size * 2)), C_SIZE(8)), ALU_NOP, "Copy generated header ");
      INSTR(CE_COPY(GEN, C_OFST(20 + (user_header_size * 2)), C_SIZE(8)), ALU_NOP, "Copy generated header ");
      INSTR(CE_COPY(GEN, C_OFST(4 + (user_header_size * 2)), C_SIZE(2)), ALU_NOP, "Copy generated header ");


      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      if (SOC_DPP_CONFIG(unit)->pp.mim_bsa_lsb_from_ssp) {
          INSTR(CE_NOP, ALU_SUB(REG_OP(3), CNST(22), REG_OP(SZ)), " ----; SZ=R3-22 number of bytes to copy");
          INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_IS_LAG), ALU_NOP, "Extract src system port; ----");
          INSTR(CE_COPY(GEN, R_OFST(3, -0), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "copy from gen; SZ=SZ-16");
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(FEM, CNST(0), REG_OP(2)), "copy from gen; r2=src system port is lag?");
          INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(SZ, 0)), ALU_NOP, "copy from gen; ----");
          INSTR(CE_COPY(GEN, R_OFST(3, -48), R_SIZE(SZ, -8)), ALU_NOP, "copy from gen; ----");
          INSTR(CE_COPY(GEN, R_OFST(3, -64), R_SIZE(SZ, -16)), ALU_NOP, "copy from gen; ----");
          INSTR(CE_COPY(GEN, C_OFST(44 + (user_header_size * 2)), C_SIZE(8)),  ALU_NOP, " copy 4B I-Tag,2B EtherType, 2B B-VID; ----");
          INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_7_LSBS), ALU_NOP, "extract lag id ; ");
          INSTR(CE_LREAD(GEN, C_OFST(24 + (user_header_size * 2)), LFEM_8_LSBS), ALU_NOP, "extrack lsb sa;");
          INSTR(CE_NOP, ALU_SUB(FEM, CNST(0), REG_OP(1)), " ----; R1=LAG id");
          INSTR(CE_NOP, ALU_SUB(FEM, CNST(0), REG_OP(3)), " ----; R3=lsb sa");
          INSTR(CE_NOP, ALU_SET_IF(REG_OP(2), EQ, CNST(0x1), REG_OP(1), REG_OP(0)), "If is lag R0=SA lag");
          INSTR(CE_NOP, ALU_SET_IF(REG_OP(2), NEQ, CNST(0x1), REG_OP(3), REG_OP(0)), "If is not  lag R0=lsb sa");
      } else {
          INSTR(CE_COPY(GEN, R_OFST(3, 0), C_SIZE(8)), ALU_SUB(REG_OP(3), CNST(38), REG_OP(SZ)), "copy from gen ; SZ= R3-19 number of bytes to copy");
          INSTR(CE_COPY(GEN, R_OFST(3, -16), C_SIZE(8)), ALU_NOP, "NOP");
          INSTR(CE_LREAD(GEN, C_OFST(29 + (user_header_size * 2)), LFEM_MSB_MPLS), ALU_SET(0xff, REG_OP(1)), "Extract dei & pri ; R1=255 TTL");
          if (SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable) {
              INSTR(CE_LREAD(PKT, C_OFST(9 + ((ftmh_size + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE) * 2)), LFEM_SVID), ALU_NOP, "Extract S-VID from vsi in PPH ; --- ");
          } else {
              INSTR(CE_LREAD(PKT, C_OFST(9 + (ftmh_size * 2)), LFEM_SVID), ALU_NOP, "Extract S-VID from vsi in PPH ; --- ");
          }
          INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_IS_LAG), ALU_SUB(FEM, CNST(0), REG_OP(2)), "Extract src system port ; R2=dei & pri");
          INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(SZ, 0)), ALU_SUB(FEM, CNST(0), REG_OP(0)), "copy from gen ; R0=S-VID");
          INSTR(CE_COPY(GEN, R_OFST(3, -48), R_SIZE(SZ, -8)), ALU_SUB(FEM, CNST(0), REG_OP(3)), "copy from gen ; r3=src system port is lag?");
          INSTR(CE_COPY(GEN, R_OFST(3, -64), R_SIZE(SZ, -16)), ALU_NOP, "copy from gen");
          INSTR(CE_LREAD(GEN, C_OFST(24 + (user_header_size * 2)), LFEM_SA_LAG), ALU_ADD(REG_OP(0), REG_OP(2), REG_OP(0)), "extract fap id; R0=dei&pri&svid");
          if (SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable) {
              INSTR(CE_LCOPY(PKT, C_OFST(10 + ((ftmh_size + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE) * 2)), C_SIZE(1), LFEM_EID), ALU_SET(0xe0e0, REG_OP(1)), "Extract EID from VSI from pph; R1=0xe0e0");
          } else {
              INSTR(CE_LCOPY(PKT, C_OFST(10 + (ftmh_size * 2)), C_SIZE(1), LFEM_EID), ALU_SET(0xe0e0, REG_OP(1)), "Extract EID from VSI from pph; R1=0xe0e0");
          }
          INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)), ALU_SUB(FEM, CNST(0), REG_OP(2)), "append r1 (ttl) to the packet ; r2=msb sa");
          INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)), ALU_SUB(FEM, CNST(0), REG_OP(1)), "append r1 (etpid) to the packet ; r1=eid");
          INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)), ALU_NOP, "append r0 (s-vid) to the packet ; ---");
          INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_FAP_ID), ALU_NOP, "extract fap id ; ");
          INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_7_LSBS), ALU_NOP, "extract lag id ; ");
          INSTR(CE_NOP, ALU_SUB(FEM, CNST(0), REG_OP(0)), " ----; R0=fap id");
          INSTR(CE_NOP, ALU_SUB(FEM, CNST(0), REG_OP(1)), " ----; R1=LAG id");
          INSTR(CE_NOP, ALU_ADD(FEM, REG_OP(2), REG_OP(2)), " r2=sa not lag");
          INSTR(CE_NOP, ALU_SET_IF(REG_OP(3), EQ, CNST(0x1), REG_OP(1), REG_OP(0)), "If is lag R0=SA lag");
      }

      INSTR(CE_COPY(GEN, C_OFST(28 + (user_header_size * 2)), C_SIZE(2)),  ALU_NOP, " copy 2B STPID");

      if (SOC_DPP_CONFIG(unit)->pp.mim_bsa_lsb_from_ssp) {
          INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1)), ALU_NOP, "Append LAG/LSB SA to SA[5]");
          INSTR(CE_COPY(GEN, C_OFST(22 + (user_header_size * 2)), C_SIZE(1)),  ALU_NOP, " copy SA[4]");
      }
      else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "sa_addressing_mode", 0)) {
          INSTR(CE_COPY(GEN, C_OFST(24 + (user_header_size * 2)), C_SIZE(2)),  ALU_NOP, " copy ");
      }
      else {
          INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)), ALU_NOP, "Append SA to the packet");
      }
      INSTR(CE_COPY(GEN, C_OFST(20 + (user_header_size * 2)), C_SIZE(8)),  ALU_NOP, " copy ");
      INSTR(CE_COPY(GEN, C_OFST(4 + (user_header_size * 2)), C_SIZE(2)),  ALU_NOP, " copy ");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR(  CE_NOP                                            ,  ALU_SUB(REG_OP(3) , CNST(19) , REG_OP(SZ))   , " ---; SZ=R3-19");
    

      INSTR(CE_NOP                                              , ALU_SET(0, REG_OP(2))                         , "R2=0");
      INSTR( CE_LREAD(GEN, C_OFST(36 + (user_header_size*2))    , LFEM_MASK_BIT_2_3)    , ALU_SET(0x1, REG_OP(1))   , "extract eth type; R1=1");

   
      INSTR(  CE_NOP                                            ,  ALU_NOP                                      , " NOP");

      INSTR(CE_NOP                                              , ALU_SET_IF(FEM, EQ, CNST(0xe0e0), REG_OP(1), REG_OP(2))              , "if eth type == 0xeoeo reg2=1");
   
      INSTR( CE_COPY(GEN, R_OFST(3 ,(user_header_size*2)), R_SIZE(SZ,0)) , ALU_NOP                               , "copy from gen ; ---"); 
      INSTR( CE_COPY(GEN, R_OFST(3 , -16+(user_header_size*2)), R_SIZE(SZ,-8)) , ALU_NOP                               , "copy from gen ; ---"); 
      INSTR( CE_COPY(GEN, R_OFST(3 ,-32+(user_header_size*2)), R_SIZE(SZ,-16)) , ALU_NOP                               , "copy from gen ; ---"); 

      INSTR( CE_READ(GEN, C_OFST(38 + (user_header_size*2)))    , ALU_NOP                                       , "extract ttl value;---");
      INSTR(  CE_NOP                                            ,  ALU_NOP                                      , " NOP");
      INSTR(  CE_NOP                                            ,  ALU_SUB(FEM       , REG_OP(2) , REG_OP(1))   , " ---; r1= TTL-1");
      INSTR(  CE_NOP                                            ,  ALU_NOP                                      , " NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                    , ALU_NOP                               , "append r1 (ttl) to the packet ; ---");
      INSTR( CE_COPY(GEN, C_OFST(34 + (user_header_size*2)), C_SIZE(8)) , ALU_NOP                               , " copy ");
      INSTR( CE_COPY(GEN, C_OFST(18 + (user_header_size*2)), C_SIZE(8)) , ALU_NOP                               , " copy ");
      INSTR( CE_COPY(GEN, C_OFST(2 + (user_header_size*2)), C_SIZE(1))  , ALU_NOP                               , " copy "); 
     
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
  }
  
  
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

      
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))                 , ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                     , "0: Copy GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE) 
                                                                                                                                , "1: FEM=sys_hdr_size,  JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: R1=sys_hdr_size");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "4: Copy GEN");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: FEM=fwd_hdr_offset");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_NOP                                                     , "6: Copy GEN, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: R0 = fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_NOP                                                     , "8: NOP");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0x100, REG_OP(2))                                   , "9: FEM=PKT.check_sum, R2=0x100 (TTL--)");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0, REG_OP(SZ))                                      , "10:FEM=PKT.check_sum, Rsz=0");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(2), REG_OP(1))                          , "11:R1=PKT.check_sum+0x100");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET_IF(FEM,LT,REG_OP(SZ),CNST(0x101),REG_OP(2))         , "12:if PKT.check_sum<0, R2=0x101");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "13:NOP");
      INSTR( CE_NOP                                               , ALU_SET_COMP_SUM(FEM, REG_OP(2), GE, ALU, REG_OP(1))        , "14:if PKT.check_sum+0x101 >=0, R1=PKT.check_sum+0x101(alu_result)");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "16:Copy new check_sum(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "17:Copy GEN IP header, byte 2-byte 9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "18:Copy PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "19:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "20:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_NOP                                                     , "23:Copy GEN");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;

      
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))                 , ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                     , "0: Copy GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                                                , "1: FEM=sys_hdr_size, JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: R1=sys_hdr_size");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "4: Copy GEN");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: FEM=fwd_hdr_offset");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_NOP                                                     , "6: Copy GEN, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: R0 = fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_NOP                                                     , "8: NOP");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0x100, REG_OP(2))                                   , "9: FEM=PKT.check_sum, R2=0x100 (TTL--)");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0, REG_OP(SZ))                                      , "10: FEM=PKT.check_sum, Rsz=0");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(2), REG_OP(1))                          , "11:R1=PKT.check_sum+0x100");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET_IF(FEM,LT,REG_OP(SZ),CNST(0x101),REG_OP(2))         , "12:if PKT.check_sum<0, R2=0x101");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "13:NOP");
      INSTR( CE_NOP                                               , ALU_SET_COMP_SUM(FEM, REG_OP(2), GE, ALU, REG_OP(1))        , "14:if PKT.check_sum+0x101 >=0, R1=PKT.check_sum+0x101(alu_result)");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "16:Copy new check_sum(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "17:Copy GEN IP header, byte 2-byte 9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "18:Copy PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "19:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "20:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_NOP                                                     , "23:Copy GEN");
  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }



  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

      
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))              , ALU_NOP                                , "0: Copy from generated header");
      INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT)
	                                                           , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                        , "1: FEM=DSP_PRESENT * 2; JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_NOP                                            , ALU_NOP                                , "2: NOP");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_ADD(FEM, CNST(ftmh_size+2), REG_OP(0))
                                                                                                        , "3: FEM=system header size; R0 pointed to PPH.FWD_HEADER_OFFSET");
      INSTR( CE_NOP                                            , ALU_NOP                                , "4: NOP");
      INSTR( CE_LREAD(PKT, R_OFST(0, 0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                               , ALU_SUB(FEM, CNST(0), REG_OP(1))       , "5: Extract FWD_HEADER_OFFSET; R1=System header Size ");
      INSTR( CE_LREAD(GEN,  R_OFST(3,-28), LFEM_4_MSB_AND_LSB) , ALU_NOP                                , "6: Copy msb of flow label");
      INSTR( CE_NOP                                            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))     , "7: R0= FWD_HEADER_OFFSET +system header size");
      INSTR( CE_NOP                                            , ALU_ADD(FEM, CNST(0), REG_OP(1))       , "8: R1= flow label");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(6))            , ALU_NOP                                , "9: Copy from generated header");
      INSTR( CE_LREAD(PKT, R_OFST(0,3), LFEM_TOS)              , ALU_NOP                                , "10:extract original tos ; ---");
      INSTR( CE_NOP                                            , ALU_NOP                                , "11:NOP");
      INSTR( CE_NOP                                            , ALU_ADD(FEM, REG_OP(1), REG_OP(1))     , "12:--- ; R1 = flow label+tos");
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)), "13:R3=R3-16");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                , "14:Copy R1");
   
      
      for(i=0; i<3; i++) {
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))        , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)), "Copy from generated header");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))     , ALU_NOP                                , "Copy from generated header");
      }
         
      INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(3, -16))       , ALU_NOP                                , "Copy from generated header");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                   , "0: Copy 8B form GEN, R0=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(0), CNST(0), REG_OP(SZ))                    , "1: FEM=sys_hdr_size, RSZ=R0");
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(0), CNST(20), REG_OP(0))                    , "2: FEM=GEM.tos, R0 -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: FEM=fwd_hdr_offset, R1=sys_hdr_size");
      INSTR( CE_READ(GEN, R_OFST(2,24))                           , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "4: FEM=GEN.check_sum, R1=GEM.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(0,0))            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: Copy from GEN (if necessary), R0=fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(0,-8))           , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                          , "6: Copy from GEN (if necessary), R2=GEN.check_sum+GEM.tos");
      INSTR( CE_LREAD(PKT, R_OFST(0,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: FEM=PKT.tos, R3=R2");
      INSTR( CE_NOP                                              , ALU_NOP                                                     , "8: NOP");
      INSTR( CE_LREAD(GEN, R_OFST(3,24), LFEM_IS_LAG)             , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                            , "9: FEM=MSB(GEN.check_sum), MSB(1); R1 = R2-PKT.tos");
      INSTR( CE_NOP                                              , ALU_NOP                                                     , "10: NOP");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)           , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "11:FEM=MSB(R1), MSB(3); R1 = R1+MSB(1)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)           , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "12:FEM=MSB(R2), MSB(2); R2 = R1");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "13:R1 = R1-MSB(3)");
      INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "14:(MSB(2)==1)? R1=R2");

      INSTR( CE_LREAD(GEN, R_OFST(SZ,8), LFEM_MPLS_EXP_TTL)       , ALU_SUB(REG_OP(3),REG_OP(SZ),REG_OP(SZ))                    , "15:NOP");
      INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:(R1 == 0xFFFF)? R1=0 (rsz)");

      INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12), ALU_ADD(FEM, CNST(0), REG_OP(2))                           , "17:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy R1");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_ADD(FEM, REG_OP(2), REG_OP(2))                          , "19:Copy gen IP header, byte2-byte9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_SUB(REG_OP(3),REG_OP(SZ),REG_OP(1))                    , "20:Copy PKT.tos");
      
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(3), REG_OP(SZ), REG_OP(3))                     , "21:Cooy GEN");
      INSTR( CE_COPY(GEN, R_OFST(1,16), C_SIZE(8))               , ALU_NOP                                                     , "22:Copy GEN");
      
      INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))              , ALU_NOP                                                     , "21:Copy ExtLabel 16LSB");
      INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))       , ALU_NOP                                                     , "22:Copy ExtLabel 16MSB");
      
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");     

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;  
      ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_JER_OAMTS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                    , "0: Copy 8B form GEN, R0=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(0), CNST(0), REG_OP(SZ))                     , "1: FEM=sys_hdr_size, RSZ=R0");
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(0), CNST(20), REG_OP(0))                     , "2: FEM=GEM.tos, R0 -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), 
                                                                  ALU_SUB(FEM, CNST(0), REG_OP(1))                              , "3: FEM=fwd_hdr_offset, R1=sys_hdr_size");
      INSTR( CE_READ(GEN, R_OFST(2,24))                           , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "4: FEM=GEN.check_sum, R1=GEM.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(0,0))            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                           , "5: Copy from GEN (if necessary), R0=fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(0,-8))           , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                           , "6: Copy from GEN (if necessary), R2=GEN.check_sum+GEM.tos");
      INSTR( CE_LREAD(PKT, R_OFST(0,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: FEM=PKT.tos, R3=R2");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "8: NOP");
      INSTR( CE_LREAD(GEN, R_OFST(3,24), LFEM_IS_LAG)             , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                            , "9: FEM=MSB(GEN.check_sum), MSB(1); R1 = R2-PKT.tos");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "10:rsz=0");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)           , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "11:FEM=MSB(R1), MSB(3); R1 = R1+MSB(1)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)           , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "12:FEM=MSB(R2), MSB(2); R2 = R1");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "13:R1 = R1-MSB(3)");
      INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "14:(MSB(2)==1)? R1=R2");

      INSTR( CE_LREAD(GEN, R_OFST(SZ,8), LFEM_MPLS_EXP_TTL)       , ALU_SUB(REG_OP(3),REG_OP(SZ),REG_OP(SZ))                    , "15:Get outer most label's TTL and EXP,RSZ=R3-RSZ");
      INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:(R1 == 0xFFFF)? R1=0 (rsz)");
      INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12), ALU_ADD(FEM, CNST(0), REG_OP(2))                           , "17:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy R1");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_ADD(FEM, REG_OP(2), REG_OP(2))                          , "19:Copy gen IP header, byte2-byte9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_SUB(REG_OP(3),REG_OP(SZ),REG_OP(1))                     , "20:Copy PKT.tos");
      
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(3), REG_OP(SZ), REG_OP(3))                   , "21:Cooy GEN");
      INSTR( CE_COPY(GEN, R_OFST(1,16), C_SIZE(8))                , ALU_NOP                                                     , "22:Copy GEN");
      
      INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))              , ALU_NOP                                                     , "21:Copy ExtLabel 16LSB");
      INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))       , ALU_NOP                                                     , "22:Copy ExtLabel 16MSB");
      
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }  

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_EXT_LABEL_IPV6_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SET(ftmh_size+2, REG_OP(0))              , "0: Copy generated header; R0=&PPH.fwd_header_offset"     );
      INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2)             , ALU_SUB(REG_OP(0), CNST(0), REG_OP(1))       , "1: FEM=OAM_TS_PRESENT; R2=R0" );
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))    , "2: ---; Rsz = R3-R2"                                     );
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
      INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT), ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(ftmh_size+2), REG_OP(0))
                                                                                                              , "3: FEM=DSP_PRESENT * 2; if OAM_TS_PRESENT != 0 (Rsz), R0 += 6");
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(SZ), CNST(2+16), REG_OP(SZ))  , "4: ---; Rsz -= 18 (2Bytes DSCP + 2 CE copy)"             );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-10))       , ALU_ADD(FEM ,REG_OP(0),REG_OP(0))            , "5: Copy generated header; R0 += DSP_PRESENT * 2"         );
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3), CNST(32), REG_OP(3))      , "6: Extract sys hdr size; R3 -= 32"                       );
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "7: Copy generated header; Rsz -= 16"                     );
      INSTR( CE_LREAD(PKT, R_OFST(0,0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                               , ALU_SUB(FEM, CNST(0), REG_OP(0))             , "8: copy fwd header offset; store sys header size (fem) in R1 " );
      INSTR( CE_COPY(GEN, R_OFST(3,16), R_SIZE(SZ,8))          , ALU_NOP                                      , "9: Copy generated header; ---"                           );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))           , ALU_ADD(FEM, REG_OP(0), REG_OP(0))           , "10: Copy generated header; R0 = fwd header offset(FEM) + system hdr size(R1)" );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "11: Copy generated header; Rsz -= 16"                    );
      INSTR( CE_LREAD(PKT, R_OFST(0, 4), LFEM_8_CENTRAL_BITS)  , ALU_NOP                                      , "12: Extract old TOS; ---"                                );
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "13: Copy generated header; Rsz -= 16"                    );
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_PERIPHERAL_BITS), ALU_SUB(FEM ,CNST(0),REG_OP(0))              , "14: Extract new TOS; R1 = old TOS (FEM)"                 );
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,8))         , ALU_NOP                                      , "15: Copy generated header; ---"                          );
      INSTR( CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))         , ALU_ADD(FEM ,REG_OP(0),REG_OP(0))            , "16: Copy generated header; R1 = { Version, old TOS, Flow Label[19:16]");

      INSTR( CE_LREAD(GEN, R_OFST(1,8), LFEM_MPLS_EXP_TTL)     , ALU_SUB(REG_OP(2), REG_OP(1), REG_OP(3))     , "17:NOP");
      INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))        , ALU_NOP                                      , "18: Copy generated header; ---"                          );
      INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12), ALU_ADD(FEM, CNST(0), REG_OP(0))          , "19:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))           , ALU_NOP                                      , "20: Copy R1 (new TOS); ---"                              );
      
      INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,-8))          , ALU_ADD(FEM, REG_OP(0), REG_OP(0))            , "21: ---; ---"                                            );            
      INSTR( CE_COPY(GEN, R_OFST(1,16), C_SIZE(8))             , ALU_SUB(REG_OP(2), REG_OP(3), REG_OP(2))     , "22:Cooy GEN");
      
      INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))           , ALU_NOP                                      , "23:Copy ExtLabel 16LSB");
      INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))    , ALU_NOP                                      , "24:Copy ExtLabel 16MSB");
  
      INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "25:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "26:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_NOP                                      , "27:Copy GEN");
      
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;  

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
        
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                   , "0: Copy 8B form GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                                                , "1: FEM=sys_hdr_size, JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: FEM=GEN.tos, Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: FEM=fwd_hdr_offset, R1=sys_hdr_size");
      INSTR( CE_READ(GEN, R_OFST(2,24))                           , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "4: FEM=GEN.check_sum, R1=GEM.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: Copy from GEN (if necessary), R0=fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                          , "6: Copy from GEN (if necessary), R2=GEN.check_sum+GEM.tos");
      INSTR( CE_LREAD(PKT, R_OFST(0,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: FEM=PKT.tos, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_NOP                                                     , "8: Copy from GEN (if necessary)");
      INSTR( CE_LREAD(GEN, R_OFST(3,24), LFEM_IS_LAG)             , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                            , "9: FEM=MSB(GEN.check_sum), MSB(1); R1 = R2-PKT.tos");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "10:NOP");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)           , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "11:FEM=MSB(R1), MSB(3); R1 = R1+MSB(1)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)           , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "12:FEM=MSB(R2), MSB(2); R2 = R1");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "13:R1 = R1-MSB(3)");
      INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "14:(MSB(2)==1)? R1=R2");
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
        INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)    , ALU_SET(2, REG_OP(2))                                       , "15: If vlan-COE enable");
        INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:(R1 == 0xFFFF)? R1=0");
        INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))            , "17:R0 = COE tag size");
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_SUB(REG_OP(3), CNST(12), REG_OP(SZ))                    , "18:Copy R1, RSZ = copy length except DA+SA");
        INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy gen IP header, byte2-byte9");
        INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");

        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))              , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "21:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))           , ALU_NOP                                                     , "22:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))            , ALU_NOP                                                     , "23:Cooy GEN");

        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))    , ALU_NOP                                                     , "24:Copy COE-tag if need");
        INSTR( CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(2, 0))    , ALU_NOP                                                     , "25:Copy COE-tag if need");
        INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                  , ALU_NOP                                                     , "26:Copy SA");
        INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                  , ALU_NOP                                                     , "27:Copy DA");
      } else if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
        INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)    , ALU_NOP                                                     , "15:NOP");
        INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:if (R1 == 0xFFFF) R1=0");
        INSTR( CE_NOP                                               , ALU_ADD(FEM, CNST(0), REG_OP(SZ))                           , "17:NOP");
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy R1");
        INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy gen IP header, byte2-byte9");
        INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "23:Cooy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "24:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
        INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0))   , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");        
      } else {
        INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
        INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:if (R1 == 0xFFFF) R1=0");
        INSTR( CE_NOP                                               , ALU_NOP                                                     , "17:NOP");
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy R1");
        INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy gen IP header, byte2-byte9");
        INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "23:Cooy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "24:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");
      }

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;  
      ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;  
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                   , "0: Copy 8B form GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                                                , "1: FEM=sys_hdr_size, JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: FEM=GEN.tos, Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: FEM=fwd_hdr_offset, R1=sys_hdr_size");
      INSTR( CE_READ(GEN, R_OFST(2,24))                           , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "4: FEM=GEN.check_sum, R1=GEM.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: Copy from GEN (if necessary), R0=fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                          , "6: Copy from GEN (if necessary), R2=GEN.check_sum+GEM.tos");
      INSTR( CE_LREAD(PKT, R_OFST(0,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: FEM=PKT.tos, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_NOP                                                     , "8: Copy from GEN (if necessary)");
      INSTR( CE_LREAD(GEN, R_OFST(3,24), LFEM_IS_LAG)             , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                            , "9: FEM=MSB(GEN.check_sum), MSB(1); R1 = R2-PKT.tos");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "10:NOP");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)           , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "11:FEM=MSB(R1), MSB(3); R1 = R1+MSB(1)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)           , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "12:FEM=MSB(R2), MSB(2); R2 = R1");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "13:R1 = R1-MSB(3)");
      INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "14:(MSB(2)==1)? R1=R2");        
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
          INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)    , ALU_SET(2, REG_OP(2))                                       , "15:NOP");
          INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:if (R1 == 0xFFFF) R1=0");
          INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))            , "17:NOP");
          INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_SUB(REG_OP(3), CNST(12), REG_OP(SZ))                    , "18:Copy new check_sum(R1)");
          INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy GEN IP header, byte 2-byte 9");
          INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
          
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))              , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "21:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))           , ALU_NOP                                                     , "22:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))            , ALU_NOP                                                     , "23:Cooy GEN");
          
          INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))    , ALU_NOP                                                     , "24:Copy COE-tag if need");
          INSTR( CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(2, 0))    , ALU_NOP                                                     , "25:Copy COE-tag if need");
          INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                  , ALU_NOP                                                     , "26:Copy SA");
          INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                  , ALU_NOP                                                     , "27:Copy DA");
      } else if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
          INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)    , ALU_NOP                                                     , "15:NOP");
          INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:if (R1 == 0xFFFF) R1=0");
          INSTR( CE_NOP                                               , ALU_ADD( FEM, CNST(0), REG_OP(SZ))                          , "17:NOP");
          INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy new check_sum(R1)");
          INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy GEN IP header, byte 2-byte 9");
          INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "23:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "24:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
          INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0))   , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");          
      } else {
          INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
          INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:if (R1 == 0xFFFF) R1=0");
          INSTR( CE_NOP                                               , ALU_NOP                                                     , "17:NOP");
          INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy new check_sum(R1)");
          INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy GEN IP header, byte 2-byte 9");
          INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "23:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "24:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");
      }

  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }  

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SET(ftmh_size+2, REG_OP(0))              , "0: Copy generated header; R0=&PPH.fwd_header_offset"     );
      INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2)             , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                              , "1: FEM=OAM_TS_PRESENT; JUMP if R0=0 (fall-back-to-bridging)" );
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))    , "2: ---; Rsz = R3-R2"                                     );
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
      INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT), ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(ftmh_size+2), REG_OP(0))
                                                                                                              , "3: FEM=DSP_PRESENT * 2; if OAM_TS_PRESENT != 0 (Rsz), R0 += 6");
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(SZ), CNST(2+16), REG_OP(SZ))  , "4: ---; Rsz -= 18 (2Bytes DSCP + 2 CE copy)"             );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-10))       , ALU_ADD(FEM ,REG_OP(0),REG_OP(0))            , "5: Copy generated header; R0 += DSP_PRESENT * 2"         );
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3), CNST(32), REG_OP(3))      , "6: Extract sys hdr size; R3 -= 32"                       );
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "7: Copy generated header; Rsz -= 16"                     );
      INSTR( CE_LREAD(PKT, R_OFST(0,0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                               , ALU_SUB(FEM, CNST(0), REG_OP(1))             , "8: copy fwd header offset; store sys header size (fem) in R1 " );
      INSTR( CE_COPY(GEN, R_OFST(3,16), R_SIZE(SZ,8))          , ALU_NOP                                      , "9: Copy generated header; ---"                           );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))           , ALU_ADD(FEM, REG_OP(1), REG_OP(0))           , "10: Copy generated header; R0 = fwd header offset(FEM) + system hdr size(R1)" );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "11: Copy generated header; Rsz -= 16"                    );
      INSTR( CE_LREAD(PKT, R_OFST(0, 4), LFEM_8_CENTRAL_BITS)  , ALU_NOP                                      , "12: Extract old TOS; ---"                                );
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "13: Copy generated header; Rsz -= 16"                    );
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_PERIPHERAL_BITS), ALU_SUB(FEM ,CNST(0),REG_OP(1))              , "14: Extract new TOS; R1 = old TOS (FEM)"                 );
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,8))         , ALU_NOP                                      , "15: Copy generated header; ---"                          );
      INSTR( CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))         , ALU_ADD(FEM ,REG_OP(1),REG_OP(1))            , "16: Copy generated header; R1 = { Version, old TOS, Flow Label[19:16]");
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
        INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) , ALU_SET(2, REG_OP(0))                        , "17: ---; ---"                                            );
        INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))        , ALU_SUB(REG_OP(2), CNST(12), REG_OP(SZ))     , "18: Copy generated header; ---"                          );
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), "19: Copy R1 (new TOS); ---"                              );

        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))           ,ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "20: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8))        , ALU_NOP                                      , "21: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-32), R_SIZE(SZ,0))         , ALU_NOP                                      , "22: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-48), R_SIZE(SZ,-8))        , ALU_NOP                                      , "23: Copy remaining generated header"                     );

        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0))    , ALU_NOP                                                     , "24:Copy COE-tag if need");
        INSTR( CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0))    , ALU_NOP                                                     , "25:Copy COE-tag if need");
        INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                  , ALU_NOP                                                     , "26:Copy SA");
        INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                  , ALU_NOP                                                     , "27:Copy DA");
      } else if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
        INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))        , ALU_NOP                                      , "17: Copy generated header; ---"                          );
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                      , "18: Copy R1 (new TOS); ---"                              );
        INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0) , ALU_NOP                                      , "19: ---; ---"                                            );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "20: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_ADD(FEM, CNST(0), REG_OP(SZ))            , "21: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "22: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "23: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "24: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "25: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "26: Copy remaining generated header"                     );
        INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0)) , ALU_NOP                                      , "27: Copy remaining generated header"                     );      
      } else {
        INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))        , ALU_NOP                                      , "17: Copy generated header; ---"                          );
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                      , "18: Copy R1 (new TOS); ---"                              );
        INSTR( CE_NOP                                            , ALU_NOP                                      , "19: ---; ---"                                            );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "20: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "21: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "22: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "23: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "24: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "25: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))      , "26: Copy remaining generated header"                     );
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                      , "27: Copy remaining generated header"                     );
      }
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
  }

  if ((SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp) {
      
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_PRESERVING_DSCP_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      
      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_PRESERVING_DSCP_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ) , ALU_SUB(REG_OP(3) , CNST(24)  , REG_OP(3)) , "Copy GEN; R3 -= 24");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(3,-16)) , ALU_NOP                                    , "Copy GEN; ---");

      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
        INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) , ALU_SET(2, REG_OP(0))              , "Copy R3 bytes from R3 offset; R3 -= 16");
        INSTR( CE_NOP                                    , ALU_SUB(REG_OP(3) , CNST(12)  , REG_OP(SZ)) , "Copy R3 bytes from R3 offset; R3 -= 16");
        INSTR( CE_NOP                                    , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)) , "Copy R3-8 bytes from R3-16nibbles offset; ---");

        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0) ) , ALU_SUB(REG_OP(3) , CNST(16)  , REG_OP(3)) , "Copy R3 bytes from R3 offset; R3 -= 16");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ) , CNST(16)  , REG_OP(SZ)), "Copy R3-8 bytes from R3-16nibbles offset; ---");

        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16)), ALU_SUB(REG_OP(3) , CNST(16)  , REG_OP(3)) , "Copy R3 bytes from R3 offset; R3 -= 16");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ) , CNST(16)  , REG_OP(SZ)), "Copy R3-8 bytes from R3-16nibbles offset; ---");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16)), ALU_SUB(REG_OP(3) , CNST(16)  , REG_OP(3)) , "Copy R3 bytes from R3 offset; R3 -= 16");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)) , ALU_NOP                                    , "Copy R3-8 bytes from R3-16nibbles offset; ---");

        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0))    , ALU_NOP                                                     , "24:Copy COE-tag if need");
        INSTR( CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0))    , ALU_NOP                                                     , "25:Copy COE-tag if need");
        INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                  , ALU_NOP                                                     , "26:Copy SA");
        INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                  , ALU_NOP                                                     , "27:Copy DA");
      } else {
          
          for(i=0; i<7; i++)
          {
              INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(3,0) ) , ALU_SUB(REG_OP(3) , CNST(16)  , REG_OP(3)) , "Copy R3 bytes from R3 offset; R3 -= 16");
              INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8)) , ALU_NOP                                    , "Copy R3-8 bytes from R3-16nibbles offset; ---");
          }
      }
      
      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);      
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;  

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

      
      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))          , ALU_ADD(REG_OP(0), CNST(20+8+8+12+2+2), REG_OP(SZ))       , "0: Copy GEN 0, Rsz points to DSCP when fwd header is untagged");
      INSTR( CE_READ(GEN, R_OFST(0,((20+8+8+12+2+8)<<1))), ALU_ADD(REG_OP(0), CNST(20+8+8+12+2+8+2), REG_OP(1))   , "1: Read Ethertype when fwd header is double tagged, R1 points to DSCP for double tagged pkt");
      INSTR( CE_LREAD(GEN, R_OFST(0,4), LFEM_8_LSBS)       , ALU_ADD(REG_OP(0), CNST(20+8+8+12+2+4+2), REG_OP(2))      , "2: Read DSCP from tunnel header, R2 points to DSCP for single tagged pkt");
      INSTR( CE_READ(GEN, R_OFST(0,((20+8+8+12+2+4)<<1))), ALU_SET_IF(FEM, EQ, CNST(0x800), REG_OP(1), REG_OP(SZ)), "3: Read Ethertype when fwd header is single tagged, Rsz = R1 if double tagged");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(8))        , ALU_SUB(FEM, CNST(0), REG_OP(1))                          , "4: Copy GEN 1, R1 = tunnel IPv4.DSCP");
      INSTR( CE_READ(GEN, R_OFST(0,24))                    , ALU_SET_IF(FEM, EQ, CNST(0x800), REG_OP(2), REG_OP(SZ))   , "5: Read tunnel IPv4.checksum, Rsz = R2 if single tagged");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), C_SIZE(8))        , ALU_NOP                                                   , "6: Copy GEN 2");
      INSTR( CE_LREAD(GEN, R_OFST(SZ,0), LFEM_8_LSBS)      , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                        , "7: Read fwd IPv4.DSCP, R2=old_checksum + old_dscp");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), C_SIZE(8))        , ALU_NOP                                                   , "8: Copy GEN 3");
      INSTR( CE_LREAD(GEN, R_OFST(0,24), LFEM_IS_LAG)      , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                          , "9: Read MSB(checksum), R1=R2-new_dscp");
      INSTR( CE_COPY(GEN, R_OFST(3,-64), C_SIZE(8))        , ALU_SUB(REG_OP(3),CNST(68),REG_OP(3))                     , "10:Copy GEN 4, R3-=68(7*8+12, 7 copies + IP length up to checksum)");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)    , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                         , "11:Read MSB(R1), R1=R1+MSB(checksum)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)    , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                    , "12:Read MSB(R2), R2=R1");
      INSTR( CE_COPY(GEN, R_OFST(3,56), C_SIZE(8))         , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                          , "13:Copy GEN 5, R1=R1-MSB(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,40), C_SIZE(8))         , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))      , "14:Copy GEN 6, if MSB(R2)==1 R1=R2");
      INSTR( CE_LREAD(GEN, R_OFST(SZ,0), LFEM_8_LSBS)      , ALU_SUB(REG_OP(3),REG_OP(0),REG_OP(SZ))                   , "15:Read fwd IPv4.DSCP, Rsz=R3-R0");
      INSTR( CE_NOP                                        , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))       , "16:if R1==0xFFFF R1=0");
      INSTR( CE_COPY(GEN, R_OFST(3,24), R_SIZE(SZ, 0))     , ALU_SUB(FEM,CNST(0),REG_OP(2))                            , "17:Copy GEN 7, R2=fwd IPv4.DSCP");
      INSTR( CE_COPY(GEN, R_OFST(3,8), R_SIZE(SZ, -8))     , ALU_NOP                                                   , "18:Copy GEN 8");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))       , ALU_NOP                                                   , "19:Copy new checksum");
      INSTR( CE_COPY(GEN, R_OFST(0, 20), C_SIZE(8))        , ALU_NOP                                                   , "20:Copy tunnel IPv4, byte 2 ~ byte 9");
      INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))       , ALU_NOP                                                   , "21:Copy fwd IPv4.DSCP");
      INSTR( CE_COPY(GEN, R_OFST(0,2), R_SIZE(0,1))        , ALU_SUB(REG_OP(0), CNST(15), REG_OP(0))                   , "22:Copy tunnel IPv4.ver/IHL/LL");
      INSTR( CE_COPY(GEN, R_OFST(0,-14), R_SIZE(0,-7))     , ALU_NOP                                                   , "23:Copy tunnel LL");
      INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))        , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "24:Copy tunnel LL");
      INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))     , ALU_NOP                                                   , "25:Copy tunnel LL");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;  

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN_ROO_COPY_DSCP_IPV6);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

      
      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))          , ALU_ADD(REG_OP(0), CNST(20+8+8+12+2+2), REG_OP(SZ))       , "0: Copy GEN 0, Rsz points to DSCP when fwd header is untagged");
      INSTR( CE_READ(GEN, R_OFST(0,((20+8+8+12+2+8)<<1))), ALU_ADD(REG_OP(0), CNST(20+8+8+12+2+8+2), REG_OP(1))   , "1: Read Ethertype when fwd header is double tagged, R1 points to DSCP for double tagged pkt");
      INSTR( CE_LREAD(GEN, R_OFST(0,4), LFEM_8_LSBS)       , ALU_ADD(REG_OP(0), CNST(20+8+8+12+2+4+2), REG_OP(2))      , "2: Read DSCP from tunnel header, R2 points to DSCP for single tagged pkt");
      INSTR( CE_READ(GEN, R_OFST(0,((20+8+8+12+2+4)<<1))), ALU_SET_IF(FEM, EQ, CNST(0x86DD), REG_OP(1), REG_OP(SZ)), "3: Read Ethertype when fwd header is single tagged, Rsz = R1 if double tagged");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(8))        , ALU_SUB(FEM, CNST(0), REG_OP(1))                          , "4: Copy GEN 1, R1 = tunnel IPv4.DSCP");
      INSTR( CE_READ(GEN, R_OFST(0,24))                    , ALU_SET_IF(FEM, EQ, CNST(0x86DD), REG_OP(2), REG_OP(SZ))   , "5: Read tunnel IPv4.checksum, Rsz = R2 if single tagged");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), C_SIZE(8))        , ALU_NOP                                                   , "6: Copy GEN 2");
      INSTR( CE_LREAD(GEN, R_OFST(SZ,-1), LFEM_8_LSBS)     , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                        , "7: Read fwd IPv6.DSCP, R2=old_checksum + old_dscp");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), C_SIZE(8))        , ALU_NOP                                                   , "8: Copy GEN 3");
      INSTR( CE_LREAD(GEN, R_OFST(0,24), LFEM_IS_LAG)      , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                          , "9: Read MSB(checksum), R1=R2-new_dscp");
      if ((SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LARGE)) {
          INSTR( CE_COPY(GEN, R_OFST(3,-64), C_SIZE(8))    , ALU_SUB(REG_OP(3),CNST(52),REG_OP(3))                     , "10:Copy GEN 4, R3-=52(5*8+12, 5 copies + IP length up to checksum)");
      }
      else {
          INSTR( CE_COPY(GEN, R_OFST(3,-64), C_SIZE(8))    , ALU_SUB(REG_OP(3),CNST(60),REG_OP(3))                     , "10:Copy GEN 4, R3-=60(6*8+12, 6 copies + IP length up to checksum)");
      }
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)    , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                         , "11:Read MSB(R1), R1=R1+MSB(checksum)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)    , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                    , "12:Read MSB(R2), R2=R1");
      if ((SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LARGE)) {
          INSTR( CE_NOP                                    , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                          , "13:R1=R1-MSB(R1)");
      }
      else {
          INSTR( CE_COPY(GEN, R_OFST(3,40), C_SIZE(8))     , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                          , "13:Copy GEN 5, R1=R1-MSB(R1)");
      }
      INSTR( CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))      , "14:if MSB(R2)==1 R1=R2");
      INSTR( CE_LREAD(GEN, R_OFST(SZ,-1), LFEM_8_LSBS)     , ALU_SUB(REG_OP(3),REG_OP(0),REG_OP(SZ))                   , "15:Read fwd IPv6.DSCP, Rsz=R3-R0");
      INSTR( CE_NOP                                        , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))       , "16:if R1==0xFFFF R1=0");
      INSTR( CE_COPY(GEN, R_OFST(3,24), R_SIZE(SZ, 0))     , ALU_SUB(FEM,CNST(0),REG_OP(2))                            , "17:Copy GEN 6, R2=fwd IPv4.DSCP");
      INSTR( CE_COPY(GEN, R_OFST(3,8), R_SIZE(SZ, -8))     , ALU_NOP                                                   , "18:Copy GEN 7");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))       , ALU_NOP                                                   , "19:Copy new checksum");
      INSTR( CE_COPY(GEN, R_OFST(0, 20), C_SIZE(8))        , ALU_NOP                                                   , "20:Copy tunnel IPv4, byte 2 ~ byte 9");
      INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))       , ALU_NOP                                                   , "21:Copy fwd IPv4.DSCP");
      INSTR( CE_COPY(GEN, R_OFST(0,2), R_SIZE(0,1))        , ALU_SUB(REG_OP(0), CNST(15), REG_OP(0))                   , "22:Copy tunnel IPv4.ver/IHL/LL");
      INSTR( CE_COPY(GEN, R_OFST(0,-14), R_SIZE(0,-7))     , ALU_NOP                                                   , "23:Copy tunnel LL");
      INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))        , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "24:Copy tunnel LL");
      INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))     , ALU_NOP                                                   , "25:Copy tunnel LL");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      
      ARAD_SOC_REG_FIELD	dummy1, dummy2;
	  SOC_PPC_TRAP_CODE_INTERNAL	internal_trap_code=0;					                                                              
      res = arad_pp_trap_mgmt_trap_code_to_internal(unit, SOC_PPC_TRAP_CODE_BFD_ECHO, &internal_trap_code, &dummy1, &dummy2);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 9999, exit); 

      
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET) , ALU_SET(internal_trap_code, REG_OP(SZ))      , "Extract FWD_HEADER_OFFSET. sz=(trap code)");
      INSTR( CE_LREAD(PKT, R_OFST(3,0), LFEM_8_LSBS)     , ALU_NOP                                                                    , "Extract trap code");
      INSTR( CE_NOP                                      , ALU_ADD(FEM, REG_OP(3), REG_OP(0))                                         , "R0= FWD_HEADER_OFFSET + R3");
      INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET) , ALU_JMP_IF(FEM, NEQ, REG_OP(SZ), BRANCH_UDH_BFD_ECHO, JUMP_POINT_UDH_BFD_ECHO)     , "Extract FWD_HEADER_OFFSET; Check if trap code = bcmRxTrapBfdEchoOverIpv4 if not jump");
      INSTR( CE_NOP                                      , ALU_SET(0xFFFF    , REG_OP(1))                                             , "R1=0xffff (src port)");
      INSTR( CE_NOP                                      , ALU_SUB(FEM, CNST(user_header_size),REG_OP(SZ))                      , "RSZ = R0 - user_header_size (FWD_HEADER_OFFSET without UDH)");
      INSTR( CE_NOP                                      , ALU_NOP                                                                    , "NOP");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , C_SIZE(6))     , ALU_SUB(REG_OP(SZ) , CNST(16)   , REG_OP(SZ))                                , "(no jump) Copy original header until UDP src port; RSZ -= 16");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))     , ALU_SUB(REG_OP(0) , CNST(16)   , REG_OP(0))                                , "Set src port; R0 -= 16");
      INSTR( CE_COPY(PKT, R_OFST(0,-8)  , C_SIZE(4))     , ALU_NOP                                                                    , "Set Sip;");
      INSTR( CE_COPY(PKT, R_OFST(0,16)   , C_SIZE(4))     , ALU_SET(0x00E3    , REG_OP(1))                                             , "Set Dip; R1= trap code = 0xe3");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , R_SIZE(SZ,0))  , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0))                                 , "Copy original header R0 = R0 - 16");
      INSTR( CE_COPY(PKT, R_OFST(0,-16) , R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))                                  , "Copy original header");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , R_SIZE(SZ,-16)) , ALU_NOP                                                                    , "Copy original header");
      INSTR( CE_COPY(PKT, R_OFST(0,-16) , R_SIZE(SZ,0))   , ALU_NOP                                                                    , "Copy original header");

      INSTR( CE_READ(PKT, R_OFST(2,4))                      , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                               , "extract PPH.FwdHdrOffset  ; RSZ = R3 - R2");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))        , ALU_SUB(REG_OP(3), CNST(1), REG_OP(3))                               , "Set trap code = 0xe3 = R1 ; R3 -= 1");
      INSTR( CE_NOP                                         , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0))                   , "---                      ; R0 = PPH.FwdHdrOffset - user_header_size");
      INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ), CNST(3), REG_OP(SZ))                                , "---                      ; RSZ -= 3 - exclude PPH.FwdHdrOffset and FHEI.trap_code");
      
      
      INSTR( CE_NOP                                         , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                                , "---                      ; R3 -= 8");
      INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, 0))       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                               , "PP-Copy from R3 with size RSZ ; RSZ -= 16");
      INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ,-8))       , ALU_NOP                                                                 , "PP-Copy from R3 with size RSZ ; ---");
      INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(SZ,0))      , ALU_NOP                                                                 ,"PP-Copy from R3 with size RSZ ; ---");
      INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))        , ALU_NOP                                                                 , "Copy PPH.FwdHdrOffset    ; ---");

      
      for (i = 0; i < 2; i++) {                                                                                                    
          INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))           , ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2))                  , "Copy with R2          ; R2 -= 16");
          INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))        , ALU_NOP                                                     , "Copy with R2          ; ---");
      }                                                                                                                           

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_UDH_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_UDH_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR(CE_COPY(PKT, R_OFST(0, 0), R_SIZE(SZ, 0))         , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "Copy network header; r0 -= 16");
      INSTR(CE_COPY(PKT, R_OFST(0, -16), R_SIZE(SZ, -8))      , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "Copy network header; RSZ -= 16");
      for (i = 0; i < 3; i++) { 
          INSTR(CE_COPY(PKT, R_OFST(0, 0),  R_SIZE(SZ, -16))        , ALU_SUB(REG_OP(0),  CNST(16), REG_OP(0))                  , "Copy network header; r0 -= 16");
          INSTR(CE_COPY(PKT, R_OFST(0, -16), R_SIZE(SZ, -8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "Copy network header; RSZ -= 16");
      }

      INSTR( CE_READ(PKT, R_OFST(2,4))                        , ALU_NOP                                                   , "extract PPH.FwdHdrOffset  ; ---");
      INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                  , "---                      ; RSZ = R3 - R2");
      INSTR( CE_NOP                                           , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0))     , "---                      ; R0 = PPH.FwdHdrOffset - user_header_size");
      INSTR( CE_NOP                                           , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))                  , "---                      ; RSZ -= 2");
      
      
      INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                  , "---                      ; R3 -= 8");
      INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, 0))         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "PP-Copy from R3 with size RSZ ; RSZ -= 16");
      INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_NOP                                                   , "PP-Copy from R3 with size RSZ ; ---");
      INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_NOP                                                   ,"PP-Copy from R3 with size RSZ ; ---");
      INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))          , ALU_NOP                                                   , "Copy PPH.FwdHdrOffset    ; ---");
      
      
      for (i = 0; i < 2; i++) {                                                                                                    
          INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))           , ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2))                  , "Copy with R2          ; R2 -= 16");
          INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))        , ALU_NOP                                                     , "Copy with R2          ; ---");
      }                                                                                                                           

      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      
      ARAD_SOC_REG_FIELD	dummy1, dummy2;
	  SOC_PPC_TRAP_CODE_INTERNAL	internal_trap_code=0;					                                                              
      res = arad_pp_trap_mgmt_trap_code_to_internal(unit, SOC_PPC_TRAP_CODE_BFD_ECHO, &internal_trap_code, &dummy1, &dummy2);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 9999, exit); 

      
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET) , ALU_SET(internal_trap_code, REG_OP(SZ))      , "Extract FWD_HEADER_OFFSET. sz=(trap code)");
      INSTR( CE_LREAD(PKT, R_OFST(3,0), LFEM_8_LSBS)     , ALU_NOP                                                                  , "Extract trap code");
      INSTR( CE_NOP                                      , ALU_SUB(FEM       , CNST(0)   , REG_OP(0))                               , "R0= FWD_HEADER_OFFSET");
      INSTR( CE_NOP                                      , ALU_JMP_IF(FEM, NEQ, REG_OP(SZ), BRANCH_BFD_ECHO, JUMP_POINT_BFD_ECHO)   , "Check if trap code = bcmRxTrapBfdEchoOverIpv4 if not jump");
      INSTR( CE_NOP                                      , ALU_SET(0xFFFF    , REG_OP(1))                                           , "R1=0xffff (src port)");
      INSTR( CE_NOP                                      , ALU_ADD(REG_OP(3) , REG_OP(0) , REG_OP(0))                               , "R0= FWD_HEADER_OFFSET + R3");
      INSTR( CE_NOP                                      , ALU_NOP                                                                  , "NOP");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , C_SIZE(6))     , ALU_SUB(REG_OP(0) , CNST(8)   , REG_OP(0))                               , "(no jump) Copy original header until UDP src port; R0 = R0 ? 8 (points end of dip)");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))     , ALU_NOP                                                                  , "Set src port");
      INSTR( CE_COPY(PKT, R_OFST(0,-8)  , C_SIZE(4))     , ALU_SUB(REG_OP(0) , CNST(8)   , REG_OP(0))                               , "Set Sip. R0=R0-8B (points start of sip)");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , C_SIZE(4))     , ALU_NOP                                                                  , "Set Dip");
      INSTR( CE_NOP                                      , ALU_SUB(REG_OP(0) , REG_OP(3) , REG_OP(SZ))                              , "SZ= R0-R3");
      INSTR( CE_NOP                                      , ALU_NOP                                                                  , "NOP");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , R_SIZE(SZ,0))  , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0))                               , "Copy original header R0 = R0 - 16");
      INSTR( CE_COPY(PKT, R_OFST(0,-16) , R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16)  , REG_OP(SZ))                              , "Copy generated header SZ = SZ - 16");
      INSTR( CE_NOP                                      , ALU_SET(0x00E3    , REG_OP(1))                                           , "R1= trap code = 0xe3");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , R_SIZE(SZ,0))  , ALU_SUB(REG_OP(0) , REG_OP(SZ), REG_OP(0))                               , "Copy original header R0 = R0 - SZ");
      INSTR( CE_COPY(PKT, R_OFST(0,-16) , R_SIZE(SZ,-8)) , ALU_NOP                                                                  , "Copy generated header SZ = SZ - 16");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))     , ALU_SUB(REG_OP(0) , CNST(1)   , REG_OP(0))                               , "Set trap code = 0xe3 = R1 R0=R0-1");
      INSTR( CE_NOP                                      , ALU_NOP                                                                  , "NOP");
      
	  for(i=0; i<2; i++)
	  {
          INSTR( CE_COPY(PKT, R_OFST(0,0), R_SIZE(0,0))      , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0))                               , "copy from original header");
          INSTR( CE_COPY(PKT, R_OFST(0,-16), R_SIZE(0,-8))   , ALU_NOP                                                                  , "copy from original header");
	  }

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
	  for(i=0; i<7; i++)
	  {
          INSTR( CE_COPY(PKT, R_OFST(0,0)  , R_SIZE(0,0) ) , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0)) , "Copy R0 bytes from R0 offset; r0 -= 16");
          INSTR( CE_COPY(PKT, R_OFST(0,-16), R_SIZE(0,-8)) , ALU_NOP                                    , "Copy R0-8 bytes from R0-16nibbles offset; ---");
	  }

      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      uint32 chan_fix_size = programs_usage[unit].bfd_chan_override * 2;

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)    , ALU_NOP , "FEM=NWK-Size ; ---");
      INSTR( CE_READ(PKT, R_OFST(2,4))                           , ALU_NOP , "extract PPH.FwdHdrOffset ;---");
      INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)    , ALU_ADD( FEM, REG_OP(3), REG_OP(1) ) , "--- ; R1 = R3+FEM[==Sys+Nwk-HeadersSize]");
      
      INSTR( CE_NOP                                                    , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0)) , "---; R0 = PPH.FwdHdrOffset - user_header_size");

      
      fld_val = chan_fix_size+user_header_size;
      INSTR(CE_NOP , ALU_SUB( FEM, CNST(fld_val), REG_OP(SZ) ) , " ; SZ = FEM [Nwk-HeadersSize] - 2(chan_fix_size) - UDH");

      switch(SOC_DPP_CONFIG(unit)->pp.bfd_masked_flags_bitfield){
      case 0x2: 
         {
             INSTR( CE_LCOPY(PKT, R_OFST(1,4), C_SIZE(2), LFEM_ZERO_BIT1),   ALU_SUB(REG_OP(1), CNST(chan_fix_size), REG_OP(1)), "Copy BFD 2MSBytes, with D-Flag cleared ; R1 -= 2 (maybe)");
             break;
         }
      case 0x8: 
         {
             INSTR( CE_LCOPY(PKT, R_OFST(1,4), C_SIZE(2), LFEM_ZERO_BIT3),   ALU_SUB(REG_OP(1), CNST(chan_fix_size), REG_OP(1)), "Copy BFD 2MSBytes, with C-Flag cleared ; R1 -= 2 (maybe)");
             break;
         }
      default:
         {
             INSTR( CE_COPY(PKT, R_OFST(1,4), C_SIZE(2)) ,                   ALU_SUB(REG_OP(1), CNST(chan_fix_size), REG_OP(1)), "Copy BFD 2MSBytes; R1 -= 2 (maybe)");
             break;
         }
      }

      if (programs_usage[unit].bfd_chan_override) {
          INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2)),        ALU_NOP,   "Copy channel from program var ; ---");
      }

      
      INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0) ) ,   ALU_SUB(REG_OP(SZ) , CNST(16)  , REG_OP(SZ)), "Copy 8 bytes from R1 offset; Rsz -= 16  [Rzs =  Nwk-HeadersSize]");
      INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(SZ,-8)) , ALU_NOP, "Copy 8 bytes from R1-16nibbles offset; ---");
      INSTR( CE_COPY(PKT, R_OFST(1,-32), R_SIZE(SZ,0) ) , ALU_SUB(REG_OP(SZ) , CNST(16)  , REG_OP(SZ)), "Copy 8 bytes from R1 offset; Rsz -= 16  [Rzs =  Nwk-HeadersSize]");
      INSTR( CE_COPY(PKT, R_OFST(1,-48), R_SIZE(SZ,-8)) , ALU_NOP, "Copy 8 bytes from R1-16nibbles offset; ---");
      INSTR( CE_COPY(PKT, R_OFST(1,-64), R_SIZE(SZ,0))  , ALU_SUB(REG_OP(SZ) , CNST(16)  , REG_OP(SZ)), "Copy 8 bytes from R1 offset; ---");
      INSTR( CE_COPY(PKT, R_OFST(1,-80), R_SIZE(SZ,-8)) , ALU_NOP, "Copy 8 bytes from R1-16nibbles offset; ---");
      INSTR( CE_COPY(PKT, R_OFST(1,-96), R_SIZE(SZ,0)) ,  ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ)) , "Copy 8 bytes from R1-16nibbles offset; Rsz = R3- R2 = all PPH length");

      
      INSTR( CE_READ(PKT, C_OFST(4)), ALU_NOP, "Get FTMH.Packet-size(2MSB) ;RSZ -2 (2 bytes pph.fwd_offset)");

      
      INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, -2))  ,   ALU_SUB(REG_OP(SZ), CNST(10), REG_OP(SZ)), "PP-Copy from R3 with size RSZ ; RSZ -8 -2 bytes FwdHdrOffset");
      INSTR( CE_NOP                                     , ALU_SUB(FEM, CNST(user_header_size << 2) , REG_OP(1)), "--- ; Packet-size - UDH");
      INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(SZ,0)),   ALU_ADD( REG_OP(2), CNST(0), REG_OP(3)) , "PP-Copy from R3 with size RSZ ; R3 == R2");
      INSTR( CE_COPY(PKT, R_OFST(3,-32), R_SIZE(SZ,-8)) ,    ALU_SUB( REG_OP(2) , CNST(2) , REG_OP(2)) ,"PP-Copy from R3 with size RSZ ; R2 -= 2 (2 B packet size)");
      INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),    ALU_NOP , "Copy PPH.FwdHdrOffset;  --- ");

      
      INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(2,0)) ,       ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2)), "PP-Copy with R2	; R2 -= 16-2 (2 B packet size)");
      INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(2,-8))  ,   ALU_NOP  , "PP-Copy with R2  ; ---");
      INSTR( CE_COPY(PKT, R_OFST(3,-32), R_SIZE(2,0))   ,   ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2)), "PP-Copy with R2; R2 -= 16");
      INSTR( CE_COPY(PKT, R_OFST(3,-48), R_SIZE(2,-8)) ,    ALU_NOP , "PP-Copy with R2  ; ---");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)),       ALU_NOP, "Copy  FTMH.Packet-size; ---");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "l2_encap_pcp_dei_config_enable", 0) == 1)
        {
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(4))                                , ALU_NOP                              	, "Prepend EEDB[31:0]");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(8))                                 , ALU_NOP                               , "Prepend Program Vars[63:0]");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -8, C_SIZE(3))                               , ALU_NOP                               , "Prepend EEDB[55:32]");
            INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(3))                               , ALU_NOP                               , "Prepend Pp-port-vars [23:0]");
        }
        else
        {

            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))                                , ALU_NOP                              	, "Prepend EEDB[15:0]");
            INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4, LFEM_12_LSBS)							, ALU_NOP                			   	, "Extract EEDB[27:16] to FEM[11:0]");
            INSTR( CE_NOP                                                 						, ALU_NOP                               , "NOP");
            INSTR( CE_NOP                            											, ALU_SUB(FEM, CNST(0), REG_OP(0))   	, "FEM -> r0");
            INSTR( CE_LREAD(PKT, C_OFST(5), LFEM_FTMH_TC_AS_MSB)							 	, ALU_NOP                				, "Extract FTMH TC DP to FEM[14:15] FEM[15]=0");
            INSTR( CE_NOP                                                 						, ALU_NOP                               , "NOP");
            INSTR( CE_NOP                            											, ALU_ADD(FEM, REG_OP(0), REG_OP(0))   	, "FEM + r0 -> r0");
            INSTR( CE_NOP                                                 						, ALU_NOP                               , "NOP");
            INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                						, ALU_NOP                               , "write R0 to header");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(8))                                 , ALU_NOP                               , "Prepend Program Vars[63:0]");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -8, C_SIZE(3))                               , ALU_NOP                               , "Prepend EEDB[55:32]");
            INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(3))                               , ALU_NOP                               , "Prepend Pp-port-vars [23:0]");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

  
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_RX, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_RX);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

 INSTR( CE_LREAD(PKT, R_OFST(3,32), LFEM_DW0_TAG)              , ALU_NOP                                                   , "Extract {PCP, CFI, VID} from DSA tag; ALU: NOP");
 INSTR( CE_LREAD(PKT, R_OFST(3,32), LFEM_DW0_TAGGED)           , ALU_SET(1, REG_OP(0))                                     , "Extract Tagged bit from DSA tag; ALU: NOP");
 INSTR( CE_NOP                                                 , ALU_SUB(FEM, CNST(0), REG_OP(1))                           , "R1 = Tag");
 INSTR( CE_NOP                                                 , ALU_JMP_IF(FEM, NEQ, REG_OP(0), BRANCH_DSA_RX_TAGGED, JUMP_POINT_DSA_RX_TAGGED)    , "R2 = Tagged bit");
 INSTR( CE_NOP                                                 , ALU_NOP                                                    , "Waiting for ALU result");
 INSTR( CE_NOP                                                 , ALU_NOP                                                    , "Waiting for ALU result");
 INSTR( CE_NOP                                                 , ALU_NOP                                                    , "Waiting for ALU result");
 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                , ALU_NOP                                                   , "Testing");
 INSTR (CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))           , ALU_NOP                                                    , "Copy TPID");
 INSTR( CE_COPY(PKT, R_OFST(3, 24), C_SIZE(6))                 , ALU_NOP                                                    , "Copy SA and DA from the packet");
 INSTR( CE_COPY(PKT, R_OFST(3, 12), C_SIZE(6))                 , ALU_NOP                                                    , "Copy SA and DA from the packet");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

      
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_DSA_RX_TAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_DSA_RX_TAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

 INSTR( CE_COPY(PKT, R_OFST(3, 24), C_SIZE(6))                 , ALU_NOP                                                    , "Copy SA and DA from the packet");
 INSTR( CE_COPY(PKT, R_OFST(3, 12), C_SIZE(6))                 , ALU_NOP                                                    , "Copy SA and DA from the packet");

      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }


  
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_TX, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_DSA_TX);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

 INSTR( CE_FLREAD(PrgeDataFieldProgVar, 0, LFEM_DSA_TPID)       , ALU_NOP                                                   , "Extract TPID from prge var; ALU: NOP");
 INSTR( CE_LREAD(PKT, R_OFST(3,32), LFEM_DSA_PCP_VID)           , ALU_NOP                                                   , "Extract PCP and VID from packet");
 INSTR( CE_LREAD(PKT, R_OFST(3,28), LFEM_DSA_TPID)              , ALU_SUB(FEM, CNST(0), REG_OP(0))                          , "Extract TPID from packet; R0 = prge var TPID");
 INSTR( CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_DSA_SRC_5)   , ALU_SUB(FEM, CNST(0), REG_OP(1))                          , "Extract Source-System-Port[5]; R1 = {PCP, 1'b0, VID}");
 INSTR( CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_DSA_SRC_4_0) , ALU_JMP_IF(FEM, NEQ, REG_OP(0), BRANCH_DSA_TX_TAGGED, JUMP_POINT_DSA_TX_TAGGED)   , "Extract Source-System-Port[4:0]; Compare TPID, jump if NEQ");
 INSTR( CE_NOP                                                  , ALU_ADD(FEM, CNST(0), REG_OP(2))                          , "R2 = {3'b111, 5'b0, Source-System-Port[4:0], 3'b0");
 INSTR( CE_LREAD(PKT, R_OFST(3,32), LFEM_DSA_CFI)               , ALU_ADD(FEM, CNST(0), REG_OP(0))                          , "R0 = {2'b0, Source-System-Port[5], 12'b0");
 INSTR( CE_NOP                                                  , ALU_NOP                                                   , "SZ = 0");
 INSTR( CE_NOP                                                  , ALU_ADD(FEM, REG_OP(0), REG_OP(0))                        , "R0 = {3'b111, 5'b0, Source-System-Port[4:0], 2'b0, CFI");
 INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(2))            , ALU_NOP                                                   , "Copy 16'b0");
 INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                 , ALU_NOP                                                   , "Copy {2'b0, Source-System-Port[5], 12'b0");
 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                 , ALU_NOP                                                   , "Copy {PCP, 1'b0, VID}");
 INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                 , ALU_NOP                                                   , "Copy {3'b111, 5'b0, Source-System-Port[4:0], 2'b0, CFI");
 INSTR( CE_COPY(PKT, R_OFST(3, 24), C_SIZE(6))                  , ALU_NOP                                                   , "Copy SA and DA from the packet");
 INSTR( CE_COPY(PKT, R_OFST(3, 12), C_SIZE(6))                  , ALU_NOP                                                   , "Copy SA and DA from the packet");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

      
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_DSA_TX_TAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_DSA_TX_TAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

 INSTR( CE_COPY(PKT, R_OFST(3, 32), C_SIZE(4))                 , ALU_NOP                                                    , "Copy SA and DA from the packet");
 INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(2))            , ALU_NOP                                                   , "Copy 16'b0");
 INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                 , ALU_NOP                                                   , "Copy {2'b0, Source-System-Port[5], 12'b0");
 INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(2))            , ALU_NOP                                                   , "Copy {PCP, 1'b0, VID}");
 INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                 , ALU_NOP                                                   , "Copy {3'b111, 5'b0, Source-System-Port[4:0], 2'b0, CFI");
 INSTR( CE_COPY(PKT, R_OFST(3, 24), C_SIZE(6))                  , ALU_NOP                                                   , "Copy SA and DA from the packet");
 INSTR( CE_COPY(PKT, R_OFST(3, 12), C_SIZE(6))                  , ALU_NOP                                                   , "Copy SA and DA from the packet");

      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_ITMH_COPY_HEADER_WITH_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
      if (customer_ftmh_dsp_extension_add) {
          ftmh_size += 2;
      }
      if (customer_ftmh_lb_extension_add) {
          ftmh_size += 1;
      }
      fld_val = ftmh_size + user_header_size;
      INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),   C_SIZE(user_header_size))    ,ALU_NOP ,"[Inst-0]: Copy UDH");
  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);  
  }


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      mem   = EPNI_PRGE_INSTRUCTION_0m-1;
      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
          ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
      entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
      entry = entry_odd;

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      
      
      
      
      
      
      
      
      
      prge_instruction_tbl_data.src_select  = 2;    
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
      prge_instruction_tbl_data.offset_base = 33;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
      prge_instruction_tbl_data.size_base   = 0; 
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
              mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
      prge_instruction_tbl_data.op_1_field_select     = 0;
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = 0;
      prge_instruction_tbl_data.cmp_action  = 0;  
      prge_instruction_tbl_data.dst_select  = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;    
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD; 
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;  
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0; 
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          
      for( ++mem ; mem < EPNI_PRGE_INSTRUCTION_0m + 11; mem++)
      {
          
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; 
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST; 
          prge_instruction_tbl_data.size_base   = 0; 
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3; 
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;  
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          entry = (entry == entry_even) ? entry_odd : entry_even;
          
         
          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.offset_base = 0xF0; 
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;   
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0; 
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }

      
      entry = (entry == entry_even) ? entry_odd : entry_even;

      
      prge_instruction_tbl_data.src_select  = 0;
      
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
      prge_instruction_tbl_data.offset_base = 0x0 + user_header_size*2 ; 
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 0 + user_header_size;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = 0; 
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = 0;
      prge_instruction_tbl_data.cmp_action  = 0;
      prge_instruction_tbl_data.dst_select  = 0;      
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

  } 

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if ((SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) && (prog_used != -1)) {
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) { 
          sal_printf("Instruction ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER with COE type 2");
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 395, exit);
          
          res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS),  ALU_SET(2, REG_OP(0)),                          "0: For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
          INSTR(CE_NOP,                                             ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ)),      "1: RSZ=R3-12");
          INSTR(CE_NOP,                                             ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), "2:  R0 will be 2 if we are pushing coe tag, 0 otherwise");
          
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "coe_tag_mapping_mode", 0)) {
              INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC), ALU_NOP,                                  "3: ");
          } else {
              INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC_DP), ALU_NOP,                                  "3: ");
          }
          INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_1),   ALU_NOP,                                        "4: extract TC/DP set indication");
          INSTR(CE_NOP,                                             ALU_ADD(FEM, CNST(0), REG_OP(1)),               "5: ");
          INSTR(CE_FLREAD(PrgeDataFieldPpPortVar, 0, LFEM_12_LSBS), ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)), "6: ");
          INSTR(CE_NOP,                                             ALU_NOP,                                        "7: ");
          INSTR(CE_NOP,                                             ALU_ADD(FEM, REG_OP(1), REG_OP(1)),             "8: Calc the COE_TAG.16LSB");
          
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)),         ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),       "9: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");          
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),       ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),      "10: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),       ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),       "11: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),       ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),      "12: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),       ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),       "13: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),       ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),      "14: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),       ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),       "15: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),       ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),      "16: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),       ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),       "17: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");

          
          INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(0, 0)),         ALU_NOP,                                        "18: Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
          INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(0, 0)),    ALU_NOP,                                        "19: Copy Program-Variable(2bytes) only if R0 == 2 ");

          
          INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)),    ALU_NOP,                                        "20:");
          INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP,                "21: ");
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)),    ALU_NOP,                                        "22: ");

          
          INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)),                ALU_NOP,                                        "23: "); 

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 393, exit);
      } else { 

          sal_printf("Instruction ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER with MyMac no COE "); 
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

           INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ)), "0; ALU: RSZ=R3-12, calc Generated Header size - (Native Eth DA:SA size)");
           INSTR(CE_NOP, ALU_NOP, "1: NOP");
           INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
           INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
           INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
           INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
           INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
           INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
           INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
           INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
           INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
           INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");

          
          INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
          INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");

          
           INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))								  , ALU_NOP, "18: Copy DA from Generated Header highst 6 Bytes");

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }
  }

  res = arad_egr_prog_editor_sbfd_reflector(unit, user_header_size);
  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  res = arad_egr_prog_editor_add_ch_header(unit, ftmh_size, customer_conn_to_np_debug);
  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  res = arad_egr_prog_editor_copy_dscp_mixed_qos_model(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  res = arad_egr_prog_editor_mixed_qos_model(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


  
  if ((SOC_DPP_CONFIG(unit)->pp.mim_vsi_mode) == 0) {
  
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);

          if ((SOC_DPP_CONFIG(unit)->pp.bfd_extended_ipv4_src_ip) == 0) {

              
              for(mem = EPNI_PRGE_INSTRUCTION_0m; mem < EPNI_PRGE_INSTRUCTION_0m + 8; mem++)
              {
                  entry = entry_even;
                  
                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
                  prge_instruction_tbl_data.op_value    = 16;
                  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                  prge_instruction_tbl_data.cmp_action  = 0x7;
                  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                  entry = entry_odd;
                  
                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0xF0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = 0;
                  prge_instruction_tbl_data.op_value    = 0;
                  prge_instruction_tbl_data.op_2_field_select     = 0;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = 0;
                  prge_instruction_tbl_data.cmp_action  = 0;
                  prge_instruction_tbl_data.dst_select  = 0;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
              }
              
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

              
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;

              prge_instruction_tbl_data.src_select  = 2;    
              prge_instruction_tbl_data.offset_base = 53; 
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; 
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, 
                      mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
              SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
              prge_instruction_tbl_data.op_1_field_select = 0;
              prge_instruction_tbl_data.op_value          = 0;
              prge_instruction_tbl_data.op_2_field_select = 0;
              prge_instruction_tbl_data.alu_action        = 0;
              prge_instruction_tbl_data.op_3_field_select = 0;
              prge_instruction_tbl_data.cmp_action        = 0;
              prge_instruction_tbl_data.dst_select        = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

              
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

              
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
              prge_instruction_tbl_data.op_value          = 0;
              prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action        = 0x7; 
              prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; 
              
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

              
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select = 0;
              prge_instruction_tbl_data.op_value          = 0;
              prge_instruction_tbl_data.op_2_field_select = 0;
              prge_instruction_tbl_data.alu_action        = 0;
              prge_instruction_tbl_data.op_3_field_select = 0;
              prge_instruction_tbl_data.cmp_action        = 0;
              prge_instruction_tbl_data.dst_select        = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 2;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
              prge_instruction_tbl_data.offset_base = 113; 
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; 
              prge_instruction_tbl_data.size_base   = 0; 
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;  
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
          } else { 
              


              res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

               INSTR( CE_FLREAD( PrgeDataFieldProgVar, -8, LFEM_8_LSBS )           , ALU_SET( 0x0004, REG_OP(2))                                  , "extract prge var[35:32]; r2 = 4");
               INSTR( CE_NOP                                                       , ALU_SET_IF( REG_OP(3), LT, CNST(4), REG_OP(3), REG_OP(2) )   , "--- ; r2 = (r3 < 4)? r3 : r2");
               INSTR( CE_NOP                                                       , ALU_SUB( FEM, CNST(0), REG_OP(SZ) )                          , "--- ; rsz = fem");
               INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_SUB( REG_OP(3), CNST(4), REG_OP(3) )                     , "try copy dip, size r2 ; r3 = r3-4");
               INSTR( CE_NOP                                                       , ALU_SET( 0x0006, REG_OP(2))                                  , "--- ; r2 = 6");
               INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET_IF( REG_OP(3), LT, CNST(6), REG_OP(3), REG_OP(2) )   , "extract ees_data1[3:0]; r2 = (r3 < 6)? r3 : r2");
               INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET( 0x0000, REG_OP(0) )                                 , "extract ees_data1[3:0]; r0 = 0 ");
               INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), REG_OP(2), REG_OP(0) )      , "--- ; r0 = (fem==rsz) ? r2 : r0");
               INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), CNST(0), REG_OP(2) )        , "--- ; r2 = (fem==rsz) ? 0 : r2");
               INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)            , ALU_NOP                                                      , "Extract Resolved.Data.tm-port-var (1B)" );
               INSTR( CE_FCOPY( PrgeDataFieldEesData1, -2, R_SIZE(0,0) )          , ALU_SUB( REG_OP(3), CNST(6), REG_OP(3) )                     , "try copy changed sip/checksum [55:8], size r0; r3 = r3-6");
               INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_SUB( FEM, CNST(0), REG_OP(SZ) )                          , "try copy from generated, size r2; ALU: RSZ = LFEM (tm-port-var value)");
              for (i = 0; i < 5; i++) {
                   INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "copy the remaining of enc and link layer");
                   INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(3,-8) )            , ALU_NOP                                                  , "copy the remaining of enc and link layer");
              }
       
               INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )          , ALU_NOP                                                      , "Copy Additional 1B based on the REG_SZ size");

              res = arad_egr_prge_mgmt_build_program_end(unit);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          }
      } 


      
	  else if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
          sal_printf("Instruction ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER with COE type 2");
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 395, exit);

          if ((SOC_DPP_CONFIG(unit)->pp.bfd_extended_ipv4_src_ip) == 0) { 
              INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS),  ALU_SET(2, REG_OP(0)),                      "0: For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
              INSTR(CE_NOP,                                             ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ)),  "1: RSZ=R3-12");
              INSTR(CE_NOP,                                             ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), "2: R0 will be 2 if we are pushing coe tag, 0 otherwise");

              
              if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "coe_tag_mapping_mode", 0)) {
                  INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC), ALU_NOP,                              "3: ");
              } else {
                  INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC_DP), ALU_NOP,                              "3: ");
              }
              INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_1),   ALU_NOP,                                    "4: extract TC/DP set indication");
              INSTR(CE_NOP,                                             ALU_ADD(FEM, CNST(0), REG_OP(1)),           "5: ");
              INSTR(CE_FLREAD(PrgeDataFieldPpPortVar, 0, LFEM_12_LSBS), ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)), "6: ");
              INSTR(CE_NOP,                                             ALU_NOP,                                    "7: ");
              INSTR(CE_NOP,                                             ALU_ADD(FEM, REG_OP(1), REG_OP(1)),         "8: Calc the COE_TAG.16LSB");

              INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, 0)),          ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),   "9: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),       ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),  "10: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");

              for (i = 0; i < 4; i++) { 
                  INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),   ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),   " Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
                  INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),   ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),  " Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              }

              
              INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(0, 0)),         ALU_NOP,                                    "19: Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
              INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0)),  ALU_NOP,                                    "20:Copy Program-Variable(2bytes) only if R0 == 2 ");

              
              INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)),                ALU_NOP,                                    "21: "); 
              
              INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)),                ALU_NOP,                                    "22: "); 
          } else {
               INSTR(CE_NOP                                                 , ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ))                    , "--- ; RSZ=R3-12");
               INSTR( CE_FLREAD( PrgeDataFieldProgVar, -8, LFEM_8_LSBS )    , ALU_SET( 0x0004, REG_OP(2))                                  , "extract prge var[35:32]; r2 = 4");
               INSTR( CE_NOP                                                , ALU_SET_IF( REG_OP(3), LT, CNST(4), REG_OP(3), REG_OP(2))    , "--- ; r2 = (r3 < 4)? r3 : r2");
               INSTR( CE_NOP                                                , ALU_SUB( FEM, CNST(0), REG_OP(1))                            , "--- ; r1 = fem");
               INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )              , ALU_SUB( REG_OP(3), CNST(16), REG_OP(2))                     , "try copy dip, size r2 ; r2 = r3-16");
               INSTR( CE_NOP                                                , ALU_SUB( REG_OP(3), CNST(4),REG_OP(3))                       , "--- ; r3 -= 4");
               INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )    , ALU_SET_IF(REG_OP(2), GT, CNST(6), CNST(6), REG_OP(2))       , "extract ees_data1[3:0]; r2 = (r3 > 6) ? 6 : r2");
               INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )    , ALU_SET( 0x0000, REG_OP(0))                                  , "extract ees_data1[3:0]; r0 = 0 ");
               INSTR( CE_NOP                                                , ALU_SET_IF( FEM, EQ, REG_OP(1), REG_OP(2), REG_OP(0))        , "--- ; r0 = (fem==r1) ? r2 : r0");
               INSTR( CE_NOP                                                , ALU_SET_IF( FEM, EQ, REG_OP(1), CNST(0), REG_OP(2))          , "--- ; r2 = (fem==r1) ? 0 : r2");
               INSTR( CE_FCOPY( PrgeDataFieldEesData1, -2, R_SIZE(0,0) )    , ALU_SUB(REG_OP(SZ), CNST(10), REG_OP(SZ))                    , "try copy changed sip/checksum [55:8], size r0; r3 = r3-6");
               INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET( 0x0002, REG_OP(0))                                  , "For port Ex. Extract Resolved.Data.tm-port-var; R0=2");
               INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,0))                , ALU_SUB(REG_OP(3),  CNST(6), REG_OP(3))                      , "try copy from generated, size r2; r3 = r3-16");
               INSTR( CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0))             , "--- ; R0 will be 2 if we are pushing coe tag, 0 otherwise");
               INSTR( CE_COPY(GEN, R_OFST(3, 0) ,  R_SIZE(SZ, 0))           , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                      , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
               INSTR( CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8))          , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                    , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              if (SOC_IS_JERICHO(unit)) {
                  fld_val = 4;
              } else {
                  fld_val = 2;
              }
              for (i = 0; i < fld_val; i++) { 
                   INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16))    , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
                   INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8))    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              }

              
               INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0))      , ALU_NOP                                                      , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
               INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0))      , ALU_NOP                                                      , "Copy Program-Variable(2bytes) only if R0 == 2 ");

              
               INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6))                    , ALU_NOP                                                      , "");

              
               INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))                    , ALU_NOP                                                      , "");
          }

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 393, exit);
      } else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "add_ftmh_header", 0)) {
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 395, exit);
          
          INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)            ,ALU_SET(9, REG_OP(SZ))                                     ,"RSZ = 9, prepare to copy 9 byte FTMH base");
          INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)            ,ALU_SET(6, REG_OP(2))                                      ,"R2 = 6, prepare to copy 6 byte OTSH");
          INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2)                        ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))          ,"RSZ = 0 if TM_var.1lsb not set");
          INSTR(CE_NOP                                                      ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))           ,"R2 = 0 if TM_var.1lsb not set");
          INSTR(CE_NOP                                                      ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))           ,"R2 = 0 if OTSH doesn't exist");
          for (i = 0; i < 6; i++) {
              INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                ,ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                    ,"copy the Gen header");
              INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))               ,ALU_NOP                                                    ,"copy the Gen header");
          }
          
          
          fld_val = (ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE+ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE)<<1;
          INSTR(CE_COPY(PKT, C_OFST(fld_val), R_SIZE(2,0))                  ,ALU_NOP                                                    ,"Copy OTSH");

          
          INSTR(CE_COPY(PKT, C_OFST(18), R_SIZE(SZ,0))                      ,ALU_NOP                                                    ,"Copy FTMH");
          INSTR(CE_COPY(PKT, C_OFST(2), R_SIZE(SZ,-8))                      ,ALU_NOP                                                    ,"Copy FTMH");
          
          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 397, exit);
      } else {

          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);

          if ((SOC_DPP_CONFIG(unit)->pp.bfd_extended_ipv4_src_ip) == 0) {

              for (mem = EPNI_PRGE_INSTRUCTION_0m; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++) {
                  entry = entry_even;

                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 7) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
                  prge_instruction_tbl_data.op_value    = 16;
                  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                  prge_instruction_tbl_data.cmp_action  = 0x7;
                  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                  entry = entry_odd;

                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0xF0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 7) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m + 7) ? 0x18 : 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = 0;
                  prge_instruction_tbl_data.op_value    = 0;
                  prge_instruction_tbl_data.op_2_field_select     = 0;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = 0;
                  prge_instruction_tbl_data.cmp_action  = 0;
                  prge_instruction_tbl_data.dst_select  = 0;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
              }

              
              entry = entry_even;
              SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));

          }
          else {
              


              res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

               INSTR( CE_FLREAD( PrgeDataFieldProgVar, -8, LFEM_8_LSBS )           , ALU_SET( 0x0004, REG_OP(2))                                  , "extract prge var[35:32]; r2 = 4");
               INSTR( CE_NOP                                                       , ALU_SET_IF( REG_OP(3), LT, CNST(4), REG_OP(3), REG_OP(2) )   , "--- ; r2 = (r3 < 4)? r3 : r2");
               INSTR( CE_NOP                                                       , ALU_SUB( FEM, CNST(0), REG_OP(SZ) )                          , "--- ; rsz = fem");
               INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_SUB( REG_OP(3), CNST(4), REG_OP(3) )                     , "try copy dip, size r2 ; r3 = r3-4");
               INSTR( CE_NOP                                                       , ALU_SET( 0x0006, REG_OP(2))                                  , "--- ; r2 = 6");
               INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET_IF( REG_OP(3), LT, CNST(6), REG_OP(3), REG_OP(2) )   , "extract ees_data1[3:0]; r2 = (r3 < 6)? r3 : r2");
               INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET( 0x0000, REG_OP(0) )                                 , "extract ees_data1[3:0]; r0 = 0 ");
               INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), REG_OP(2), REG_OP(0) )      , "--- ; r0 = (fem==rsz) ? r2 : r0");
               INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), CNST(0), REG_OP(2) )        , "--- ; r2 = (fem==rsz) ? 0 : r2");
               INSTR( CE_FCOPY( PrgeDataFieldEesData1, -2, R_SIZE(0,0) )           , ALU_SUB( REG_OP(3), CNST(6), REG_OP(3) )                     , "try copy changed sip/checksum [55:8], size r0; r3 = r3-6");
               INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_NOP                                                      , "try copy from generated, size r2; -----");
              for (i = 0; i < 5; i++) {
                   INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "copy the remaining of enc and link layer");
                   INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(3,-8) )            , ALU_NOP                                                  , "copy the remaining of enc and link layer");
              }
               INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "copy the remaining of enc and link layer");

              res = arad_egr_prge_mgmt_build_program_end(unit);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          }
      }
  }
  else {   

      
      res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_PP_COPY_HEADER, &branch_pointer);
      SOC_SAND_IF_ERR_EXIT(res);

      
      mem = EPNI_PRGE_INSTRUCTION_0m;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
          ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
      entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
      entry = entry_even;
      
      
      prge_instruction_tbl_data.src_select  = 2;
      prge_instruction_tbl_data.offset_base = 33;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value = 0;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      
      entry = entry_odd;
      
      prge_instruction_tbl_data.src_select      = 2;
      prge_instruction_tbl_data.offset_base     = 45;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = 1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem = EPNI_PRGE_INSTRUCTION_0m + 1;
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      entry = entry_odd;
      
      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem = EPNI_PRGE_INSTRUCTION_0m + 2;
      
      
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD,
              mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 35;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x0;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem = EPNI_PRGE_INSTRUCTION_0m + 3;

      
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(branch_pointer, entry==entry_odd);
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
      
      if(soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_two_ive_reserved", 0)) {
         prge_instruction_tbl_data.cmp_action      = 0x6;
      }else{
         prge_instruction_tbl_data.cmp_action      = 0x2;
      }
        
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem = EPNI_PRGE_INSTRUCTION_0m + 4;
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value        = 8;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      for(mem = EPNI_PRGE_INSTRUCTION_0m + 5; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++) {
          
          entry = entry_even;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 11) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);      

          entry = entry_odd;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_base = (mem != EPNI_PRGE_INSTRUCTION_0m + 5) ? 0xF0 : 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +11) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = (mem != EPNI_PRGE_INSTRUCTION_0m + 5 && mem < EPNI_PRGE_INSTRUCTION_0m +11) ? 0x18 : 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);       
      }

      
      entry = entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

      
      
      mem = EPNI_PRGE_INSTRUCTION_0m + 4;
      entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
      entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
      entry = entry_odd;

      for (i=0; i<9; ++i) {
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base = i == 0 ? 0 : entry == 35 ? 0 : 0xF0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.size_base   = entry == 35 ? 0x18 : 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = entry == 35 ? ARAD_PP_PRGE_ENG_OP1_REG_R3 : ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value    = 16;
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action  = 0x7;
        prge_instruction_tbl_data.dst_select  = entry == 35 ? ARAD_PP_PRGE_ENG_DST_REG_R3 : ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }

      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 2;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;
      prge_instruction_tbl_data.offset_base = 0xF9;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 1;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0xFA;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0x1D;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
      prge_instruction_tbl_data.op_value    = 19;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0xEA;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0x15;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, 34, 35) );
  }

    res = arad_egr_prog_editor_tdm_coe_inter_conn(unit, user_header_size, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER_TDM_COE);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SET(2, REG_OP(0))                          ,"0: For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
        INSTR(CE_NOP                                            ,ALU_NOP                                        ,"1: NOP");
        INSTR(CE_NOP                                            ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)),"2: R0 will be 2 if we are pushing coe tag, 0 otherwise");

        
        
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "coe_tag_mapping_mode", 0)) {
            INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC), ALU_NOP,                              "3: ");
        } else {
            INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC_DP), ALU_NOP,                              "3: ");
        }
        INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_1) ,ALU_NOP,                                        "4: extract TC/DP set indication");
        INSTR(CE_NOP                                           ,ALU_ADD(FEM, CNST(0), REG_OP(1)),               "5: ");
        INSTR(CE_FLREAD(PrgeDataFieldPpPortVar, 0, LFEM_12_LSBS),ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)), "6: ");
        INSTR(CE_NOP                                           ,ALU_NOP,                                        "7: ");
        INSTR(CE_NOP                                           ,ALU_ADD(FEM, REG_OP(1), REG_OP(1)),             "8: Calc the COE_TAG.16LSB");
        INSTR(CE_NOP                                           ,ALU_NOP,                                        "9:NOP");

        INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(0, 0))        ,ALU_NOP                                        ,"Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(0, 0))   ,ALU_NOP                                        ,"Copy Program-Variable(2bytes) only if R0 == 2 ");  

        INSTR(CE_NOP                                            ,ALU_ADD(REG_OP(3), CNST(user_header_size), REG_OP(SZ)) ,"Point to start of MAC address");        
        INSTR(CE_NOP                                            ,ALU_NOP                                        ,"NOP");
        INSTR(CE_COPY(PKT, R_OFST(SZ,24), C_SIZE(8))            ,ALU_NOP                                        ,"Copy DMAC+SMAC[5~4]");
        INSTR(CE_COPY(PKT, R_OFST(SZ,8), C_SIZE(4))             ,ALU_NOP                                        ,"Copy SMAC[3~0]");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;
      
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 33;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                      
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 8;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 10;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 0xf0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
            prge_instruction_tbl_data.cmp_action = 4 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 51;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 8;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_NOP , ALU_SUB(REG_OP(3), CNST(user_header_size), REG_OP(0)) , "--- ; Decrease UHD size from generated header size (R0 = R3 - user_header_size)");
      INSTR( CE_NOP , ALU_NOP                                               , "NOP");

      
      INSTR( CE_NOP , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))               , "--- ; R0 -= 16 (Prepare for PP-Copy loop with seperate size register)");
      for (i = 0; i < 9; i++) {
          INSTR( CE_COPY( GEN, R_OFST(3, 0) , R_SIZE(0, 0) )     , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))  , "copy the remaining of enc and link layer");
          INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(0, 8) )     , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))  , "copy the remaining of enc and link layer");
      }
      if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists == 1)) {
          INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)      , ALU_NOP                           , "Extract Resolved.Data.tm-port-var (1B)" );
          INSTR( CE_NOP                                                 , ALU_NOP                           , "NOP");
          INSTR( CE_NOP                                                 , ALU_ADD( FEM, CNST(0), REG_OP(SZ) ), "ALU: RSZ = LFEM (tm-port-var value)");
          INSTR( CE_NOP                                                 , ALU_NOP                           , "NOP");
          INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )    , ALU_NOP                           , "Copy Additional 1B based on the REG_SZ size");
      }
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
  
    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 20;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 20;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 93;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 12;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 2;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 57;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 16;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 8;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 8;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 5;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 18;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 43;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 17;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 59;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        
        res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_2_HOP_SCHEDULING, &branch_pointer);
        SOC_SAND_IF_ERR_EXIT(res);

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; 
        prge_instruction_tbl_data.offset_base     = 57; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(branch_pointer, entry==entry_odd);
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 0x4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4;  
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; 
        prge_instruction_tbl_data.offset_base     = 27; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 14;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 31; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 27; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4;  
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
               
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; 
        
        prge_instruction_tbl_data.offset_base     = ((128 + 556 - 0)/4) - 64*2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 49; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


        

        mem   = EPNI_PRGE_INSTRUCTION_3m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; 
        prge_instruction_tbl_data.offset_base     = 20; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 14;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 24; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 20; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4;  
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                                      
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; 
        
        prge_instruction_tbl_data.offset_base     = ((128 + 556 - 0)/4) - 64*2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 49; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


    } 

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0xfb00;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0xfb00;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    
    if(programs_usage[unit].customer_conn_to_np_enable) {
        
        if (customer_conn_to_np_debug) {
            
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL);
        } else {
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
            
                INSTR( CE_COPY(PKT,  C_OFST(17),     C_SIZE(2))                     ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy Outlif from FTMH, R0 = R3 + 4");
                INSTR( CE_LCOPY(PKT, C_OFST(13),     C_SIZE(0), LFEM_3_LSBS)        ,ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: R1 = FEM + R1");                   
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM) ,ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy tag number to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-7]: Set DS mode");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-8]: R0 = FEM + R0");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -6, C_SIZE(1), LFEM_NPH_SLOT_OUT) ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-9]: Get slot_out from data entry, R1 = R3 - 2");
            
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_NOP                        ,"[Inst-10]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");
            
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-11]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1, -12, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-12]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(0, REG_OP(1))        ,"[Inst-13]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]: Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]: copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]: copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]: main type and sub type");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                INSTR( CE_COPY(PKT,  C_OFST(17),     C_SIZE(2))                     ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy Outlif from FTMH, R0 = R3 + 4");
                INSTR( CE_LCOPY(PKT, C_OFST(13),     C_SIZE(0), LFEM_3_LSBS)        ,ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC),ALU_ADD(FEM, CNST(0), REG_OP(0)) ,"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)) ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -6, C_SIZE(1))              ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-8]: Get slot_out from data entry, R1 = R3 - 2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN)   ,ALU_NOP                      ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(0, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-16]: main type and sub type");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]: Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]: copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]: copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-23]: Set Main Type and sub Type.");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2,      0, C_SIZE(2))             ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)) ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_COPY(RES,  C_OFST(128+55),     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                
                INSTR( CE_LCOPY(RES, C_OFST(128+25), C_SIZE(1), LFEM_NPH_SLOT_OUT)  ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1)) ,"[Inst-8]: Get slot_out from data entry, R1 = R3 - 2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");

                
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_COPY (RES, C_OFST(128+19), C_SIZE(1))                     ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
            
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-26]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;

                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -6, C_SIZE(1))             ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-8]: Get slot_out from data entry, R1 = R3 - 2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-16]:main type and sub type");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-23]: Set Main Type and sub Type.");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2,      0, C_SIZE(2))             ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }


            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;

                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_MC_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE_MC),ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_COPY(RES,  C_OFST(128+55),     C_SIZE(2))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-8]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_SET(0 , REG_OP(1))         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, Set R0 = 0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for VPN ID(13)");
                if (customer_ftmh_lb_extension_add) {
                    fld_val = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + 1;
                    INSTR( CE_COPY(PKT, C_OFST((fld_val<<1)), C_SIZE(1))            ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Got LB key as Hash ID(4)");
                } else {
                    INSTR( CE_COPY(RES, C_OFST(128+55), C_SIZE(1))                  ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Hash ID(4) to 0");
                }
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_MC) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0] to form MC_ID");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");

                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11), C_SIZE(2), LFEM_XTMH_DP_MC)    ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                
                INSTR( CE_LCOPY(PKT, C_OFST(32),     C_SIZE(0), LFEM_8_LSBS)        ,ALU_SET(0x0004, REG_OP(0))             ,"[Inst-0]: Get PPH.Base[31:24], set ");
                INSTR( CE_COPY(PKT,  R_OFST(3,8),    C_SIZE(0))                     ,ALU_NOP                                ,"[Inst-1]: Get user_header_1 16LSB");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-2]: RSZ = PPH.Base[31:24]");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: R0 = user_header_1 16LSB");

                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_NOP                         ,"[Inst-4]: NOP");
                INSTR( CE_NOP                                                       ,ALU_SET_IF(REG_OP(SZ), EQ, CNST(0xA5), REG_OP(1), REG_OP(0))   , "[Inst-5]: If CPU injected pkt, copy OAM content from user header");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(3))       ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                      ,ALU_NOP                                ,"[Inst-7]: Add NPH 16LSB.");

                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_SET(0, REG_OP(2))                  ,"[Inst-8]: copy FTMH.TC and FTMH.DP");                
                INSTR( CE_LCOPY(RES, C_OFST(128+25), C_SIZE(1), LFEM_NPH_SLOT_OUT)  ,ALU_NOP                                ,"[Inst-9]: Get slot_out from data entry, R1 = R3 - 2");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN)   ,ALU_NOP                      ,"[Inst-10]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");
                
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-11]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_COPY (RES, C_OFST(128+19), C_SIZE(1))                     ,ALU_SUB(FEM, CNST(user_header_size), REG_OP(0))       ,"[Inst-12]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(3, REG_OP(1))        ,"[Inst-13]: NOP");

                
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SET_IF(REG_OP(SZ), EQ, CNST(0xA5), REG_OP(2), REG_OP(0)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(1), LFEM_NPH_TAG_NUM) ,ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-15]: Get tag_num from FHEI.IVE-CMD[3:2]");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))                      ,ALU_NOP                                ,"[Inst-18]: test");

                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(3), REG_OP(2))     ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");

                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }
            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -5, C_SIZE(0), LFEM_2_LSBS) ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Get lsp_ecmp_fp.1MSB to FEM, R0 = R3 + 4");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -10, C_SIZE(0), LFEM_8_LSBS),ALU_NOP                                ,"[Inst-1]: Get lsp_ecmp_en to fem on bit7");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM, R1=lsp_ecmp_fp.1MSB");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R2 = lsp_ecmp_en");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -6, C_SIZE(0), LFEM_NPH_SLOT_OUT),ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy NextHopIndex or lsp_ecmp_fp.16 LSB from data-entry");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1,  -1,   C_SIZE(2))            ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode and lsp_ecmp_fp.1MSB, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-8]: Get slot_out from data entry, R2 = FEM + R2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-10]: Copy slot_out+[emcp_en]");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_ADD(FEM, CNST(0), REG_OP(2)),"[Inst-11]: Got VRF, R2=forwarding_header_offset");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -12, C_SIZE(1))              ,ALU_NOP                                ,"[Inst-12]: Get port_out from data-entrys");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(2, REG_OP(1))        ,"[Inst-13]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size+12), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                        ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }

                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -5, C_SIZE(0), LFEM_2_LSBS) ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Get lsp_ecmp_fp.1MSB to FEM, R0 = R3 + 4");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -10, C_SIZE(0), LFEM_8_LSBS),ALU_NOP                                ,"[Inst-1]: Get lsp_ecmp_en to fem on bit7");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM, R1=lsp_ecmp_fp.1MSB");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R2 = lsp_ecmp_en");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -6, C_SIZE(0), LFEM_NPH_SLOT_OUT),ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy NextHopIndex or lsp_ecmp_fp.16 LSB from data-entry");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1,  -1,   C_SIZE(2))            ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode and lsp_ecmp_fp.1MSB, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                      ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-8]: Get slot_out from data entry, R2 = FEM + R2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar,  -6, C_SIZE(1))             ,ALU_NOP                                ,"[Inst-10]: Copy slot_out+[emcp_en]");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_ADD(FEM, CNST(0), REG_OP(2)),"[Inst-11]: Got VRF, R2=forwarding_header_offset");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(1))              ,ALU_NOP                                ,"[Inst-12]: Get port_out from data-entrys");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(2, REG_OP(1))        ,"[Inst-13]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size+12), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                        ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }

                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }


            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
            
                INSTR( CE_FCOPY(PrgeDataFieldEesData1,  -1,   C_SIZE(2))            ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy NextHopIndex from data-entry 0, R0 = R3 + 4");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_NOP                                ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(8), REG_OP(0)),"[Inst-4]: Put FEM to R0 and set B_F flag");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-5]: R1 = FEM + R1");                   
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM) ,ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy tag number to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-7]: Set DS mode");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-8]: R0 = FEM + R0");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -6, C_SIZE(1), LFEM_NPH_SLOT_OUT) ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-9]: Get slot_out from data entry, R1 = R3 - 2");
            
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_NOP                        ,"[Inst-10]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");
            
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -6, C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                            ,"[Inst-11]: Got Ulei_Port(13) from data entry");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -12, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-12]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(0, REG_OP(1))        ,"[Inst-13]: Set R1=NPH.SubType, Get MainType");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size+12), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB) ,ALU_NOP                       ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }


            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_MC_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;

                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE_MC),ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_COPY(RES,  C_OFST(128+55),     C_SIZE(2))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-8]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_SET(0 , REG_OP(1))         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, Set R0 = 0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for VPN ID(13)");
                if (customer_ftmh_lb_extension_add) {
                    fld_val = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + 1;
                    INSTR( CE_COPY(PKT, C_OFST((fld_val<<1)), C_SIZE(1))            ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Got LB key as Hash ID(4)");
                } else {
                    INSTR( CE_COPY(RES, C_OFST(128+55), C_SIZE(1))                  ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Hash ID(4) to 0");
                }
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_MC) ,ALU_SET(2, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0] to form MC_ID");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");

                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP_MC)   ,ALU_NOP                             ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_MC_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
            
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE_MC),ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-8]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_SET(0 , REG_OP(1))         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, Set R0 = 0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for VPN ID(13)");
                if (customer_ftmh_lb_extension_add) {
                    fld_val = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + 1;
                    INSTR( CE_COPY(PKT, C_OFST((fld_val<<1)), C_SIZE(1))            ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Got LB key as Hash ID(4)");
                } else {
                    INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                  ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Hash ID(4) to 0");
                }
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_MC) ,ALU_SET(3, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0] to form MC_ID");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                        ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))                      ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
            
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP_MC),ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_MC_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;
            
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size;

                INSTR( CE_LCOPY(PKT, C_OFST((fld_val<<1)+1), C_SIZE(0), LFEM_2_LSBS),ALU_SET(0x1, REG_OP(3))                ,"[Inst-0]: Put FHEI size to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-1]: NOP");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(0))       ,"[Inst-2]: R0=FHEI value");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-3]: NOP");
                INSTR( CE_NOP                                                       ,ALU_SET_IF(REG_OP(0), EQ, CNST(0), CNST(0), REG_OP(3)) ,"[Inst-4]: if(FHEI size == 0), R3=0");
                INSTR( CE_NOP                                                       ,ALU_ADD(REG_OP(0), REG_OP(0), REG_OP(0)),"[Inst-5]: FHEI_size=FHEI_value*2 + 1/0 for MPLS");
                INSTR( CE_NOP                                                       ,ALU_SET(0x0800, REG_OP(2))             ,"[Inst-6]: NOP");
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + user_header_size;
                INSTR( CE_NOP                                                       ,ALU_ADD(REG_OP(0), CNST(fld_val), REG_OP(1)),"[Inst-7]: R1=offet of DMAC");
                INSTR( CE_NOP                                                       ,ALU_SET(0x0, REG_OP(SZ))               ,"[Inst-8]: Set Etype to R0");

                INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                      ,ALU_ADD(REG_OP(3), REG_OP(1), REG_OP(1)) ,"[Inst-9]: Copy Etype");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-10]: NOP");
                INSTR( CE_COPY(PKT,  R_OFST(1,28), C_SIZE(0))                       ,ALU_SET(0x8100, REG_OP(0))             ,"[Inst-11]: copy packet");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-12]: NOP");
                INSTR( CE_NOP                                                       ,ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(4), REG_OP(SZ)) ,"[Inst-13]: RSZ = 4 if TPID=0x8100");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-14]: NOP");

                
                INSTR( CE_COPY(PKT,  R_OFST(1,32), R_SIZE(SZ,0))                    ,ALU_NOP                                ,"[Inst-15]: copy VLAN tag");
                
                INSTR( CE_COPY(PKT,  R_OFST(1,24), C_SIZE(4))                       ,ALU_SET(0x80, REG_OP(2))               ,"[Inst-16]: copy MAC address");
                INSTR( CE_COPY(PKT,  R_OFST(1,16), C_SIZE(8))                       ,ALU_NOP                                ,"[Inst-17]: copy MAC address");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");

                
                INSTR( CE_LCOPY(PKT, C_OFST(9), C_SIZE(1), LFEM_NPH_SLOT_IN)        ,ALU_NOP                                ,"[Inst-19]: copy packet");
                INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))                      ,ALU_NOP                                ,"[Inst-20]: Copy Etype");

                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }
        }

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
        
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY);
            SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
        
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_NOP                                           , "0: FEM = SysHdrSize                                       ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "1: NOP                                                    ");
            INSTR( CE_LREAD(PKT, C_OFST(13), LFEM_NPH_PS_FROM_CUD)   , ALU_ADD(FEM, CNST(user_header_size+16), REG_OP(3)), "2: FEM = {FTMH[31]:FTMH[22:20]} ({ps[2:0], output_fp[16]}), R3 points to end of NPH");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "3: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_SUB(FEM, CNST(0), REG_OP(0))                  , "4: R0 = FEM                                               ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "5: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "6: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "7: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "8: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "9: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "10:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "11:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "12:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "13:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "14:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "15:NOP                                                    ");
            INSTR( CE_LREAD(PKT, R_OFST(3, -20), LFEM_12_MSBS)       , ALU_NOP                                           , "16:FEM = {NPH[95:84], 4'b0}                               ");
            INSTR( CE_LREAD(PKT, R_OFST(3, -30), LFEM_7_LSBS)        , ALU_NOP                                           , "17:FEM = NPH[126:120]                                     ");
            INSTR( CE_COPY(PKT, R_OFST(3,0), C_SIZE(8))              , ALU_ADD(FEM, REG_OP(0), REG_OP(1))                , "18:Copy NPH[63:0], R1=R0+FEM (NPH[95:80])                 ");
            INSTR( CE_COPY(PKT, C_OFST(17), C_SIZE(2))               , ALU_SUB(FEM, CNST(0), REG_OP(2))                  , "19:Copy FTMH[19:4] (output_fp[15:0]), R2 = FEM            ");
            INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                           , "20:Cpoy R1                                                ");
            INSTR( CE_COPY(PKT, R_OFST(3,-24), C_SIZE(3))            , ALU_ADD(REG_OP(2), CNST(8), REG_OP(2))            , "21:Copy NPH[119:86], R2 += 8 (set bit 3)                  ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "22:NOP                                                    ");
            INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))           , ALU_NOP                                           , "23:Copy R2                                                ");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
        }
    }


    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 33;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 8;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 10;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 16;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 0xf0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
        prge_instruction_tbl_data.cmp_action = 4 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }




    for (is_1588 =0 ; is_1588 < PROG_DM_DOWN_LIST_SIZE ; is_1588++  ) {
        uint32 tod_msb_add_enable = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,
                                                                "oam_dm_tod_msb_add_enable",
                                                                SOC_IS_JERICHO_PLUS_AND_BELOW(unit)); 
        uint32 tod_msb_add_size = tod_msb_add_enable ? 4 : 0 ;
        int prog_index = prog_dm_down_list[is_1588];

        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            predefined_data_e tod_field = (is_1588%2) ? PrgeDataFieldTod1588 : PrgeDataFieldTodNtp;
            
            
            res = arad_egr_prge_mgmt_build_program_start(unit, prog_index);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            INSTR( CE_NOP                                             , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                                  , "---                                          ; R0 = R3-R2 -> PPH size" );
            INSTR( CE_FCOPY(tod_field, -8, C_SIZE(tod_msb_add_size))   , ALU_NOP                                                                   , "Copy ToD NTP [63:32]                         ; ---" );

            if(is_1588 >= 2){ 
                INSTR(CE_COPY(PKT, R_OFST(3, 0 + (user_header_size * 2)), C_SIZE(user_header_size)) , ALU_NOP  , "Copy UDH");
            }

            INSTR( CE_COPY(PKT, R_OFST(3, 0),R_SIZE(0, -7))           , ALU_NOP                                                                   , "Copy PPH eei and learn                       ; ---" );
            INSTR( CE_READ(PKT, R_OFST(2, 4))                         , ALU_NOP                                                                   , "Read PPH fwrd_offset+pkt_ctrl                ; ---" );
            INSTR( CE_COPY(PKT, R_OFST(3, -16),R_SIZE(0, -15))        , ALU_NOP                                                                   , "Copy PPH FHEI (if any)                       ; ---" );

            if(is_1588 >= 2){ 
                INSTR( CE_NOP                                             , ALU_ADD(FEM, CNST((tod_msb_add_size)<< 1), REG_OP(3))  , "---                                          ; Recalculate the pph fwrd offset 0 -> R0 = FEM - ((tod_msb_add_size) << 1)" );
            } else {
                INSTR( CE_NOP                                             , ALU_ADD(FEM, CNST((tod_msb_add_size - user_header_size)<< 1), REG_OP(3))  , "---                                          ; Recalculate the pph fwrd offset 0 -> R0 = FEM - ((tod_msb_add_size -  user_header_size) << 1)" );
            }
            INSTR( CE_COPY(PKT, R_OFST(2, 14),C_SIZE(5))                , ALU_NOP                                                                   , "Copy PPH base 5 last bytes , nop for pph     ; ---" );
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))            , ALU_NOP                                                                   , "Copy PPH base fwrd offset + pkt_ctrl         ; ---" );
            INSTR( CE_COPY(PKT, R_OFST(2, 2), C_SIZE(1))                , ALU_NOP                                                                   , "Copy PPH base first byte                     ; ---" );
            INSTR( CE_COPY(PKT, R_OFST(1, 12), C_SIZE(6))               , ALU_NOP                                                                   , "Copy OAM TS                                  ; ---" );
            INSTR( CE_COPY(PKT, R_OFST(1, 0), R_SIZE(1, -6))          , ALU_NOP                                                                   , "Copy LSB of FTMH                             ; ---" );
            INSTR( CE_COPY(PKT, C_OFST(12), C_SIZE(6))                , ALU_NOP                                                                   , "Copy MSB of FTMH stamp pph_type = 3          ; ---" );
            
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
    }

	
    for (is_1588=0 ; is_1588 <=1 ; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP;
        uint32 tod_msb_add_enable = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,
                                                                "oam_dm_tod_msb_add_enable",
                                                                SOC_IS_JERICHO_PLUS_AND_BELOW(unit)); 
        uint32 tod_msb_add_size = tod_msb_add_enable ? 4 : 0 ;
        int tod_field = (is_1588 == 1) ? PrgeDataFieldTod1588 : PrgeDataFieldTodNtp;

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

            res = arad_egr_prge_mgmt_build_program_start(unit, prog_index);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            if (!soc_petrab_cfg) {

                
                for (i = 0; i < 4; i++) {                                                                                                                   
                    INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                                        , "PP-Copy with R3; R3 -= 16");
                    INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                                , ALU_NOP                                                                           , "PP-Copy with R3");
                }                                                                                                                                            
                INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SET( (0x1700|((tod_msb_add_size+14+user_header_size)<<1)) , REG_OP(1))      , "PP-Copy with R3; R1 = PPH 2MSB with FWD-Offset=14+user_header_size");
                INSTR( CE_FCOPY(tod_field, -8, C_SIZE(tod_msb_add_size))                  , ALU_NOP                                                                               , "Copy ToD NTP [63:32] and insert it in the begining of the header");
                INSTR( CE_READ(GEN, C_OFST(14*2))                                         , ALU_SET( (0x1700|((tod_msb_add_size+18+user_header_size)<<1)) , REG_OP(2))        , "Read offset 14 of candidate ; R2 = PPH 2MSB with FWD-Offset=18+user_header_size");
                INSTR( CE_READ(GEN, C_OFST(18*2))                                         , ALU_SET( (0x1700|((tod_msb_add_size+22+user_header_size)<<1)) , REG_OP(0))        , "Read offset 18 of candidate ; R0 = PPH 2MSB with FWD-Offset=22+user_header_size");
                INSTR( CE_COPY(GEN, C_OFST(0), C_SIZE(user_header_size))                  , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(1), REG_OP(0))                               , "Copy UDH [=user_header_size'd0] ; if (offset 14 == 0x8902) R0 = R1");
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(2), REG_OP(0))                               , "Copy FHEI LSB (Trap-Code) ; if (offset 18 == 0x8902) R0 = R2");
                INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                      , ALU_NOP                                                                               , "Copy FHEI MSB (OAM-ID) ; ---");
                if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) || !SOC_IS_JERICHO(unit)) {
                    if (SOC_IS_JERICHO(unit)) {
                        INSTR( CE_LREAD(PKT,C_OFST(18),LFEM_BIT_3)                            , ALU_SET(ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE,REG_OP(1)), "Get DSP bit from FTMH header ; R1 = 2");
                        INSTR( CE_NOP                                                         , ALU_NOP                                                   , "---");
                        INSTR( CE_NOP                                                         , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1))        , "Update R1 if DSP bit is not set");
                        INSTR( CE_NOP                                                         , ALU_NOP                                                   , "---");
                        INSTR( CE_COPY(PKT, R_OFST(1,2*(ftmh_size+7)), C_SIZE(5)), ALU_ADD(REG_OP(1), CNST(ftmh_size), REG_OP(1))         , "Copy PPH 5LSB ; R1 = FTMH-Size + R1");
                    } else {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                    }
                    INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                                               , "Copy PPH 2MSB");
                    
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                                         , "Set OAM TS offset = 0 , ---");  
                    INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                                        , ALU_NOP                                                                         , "Copy  OAM ToD LSB , ---");
                    
                    if (is_1588 == 1) {
                        if (SOC_IS_ARADPLUS(unit)) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD)               , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                    } else {
                        INSTR(CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP)            , ALU_NOP, "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                    }
                    INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                                  , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                    INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH)              , ALU_NOP                                                 , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                } else {
                    if (ftmh_size == 9) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                                                       , "Copy PPH 5LSB ; R1 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                                               , "Copy PPH 2MSB");
                        
                        INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                                         , "Set OAM TS offset = 0 , ---");  
                        INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                        INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                        INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        INSTR( CE_FCOPY(tod_field, 0, C_SIZE(2))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(tod_field, -4, C_SIZE(2))                 , ALU_NOP                                                   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        
                        if (is_1588 == 1) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                   , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(3))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                        INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    } else if (ftmh_size == 10) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                                                       , "Copy PPH 5LSB ; R1 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                                               , "Copy PPH 2MSB");
                        
                        INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                                         , "Set OAM TS offset = 0 , ---");  
                        INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                        INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                        INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        INSTR( CE_FCOPY(tod_field, 0, C_SIZE(3))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(tod_field, -6, C_SIZE(1))                 , ALU_NOP                                                   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        
                        if (is_1588 == 1) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                   , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(4))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                        INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    } else if (ftmh_size == 11) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                                                       , "Copy PPH 5LSB ; R1 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                                               , "Copy PPH 2MSB");
                        
                        INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                                         , "Set OAM TS offset = 0 , ---");  
                        INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                        INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                        INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                        
                        if (is_1588 == 1) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                   , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(5))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                        INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    } else if (ftmh_size == 12) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                                                       , "Copy PPH 5LSB ; R1 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                                               , "Copy PPH 2MSB");
                        
                        INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                                         , "Set OAM TS offset = 0 , ---");  
                         INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                         INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                         INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                         INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                         
                         if (is_1588 == 1) {
                             INSTR( CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                  , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                         } else {
                             INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                         }
                         INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                         INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                         INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(6))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                         INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    }
                }
            } else {
                

                INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(2), CNST(4), REG_OP(2))                  , "Increase R2 to point to the PPH msb");
                INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(1), CNST(2), REG_OP(1))                  , "Increase R1 to point to the Stacking lsb");
                INSTR(CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI), ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))         , "Extract FHEI size , r0 = r3-r2 (pph size)");
                INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)  , ALU_NOP                                         , "Extract FHEI size");
                INSTR( CE_NOP                                                                   , ALU_SUB(REG_OP(0), FEM, REG_OP(0))                      , "--- , r0 -= fem [== (r3-r2)-FheiSize]");
                INSTR( CE_NOP                                                                   , ALU_ADD(FEM, REG_OP(3), REG_OP(SZ))                     , "--- , rsz = r3 + PPH.FwdHeaderOffset");
                
                INSTR( CE_FCOPY(tod_field, -8, C_SIZE(tod_msb_add_size))                        , ALU_NOP                                                 , "Copy ToD NTP [63:32] and insert it in the begining of the header");
                INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(0,-7))                                  , ALU_SET(0x8902, REG_OP(0))                              , "Copy PPH eei and learn;  r0= 0x8902");
                INSTR( CE_READ(PKT, R_OFST(SZ,28))                                              , ALU_SET((tod_msb_add_enable? 0x34 :0x2c), REG_OP(SZ))   , "Extract Eth type(first attempt 12-13 byte), set rsz=8+14, shifted with 1 bit left - 0x2c;");
                INSTR( CE_READ(PKT, R_OFST(SZ,36))                                              , ALU_NOP                                                 , "Extract Eth type(second attempt 17-18 byte);");
                INSTR( CE_NOP                                                                   , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(tod_msb_add_enable? 0x24 : 0x1c), REG_OP(SZ)), "--- , rsz = (fem == 0x8902) ? 14 : rsz;");
                INSTR( CE_FREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0)                            , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(tod_msb_add_enable? 0x2c : 0x24), REG_OP(SZ)), "Extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;");
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(1))                            , ALU_NOP                                                 , "Create new FHEI, trap code0xe8 , nop for pph");
                INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                            , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))                     , "Create new FHEI - trap qualifier,  recalculate the pph fwrd offset r3=fem+rsz");
                INSTR( CE_COPY(PKT, R_OFST(2,14), C_SIZE(5))                                    , ALU_NOP                                                 , "Copy PPH base 5 last bytes ,");
                
                INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))                                  , ALU_NOP                                                 , "Copy PPH base fwrd offset =pkt_ctrl");
                INSTR( CE_LCOPY(PKT, R_OFST(2,2), C_SIZE(1), LFEM_OAM_TS_CCM_FHEI)              , ALU_NOP                                                 , "Copy PPH base first byte , ---");
                
                INSTR(CE_COPY(PKT, R_OFST(2,0), C_SIZE(2))                                      , ALU_NOP                                                 , "Copy Petra-B EEP");
                
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                 , "Set OAM TS offset = 0 , ---");  
                INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                                        , ALU_NOP                                                 , "Copy  OAM ToD LSB , ---");
                
                if (is_1588 == 1) {
                    if (SOC_IS_ARADPLUS(unit)) {
                        INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                    } else {
                        INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD)               , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                    }
                } else {
                    INSTR(CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP)            , ALU_NOP, "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                }
                INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                                  , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB), ALU_NOP, "Copy MSB of FTMH stamp pph_type = 3 , ---");

            }

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (!soc_petrab_cfg) {
            
            for (i = 0; i < 4; i++) {                                                                                                                   
                INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                , "PP-Copy with R3; R3 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                                , ALU_NOP                                                   , "PP-Copy with R3");
            }                                                                                                                                            
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                             , ALU_SET( (0x1700|((14+user_header_size)<<1)) , REG_OP(1)) , "PP-Copy with R3; R1 = PPH 2MSB with FWD-Offset=14+user_header_size");
            INSTR( CE_READ(GEN, C_OFST(14*2))                                         , ALU_SET( (0x1700|((18+user_header_size)<<1)) , REG_OP(2)) , "Read offset 14 of candidate ; R2 = PPH 2MSB with FWD-Offset=18+user_header_size");
            INSTR( CE_READ(GEN, C_OFST(18*2))                                         , ALU_SET( (0x1700|((22+user_header_size)<<1)) , REG_OP(0)) , "Read offset 18 of candidate ; R0 = PPH 2MSB with FWD-Offset=22+user_header_size");
            INSTR( CE_COPY(GEN, C_OFST(0), C_SIZE(user_header_size))                      , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(1), REG_OP(0))   , "Copy UDH [=user_header_size'd0]; ---");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(1))                      , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(2), REG_OP(0))   , "Copy FHEI LSB (Trap-Code) ; if (offset 14 == 0x8902) R0 = R1");
            INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                      , ALU_NOP                                                   , "Copy FHEI MSB (OAM-ID) ; if (offset 18 == 0x8902) R0 = R2");
            if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) || !SOC_IS_JERICHO(unit)) {
                if (!SOC_DPP_CONFIG(unit)->pp.xgs_port_exists && SOC_IS_JERICHO(unit)) {
                    INSTR( CE_LREAD(PKT,C_OFST(18),LFEM_BIT_3)                            , ALU_SET(ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE,REG_OP(1)), "Get DSP bit from FTMH header ; R1 = 2");
                    INSTR( CE_NOP                                                         , ALU_NOP                                                   , "---");
                    INSTR( CE_NOP                                                         , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1))        , "Update R1 if DSP bit is not set");
                    INSTR( CE_NOP                                                         , ALU_NOP                                                   , "---");
                    INSTR( CE_COPY(PKT, R_OFST(1,2*(ftmh_size+7)), C_SIZE(5)), ALU_ADD(REG_OP(1), CNST(ftmh_size), REG_OP(1))         , "Copy PPH 5LSB ; R1 = FTMH-Size + R1");
                } else {
                    INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                }
                INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                   , "Copy PPH 2MSB");
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                      , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  
                INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH)        , ALU_NOP                                                 , "Copy MSB of FTMH stamp pph_type = 3 , ---");
            } else {
                if (ftmh_size == 9) {
                    INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                    INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                   , "Copy PPH 2MSB");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                      , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  
                    INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(2))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, -4, C_SIZE(2))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                } else if (ftmh_size == 10) {
                    INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                    INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                   , "Copy PPH 2MSB");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                      , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  
                    INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(3))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, -6, C_SIZE(1))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                } else if (ftmh_size == 11) {
                    INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                    INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                   , "Copy PPH 2MSB");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                      , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  
                    INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                } else if (ftmh_size == 12) {
                    INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                    INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                   , "Copy PPH 2MSB");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                      , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  
                    INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                }
                INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH)        , ALU_NOP                                                 , "Copy MSB of FTMH stamp pph_type = 3 , ---");
            }

            
            if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) && (SOC_DPP_CONFIG(unit)->pp.xgs_port_exists) && SOC_IS_JERICHO(unit)) {
                INSTR(CE_FLREAD(PrgeDataFieldPpPortVar, 0, LFEM_2_LSBS)     , ALU_SET(8, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, RSZ=8");
                INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                INSTR(CE_COPY(RES, C_OFST(47+128), R_SIZE(SZ, 0))           , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if RSZ == 8 ");
                INSTR(CE_COPY(RES, C_OFST(45),     R_SIZE(SZ, 0))           , ALU_NOP                                             , "Copy TPID(2bytes) only if RSZ == 8 ");
            }            
        }
        else {
            

            INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(2), CNST(4), REG_OP(2))                  , "Increase R2 to point to the PPH msb");
            INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(1), CNST(2), REG_OP(1))                  , "Increase R1 to point to the Stacking lsb");
            INSTR( CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI), ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))        , "Extract FHEI size , r0 = r3-r2 (pph size)");
            INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)  , ALU_NOP                                         , "extract PPH.FwdHdrOffset , ---");
            INSTR( CE_NOP                                                                   , ALU_SUB(REG_OP(0), FEM, REG_OP(0))                      , "---; r0 -= fem [== r3-r2-FheiSize]");
            INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(3), FEM, REG_OP(SZ))                     , "---; rsz = r3+fem");
            INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(0,-7))                                  , ALU_SET(0x8902, REG_OP(0))                              , "Copy PPH eei and learn;  r0= 0x8902");
            INSTR( CE_READ(PKT, R_OFST(SZ,28))                                              , ALU_SET(0x2c, REG_OP(SZ))                               , "Extract Eth type(first attempt bytes 12-13), set rsz=8+14, shifted with 1 bit left - 0x2c;");
            INSTR( CE_READ(PKT, R_OFST(SZ,36))                                              , ALU_NOP                                                 , "Extract Eth type(second attempt bytes 16-17);");
            INSTR( CE_NOP                                                                   , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(28), REG_OP(SZ))    , "--- , rsz = (fem == 0x8902) ? 14 : rsz;");
            INSTR( CE_FREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0)                                    , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(36), REG_OP(SZ))    , "Extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(1))                            , ALU_NOP                                                 , "Create FHEI trap code;");
            INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                            , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))                     , "Create new FHEI - trap qualifier,  recalculate the pph fwrd offset r3=fem+rsz");
            INSTR( CE_COPY(PKT, R_OFST(2,14), C_SIZE(5))                                    , ALU_NOP                                                 , "Copy PPH base 5 last bytes ,");
            
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))                                  , ALU_NOP                                                 , "Copy PPH base fwrd offset =pkt_ctrl");
            INSTR( CE_LCOPY(PKT, R_OFST(2,2), C_SIZE(1), LFEM_OAM_TS_CCM_FHEI)              , ALU_NOP                                                 , "Copy PPH base first byte , ---");
            
            INSTR(CE_COPY(PKT, R_OFST(2,0), C_SIZE(2))                                      , ALU_NOP                                                 , "Copy Petra-B EEP");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  
            INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))                     , ALU_NOP                                                 , "Copy  OAM counter ,");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                             , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
            INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                                  , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
            INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB), ALU_NOP                                         , "Copy MSB of FTMH stamp pph_type = 3 , ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }
	
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_FCOPY(PrgeDataFieldOutLif, 0, C_SIZE(2))  , ALU_NOP   , "Copy CUD (OutLIF)");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }


  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    

    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;

    if (soc_petrab_cfg)
    {
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (tdm_arad_opt)
    {
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (tdm_arad_std)
    {
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 18;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 13;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 54;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 10;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 5;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m -1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gpon_application_enable", 0)) {
        int i;

        

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; 
        prge_instruction_tbl_data.offset_base     = 33;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; 
        prge_instruction_tbl_data.offset_base     = 0xf1;      
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, (SOC_IS_JERICHO(unit) ? ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN_JER : ARAD_EGR_PROG_EDITOR_LFEM_GPON_CHAN),
            mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 8;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; 
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_GPON_GEM_ID,
            mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_GPON_STAG_PCP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        for (i = 0; i < 6; i++) {

           
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0x18;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

           
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       }

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; 
        prge_instruction_tbl_data.offset_base     = 24;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; 
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
      }
      else
      {

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:2);
        prge_instruction_tbl_data.offset_base     = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:ARAD_PP_PRGE_EES_DATA2);
        prge_instruction_tbl_data.offset_src      = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:ARAD_PP_PRGE_ENG_OFFSET_CONST_64);
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        }
        else {
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        }
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 12;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_ARADPLUS(unit)) {
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        for(i=0; i<6; i++)
        {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 24;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 8; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 29:(ARAD_PP_PRGE_EES_DATA2 - 1));
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? ARAD_PP_PRGE_ENG_SIZE_CONST:ARAD_PP_PRGE_ENG_SIZE_REG_R2);
        prge_instruction_tbl_data.size_base       = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 4:0);
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 24;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
      }
   }
  
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        for (i=6; i<19; i++){
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 0 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 
        }       
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {  
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_TUNNEL_TOR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

         INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)     , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ))  , "Extract system header size; rsz = r3 -r0");
         INSTR(CE_NOP                                                 , ALU_SET(0x0800, REG_OP(1))                 , "---; r1 = 0x0800");
         INSTR(CE_NOP                                                 , ALU_ADD(FEM, CNST(8), REG_OP(2))           , "---; r2 = fem + 8");
         INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ, 0))               , ALU_SUB(REG_OP(SZ), CNST(40), REG_OP(SZ))   , "Copy frwd header; rsz = rsz - 40(20+4+2*8)");
         INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ, -8))            , ALU_NOP                                    , "Copy frwd header; ---");
         INSTR(CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ, 0))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))  , "Copy frwd header; rsz = rsz - 16");
         INSTR(CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ, -8))            , ALU_NOP                                    , "Copy frwd header; ---");
         INSTR(CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ, 0))             , ALU_NOP                                    , "Copy frwd header; ---");
         INSTR(CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ, -8))            , ALU_NOP                                    , "Copy frwd header; ---");
         INSTR(CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(2))          , ALU_NOP                                    , "Copy UDP dest port from EES[35:20]; ---");
         INSTR(CE_COPY(GEN, R_OFST(0,44), C_SIZE(2))                  , ALU_NOP                                    , "Copy UDP src port; ---");
         INSTR(CE_COPY(PKT, R_OFST(2, -8), C_SIZE(4))                 , ALU_NOP                                    , "Extract Dest-VTEP-IPv4-Address(32) from UDH[63:32]; ---");
         INSTR(CE_COPY(GEN, R_OFST(0,32), C_SIZE(4))                  , ALU_NOP                                    , "Copy SIP; ---");
         INSTR(CE_COPY(PKT, R_OFST(2, 0), C_SIZE(2))                  , ALU_NOP                                    , "Extract IP-Checksum-Fix(16)from UDH[15:0]; ---");
         INSTR(CE_COPY(GEN, R_OFST(0, 20), C_SIZE(2))                 , ALU_NOP                                    , "Copy TTL and Protocol; ---");
         INSTR(CE_COPY(GEN, R_OFST(0, 16), C_SIZE(4))                 , ALU_NOP                                    , "Copy Indentifier, Flags and Fragment Offset; ---");
         INSTR(CE_COPY(GEN, R_OFST(0, 8), C_SIZE(4))                  , ALU_SUB(REG_OP(0), CNST(2), REG_OP(0))     , "Copy Version, IHL, TOS and Total Length; r0 = r0 - 2");
         INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                , ALU_NOP                                    , "Copy Eth-Type; ---");
         INSTR(CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                 , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))    , "Copy Ethernet header; r0 = r0 - 16");
         INSTR(CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))              , ALU_NOP                                    , "Copy Ethernet header; ---");
         INSTR(CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                 , ALU_NOP                                    , "Copy Ethernet header; ---");
            
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }        

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {  
        if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_NORMAL)) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

             INSTR(CE_LREAD(GEN, R_OFST(0,32), LFEM_8_LSBS)               , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ))  , "Extract SIP-Index; rsz = r3 -r0");
             INSTR(CE_FLREAD(PrgeDataFieldProgVar, -8, LFEM_STACKING_8)   , ALU_SUB(REG_OP(3), CNST(0), REG_OP(2))     , "Extract ipv6 type; r2 = r3");
             INSTR(CE_NOP                                                 , ALU_SUB(FEM, CNST(0), DATA_ADDR)           , "--- ; ind_addr = fem");
             INSTR(CE_NOP                                                 , ALU_SUB(FEM, CNST(0), REG_OP(3))           , "---; r3 = fem");
             INSTR(CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ, 0))               , ALU_SUB(REG_OP(SZ), CNST(36), REG_OP(SZ))  , "Copy frwd header; rsz = rsz - 36");
             INSTR(CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ, -8))            , ALU_SUB(REG_OP(2), CNST(24), REG_OP(2))    , "Copy frwd header; r2 = r2 - 24");
             INSTR(CE_COPY(GEN, R_OFST(2,-32), R_SIZE(SZ, 0))             , ALU_NOP                                    , "Copy frwd header; ---");
             INSTR(CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ, -8))              , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))  , "Copy frwd header; rsz = rsz - 24");
             INSTR(CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ, -16))           , ALU_NOP                                    , "Copy frwd header; ---");
             INSTR(CE_COPY(GEN, R_OFST(2,-32), R_SIZE(SZ, 0))             , ALU_NOP                                    , "Copy frwd header; ---");
             INSTR(CE_COPY(GEN, R_OFST(2,-48), R_SIZE(SZ, -8))           , ALU_NOP                                    , "Copy frwd header; ---");
             INSTR(CE_LREAD(GEN, R_OFST(0,4), LFEM_TOS)                  , ALU_NOP                                    , "Extract tos; ---");
             INSTR(CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(7))          , ALU_NOP                                    , "Copy LSB-DIP; ---");
             INSTR(CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(5))          , ALU_ADD(REG_OP(3), FEM, REG_OP(3))         , "Copy DIP; r3 = r3 + fem");
             INSTR(CE_LREAD(GEN, R_OFST(0,8), LFEM_STACKING_8)            , ALU_NOP                                    , "Extract payload length; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,40), C_SIZE(4))                  , ALU_NOP                                    , "Copy DIP; ---");
             INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(8))   , ALU_SUB(FEM, CNST(20), REG_OP(2))          , "Copy LSB-SIP; r2 = fem - 20");
             INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, -16, C_SIZE(8)) , ALU_NOP                                    , "Copy MSB-SIP; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,18), C_SIZE(1))                  , ALU_NOP                                    , "Copy Hop Limit; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,20), C_SIZE(1))                  , ALU_SET(0x0, REG_OP(1))                    , "Copy Next Header; r1 = 0");
             INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                , ALU_SUB(REG_OP(0), CNST(2), REG_OP(0))     , "Copy payload length; r0 = r0 -2");
            if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode) {
                 INSTR(CE_COPY(PKT, C_OFST(20), C_SIZE(1))                    , ALU_NOP                                    , "Copy lb-key; ---");
                 INSTR(CE_COPY(PKT, C_OFST(20), C_SIZE(1))                    , ALU_NOP                                    , "Copy lb-key; ---");
            } else {
                 INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                , ALU_NOP                                    , "Copy lb-key; ---");
            }
             INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                , ALU_NOP                                    , "Copy version, tc, flow label; ---");
             INSTR(CE_FCOPY(PrgeDataFieldProgVar, -12, C_SIZE(2))         , ALU_NOP                                    , "Copy Eth-Type; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                 , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))    , "Copy Ethernet header; r0 = r0 - 16");
             INSTR(CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))              , ALU_NOP                                    , "Copy Ethernet header; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                 , ALU_NOP                                    , "Copy Ethernet header; ---");
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        } else if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LARGE)) {
            
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

             INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)     , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ))  , "Extract system header size; rsz = r3 -r0");
             INSTR(CE_LREAD(GEN, R_OFST(0,32), LFEM_8_LSBS)               , ALU_NOP                                    , "Extract SIP-Index; ---");
             INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ, 0))               , ALU_ADD(FEM, CNST(8), REG_OP(2))           , "Copy frwd header; r2 = fem + 8");            
             INSTR(CE_FLREAD(PrgeDataFieldEesData2, -4, LFEM_LSHIFT_12)   , ALU_SUB(FEM, CNST(0), DATA_ADDR)           , "Extract IPv6-DC-ID[3:0] from EES[39:36]; ind_addr = fem");    
             INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ, -8))            , ALU_SUB(REG_OP(SZ), CNST(40), REG_OP(SZ))  , "Copy frwd header; rsz = rsz - 40(20+4+2*8)");
             INSTR(CE_LREAD(PKT, R_OFST(2,-4), LFEM_12_LSBS)              , ALU_SUB(FEM, CNST(0), REG_OP(1))           , "Extract TOR-ID[28:16] from UDH[59:48]; r1 = fem");
             INSTR(CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ, 0))             , ALU_NOP                                    , "Copy frwd header; ---");
             INSTR(CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ, -8))            , ALU_ADD(FEM, REG_OP(1), REG_OP(1))         , "Copy frwd header; r1 = fem + r1");
             INSTR(CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ, -16))           , ALU_NOP                                    , "Copy frwd header; ---");            
             INSTR(CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(2))          , ALU_NOP                                    , "Copy UDP dest port from EES[35:20]; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,44), C_SIZE(2))                  , ALU_NOP                                    , "Copy UDP src port; ---");
             INSTR(CE_COPY(PKT, R_OFST(2, -8), C_SIZE(4))                 , ALU_NOP                                    , "Copy VTEP-IPv4-Addr[31:0]; ---");
             INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(4))           , ALU_NOP                                    , "Copy All Zeros[31:0]; ----");
             INSTR(CE_COPY(PKT, R_OFST(2, 0), C_SIZE(2))                  , ALU_NOP                                    , "Copy TOR-ID[15:0]; ---");
             INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                , ALU_NOP                                    , "Copy TOR-ID[28:16] and IPv6-DC-ID[3:0]; ---");
             INSTR(CE_LREAD(GEN, R_OFST(0,4), LFEM_TOS)                   , ALU_NOP                                    , "Extract ipv6 TC(IPv4.TOS); ---");
             INSTR(CE_LREAD(GEN, R_OFST(0,8), LFEM_STACKING_8)            , ALU_NOP                                    , "Extract payload length; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,40), C_SIZE(4))                  , ALU_ADD(FEM, CNST(0x6000), REG_OP(2))      , "Copy IPv6-DC-ID[127:96]; r2 = fem + 0x6000");
             INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(8))   , ALU_SUB(FEM, CNST(20), REG_OP(3))          , "Copy LSB-SIP; r3 = fem - 20");
             INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, -16, C_SIZE(8)) , ALU_NOP                                    , "Copy MSB-SIP; ---");            
             INSTR(CE_LCOPY(GEN, R_OFST(0,20), C_SIZE(2), LFEM_IPV6_VXLAN_NH_HL)  , ALU_NOP                            , "Copy Next Header and Hop Limit from IPv4 Protocol and TTL; ---");
             INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                , ALU_SUB(REG_OP(0), CNST(2), REG_OP(0))     , "Copy payload length; r0 = r0 -2");
            if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode) {
                 INSTR(CE_LCOPY(PKT, C_OFST(20), C_SIZE(2), LFEM_IPV6_VXLAN_FL)   , ALU_NOP                            , "Copy lb-key; ---");
            } else {
                 INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))       , ALU_NOP                                    , "Copy lb-key; ---");
            }
             INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                , ALU_NOP                                    , "Copy version, tc, flow label; ---");
             INSTR(CE_FCOPY(PrgeDataFieldProgVar, -12, C_SIZE(2))         , ALU_NOP                                    , "Copy Eth-Type; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                 , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))    , "Copy Ethernet header; r0 = r0 - 16");
             INSTR(CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))              , ALU_NOP                                    , "Copy Ethernet header; ---");
             INSTR(CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                 , ALU_NOP                                    , "Copy Ethernet header; ---");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        } else {
            mem   = EPNI_PRGE_INSTRUCTION_0m -1;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;
    
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 27;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R3;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0x18; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value        = 24;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xE0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 2;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0x18; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R1;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base       = 0x10; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 33;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 4;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 35;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 25;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 20;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 127;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 2;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 119;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x18; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

             
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
        }
    }
  
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
            ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            if (!soc_petrab_cfg) {
                
                for (i = 0; i < 3; i++) {                                                                                                    
                    INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                , "PP-Copy with R3; R3 -= 16");
                    INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                , ALU_NOP                                                   , "PP-Copy with R3");
                }
                INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                , "PP-Copy with R3; R3 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                , ALU_SET(61, REG_OP(1))                                    , "PP-Copy with R3");
                INSTR( CE_LREAD(RES, C_OFST(33), LFEM_OTMH_BASE_EXTRACT_TC_PB)  , ALU_SET(65, REG_OP(SZ))                                   , "OAM sub type");
                INSTR( CE_NOP                                                   , ALU_NOP                                                   , "NOP");
                fld_val = _ARAD_PP_OAM_SUBTYPE_ETH_LOOPBACK; 
                INSTR( CE_NOP                                                   , ALU_SET_IF(FEM, EQ, CNST(fld_val), REG_OP(1), REG_OP(SZ)) , "If OAM_sub_tye is loopback, set trapid offset");
                
                INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))             , ALU_SET( (0x1700|((14+user_header_size)<<1)) , REG_OP(1)) , "PP-Copy with R3; R1 = PPH 2MSB with FWD-Offset=14+user_header_size");
                INSTR( CE_READ(GEN, C_OFST(14*2))                         , ALU_SET( (0x1700|((18+user_header_size)<<1)) , REG_OP(2)) , "Read offset 14 of candidate ; R2 = PPH 2MSB with FWD-Offset=18+user_header_size");
                INSTR( CE_READ(GEN, C_OFST(18*2))                         , ALU_SET( (0x1700|((22+user_header_size)<<1)) , REG_OP(0)) , "Read offset 18 of candidate ; R0 = PPH 2MSB with FWD-Offset=22+user_header_size");
                INSTR( CE_COPY(GEN, C_OFST(0), C_SIZE(user_header_size))  , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(1), REG_OP(0))   , "Copy UDH [=user_header_size'd0]; if (offset 14 == 0x8902) R0 = R1");
                INSTR( CE_COPY(RES, R_OFST(SZ,1), C_SIZE(1))              , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(2), REG_OP(0))   , "Copy FHEI LSB (Trap-Code) ; if (offset 18 == 0x8902) R0 = R2");
                INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))      , ALU_NOP                                                   , "Copy FHEI MSB (OAM-ID) ; ---");
                if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) || !SOC_IS_JERICHO(unit)) {
                    if (SOC_IS_JERICHO(unit)) {
                        INSTR( CE_LREAD(PKT,C_OFST(18),LFEM_BIT_3)                , ALU_SET(ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE,REG_OP(1)), "Get DSP bit from FTMH header ; R1 = 2");
                        INSTR( CE_NOP                                             , ALU_NOP                                                   , "---");
                        INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1))        , "Update R1 if DSP bit is not set");
                        INSTR( CE_NOP                                             , ALU_NOP                                                   , "---");
                        INSTR( CE_COPY(PKT, R_OFST(1,2*(ftmh_size+7)), C_SIZE(5)), ALU_ADD(REG_OP(1), CNST(ftmh_size), REG_OP(3))         , "Copy PPH 5LSB ; R3 = FTMH-Size + R1");
                    } else {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(3))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
                    }
                    INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))            , ALU_NOP                                                   , "Copy PPH 2MSB");
                    INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB( REG_OP(3), CNST(16), REG_OP(3))                  , "TM-Copy FTMH");
                    INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                   , "TM-Copy FTMH");
                    INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_NOP                                                   , "TM-Copy FTMH");
                } else {
                    INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(1))                                , "Set TPID");
                    INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    if (ftmh_size == 9) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(4))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+3)), C_SIZE(1))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        INSTR( CE_COPY(PKT, C_OFST(2), C_SIZE(1))                   , ALU_NOP                                             , "TM-Copy FTMH");
                    } else if (ftmh_size == 10) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        INSTR( CE_COPY(PKT, C_OFST(4), C_SIZE(2))                   , ALU_NOP                                             , "TM-Copy FTMH");
                    } else if (ftmh_size == 11) {
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR0, -2, C_SIZE(1))             , ALU_NOP                                             , "Copy PPH 2MSB");
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        INSTR( CE_COPY(PKT, C_OFST(6), C_SIZE(3))                   , ALU_NOP                                             , "TM-Copy FTMH");                       
                    } else if (ftmh_size == 12) {
                        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        INSTR( CE_COPY(PKT, C_OFST(8), C_SIZE(4))                   , ALU_NOP                                             , "TM-Copy FTMH");
                    }
                }
            }
            else {
                

                INSTR( CE_NOP                                                                             , ALU_ADD(REG_OP(2), CNST(4), REG_OP(2))                  , "Increase R2 to point to the PPH msb");
                INSTR( CE_NOP                                                                             , ALU_NOP                                                 , "NOP");
                INSTR(CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI)   , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                , "Extract FHEI size , r0 = r3-r2 (pph size)");
                INSTR( CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI)  , ALU_NOP                                                 , "Extract FHEI size");
                INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)    , ALU_SET_IF(FEM, EQ, CNST(3), CNST(3), REG_OP(SZ))       , "extract PPH.FwdHdrOffset , rsz = (fem == 3) ? 3 : rsz");
                INSTR( CE_NOP                                                                             , ALU_SET_IF(FEM, EQ, CNST(5), CNST(5), REG_OP(SZ))       , "---; rsz = (fem == 5) ? 5 : rsz");
                INSTR( CE_NOP                                                                             , ALU_ADD(REG_OP(3), FEM, REG_OP(1))                      , "---; r1 = r3+fem");
                INSTR( CE_NOP                                                                             , ALU_SUB(REG_OP(0), REG_OP(SZ), REG_OP(0))               , "r0 = r0 - rsz as PPH size holds sizes of base, eei ext, learn ext and fhei ext, removes fhei size");
                INSTR( CE_NOP                                                                             , ALU_NOP                                                 , "nop");
                INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(0,-7))                                            , ALU_SET(0x8902, REG_OP(0))                              , "Copy PPH eei and learn;  r0= 0x8902");
                INSTR( CE_READ(PKT, R_OFST(1,28))                                                         , ALU_SET(0x2c, REG_OP(SZ))                               , "Extract Eth type(first attempt 12-13 byte), set rsz=8+14, shifted with 1 bit left - 0x2c;");
                INSTR( CE_READ(PKT, R_OFST(1,36))                                                         , ALU_NOP                                                 , "Extract Eth type(second attempt 16-17 byte);");
                INSTR( CE_NOP                                                                             , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(0x1c), REG_OP(SZ))  , "Compare rsz = (fem == 0x8902) ? 0+14 : rsz;");
                INSTR( CE_FREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0)                                      , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(0x24), REG_OP(SZ))  , "Extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;");
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                                       , ALU_NOP                                                 , "Create FHEI trap code;");
                INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                                      , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))                     , "Create FHEI trap code qaulifier , r3=fem+rsz");
                INSTR( CE_COPY(PKT, R_OFST(2,14), C_SIZE(5))                                              , ALU_NOP                                                 , "Copy 5 LSB bytes from PPH , ---");
                INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))                                            , ALU_NOP                                                 , "Copy second byte of PPH from R3 , ---");
                INSTR( CE_LCOPY(PKT, R_OFST(2,2), C_SIZE(1), LFEM_OAM_TS_CCM_FHEI)                        , ALU_NOP                                                 , "Copy PPH base first byte , ---");
                INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))                                             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                 , "Copy FTMH , r2 = r2 - 16");
                INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))                                          , ALU_NOP                                                 , "Copy FTMH , ---");
                INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))                                             , ALU_NOP                                                 , "Copy FTMH , ---");

            }


            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_READ(PKT, R_OFST(2,4))                              , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                 , "extract PPH.FwdHdrOffset         ; RSZ = R3 - R2");
        INSTR( CE_NOP                                                 , ALU_NOP                                                   , "---                              ; ---");
        INSTR( CE_NOP                                                 , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0))     , "---                              ; R0 = PPH.FwdHdrOffset - user_header_size");
        INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))                  , "---                              ; RSZ -= 2");

        
        INSTR( CE_LREAD(PKT, R_OFST(1,4), LFEM_ZERO_BIT12_TO_BIT13)   , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                  , "Read FTMH OAM-TS, set subtype=1  ; R3 -= 8");
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, 0))               , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "PP-Copy from R3 with size RSZ    ; RSZ -= 16");
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ,-8))               , ALU_SUB(FEM, CNST(0) , REG_OP(1))                         , "PP-Copy from R3 with size RSZ    ; R1 = FEM - FTMH OAM-TS subtype=1");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))              , ALU_NOP                                                   , "PP-Copy from R3 with size RSZ    ; ---");

        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                , ALU_NOP                                                   , "Copy PPH.FwdHdrOffset            ; ---");

        INSTR( CE_COPY(PKT, R_OFST(2,0), C_SIZE(4))                   , ALU_SUB( REG_OP(2) , CNST(6) , REG_OP(2))                , "Copy system headers with R2       ; R2 -= 6");
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                , ALU_NOP                                                   , "Set updated FTMH OAM-TS subtype  ; ---");

        
        for (i = 0; i < 5; i++) {                                                                                                    
            INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))                   , ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2))                , "Copy with R2                     ; R2 -= 16");
            INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))                , ALU_NOP                                                   , "Copy with R2                     ; ---");
        }                                                                                                                           

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_READ(PKT, R_OFST(2,4))                      , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                 , "extract PPH.FwdHdrOffset  ; RSZ = R3 - R2");
        INSTR( CE_NOP                                         , ALU_NOP                                                   , "---                      ; ---");
        INSTR( CE_NOP                                         , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0))     , "---                      ; R0 = PPH.FwdHdrOffset - user_header_size");
        INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))                  , "---                      ; RSZ -= 2");

        
        INSTR( CE_NOP                                         , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                  , "---                      ; R3 -= 8");
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, 0))       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "PP-Copy from R3 with size RSZ ; RSZ -= 16");
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ,-8))       , ALU_NOP                                                   , "PP-Copy from R3 with size RSZ ; ---");
        INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(SZ,0))      , ALU_NOP                                                   ,"PP-Copy from R3 with size RSZ ; ---");

        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))        , ALU_NOP                                                   , "Copy PPH.FwdHdrOffset    ; ---");

        
        for (i = 0; i < 5; i++) {                                                                                                    
            INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))           , ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2))                , "PP-Copy with R2          ; R2 -= 16");
            INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))        , ALU_NOP                                                   , "PP-Copy with R2          ; ---");
        }                                                                                                                           

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        if (customer_ftmh_dsp_extension_add) {
            ftmh_size += 2;
        }
        
        fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
            INSTR(CE_FLCOPY(PrgeDataFieldProgVar, 0, C_SIZE(0), LFEM_8_LSBS), ALU_ADD(REG_OP(3), CNST(0), REG_OP(0)), "0. Get prg variable, R0=R3+ (2 labels)");
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_8_LSBS), ALU_SET(2, REG_OP(SZ)),            "1. Get trap code, RSZ=2");     
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2; 
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_ADD(FEM, CNST(0), REG_OP(2)), "2. Get PPH.forward-header-offset, R2=prg variable");
            INSTR(CE_NOP,                                            ALU_ADD(FEM, CNST(0), REG_OP(1)),          "3. R1= trap code");
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;
            INSTR(CE_NOP,                                            ALU_ADD(FEM, REG_OP(0), REG_OP(0)),        "4. R0= forward-header-offset + 2 labels + R3");
            INSTR(CE_NOP,                                            ALU_SET_IF(REG_OP(1), EQ, REG_OP(2), CNST(0), REG_OP(SZ)), "5. if trap code==42, RSZ=0");
            
            
            
            INSTR(CE_COPY(PKT, R_OFST(0, 4), C_SIZE(1)),             ALU_ADD(REG_OP(0), CNST(36), REG_OP(1)),   "6. build End TLV(value = 0), R1=R0+36,");
            INSTR(CE_LCOPY(PKT,R_OFST(0, 2), C_SIZE(0), LFEM_8_LSBS),ALU_ADD(REG_OP(0), CNST(28), REG_OP(1)),   "7: Get function Type, R1=R0+28");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(8)),             ALU_SET(12, REG_OP(2)),                    "8: copy TxFcb and RxFcf, R2=0x000c");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(CNST(54), FEM, REG_OP(2)),         "9: copy TxFcf, R2=56-Function Type");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_ADD(REG_OP(0), CNST(40), REG_OP(1)),   "10: Built flags and TLV offset");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_NOP,                                   "11: copy MEL + Version + OpCode");

            
            INSTR(CE_LCOPY(PKT, R_OFST(0, 0), C_SIZE(0), LFEM_STACKING_8), ALU_NOP,                             "12: Get GAL 16LSB to FEM");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(SZ), REG_OP(SZ), REG_OP(2)),"13: R1 = GAL size");
            INSTR(CE_NOP,                                            ALU_SUB(FEM, CNST(0x1000), REG_OP(1)),     "14: Recover label to 13(1731)");
            
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_NOP,                                   "15: copy ACH from PDU[40]");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0)),        ALU_ADD(REG_OP(2), CNST(8), REG_OP(2)),    "16: build GAL 16 LSB if exist, R2=GAL size + 8");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), R_SIZE(SZ,0)),          ALU_SUB(REG_OP(0), CNST(4), REG_OP(1)),    "17: copy GAL 16 MSB if exist");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(2), REG_OP(2), REG_OP(2)),  "18: forward header offset << 1 ");
            
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2;
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(REG_OP(3), CNST(fld_val+8), REG_OP(1)), "19: copy LSP/PWE, R1= R3-(fld_val + 8)");

            
            
            INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(8)),             ALU_SUB(REG_OP(3), CNST(fld_val+16), REG_OP(1)),"21: copy first 8Bytes from offset=R3");
            INSTR(CE_COPY(PKT, R_OFST(3, -16), R_SIZE(1, 0)),        ALU_NOP,                                   "22: NOP");
            INSTR(CE_COPY(PKT, R_OFST(3, -32), R_SIZE(1, 0)),        ALU_NOP,                                   "23: copy reset part");
            
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1)),           ALU_NOP,                                   "24: Built new forward header offset");
            
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 1;
            INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),       ALU_NOP,                                   "25: copy system header");
            fld_val = fld_val - 8;
            if (fld_val <= 8) {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "26: copy system header");
            } else {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),   ALU_NOP,                                   "26: copy system header");
                fld_val = fld_val - 8;
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "27: copy system header");
            }         
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        if (customer_ftmh_dsp_extension_add) {
            ftmh_size += 2;
        }
        
        fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
            INSTR(CE_FLCOPY(PrgeDataFieldProgVar, 0, C_SIZE(0), LFEM_8_LSBS), ALU_ADD(REG_OP(3), CNST(0), REG_OP(0)), "0. Get prg variable, R0=R3+ (2 labels)");
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_8_LSBS), ALU_SET(2, REG_OP(SZ)),            "1. Get trap code, RSZ=2");     
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2; 
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_ADD(FEM, CNST(0), REG_OP(2)), "2. Get PPH.forward-header-offset, R2=prg variable");
            INSTR(CE_NOP,                                            ALU_ADD(FEM, CNST(0), REG_OP(1)),          "3. R1= trap code");
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;
            INSTR(CE_NOP,                                            ALU_ADD(FEM, REG_OP(0), REG_OP(0)),        "4. R0= forward-header-offset + 2 labels + R3");
            INSTR(CE_NOP,                                            ALU_SET_IF(REG_OP(1), EQ, REG_OP(2), CNST(0), REG_OP(SZ)), "5. if trap code==42, RSZ=0");
            
            
            
            INSTR(CE_COPY(PKT, R_OFST(0, 4), C_SIZE(1)),             ALU_ADD(REG_OP(0), CNST(36), REG_OP(1)),   "6. build End TLV(value = 0), R1=R0+36,");
            INSTR(CE_LCOPY(PKT,R_OFST(0, 2), C_SIZE(0), LFEM_8_LSBS),ALU_ADD(REG_OP(0), CNST(28), REG_OP(1)),   "7: Get function Type, R1=R0+28");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(8)),             ALU_SET(12, REG_OP(2)),                    "8: copy TxFcb and RxFcf, R2=0x000c");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(CNST(54), FEM, REG_OP(2)),         "9: copy TxFcf, R2=56-Function Type");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_ADD(REG_OP(0), CNST(40), REG_OP(1)),   "10: Built flags and TLV offset");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_NOP,                                   "11: copy MEL + Version + OpCode");

            
            INSTR(CE_LCOPY(PKT, R_OFST(0, 0), C_SIZE(0), LFEM_STACKING_8), ALU_NOP,                             "12: Get GAL 16LSB to FEM");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(SZ), REG_OP(SZ), REG_OP(2)),"13: R1 = GAL size");
            INSTR(CE_NOP,                                            ALU_SUB(FEM, CNST(0x1000), REG_OP(1)),     "14: Recover label to 13(1731)");
            
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_NOP,                                   "15: copy ACH from PDU[40]");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0)),        ALU_ADD(REG_OP(2), CNST(8), REG_OP(2)),    "16: build GAL 16 LSB if exist, R2=GAL size + 8");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), R_SIZE(SZ,0)),          ALU_SUB(REG_OP(0), CNST(4), REG_OP(1)),    "17: copy GAL 16 MSB if exist");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(2), REG_OP(2), REG_OP(2)),  "18: forward header offset << 1 ");
            
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2;
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(REG_OP(3), CNST(fld_val+8), REG_OP(1)), "19: copy LSP/PWE, R1= R3-(fld_val + 8)");

            
            
            INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(8)),             ALU_SUB(REG_OP(3), CNST(fld_val+16), REG_OP(1)),"21: copy first 8Bytes from offset=R3");
            INSTR(CE_COPY(PKT, R_OFST(3, -16), R_SIZE(1, 0)),        ALU_NOP,                                   "22: NOP");
            INSTR(CE_COPY(PKT, R_OFST(3, -32), R_SIZE(1, 0)),        ALU_NOP,                                   "23: copy reset part");
            
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1)),           ALU_NOP,                                   "24: Built new forward header offset");
            
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 1;
            INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),       ALU_NOP,                                   "25: copy system header");
            fld_val = fld_val - 8;
            if (fld_val <= 8) {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "26: copy system header");
            } else {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),   ALU_NOP,                                   "26: copy system header");
                fld_val = fld_val - 8;
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "27: copy system header");
            }         
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 		{
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        if ((soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "snooped_UPMIP_InLIF_info", 0)) == 1 ) {
             
              INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0))                                  , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))  , "0: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8))                                , ALU_NOP                                   , "1: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0))                                  , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))  , "2: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8))                                , ALU_NOP                                   , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0))                                  , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8))                                , ALU_NOP                                   , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0))                                  , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8))                                , ALU_NOP                                   , "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT)                 , ALU_SET((ftmh_size + 7), REG_OP(0))       , "8: extract DSP_EXT for FTMH size, R0= ftmh size +PPH base size ");
              INSTR(CE_NOP                                                                     , ALU_SET(0, REG_OP(3))                     , "9: NOP. R3=0");
             INSTR(CE_COPY(PKT, C_OFST(0), C_SIZE(user_header_size))                          , ALU_ADD(FEM, REG_OP(0), REG_OP(0))        , "10: place UDH header if present; r0 = R0 + FEM ");
             INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_2_LSBYTES)                             , ALU_NOP                                   , "11: Extract from FTMH 2LSBytes 12'h000,1'b0,FTMH[2:0] ");
             INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, -3, LFEM_4_LSBS)                        , ALU_NOP                                   , "12: Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0");
             INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, 0, LFEM_TDM_CUD_STACKING_EXTRACT_CUD)   , ALU_ADD(FEM, CNST(0), REG_OP(2))          , "13: extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem");
             INSTR(CE_COPY(PKT, R_OFST(0, 0), C_SIZE(3))                                      , ALU_ADD(FEM, CNST(0), REG_OP(1))          , "14: copy OAM-TS(inlif-info) 3LSB r1=fem");
             INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_FTMH_2_BYTES)                               , ALU_ADD(FEM, REG_OP(2), REG_OP(2))        , "15: extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2");
             INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(3))                                      , ALU_NOP                                   , "16: copy OAM-TS(zeros) 3MSB");
             INSTR(CE_FCOPY(PrgeDataFieldOutLif, 0, C_SIZE(2))                                , ALU_ADD(FEM, CNST(0), REG_OP(0))          , "17: add FTMH.DSP extension;");
             INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_FTMH_2_BYTES_PPH_TYPE_2)         , ALU_NOP                                   , "18: {1'b0, out_pp_port[7:0],7'h0 } ");
             INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                                    , ALU_NOP                                   , "19: copy from r2  2 bytes (FTMH 2LSBytes)");
             INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                                    , ALU_ADD(FEM, REG_OP(0), REG_OP(0))        , "20: copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0");
             INSTR(CE_NOP                                                                     , ALU_NOP                                   , "21: NOP");
             INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                                    , ALU_NOP                                   , "22: copy from r0 (FTMH 4th and 5th LSB)");
             INSTR(CE_COPY(PKT, C_OFST(8), C_SIZE(4))                                         , ALU_NOP                                   , "23 copy remaining 4 bytes of FTMH ");

        } else {
            
            if (SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists == 1) {
                
                for (i = 0; i < 4; i++) {
                    INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0))                                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                      , "Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
                    INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8))                                   , ALU_NOP                                                       , "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                }

                 INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_2_LSBYTES)                             , ALU_NOP                                                       , "Extract from FTMH 2LSBytes 12'h000,1'b0,FTMH[2:0] ");
                 INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, -3, LFEM_4_LSBS)                        , ALU_NOP                                                       , "Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0");
                 INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, 0, LFEM_TDM_CUD_STACKING_EXTRACT_CUD)   , ALU_ADD(FEM, CNST(0), REG_OP(2))                              , "extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem");
                 INSTR(CE_COPY(PKT, C_OFST(0), C_SIZE(user_header_size))                          , ALU_ADD(FEM, CNST(0), REG_OP(1))                              , "place UDH header if present ; r1=fem");
                 INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_FTMH_2_BYTES)                               , ALU_ADD(FEM, REG_OP(2), REG_OP(2))                            , "extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2");
                 INSTR(CE_FCOPY(PrgeDataFieldOutLif, 0, C_SIZE(2))                                , ALU_NOP                                                       , "add FTMH.DSP extension;");

                if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode) {
                    INSTR(CE_COPY(PKT, C_OFST(20), C_SIZE(1))                                           , ALU_ADD(FEM, CNST(0), REG_OP(3))                              , "add LB-Key extension; r3=fem");
                    INSTR(CE_NOP                                                                        , ALU_NOP                                                       , "NOP");
                    INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_FTMH_2_BYTES_2)                     , ALU_SUB(REG_OP(3), CNST(0), REG_OP(0))                        , "extract {1'b0, out_pp_port[7:0],7'h0 } ");
                } else {
                    INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_FTMH_2_BYTES_2)                     , ALU_SUB(FEM, CNST(0), REG_OP(0))                              , "extract {1'b0, out_pp_port[7:0],7'h0 } ; r0 = fem");
                }
                
                INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                                           , ALU_NOP                                                       , "copy from r2  2 bytes (FTMH 2LSBytes)");
                INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                                           , ALU_ADD(FEM, REG_OP(0), REG_OP(0))                            , "copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0");
                INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)                                  , ALU_NOP                                                       , "Extract Resolved.Data.tm-port-var (1B)");
                INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                                           , ALU_NOP                                                       , "copy from r0 (FTMH 4th and 5th LSB)");
                INSTR(CE_COPY(PKT, C_OFST(8), C_SIZE(4))                                                , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                             , "copy remaining 4 bytes of FTMH; rsz = fem ");
                INSTR(CE_NOP                                                                            , ALU_NOP                                                       , "NOP");
                INSTR(CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ, 0))                                , ALU_NOP                                                       , "Copy Additional 1B based on the rsz size");

            } else {

                
                for (i = 0; i < 6; i++) {
                    INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0))                                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                      , "Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
                    INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8))                                   , ALU_NOP                                                       , "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                }

                if (SOC_IS_JERICHO(unit)) {
                     INSTR(CE_FLREAD(PrgeDataFieldOutLifMsb, 0, LFEM_OUT_LIF_MSB)                     , ALU_NOP                                                       , "Stamp outlif_msb into low 3bits of FTMH[2:0] ");
                } else {
                     INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_2_LSBYTES)                             , ALU_NOP                                                       , "Extract from FTMH 2LSBytes 12'h000,1'b0,FTMH[2:0] ");				    
                }
                 INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, -3, LFEM_4_LSBS)                        , ALU_NOP                                                       , "Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0");
                 INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, 0, LFEM_TDM_CUD_STACKING_EXTRACT_CUD)   , ALU_ADD(FEM, CNST(0), REG_OP(2))                              , "extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem");
                if (SOC_IS_JERICHO(unit)) {
                     INSTR(CE_COPY(PKT, C_OFST(0), C_SIZE(0))                                         , ALU_ADD(FEM, CNST(0), REG_OP(1))                              , "don't copy user header, since user header is not needed in 2nd pass ; r1=fem");
                } else {
                     INSTR(CE_COPY(PKT, C_OFST(0), C_SIZE(user_header_size))                          , ALU_ADD(FEM, CNST(0), REG_OP(1))                              , "place UDH header if present ; r1=fem");
                }
                 INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_FTMH_2_BYTES)                               , ALU_ADD(FEM, REG_OP(2), REG_OP(2))                            , "extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2");
                 INSTR(CE_FCOPY(PrgeDataFieldOutLif, 0, C_SIZE(2))                                , ALU_NOP                                                       , "add FTMH.DSP extension;");
                 INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_FTMH_2_BYTES_PPH_TYPE_2)         , ALU_NOP                                                       , "extract {1'b0, out_pp_port[7:0],7'h0 } ");
                 INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                                    , ALU_NOP                                                       , "copy from r2  2 bytes (FTMH 2LSBytes)");
                 INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                                    , ALU_ADD(FEM, REG_OP(0), REG_OP(0))                            , "copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0");
                 INSTR(CE_NOP                                                                     , ALU_NOP                                                       , "NOP");
                 INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                                    , ALU_NOP                                                       , "copy from r0 (FTMH 4th and 5th LSB)");
                 INSTR(CE_COPY(PKT, C_OFST(8), C_SIZE(4))                                         , ALU_NOP                                                       , "copy remaining 4 bytes of FTMH ");
            }
        }
        
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        uint8 itmh_programmable = (SOC_IS_JERICHO(unit) && soc_property_get(unit, spn_ITMH_PROGRAMMABLE_MODE_ENABLE, 1));
        bcm_gport_t oam_rcy_port = soc_property_get(unit, spn_OAM_RCY_PORT, -1);

    

        
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     
        INSTR( CE_NOP                       , ALU_SET(0x8902,REG_OP(0))                             , "Extract out pp port ; r0 = 0x8902 ");
        INSTR(CE_READ(PKT, R_OFST(3,28 + (user_header_size*2)))           , ALU_SET(24,REG_OP(SZ))                                , "Extract Eth type(first attempt 13-14 byte), set rsz=8+16 ");
        INSTR(CE_READ(PKT, R_OFST(3,36 + (user_header_size*2)))           , ALU_SET(oam_rcy_port,REG_OP(1)) , "Extract Eth type(second attempt 17-18 byte); r1 = oam_rcy_port");
        INSTR(CE_FREAD(PrgeDataFieldOutPpPort, 0)                         , ALU_SET_IF(REG_OP(0), EQ, FEM, CNST(16), REG_OP(SZ))  , "Extract out pp port ; compare rsz = (fem == 0x8902) ? 16 : rsz; ");
        INSTR(CE_LREAD(PKT, R_OFST(2,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET) , ALU_SET_IF(REG_OP(0), EQ, FEM, CNST(20), REG_OP(SZ))  , "copy fwd offset, rsz = (fem == 0x8902)? (16+4):rsz");

        if (itmh_programmable) {
            INSTR(CE_LREAD(PKT, C_OFST(11), LFEM_OAM_LOOPBACK_EXTRACT_TC_JER) ,       ALU_JMP_IF(FEM, NEQ, REG_OP(1), BRANCH_OAM_LB_UP, JUMP_POINT_OAM_LB_UP)  , "extract TC and DP ; ");
        } else {
            INSTR(CE_LREAD(PKT, C_OFST(11), LFEM_OAM_LOOPBACK_EXTRACT_TC)     , ALU_JMP_IF(FEM, NEQ, REG_OP(1), BRANCH_OAM_LB_UP, JUMP_POINT_OAM_LB_UP)       , "extract TC and DP ; ");
        }
        INSTR(CE_NOP                                                      , ALU_ADD(FEM       , REG_OP(SZ)   , REG_OP(SZ))        , "recalculate the pph fwrd offset rsz=fem+rsz");
        INSTR(CE_NOP                                                      , ALU_SUB(FEM ,CNST(0), REG_OP(0))                      , "load r0 with fem -> tc, dp and fwd-dest-info[19:16]=(4'b1100)");
        INSTR(CE_NOP                                                      , ALU_SUB(CNST(24 + user_header_size), REG_OP(SZ) , REG_OP(1))   , " r1 = 24 - rsz (24-bytes to remove)");
        INSTR(CE_NOP                        , ALU_ADD(REG_OP(3), CNST(24 + user_header_size), REG_OP(2))    , " (no jump) r2 = 24 + r3");
        INSTR(CE_NOP                                                     , ALU_SUB(REG_OP(SZ), CNST(1)   , REG_OP(SZ))            , "sz = rsz - 1");
     
        INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_SUB(REG_OP(1), CNST(16)   , REG_OP(1))             , "Copy NWK LSB , r1 = r1 - 16");
        INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_ADD(REG_OP(3), REG_OP(SZ)   , REG_OP(2))           , "Copy NWK LSB , r2 = r3 + rsz");
        INSTR(CE_COPY(PKT, R_OFST(2,-48), R_SIZE(1,-8))                , ALU_SUB(REG_OP(SZ), CNST(12 + user_header_size), REG_OP(1)) , "Copy NWK LSB , r1 = rsz - 12");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))               , ALU_NOP              , "(no jump )Set 1731.OpCode");
        INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_NOP              , "Copy NWK MSB");
        INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_NOP              , "Copy NWK MSB");
        INSTR(CE_COPY(PKT, R_OFST(3,12 + (user_header_size * 2)), C_SIZE(6)) , ALU_NOP          , "Copy DA");
        INSTR(CE_COPY(PKT, R_OFST(3,24 + (user_header_size * 2)), C_SIZE(6)) , ALU_NOP          , "Copy SA");
        INSTR(CE_COPY(PKT, R_OFST(3, 0 + (user_header_size * 2)), C_SIZE(user_header_size)) , ALU_NOP  , "Copy UDH");
        if (itmh_programmable) {
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))                , ALU_NOP              , "Copy ITMH MSB 1st LSByte");
        }
        INSTR(CE_FCOPY(PrgeDataFieldSrcSysPort, 0, C_SIZE(2))            , ALU_NOP              , "extract lag id ; ");
        if (itmh_programmable) {
            INSTR(CE_FCOPY(PrgeDataFieldR0, -2, C_SIZE(1))                , ALU_NOP              , "Copy ITMH MSB 1st LSByte");
        } else {
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                 , ALU_NOP              , "Copy ITMH MSB 1st LSByte");
        }
  
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_OAM_LB_UP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_OAM_LB_UP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        

        
        INSTR(CE_NOP                                                      , ALU_SET (SOC_PPC_OAM_ETHERNET_PDU_OPCODE_LBR, REG_OP(0))    , "r0= LBR opcode");

        INSTR(CE_NOP                                                      , ALU_ADD(REG_OP(3), CNST(24 + user_header_size), REG_OP(2))    , "r2 = 24 + r3");
        INSTR(CE_NOP                                                     , ALU_SUB(REG_OP(SZ), CNST(1)   , REG_OP(SZ))            , "sz = rsz - 1");
        INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_SUB(REG_OP(1), CNST(16)   , REG_OP(1))             , "Copy NWK LSB , r1 = r1 - 16");
        INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_ADD(REG_OP(3), REG_OP(SZ)   , REG_OP(2))           , "Copy NWK LSB , r2 = r3 + rsz");
        INSTR(CE_COPY(PKT, R_OFST(2,-48), R_SIZE(1,-8))                , ALU_SUB(REG_OP(SZ), CNST(12 + user_header_size), REG_OP(1)) , "Copy NWK LSB , r1 = rsz - 12");
        INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_8_LSBS)                   , ALU_SET (0xf000, REG_OP(0))    , "r0= MSB ptch");    
        INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))               , ALU_NOP              , "Set LBR OpCode");
        INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_ADD(FEM       , REG_OP(0)   , REG_OP(0))              , "Copy NWK MSB; R0=out pp port + MSB ptch ");
        INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_NOP              , "Copy NWK MSB");
        INSTR(CE_COPY(PKT, R_OFST(3,12 + (user_header_size * 2)), C_SIZE(6)) , ALU_SET(0xd0, REG_OP(2))          , "Copy DA; R2= msb of PTCH");
        INSTR(CE_COPY(PKT, R_OFST(3,24 + (user_header_size * 2)), C_SIZE(6)) , ALU_NOP          , "Copy SA");
        INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))               , ALU_NOP              , "Set PTCH");
      
    
        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }


    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_WA);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
            INSTR(CE_NOP                                                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(SZ)), "R=0 if COE is not enable");
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(0))                  ,  "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))  , ALU_SUB(REG_OP(3), CNST(4), REG_OP(3)),   "Copy  OAM counter, decrease R3 by 4");
            
            if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "coe_tag_mapping_mode", 0)) {
                INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC), ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), "R=0 if COE is not enable");
            } else {
                INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(0), LFEM_COE_TAG_TC_DP), ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), "R=0 if COE is not enable");
            }
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_1)      ,ALU_NOP,                                   "4: extract TC/DP set indication");
            INSTR(CE_NOP                                                ,ALU_ADD(FEM, CNST(0), REG_OP(1)),          "5: ");
            INSTR(CE_FLREAD(PrgeDataFieldPpPortVar, 0, LFEM_12_LSBS)    ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)), "6: ");
            INSTR(CE_NOP                                                ,ALU_NOP,                                   "7: ");
            INSTR(CE_NOP                                                ,ALU_ADD(FEM, REG_OP(1), REG_OP(1)),        "8: Calc the COE_TAG.16LSB");

            INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0))            , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
            INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8))          , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),"Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            for (i = 0; i < 5; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -16))       , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),  "");
                INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),"");
            }
            
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(0, 0))            , ALU_NOP,                                  "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0))     , ALU_NOP,                                  "Copy Program-Variable(2bytes) only if R0 == 2 ");            
            INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6))                   , ALU_NOP,                                  ""); 
            INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))                   , ALU_NOP,                                  ""); 

        } else {
            INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4)) , ALU_SUB(REG_OP(3), CNST(4), REG_OP(3)),  "Copy  OAM counter, decrease R3 by 4");
            INSTR( CE_NOP                                               , ALU_NOP                               ,  "NOP Instruction");

            
            for (i = 0; i < 13; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))       , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))    , "copy the remaining of enc and link layer");
                INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(3,-8) )   , ALU_NOP                                    , "copy the remaining of enc and link layer");
            }
        }
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGR_INJECTION_OPCODE);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
            
            INSTR(CE_NOP,                                                   ALU_SET(0x8902, REG_OP(2)),           "0: NOP");
            INSTR(CE_COPY(GEN, R_OFST(3, -12), C_SIZE(0)),                  ALU_SET(8, REG_OP(SZ)),               "1: R1 = offset from R3 for OPcode");
            INSTR(CE_NOP,                                                   ALU_NOP,                                    "2: NOP");
            INSTR(CE_NOP,                                                   ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(4), REG_OP(SZ)), "3: NOP");
            INSTR(CE_NOP,                                                   ALU_NOP,                                    "4: NOP");
            
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS),        ALU_SET(2, REG_OP(1)),                      "5:");       
            INSTR(CE_NOP,                                                   ALU_SUB(REG_OP(3), REG_OP(SZ), REG_OP(0)),  "6: R0 = position of OPCODE");
            INSTR(CE_NOP,                                                   ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)), "7: R1=0 if COE is not enable");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, 0)),                ALU_SUB(REG_OP(0), CNST(2), REG_OP(3)),    "8: Copy reset of header");
            INSTR(CE_LCOPY(GEN, R_OFST(0,0), C_SIZE(2), LFEM_OAM_EGR_INJ_OPCODE), ALU_NOP,                              "9: Copy new OPcode");
            INSTR(CE_NOP,                                                   ALU_SUB(REG_OP(3), CNST(12), REG_OP(SZ)),   "10: R1=0 if COE is not enable");
            INSTR(CE_NOP,                                                   ALU_NOP,                                    "11: ");

            INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)),               ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),   "12: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
            INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),             ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),  "13: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            for (i = 0; i < 5; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -16)),          ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),    "");
                INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)),           ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)),  "");
            }
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(1, 0)),        ALU_NOP,                                    "24: Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(1, 0)),        ALU_NOP,                                    "25: Copy Program-Variable(2bytes) only if R0 == 2 ");            
            INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)),                      ALU_NOP,                                    "26: "); 
            INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)),                      ALU_NOP,                                    "27: "); 
        } else {
            
            INSTR(CE_NOP,                                                   ALU_SET(0x8902, REG_OP(2)),           " NOP");
            INSTR(CE_COPY(GEN, R_OFST(3, -12), C_SIZE(0)),                  ALU_SET(8, REG_OP(1)),                " R1 = offset from R3 for OPcode");
            INSTR(CE_NOP,                                                   ALU_NOP,                                    " NOP");
            INSTR(CE_NOP,                                                   ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(4), REG_OP(1)), " NOP");
            INSTR(CE_NOP,                                                   ALU_NOP,                                    " NOP");
            
            INSTR(CE_NOP,                                                   ALU_SUB(REG_OP(3), REG_OP(1), REG_OP(0)),   " R0 = position of OPCODE");
            INSTR(CE_NOP,                                                   ALU_NOP,                                    " NOP");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(1, 0)),                 ALU_SUB(REG_OP(0), CNST(2), REG_OP(3)),    " Copy reset of header");
            INSTR(CE_LCOPY(GEN, R_OFST(0,0), C_SIZE(2), LFEM_OAM_EGR_INJ_OPCODE), ALU_NOP,                              " Copy new OPcode");

            for (i = 0; i < 5; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0)),             ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),    "copy the remaining of enc and link layer");
                INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ),           ALU_NOP,                                    "copy the remaining of enc and link layer");
            }
        }
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1)) {

            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_3),  ALU_SET(1, REG_OP(SZ)), "For port Extract Resolved.Data.tm-port-var bit 3");

            
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS), ALU_SET(2, REG_OP(2)), "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_NOP                                     , ALU_JMP_IF(FEM, EQ, REG_OP(SZ), BRANCH_OAM_DROP_1ST_ENC, JUMP_POINT_OAM_DROP_1ST_ENC), "Extract FWD_HEADER_OFFSET; Check if bit3 = 1 jump mpls raw ins");
            INSTR(CE_NOP                                     , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                          , " R2 will be 2 if we are pushing coe tag, 0 otherwise");
            INSTR(CE_NOP                                     , ALU_SUB(REG_OP(1),  CNST(12), REG_OP(SZ))                                               , "RSZ=R1-12");
            INSTR(CE_NOP                                     , ALU_NOP                                                                             , "NOP");
            
            for (i = 0; i < 5; i++) { 
                INSTR(CE_COPY(GEN, R_OFST(1, 0),  R_SIZE(SZ, 0)),   ALU_SUB(REG_OP(1),  CNST(16), REG_OP(1)), "Copy 8B from offset R1, Size RSZ; ALU: R1 = R1-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(SZ, -8)),  ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R1-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                INSTR(CE_NOP                                 , ALU_NOP                              , "NOP");
            }
            INSTR(CE_COPY(GEN, R_OFST(1, 0),  R_SIZE(SZ, 0))       , ALU_SUB(REG_OP(1)                     , CNST(16), REG_OP(1)), "Copy 8B from offset R1, Size RSZ; ALU: R1 = R1-16 (calc next generated reference)");

            
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0)), ALU_NOP, "Copy PP-Port-Variable(2bytes) only if R2 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(2, 0)), ALU_NOP, "Copy Program-Variable(2bytes) only if R2 == 2 ");

            
            INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
            INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");

            
            INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");
        } else if (SOC_IS_JERICHO(unit) && !(SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) && ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2)) {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_3) , ALU_SET(1, REG_OP(SZ)), "For port Extract Resolved.Data.tm-port-var bit 3");
            
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS), ALU_SET(2, REG_OP(2)), "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_NOP                                     , ALU_JMP_IF(FEM, EQ,REG_OP(SZ), BRANCH_OAM_DROP_1ST_ENC, JUMP_POINT_OAM_DROP_1ST_ENC), "Extract FWD_HEADER_OFFSET; Check if bit3 = 1 jump mpls raw ins");
            INSTR(CE_NOP                                     , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "R2 will be 2 if we are pushing coe tag, 0 otherwise");
            INSTR(CE_NOP                                     , ALU_SUB(REG_OP(1),  CNST(12), REG_OP(SZ))                                              , "RSZ=R1-12");
            INSTR(CE_NOP                                     , ALU_NOP                                                                            , "NOP");

            for (i = 0; i < 6; i++) { 
                INSTR(CE_COPY(GEN, R_OFST(1, 0),  R_SIZE(SZ, 0)),   ALU_SUB(REG_OP(1),  CNST(16), REG_OP(1)), "Copy 8B from offset R1, Size RSZ; ALU: R1 = R1-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R1-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                INSTR(CE_NOP, ALU_NOP, "NOP");
            }

            
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0)), ALU_NOP, "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(2, 0)), ALU_NOP, "Copy Program-Variable(2bytes) only if R0 == 2 ");

            
            INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
            
            INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");
        } else {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_3), ALU_SET(1, REG_OP(SZ)), "For port Extract Resolved.Data.tm-port-var bit 3");
            
            INSTR(CE_NOP                                   , ALU_NOP             , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_NOP                                   , ALU_JMP_IF(FEM, EQ, REG_OP(SZ), BRANCH_OAM_DROP_1ST_ENC, JUMP_POINT_OAM_DROP_1ST_ENC)	  , "Extract FWD_HEADER_OFFSET; Check if bit3 = 1 jump mpls raw ins");
            INSTR(CE_NOP                                   , ALU_NOP                 , "NOP");
            INSTR(CE_NOP                                   , ALU_NOP                 , "NOP");
            INSTR(CE_NOP                                   , ALU_NOP                 , "NOP");
            
            for (i = 0; i < 10; i++) {                                                                              
                INSTR( CE_COPY(GEN, R_OFST(1,0), R_SIZE(1,0))     , ALU_SUB( REG_OP(1) , CNST(16) , REG_OP(1))         , "PP-Copy with R1; R1 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(1,-16), R_SIZE(1,-8))  , ALU_NOP                                            , "PP-Copy with R1");
            }                                                                                                       
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_OAM_DROP_1ST_ENC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_OAM_DROP_1ST_ENC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        INSTR(CE_NOP, ALU_SUB(REG_OP(1),  REG_OP(0), REG_OP(SZ)), "RSZ=R1-R0");
        INSTR(CE_NOP, ALU_NOP                               , "NOP");

        for (i = 0; i < 6; i++) { 
              INSTR(CE_COPY(GEN, R_OFST(1, 0),  R_SIZE(SZ, 0))  , ALU_SUB(REG_OP(1),  CNST(16), REG_OP(1)), "Copy 8B from offset R1, Size RSZ; ALU: R1 = R1-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(SZ, -8)) , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R1-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
              INSTR(CE_NOP                                 , ALU_NOP                              , "NOP");
        }

       res = arad_egr_prge_mgmt_build_branch_end(unit);
       SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    
    else { 
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            
            fld_val = 0x24;
            SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  90,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_IPV4_SIZE_WITH_GRE_8_KEYr, SOC_CORE_ALL, 0, IPV4_SIZE_WITH_GRE_8_KEYf,  fld_val)); 
            
            fld_val = 0x11;
            SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  100,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_IP_PROTOCOL_GREr, SOC_CORE_ALL, 0, IP_PROTOCOL_GREf,  fld_val)); 

            
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0xF0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = (4*8)/4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0xE0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 24;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0xD0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x10; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 20;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0xC0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0xB0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 3; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0xEE; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 127; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 128; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 55; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 119; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 128; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0; 
            prge_instruction_tbl_data.offset_base     = 20; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 40; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 24; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; 
            prge_instruction_tbl_data.offset_base     = 1; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0x12; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0x2; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x1; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; 
            prge_instruction_tbl_data.offset_base     = 0x0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x0; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xf0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x18;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;

            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xe0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x10;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
        }
    }

    if (SOC_IS_QAX(unit)) {
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) { 
            ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
            SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

            
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT) , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))                     , "0: Extract DSP; R2 -= 8");
            INSTR( CE_READ(GEN, R_OFST(2,-48))                                 , ALU_NOP                                                   , "1: FEM=GEN.checksum");
            INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_BIT_2_M_6)                   , ALU_ADD(FEM, CNST(ftmh_size), REG_OP(3))                  , "2: Extract OAM_TS; R3=ftmh_size + dsp_ext size");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(6))              , ALU_SUB(FEM, CNST(0), REG_OP(1))                          , "3: Copy EES_DATA1[55:7]; R1=checksum(cs0)");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(2))               , ALU_ADD(FEM, REG_OP(3), REG_OP(3))                        , "4: Cooy prog_var[31:16]; R3+=oam_ts size(points to PPH)");
            INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)                  , ALU_NOP                                                   , "5: Extract MSB of cs0");
            INSTR( CE_LREAD(PKT, R_OFST(3,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_NOP                                                    , "6: FEM=fwd_header_offset");
            INSTR( CE_LREAD(PKT, R_OFST(3,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_SUB(FEM, CNST(0), REG_OP(3))                           , "7: FEM=fwd_header_offset; R3=MSB(cs0)");
            INSTR( CE_COPY(GEN, R_OFST(2,0), C_SIZE(4))                        , ALU_SUB(REG_OP(1), FEM, REG_OP(1))                        , "8: Copy GRE[31:0]; R1-=fwd_header_offset(cs1)");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(4))                , ALU_SUB(FEM, CNST(0), REG_OP(0))                          , "9: Copy prog_var[31:0]; R0=fwd_header_offset");
            INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)                  , ALU_NOP                                                   , "10:FEM=MSB(cs1)");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), C_SIZE(8))                      , ALU_SUB(REG_OP(2), CNST(18), REG_OP(2))                   , "11:Copy SIP/DIP; R2-=18(points to IP.protocol)");
            INSTR( CE_NOP                                                      , ALU_SUB(REG_OP(1), FEM, REG_OP(1))                        , "12:R1-=MSB(cs1)(cs2)");
            INSTR( CE_READ(GEN, R_OFST(2,-12))                                 , ALU_SUB(REG_OP(1), CNST(0), REG_OP(3))                    , "13:FEM=IP.total_len; R3=cs1");
            INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)            , ALU_SET_IF(REG_OP(3), EQ, CNST(0x0), REG_OP(1), REG_OP(3)), "14:FEM=LSB(tm_port_var); If (MSB(cs0)==0) R3=cs2");
            INSTR( CE_NOP                                                      , ALU_ADD(FEM, REG_OP(0), REG_OP(3))                        , "15:R3=IP.total_len-fwd_header_offset");
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                     , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                         , "16:Copy R3(checksum); Rsz=LSB(tm_port_var)");
            INSTR( CE_COPY(GEN, R_OFST(2,0), C_SIZE(6))                        , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))                    , "17:Copy IP Byte2~Byte7; R2-=8(points to DSCP)");
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                     , ALU_NOP                                                   , "18:Copy R3(total_len)");
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))                      , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                   , "19:Copy reset of IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))                   , ALU_NOP                                                   , "20:Copy LL");
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))                      , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                   , "21:Copy LL");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))                   , ALU_NOP                                                   , "22:Copy LL");
            INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ, 0))          , ALU_NOP                                                   , "23:If (LSB(tm_port_var)) is set, copy out_pp_port");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
        }  
    }
    else {
        
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
            SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

            
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(6))     , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2)) , "0: Copy EES_DATA1[55:7]; R2-=8");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(2))      , ALU_NOP                                , "1: Copy prog_var[31:16]");
            INSTR( CE_COPY(GEN, R_OFST(2,0), C_SIZE(4))               , ALU_SUB(REG_OP(2), CNST(8), REG_OP(2)) , "2: Copy GRE[31:0]; R2-=8");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(4))       , ALU_NOP                                , "3: Copy prog_var[31:0]");
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "4: Copy SIP/DIP");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))          , ALU_NOP                                , "5: Copy IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "6: Copy IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))          , ALU_NOP                                , "7: Copy IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "8: Copy IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))          , ALU_NOP                                , "9: Copy IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "10:Copy IP/LL");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))          , ALU_NOP                                , "11:Copy IP/LL");
            INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)   , ALU_NOP                                , "12:FEM=LSB(tm_port_var)");
            INSTR( CE_NOP                                             , ALU_NOP                                , "13:NOP");
            INSTR( CE_NOP                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))      , "14:Rsz=LSB(tm_port_var)");
            INSTR( CE_NOP                                             , ALU_NOP                                , "15:NOP");
            INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ, 0)), ALU_NOP                                 , "16:If (LSB(tm_port_var)) is set, copy out_pp_port");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
        }  
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        int mc_support = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "erspan_mc_support", 0) ;
        res = arad_sw_db_eg_encap_prge_tbl_nof_dynamic_entries_get(unit, &nof_dynamic_members);
        SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (mc_support) {
             INSTR(CE_FLREAD(PrgeDataFieldVsiVar, 0, LFEM_4_LSBS)           , ALU_NOP                                            , "extract vsi variable[3:0]; ---");
        } else {
             INSTR(CE_LREAD(PKT, C_OFST(17), LFEM_4_LSBS)                   , ALU_NOP                                            , "extract FTMH.Outlif; ---");
        }
        
        if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
             INSTR(CE_LREAD(GEN, R_OFST(1,-64), LFEM_STACKING_8)            , ALU_SUB(REG_OP(1), CNST(8), REG_OP(1))              , "extract Ip header total length; r1=r1-8");
        } else {
             INSTR(CE_LREAD(GEN, R_OFST(1,-48), LFEM_STACKING_8)            , ALU_NOP                                             , "Read Ip header total length; ---");
        }
        
         INSTR(CE_NOP                                                       , ALU_ADD(FEM, CNST(nof_dynamic_members), REG_OP(0))  , "---; r0=fem+nof_dynamic_members");
         INSTR(CE_LREAD(GEN, R_OFST(1,-32), LFEM_STACKING_8)                , ALU_SUB(FEM, CNST(user_header_size), REG_OP(SZ))    , "extract checksum; rsz=fem-udh");
         INSTR(CE_NOP                                                       , ALU_SUB(REG_OP(0), CNST(0), DATA_ADDR)              , "---; data_addr=r0");
         INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)           , ALU_ADD(FEM, CNST(user_header_size), REG_OP(3))     , "extract network header size; r3=fem-udh");
         INSTR(CE_FLREAD(PrgeDataFieldDataMemoryEntry, -16, LFEM_STACKING_8), ALU_ADD(REG_OP(0), CNST(16), DATA_ADDR)             , "extract header size; data_addr=r0+16");
         INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)           , ALU_SUB(REG_OP(3), FEM, REG_OP(2))                  , "extract network header size; r2=r3-fem");
         INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(8))         , ALU_NOP                                             , "copy erspan header; ---");
         INSTR(CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)                   , ALU_ADD(FEM, REG_OP(SZ), REG_OP(0))                 , "extract msb of r2; r0=fem+rsz");
         INSTR(CE_FLREAD(PrgeDataFieldDataMemoryEntry, -16, LFEM_STACKING_8), ALU_NOP                                             , "extract eth header size; ---");
         INSTR(CE_LREAD(GEN, R_OFST(1,-32), LFEM_IS_LAG)                    , ALU_SUB(REG_OP(2), FEM, REG_OP(3))                  , "extract msb(Gen.checksum); r3=r2-fem");
         INSTR(CE_FLREAD(PrgeDataFieldDataMemoryEntry, -28, LFEM_STACKING_8), ALU_SUB(FEM, CNST(0), REG_OP(SZ))                   , "extract eth size; rsz=fem");
         INSTR(CE_COPY(GEN, R_OFST(1,0), C_SIZE(8))                         , ALU_SET_IF(FEM, EQ, CNST(0x0), REG_OP(3), REG_OP(2)), "copy GRE8 header; (msb(Gen.checksum)== 0x0) ? r2=r3;");
         INSTR(CE_COPY(GEN, R_OFST(1,-16), C_SIZE(8))                       , ALU_ADD(FEM, CNST(0), REG_OP(3))                    , "copy IPv4 Header; r3=fem");
         INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                      , ALU_NOP                                             , "copy IPv4 Header; ---");
         INSTR(CE_COPY(GEN, R_OFST(1,-36), C_SIZE(6))                       , ALU_NOP                                             , "copy IPv4 header; ---");
         INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                      , ALU_NOP                                             , "copy IPv4 header; ---");
         INSTR(CE_COPY(GEN, R_OFST(1,-52), C_SIZE(2))                       , ALU_NOP                                             , "copy IPv4 header; ---");
         INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                      , ALU_NOP                                             , "copy IPv4 Header; ---");
         INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(8))         , ALU_NOP                                             , "copy eth header; ---");
         INSTR(CE_FCOPY(PrgeDataFieldDataMemoryEntry, -16, R_SIZE(SZ, -8))  , ALU_NOP                                             , "copy eth header; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }
  
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) { 

        
        res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_STACKING, &branch_pointer);
        SOC_SAND_IF_ERR_EXIT(res);

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 9;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; 
        prge_instruction_tbl_data.offset_base     = 53; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = (entry==entry_odd) ? 1 : 0; 
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xE0; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
    

    
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0; 
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                        entry==entry_odd);
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8,
            mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
    
    
        lfem_stacking_8_index[unit] = prge_instruction_tbl_data.fem_select;
        lfem_stacking_8_map[unit] = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    
    prge_instruction_tbl_data.op_1_field_select = 0; 
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    

    
    mem   = EPNI_PRGE_INSTRUCTION_4m-1;
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
    entry = entry_odd;

    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                        entry==entry_odd);
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10,
            mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
    
    
        lfem_stacking_10_index[unit] = prge_instruction_tbl_data.fem_select;
        lfem_stacking_10_map[unit] = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;

    if (SOC_IS_JERICHO(unit) && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mcid_from_ftmh", 0) == 1)) {
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 18;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    } else {
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 18;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 13;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 54;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 10;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 5;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
#ifdef BCM_88660_A0
        if (SOC_IS_ARADPLUS(unit)) {
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == ARAD_MGMT_FTMH_LB_EXT_MODE_FULL_HASH) ? 1 : 0;
        } else 
#endif 
        {
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
        }
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
		
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
		

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN);
        SOC_SAND_CHECK_FUNC_RESULT(res, 395, exit);

        if (SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists == 2) {
             INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)              , ALU_SET(COE_TYPE_2_TPID, REG_OP(0))          , "Extract tm port var; R0=0x8100");
             INSTR(CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(4))                 , ALU_SET(0x2, REG_OP(1))                      , "Copy RSPAN vlan tag; R1=0x2");
             INSTR(CE_NOP                                                         , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(1)) , "---; If TM-Port-Variable==0, R1=0");
             INSTR(CE_NOP                                                         , ALU_NOP                                      , "---; ---");
             INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(1, 0))              , ALU_NOP                                      , "Copy PP-Port-Variable with size=R1; --- ");
             INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(1, 0))                     , ALU_NOP                                      , "Copy R0 with size=R1; --- ");
             INSTR(CE_COPY(PKT, R_OFST(3, 2 * user_header_size + 24), C_SIZE(6))  , ALU_NOP                                      , "Copy SA; ---");
             INSTR(CE_COPY(PKT, R_OFST(3, 2 * user_header_size + 12), C_SIZE(6))  , ALU_NOP                                      , "Copy DA; ---");
        } else if (SOC_DPP_CONFIG(unit)->pp.pon_application_enable) {
            
             INSTR(CE_COPY(PKT, C_OFST(9), C_SIZE(0) )                            , ALU_SET(4, REG_OP(1))                        , "FEM=FTMH[51:36]; R1=4");
             INSTR(CE_NOP                                                         , ALU_ADD(REG_OP(3), CNST(16+user_header_size), REG_OP(3)), "---; R3+=16+user_header_size");
             INSTR(CE_NOP                                                         , ALU_SET_IF(FEM, GE, CNST(0x400), REG_OP(1), REG_OP(SZ)), "if (FEM>=0x400) (originated from NNI port) Rsz=R1");
             INSTR(CE_NOP                                                         , ALU_NOP                                      , "---; ---");
             INSTR(CE_COPY(PKT, R_OFST(3, 0), R_SIZE(SZ, 0))                      , ALU_SUB(REG_OP(3), REG_OP(SZ), REG_OP(3))    , "Copy from R3 with Rsz bytes; R3 -= Rsz");
             INSTR(CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(4))                 , ALU_SUB(CNST(8), REG_OP(SZ), REG_OP(SZ))     , "Copy RSPAN vlan tag; Rsz = 8 - Rsz");
             INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(8))                          , ALU_NOP                                      , "Copy from R3 with 8 bytes; ---");
             INSTR(CE_COPY(PKT, R_OFST(3, -16), R_SIZE(SZ, 0))                    , ALU_NOP                                      , "Copy from R3 with Rsz bytes; ---");
        } else {
            
            INSTR(CE_FLREAD( PrgeDataFieldEesData1, -10, LFEM_2_LSBS)            , ALU_SET(2, REG_OP(0))                                     , "0: FEM=type; R0=2");
            INSTR(CE_NOP                                                         , ALU_SET(0, REG_OP(1))                                     , "1: R1=0");
            INSTR(CE_NOP                                                         , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                         , "2: Rsz=FEM(type)");
            INSTR(CE_NOP                                                         , ALU_SET(0, REG_OP(2))                                     , "3: R2=0");
            INSTR(CE_NOP                                                         , ALU_SET(1, REG_OP(0))                                     , "4: R0=1");
            INSTR(CE_NOP                                                         , ALU_SET_IF(REG_OP(SZ), EQ, REG_OP(0), CNST(6), REG_OP(2)) , "5: If type==2, R2=6");
            INSTR(CE_NOP                                                         , ALU_SET(0, REG_OP(0))                                     , "6: R0=2");
            INSTR(CE_FCOPY(PrgeDataFieldTod1588, 0, R_SIZE(2, 0))                , ALU_SET_IF(REG_OP(SZ), EQ, REG_OP(0), CNST(6), REG_OP(1)) , "7: Copy 1588 TOD; If type==1, R1=6");
            INSTR(CE_NOP                                                         , ALU_SET_IF(REG_OP(SZ), EQ, REG_OP(0), CNST(2), REG_OP(0)) , "8: If type==0, R0=2");
            INSTR(CE_FCOPY(PrgeDataFieldTodNtp, 0, R_SIZE(1, 0))                 , ALU_NOP                                                   , "9: Copy NTP TOD");
            INSTR(CE_FCOPY(PrgeDataFieldEesData1, -2, R_SIZE(0, 0))              , ALU_NOP                                                   , "10:Copy RSPAN VLAN");
            INSTR(CE_FCOPY(PrgeDataFieldEesData1, -6, C_SIZE(2))                 , ALU_NOP                                                   , "11:Copy TPID");
            INSTR(CE_COPY(PKT, R_OFST(3, 2 * user_header_size + 24), C_SIZE(6))  , ALU_NOP                                                   , "Copy SA; ---");
            INSTR(CE_COPY(PKT, R_OFST(3, 2 * user_header_size + 12), C_SIZE(6))  , ALU_NOP                                                   , "Copy DA; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }



    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;                                        ;
        prge_instruction_tbl_data.offset_base     = 3;  ;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        
        prge_instruction_tbl_data.size_base       = 0x0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 40; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0x0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0x2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        for (i=4; i<8; i++) {
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;

                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 0;
                prge_instruction_tbl_data.offset_src      = 0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 32; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 16; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

        
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_odd;
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            for(i = 0; i<6 ; i++)
            {
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 1;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2 ;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
                prge_instruction_tbl_data.op_value    = 16;
                prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action  = 0;
                prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7 ;
                prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
                
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 1;
                prge_instruction_tbl_data.offset_base     = 0xF0;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2 ;
                prge_instruction_tbl_data.size_base     = 0x18;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action  = 0;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
            }
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 43;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 39;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }


    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
           int mc_support = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "erspan_mc_support", 0) ;
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_odd;
            
           
           res = arad_sw_db_eg_encap_prge_tbl_nof_dynamic_entries_get(unit, &nof_dynamic_members);
           SOC_SAND_CHECK_FUNC_RESULT(res, 376, exit);


            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
           prge_instruction_tbl_data.src_select      = (mc_support)? 2: 0;
          prge_instruction_tbl_data.offset_base     = (mc_support)? 65: 17; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2 : 0;
            prge_instruction_tbl_data.offset_base     = (mc_support)?65 : 17; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members; 
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members + 16; 
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1 ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x1E;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x16;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 0xFF;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 59;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 55;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 39;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_even;

           
           prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
           prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_ACE_VARIABLE;
           prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base       = 0;
           res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                   mem, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &(prge_instruction_tbl_data.fem_select));
           prge_instruction_tbl_data.op_1_field_select     = 0;
           prge_instruction_tbl_data.op_value    = 0xF000;
           prge_instruction_tbl_data.op_2_field_select     = 0;
           prge_instruction_tbl_data.alu_action      = 0;
           prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
           prge_instruction_tbl_data.cmp_action  = ARAD_PP_EG_PROG_NO_COMPARE;
           prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           
           prge_instruction_tbl_data.src_select  = 0;
           prge_instruction_tbl_data.offset_base = 0;
           prge_instruction_tbl_data.offset_src  = 0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base   = 0;
           prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
           prge_instruction_tbl_data.op_1_field_select     = 0;
           prge_instruction_tbl_data.op_value    = 0;
           prge_instruction_tbl_data.op_2_field_select     = 0;
           prge_instruction_tbl_data.alu_action      = 0;
           prge_instruction_tbl_data.op_3_field_select     = 0;
           prge_instruction_tbl_data.cmp_action  = 0;
           prge_instruction_tbl_data.dst_select  = 0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           
           prge_instruction_tbl_data.src_select  = 0;
           prge_instruction_tbl_data.offset_base = 0;
           prge_instruction_tbl_data.offset_src  = 0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base   = 0;
           prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
           prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
           prge_instruction_tbl_data.op_value    = 0;
           prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R0;
           prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
           prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
           prge_instruction_tbl_data.cmp_action  = ARAD_PP_EG_PROG_NO_COMPARE;
           prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
           
           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           
           prge_instruction_tbl_data.src_select  = 0;
           prge_instruction_tbl_data.offset_base = 0;
           prge_instruction_tbl_data.offset_src  = 0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base   = 0;
           prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
           prge_instruction_tbl_data.op_1_field_select     = 0;
           prge_instruction_tbl_data.op_value    = 0;
           prge_instruction_tbl_data.op_2_field_select     = 0;
           prge_instruction_tbl_data.alu_action      = 0;
           prge_instruction_tbl_data.op_3_field_select     = 0;
           prge_instruction_tbl_data.cmp_action  = 0;
           prge_instruction_tbl_data.dst_select  = 0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           
          prge_instruction_tbl_data.src_select  = 2;  
          prge_instruction_tbl_data.offset_base = 59; 
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 2; 
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_even;

          
          for(i=0; i<6; i++) {
              prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
              prge_instruction_tbl_data.size_base   = 0x1A;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
              prge_instruction_tbl_data.op_value    = 16;
              prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
              prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

              arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

              prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
              prge_instruction_tbl_data.offset_base = 0xF0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
              prge_instruction_tbl_data.size_base   = 0x12;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = 0;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

              arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);
          }

          

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 8;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
          mem   = EPNI_PRGE_INSTRUCTION_0m;
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
          entry = entry_even;


          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 12;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 0xF0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.size_base   = 0x18 ;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_value    = 24;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x10;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 ;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 ;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0;;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 ;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 ;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 8;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 12;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_odd;
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            

            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 24 + (user_header_size*2); 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 12 + (user_header_size*2); 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 53;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)     
    {

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 2 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 4 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
         
         mem   = (entry == entry_odd) ? (mem + 1) : mem;
         entry = (entry == entry_even) ? entry_odd : entry_even;
         prge_instruction_tbl_data.src_select      = 0;
         prge_instruction_tbl_data.offset_base     = 0;
         prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
         prge_instruction_tbl_data.size_base       = 2 ; 
         prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
         prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
         prge_instruction_tbl_data.op_1_field_select = 0;
         prge_instruction_tbl_data.op_value        = 0;
         prge_instruction_tbl_data.op_2_field_select = 0;
         prge_instruction_tbl_data.alu_action      = 0;
         prge_instruction_tbl_data.op_3_field_select = 0;
         prge_instruction_tbl_data.cmp_action = 0 ;
         prge_instruction_tbl_data.dst_select      = 0;
         res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
         SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                    
         
         mem   = (entry == entry_odd) ? (mem + 1) : mem;
         entry = (entry == entry_even) ? entry_odd : entry_even;
         SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

		
		
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
        prge_instruction_tbl_data.offset_base = 4; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; 
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value				= (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "add_size_header_adjust", 0)); 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_ADD; 
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2; 
		prge_instruction_tbl_data.offset_base = 35; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action			= 0; 
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action			= 0;
        prge_instruction_tbl_data.dst_select			= 0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		
		
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2; 
		prge_instruction_tbl_data.offset_base = 33; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value				= 2; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R1; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;  
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

		
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);
		        
		
		for(i = 0; i < 6; i++)
		{
			mem   = (entry == entry_odd) ? (mem + 1) : mem;
			entry = (entry == entry_even) ? entry_odd : entry_even;
          
			prge_instruction_tbl_data.src_select  = 1;
			prge_instruction_tbl_data.offset_base = 0;
			prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
			prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
			prge_instruction_tbl_data.size_base   = 0;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
			prge_instruction_tbl_data.op_value    = 16;
			prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
			prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
			prge_instruction_tbl_data.cmp_action  = 0x7;
			prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

			mem   = (entry == entry_odd) ? (mem + 1) : mem;
			entry = (entry == entry_even) ? entry_odd : entry_even;
          
			prge_instruction_tbl_data.src_select  = 1;
			prge_instruction_tbl_data.offset_base = 0xF0; 
			prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
			prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
			prge_instruction_tbl_data.size_base   = 0x18; 
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select     = 0;
			prge_instruction_tbl_data.op_value    = 0;
			prge_instruction_tbl_data.op_2_field_select     = 0;
			prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select     = 0;
			prge_instruction_tbl_data.cmp_action  = 0;
			prge_instruction_tbl_data.dst_select  = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
		}
		
		
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select  = 2;	
        prge_instruction_tbl_data.offset_base = 59; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 2; 
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action			= 0; 
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action			= 0;
        prge_instruction_tbl_data.dst_select			= 0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
	}


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {


		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
		entry = entry_odd;


		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; 
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; 
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; 
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x10;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; 
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; 
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; 
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);




		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2; 
		prge_instruction_tbl_data.offset_base     = 30;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
        res = arad_sw_db_eg_encap_prge_tbl_overlay_arp_entries_base_index_get(unit, &prge_instruction_tbl_data.op_value);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;

		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 1;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU; 
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);




		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xE0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xD0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xC0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 32; 
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0; 
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; 
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 31;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 8;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 15;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);




		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 29;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 6; 
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

	}

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) ), " --- ;Rsz = R3-R2 (calc native IP length)");
        INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(2) , REG_OP(0)  , REG_OP(1)  ), " --- ;R1 = R2-R0 (calc Overlay length)");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16 (calc next size)");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))      , ALU_SUB(   REG_OP(SZ), CNST(24)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-24");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy Remainder from offset R3 (updated in instr2); r3=r3-16");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_NOP                                         , "Copy 8B from offset R3-16. size rsz; ---");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))      , ALU_NOP                                         , "Copy 8B from offset R3-16. size rsz-8; ---");
        INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))        , ALU_SUB(   REG_OP(0) , CNST(16)   , REG_OP(0)  ), "Copy 8B from Native Eth @ offset R0; Calc next size R0=R0-16");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))       , ALU_NOP                                         , "Copy 8B from Native Eth @ offset R0-16; ---");
        INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))        , ALU_SET(         101              , REG_OP(3)  ), "Copy Remainder bytes from Native Eth @ offset R0; r3 = 101");
        INSTR( CE_FLREAD(PrgeDataFieldEesData3, 0, LFEM_4_LSBS), ALU_SET(          97              , REG_OP(SZ) ), "extract ees-data3[3:0] -> vlan_tag_size ; rsz = 97");
        INSTR( CE_COPY(GEN, R_OFST(2,0)  , R_SIZE(1,0))        , ALU_SUB(   REG_OP(1) , CNST(16)   , REG_OP(1)  ), "Copy 8B from offset R2 (Overlay), Calc R1=R1-16");
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(1,-8))       , ALU_SUB(   FEM       , CNST(0)    , REG_OP(0)  ), "Copy 8B from offset R2-16 (Overlay), Calc r0=fem_field (tag_size)");
        INSTR( CE_COPY(GEN, R_OFST(2,-32), R_SIZE(1,0))        , ALU_SUB(   REG_OP(1) , CNST(16)   , REG_OP(1)  ), "Copy 8B from offset R2-32 (Overlay), Calc R1=R1-16");
        INSTR( CE_COPY(GEN, R_OFST(2,-48), R_SIZE(1,-8))       , ALU_SET_IF(REG_OP(0) , EQ, CNST(8), REG_OP(3), REG_OP(SZ)), "Copy 8B from offset R2 (Overlay); rsz =(r0 ==8)? r3 : rsz");
        INSTR( CE_COPY(GEN, R_OFST(2,-64), R_SIZE(1,0))        , ALU_NOP                                         , "Copy 8B from offset R2 (Overlay); ---");
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))   , ALU_NOP                                         , "copy from ees_data1[15:0] ether-type ; ---");
        INSTR( CE_COPY(RES, R_OFST(SZ,6) , R_SIZE(0,0))        , ALU_NOP                                         , "copy from ees_data3 vlan tag with size r0(vlan_tag size), offset rsz ; ---");
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, -4, C_SIZE(5))  , ALU_NOP                                         , "copy from ees_data1[55:16] SA 5 LSbytes ; ---");
        INSTR( CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(7))   , ALU_NOP                                         , "copy from ees_data2[55:0] DA 6bytes, SA 1MSbyte ; ---");
        if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists == 1)) {
            INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)      , ALU_NOP                           , "Extract Resolved.Data.tm-port-var (1B)" );
            INSTR( CE_NOP                                                 , ALU_NOP                           , "NOP");
            INSTR( CE_NOP                                                 , ALU_ADD( FEM, CNST(0), REG_OP(SZ) ), "ALU: RSZ = LFEM (tm-port-var value)");
            INSTR( CE_NOP                                                 , ALU_NOP                           , "NOP");
            INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )    , ALU_NOP                           , "Copy Additional 1B based on the REG_SZ size");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3), CNST(0), REG_OP(SZ))                  , "0: FEM=system header size, Rsz=R3");
        INSTR(CE_NOP                                            , ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(SZ))  , "1: For external reflector, Rsz=0");
        INSTR(CE_NOP                                            , ALU_ADD(FEM, CNST(user_header_size), REG_OP(0))          , "2: R0 points to start of DA in case of external reflector");
        INSTR(CE_COPY(GEN, R_OFST(3,24), R_SIZE(SZ,0))          , ALU_SET_IF(REG_OP(3), NEQ, CNST(0), CNST(0), REG_OP(0))  , "3: For internal reflector, R0=0");
        INSTR(CE_COPY(GEN, R_OFST(3,8), R_SIZE(SZ,-8))          , ALU_NOP                                                  , "4: Copy from generated header for internal reflector");
        INSTR(CE_LREAD(GEN, C_OFST(2), LFEM_BIT_0_M_6)          , ALU_NOP                                                  , "5: FEM=GEN.DA_is_mc * 6");
        INSTR(CE_LREAD(PKT, R_OFST(0,2), LFEM_BIT_0_M_6)        , ALU_SUB(REG_OP(SZ), CNST(32), REG_OP(SZ))                , "6: FEM=PKT.DA_is_mc * 6");
        INSTR(CE_COPY(GEN, R_OFST(3,-8), R_SIZE(SZ,-16))        , ALU_SUB(FEM, CNST(0), REG_OP(1))                         , "7: R1=6 if GEN.DA_is_mc");
        INSTR(CE_COPY(GEN, R_OFST(3,-24), R_SIZE(SZ,8))         , ALU_SUB(FEM, CNST(0), REG_OP(2))                         , "8: R2=6 if PKT.DA_is_mc");
        INSTR(CE_COPY(GEN, R_OFST(3,-40), R_SIZE(SZ,0))         , ALU_SET_IF(REG_OP(3), NEQ, CNST(0), REG_OP(1), REG_OP(2)), "9: For internal reflector, set R2=R1");
        INSTR(CE_COPY(GEN, R_OFST(3,-56), R_SIZE(SZ,-8))        , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))                , "10:Copy from generated header for internal reflector");
        INSTR(CE_COPY(GEN, R_OFST(3,-72), R_SIZE(SZ,-16))       , ALU_SUB(CNST(6), REG_OP(2), REG_OP(1))                   , "11:R1=6-R2(number of bytes to copy from GEN.DA)");
        INSTR(CE_COPY(GEN, R_OFST(3,-88), R_SIZE(SZ,0))         , ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(1))   , "12:For external reflector, R1=0");
        INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, -2)), ALU_SUB(CNST(6), REG_OP(2), REG_OP(2))                   , "13:Build SA from pp port var, R2=6-R2(number of bytes to copy from PKT.DA)");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(2, -4))  , ALU_SET_IF(REG_OP(3), NEQ, CNST(0), CNST(0), REG_OP(2))  , "14:Build SA from program var, For internal reflector R2=0");
        INSTR(CE_COPY(GEN, C_OFST(12), R_SIZE(1, 0))            , ALU_SET(6, REG_OP(1))                                    , "15:For internal reflector, copy GEN.DA, R1=6(number of bytes to copy from GEN.SA)");
        INSTR(CE_COPY(PKT, R_OFST(0, 12), R_SIZE(2, 0))         , ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(1))   , "16:For external reflector, copy PKT.DA, for external reflector, R1=0");
        INSTR(CE_NOP                                            , ALU_SET(6, REG_OP(2))                                    , "17:R2=6(number of bytes to copy from PKT.SA)");
        INSTR(CE_COPY(GEN, C_OFST(24), R_SIZE(1, 0))            , ALU_SET_IF(REG_OP(3), NEQ, CNST(0), CNST(0), REG_OP(2))  , "18:Copy GEN.SA, for internal reflector, R2=0");

        
        if (!SOC_IS_JERICHO(unit)) {
            INSTR(CE_NOP                                            , ALU_SET(0x80, REG_OP(0))                                 , "19:R0=0x80");
            INSTR(CE_COPY(PKT, R_OFST(0, 24), R_SIZE(2, 0))         , ALU_NOP                                                  , "20:Copy PKT.SA");
            INSTR(CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(1, -5)), ALU_NOP                                                  , "21:SSP=out pp port");
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(1, -5))       , ALU_NOP                                                  , "22:PTCH[0]=0x80");
        } else {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)  , ALU_SET(0x80, REG_OP(0))                                 , "19:R0=0x80");
            INSTR(CE_COPY(PKT, R_OFST(0, 24), R_SIZE(2, 0))         , ALU_NOP                                                  , "20:Copy PKT.SA, R1=1");
            INSTR(CE_NOP                                            , ALU_SET_IF(FEM, NEQ, CNST(0), CNST(0), REG_OP(1))        , "21:R1=(TM_var.bit[0] != 0)?0:1");
            INSTR(CE_NOP                                            , ALU_NOP                                                  , "22:NOP");
            
            
            INSTR(CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(1, -5)), ALU_NOP                                                  , "23:SSP=out pp port");
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(1, -5))       , ALU_NOP                                                  , "24:PTCH[0]=0x80");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
	}

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        
          
        INSTR( CE_COPY( PKT, R_OFST(3,12+user_header_size*2), C_SIZE(6) ), ALU_NOP , "Copy DA from original packet" );
        INSTR( CE_COPY( PKT, R_OFST(3,24+user_header_size*2), C_SIZE(6) ), ALU_NOP , "Copy SA from original packet" );

        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0),     ALU_NOP,                            "Extract Resolved.Data.tm-port-var (1B)" );
            INSTR(CE_NOP,                                               ALU_NOP,                            "NOP");
            INSTR(CE_NOP,                                               ALU_SUB(FEM, CNST(0), REG_OP(SZ)),  "RSZ = FEM (tm-port-var value)");
            INSTR(CE_NOP,                                               ALU_NOP,                            "NOP");
            INSTR(CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0)),    ALU_NOP,                            "Copy Additional 1B based on the REG_SZ size");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);    
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        if (SOC_IS_JERICHO(unit)) {
            
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SET(0x0800, REG_OP(2))                            , "FEM = SysHdrSize                 ; R2 = 0x0800 (IPv4 Eth-Type)");
            INSTR( CE_NOP                                               , ALU_NOP                                               , "NOP (Let FEM update)");
            INSTR( CE_NOP                                               , ALU_ADD(FEM, CNST(42+user_header_size), REG_OP(1))    , "---                              ; R1 = SysHdrSize+42");
            INSTR( CE_NOP                                               , ALU_SET(0 , REG_OP(SZ))                               , "---                              ; R2 = 0");
            INSTR( CE_READ(PKT, R_OFST(1,-28*2))                        , ALU_SET(0 , REG_OP(3))                                , "FEM = Orig[R1-28B]               ; ---");
            INSTR( CE_READ(PKT, R_OFST(1,-24*2))                        , ALU_SET(0x9100, REG_OP(0))                            , "FEM = Orig[R1-24B]               ; ---");
            INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(8), REG_OP(SZ))   , "---                              ; IF (FEM==0x0800) RSZ=8");
            INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(4), REG_OP(SZ))   , "---                              ; IF (FEM==0x0800) RSZ=4");
            INSTR( CE_NOP                                               , ALU_SET(0x8100, REG_OP(2))                            , "NOP (Let RSZ update)");
            INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0))              , ALU_SUB(REG_OP(1), REG_OP(SZ), REG_OP(1))             , "Copy Extra data                  ; R1 -= RSZ");
            INSTR( CE_READ(GEN, C_OFST(14*2))                           , ALU_NOP                                               , "---                              ; RSZ = 8-RSZ");

            INSTR( CE_READ(GEN, C_OFST(14*2))                           , ALU_SET(0 , REG_OP(SZ))                               , "");
            INSTR( CE_READ(GEN, C_OFST(18*2))                           , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(4), REG_OP(3))    , "check offset=14,if tpid match=0x8100");
            INSTR( CE_READ(GEN, C_OFST(18*2))                           , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(4), REG_OP(3))    , "check offset=14,if tpid match=0x9100");
            INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(8), REG_OP(SZ))   , "check offset=18,if tpid match=0x8100");
            INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(8), REG_OP(SZ))   , "check offset=18,if tpid match=0x9100");
            INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(SZ)), "vlan size=0 when offset=14 doesn't match ");


            
            INSTR( CE_COPY(PKT, R_OFST(1,-4*2), C_SIZE(4))              , ALU_SUB(REG_OP(1), CNST(8), REG_OP(1))                , "Copy SIP from original packet    ; R1 -= 8" );
            INSTR( CE_COPY(PKT, R_OFST(1,0), C_SIZE(4))                 , ALU_SET_IF(REG_OP(SZ), EQ, CNST(0), REG_OP(3), REG_OP(SZ)), "Copy DIP from original packet    ; ---" );

            
            INSTR( CE_COPY(PKT, R_OFST(1,0), C_SIZE(8))                 , ALU_NOP                                               , "Copy the rest of the IP header + Eth-Type" );
            INSTR( CE_COPY(PKT, R_OFST(1,-8*2), C_SIZE(6))              , ALU_NOP                                               , "Copy the rest of the IP header + Eth-Type" );

            
            INSTR( CE_COPY(GEN, R_OFST(SZ,12*2), R_SIZE(SZ,0))          , ALU_NOP                                               , "Copy VLANS from gen header" );

            
            INSTR( CE_COPY(GEN, C_OFST(6*2), C_SIZE(6))                 , ALU_NOP                                               , "Copy DA from gen header" );
            INSTR( CE_COPY(GEN, C_OFST(12*2), C_SIZE(6))                , ALU_NOP                                               , "Copy SA from gen header" );

            
            if (SOC_IS_JERICHO_PLUS(unit)) {
                INSTR(CE_FCOPY(PrgeDataFieldOutPpPort, 0, C_SIZE(1))    , ALU_NOP                                               , "PTCH - SSP");
            } else {
                INSTR(CE_LCOPY(PKT, C_OFST(11), C_SIZE(1), LFEM_XGS_FRC_LITE_EXTRACT_DSP), ALU_NOP                              , "PTCH - SSP");
            }
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))         , ALU_NOP                                               , "PTCH - 0x80");
        } else {
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SET(0x0800, REG_OP(2))                            , "FEM = SysHdrSize                 ; R2 = 0x0800 (IPv4 Eth-Type)");
            INSTR( CE_NOP                                               , ALU_NOP                                               , "NOP (Let FEM update)");
            INSTR( CE_NOP                                               , ALU_ADD(FEM, CNST(42+user_header_size), REG_OP(1))                     , "---                              ; R1 = SysHdrSize+42");
            INSTR( CE_NOP                                               , ALU_SET(0 , REG_OP(SZ))                               , "---                              ; R2 = 0");
            INSTR( CE_READ(PKT, R_OFST(1,-28*2))                        , ALU_NOP                                               , "FEM = Orig[R1-28B]               ; ---");
            INSTR( CE_READ(PKT, R_OFST(1,-24*2))                        , ALU_NOP                                               , "FEM = Orig[R1-24B]               ; ---");
            INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(8), REG_OP(SZ))   , "---                              ; IF (FEM==0x0800) RSZ=8");
            INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(4), REG_OP(SZ))   , "---                              ; IF (FEM==0x0800) RSZ=4");
            INSTR( CE_NOP                                               , ALU_NOP                                               , "NOP (Let RSZ update)");
            INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0))              , ALU_SUB(REG_OP(1), REG_OP(SZ), REG_OP(1))             , "Copy Extra data                  ; R1 -= RSZ");
            INSTR( CE_NOP                                               , ALU_SUB(CNST(8), REG_OP(SZ), REG_OP(SZ))              , "---                              ; RSZ = 8-RSZ");
            
            
            INSTR( CE_COPY(PKT, R_OFST(1,-4*2), C_SIZE(4))              , ALU_SUB(REG_OP(1), CNST(8), REG_OP(1))                , "Copy SIP from original packet    ; R1 -= 8" );
            INSTR( CE_COPY(PKT, R_OFST(1,0), C_SIZE(4))                 , ALU_NOP                                               , "Copy DIP from original packet    ; ---" );
            
            
            INSTR( CE_COPY(PKT, R_OFST(1,0), C_SIZE(8))                 , ALU_NOP                                               , "Copy the rest of the IP header + Eth-Type" );
            INSTR( CE_COPY(PKT, R_OFST(1,-8*2), C_SIZE(6))              , ALU_NOP                                               , "Copy the rest of the IP header + Eth-Type" );
            
            
            INSTR( CE_COPY(GEN, R_OFST(SZ,12*2), R_SIZE(SZ,0))          , ALU_NOP                                               , "Copy VLANS from gen header" );
            
            
            INSTR( CE_COPY(GEN, C_OFST(6*2), C_SIZE(6))                 , ALU_NOP                                               , "Copy DA from gen header" );
            INSTR( CE_COPY(GEN, C_OFST(12*2), C_SIZE(6))                , ALU_NOP                                               , "Copy SA from gen header" );
            
            
            INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, C_SIZE(1))       , ALU_NOP                                               , "PTCH - SSP");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))         , ALU_NOP                                               , "PTCH - 0x80");
        }
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        int    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 1;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5 + (user_header_size*2);
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 65;
        prge_instruction_tbl_data.op_2_field_select = 0; 
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 63;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 1;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        for (i = 0; i < 6; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value    = 16;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PP_PORT_VARIABLE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_LIF;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 127;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    
    res = arad_egr_prog_editor_ptag_mpls_raw(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED_MPLS_RAW);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    res = arad_egr_prog_editor_ptag_mpls_raw(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED_MPLS_RAW);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    res = arad_egr_prog_editor_ptag_mpls_raw(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED_MPLS_RAW);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        

        
         
        INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS),   ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(2)),           "0: Calc the length of Gen except LL");
        INSTR(CE_NOP,                                               ALU_SET(12, REG_OP(1)),                             "1: R1=12");
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS),   ALU_ADD(FEM, CNST(0), REG_OP(1)),                   "2: R1=nwk size");
        INSTR(CE_NOP,                                               ALU_JMP_IF(REG_OP(2), LT, REG_OP(1), BRANCH_MPLS_RAW, JUMP_POINT_MPLS_RAW),"3: Jump if R2 < 12");
        INSTR(CE_NOP,                                               ALU_ADD(FEM, REG_OP(1), REG_OP(1)),                 "4: Waiting for ALU result, R1=start of removed 12 bytes");
        INSTR(CE_NOP,                                               ALU_NOP,                                            "5: Waiting for ALU result");
        INSTR(CE_NOP,                                               ALU_NOP,                                            "6: Waiting for ALU result");

        
        INSTR(CE_COPY(PKT, R_OFST(1,24), C_SIZE(8)),                ALU_SUB(REG_OP(2), CNST(12), REG_OP(2)),            "7: copy original pkt, Gen copy size not include first 12 bytes");
        INSTR(CE_COPY(PKT, R_OFST(1,8), C_SIZE(4)),                 ALU_NOP,                                            "8: copy original pkt");

        INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,0)),               ALU_SUB(REG_OP(3), CNST(8), REG_OP(3)),             "9: Copy and R3=R3-8");
        INSTR(CE_NOP,                                               ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)),            "10: R2=R2-16");

        for (i = 0; i < (SOC_IS_JERICHO(unit) ? 4 : 2); i++) {
            INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8)),            ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)), "11:");
            INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0)),           ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "12:");
        }

        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS),    ALU_SET(2, REG_OP(SZ)),                             "19:");
            INSTR(CE_NOP,                                               ALU_NOP,                                            "20:");
            INSTR(CE_NOP,                                               ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ)),  "21:");
            INSTR(CE_NOP,                                               ALU_NOP,                                            "22:");
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)),   ALU_NOP,                                            "23:");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(SZ, 0)),   ALU_NOP,                                            "24:");
        }

        
        INSTR(CE_COPY(GEN, R_OFST(0,24), C_SIZE(6)),                    ALU_NOP,                                            "25: Copy SA");
        INSTR(CE_COPY(GEN, R_OFST(0,12), C_SIZE(6)),                    ALU_NOP,                                            "26: Copy DA");
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_MPLS_RAW);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);        
        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_MPLS_RAW);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        INSTR(CE_COPY(PKT, R_OFST(1,0), R_SIZE(2,0)),                   ALU_NOP,                                            "7: Copy Ori2, size=R2");
        INSTR(CE_COPY(PKT, R_OFST(1,-16), R_SIZE(2,-8)),                ALU_NOP,                                            "8: Copy Ori2");
        

        
        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS),    ALU_SET(2, REG_OP(SZ)),                             "9:");
            INSTR(CE_NOP,                                               ALU_NOP,                                            "10:");
            INSTR(CE_NOP,                                               ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ)),  "11:");
            INSTR(CE_NOP,                                               ALU_NOP,                                            "12:");
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)),   ALU_NOP,                                            "13:");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(SZ, 0)),   ALU_NOP,                                            "14:");
        }
        
        INSTR(CE_NOP,                                                   ALU_SUB(CNST(12), REG_OP(2), REG_OP(SZ)),           "15: RSZ=delta for (R2<12) case");
        INSTR(CE_NOP,                                                   ALU_SUB(REG_OP(1), REG_OP(2), REG_OP(1)),           "16: Calc the offset of Ori");
        INSTR(CE_NOP,                                                   ALU_NOP,                                            "17: NOP");
        INSTR(CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0)),                  ALU_NOP,                                            "18: Copy Ori2, size=R2");

        
        INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,0)),                   ALU_NOP,                                            "19: Copy and R3=R3-8");
        INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,-8)),                ALU_NOP,                                            "20: ");

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_NWK_HEADERS_SIZE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 26;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        for (i = 0; i < 7; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select        = 0;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src          = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select        = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select   = 0;
            prge_instruction_tbl_data.op_value          = 0;
            prge_instruction_tbl_data.op_2_field_select   = 0;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select   = 0;
            prge_instruction_tbl_data.cmp_action        = 0;
            prge_instruction_tbl_data.dst_select        = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS) , ALU_ADD(    REG_OP(3), CNST(26),             REG_OP(3) ) , "extract nwk hdr size; r3 = r3+26");
        INSTR( CE_NOP                                             , ALU_SET(           4 ,                       REG_OP(0) ) , "--- ; r0=4 (MAID String format code)");
        INSTR( CE_NOP                                             , ALU_ADD(    REG_OP(3),   FEM   ,             REG_OP(3) ) , "--- ; r3 = r3+fem");
        INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        INSTR( CE_LREAD(PKT, R_OFST(3,-30), LFEM_8_LSBS)          , ALU_NOP                                                  , "extract MAID format ; ---");
        INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        INSTR( CE_NOP                      , ALU_JMP_IF(FEM, EQ, REG_OP(0), BRANCH_OAM_STRING_MAID, JUMP_POINT_OAM_MAID_INT) , "--- ; if (FEM == r0) jump to String translation branch");
        INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");

        

        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))       , ALU_NOP                                                  , "Copy EndTlv byte; ---");

        
        for (i = 0; i < 6; i++) {
            INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                        , "copy OAM/ETH/System hdrs");
            INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                        , "copy OAM/ETH/System hdrs");
        }
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))              , ALU_NOP                                                        , "copy OAM/ETH/System hdrs");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_OAM_STRING_MAID);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_OAM_MAID_INT);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        INSTR( CE_COPY(PKT, R_OFST(3,0), C_SIZE(8))               , ALU_SUB(    REG_OP(3), CNST(16),             REG_OP(3) ) , "copy MAID 8bytes ; r3 = r3 - 16");
        INSTR( CE_COPY(PKT, R_OFST(3,-18), C_SIZE(6))             , ALU_NOP                                                  , "copy MAID 6bytes ;  ---");
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(3))      , ALU_NOP                                                  , "Copy MD Format, MA Format and Length; ---");

        
        for (i = 0; i < 5; i++) {
            INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                        , "copy OAM/ETH/System hdrs");
            INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                        , "copy OAM/ETH/System hdrs");
        }
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))              , ALU_NOP                                                         , "copy OAM/ETH/System hdrs");

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

   res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

        
        res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_DELAY_BASE_ECN2, &branch_pointer);
        SOC_SAND_IF_ERR_EXIT(res);

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2 * (ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE - 1) - 3; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_TOD_NTP - 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.op_value        = 10;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = (uint8)(2 * (-18)); 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 3;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(branch_pointer, entry == entry_odd);
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value        = 1;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0xFFFF;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0xFFFE;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     =  2 * 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));


        
        mem   = EPNI_PRGE_INSTRUCTION_7m;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
        entry = entry_even;

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 0xFFFE;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 0xFFFD;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 9;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_LREAD(GEN, R_OFST(2,-10), LFEM_BIT_0_M_4)                      , ALU_SET( 0x0, REG_OP(SZ) )                                 , "Read the 2nd inner-most label bos and x 4(cw_size) to FEM      ; RSZ = 0");
         INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))                              , ALU_SUB( REG_OP(3), REG_OP(2), REG_OP(SZ) )                , "Copy forwarding header: 8Byte                                  ; RSZ = R3 - R2: forward header size");
         INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                , ALU_JMP_IF(FEM, EQ, REG_OP(SZ), BRANCH_EVPN_BRIDGE_ESI, JUMP_POINT_EVPN_BRIDGE_ESI)  ,"Read System header size               ; Jump if cw_size (FEM) = 0");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(6))                            , ALU_SUB(REG_OP(SZ),CNST(22),REG_OP(SZ))                    , "Copy forwarding header: 6Byte                                  ; R2 -= (8 + 6 + 8)");
         INSTR( CE_COPY(GEN, R_OFST(3,-28), R_SIZE(SZ,-14))                       , ALU_ADD( FEM, CNST(user_header_size), REG_OP(1))           , "Copy forwarding header                                         ; R1 = system_header_size + udh_size");
         INSTR( CE_COPY(GEN, R_OFST(3,-44), R_SIZE(SZ,0))                         , ALU_SUB( REG_OP(2), REG_OP(0), REG_OP(SZ) )                , "Copy forwarding header                                         ; RSZ = R2 - R1: encap size");

        
         INSTR( CE_COPY(GEN, R_OFST(3,-60), R_SIZE(SZ,-8))                        , ALU_SET( 0x0000, REG_OP(3) )                               , "copy forwarding header                                         ; R3 = 0: initial CW size");

        
         INSTR( CE_READ(PKT, R_OFST(1,-5))                                        , ALU_SET( 0x0002, REG_OP(SZ) )                              , "Read PE-ID[15:0] from UDH                                      ; RSZ = 2: used for ESI copy");
         INSTR( CE_READ(PKT, R_OFST(1,-6))                                        , ALU_SET_IF(REG_OP(SZ), GT, CNST(4), CNST(4), REG_OP(3))    , "Read PE-ID[19:4] from UDH                                      ; If SZ > 4(means >=8, has CW), R3 = 4");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, 0)                                , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Read PE-ID[15:0] from EEDB data                                ; R1 = UDH.PE-ID[15:0]");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, -1)                               , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Read PE-ID[19:4] from EEDB data                                ; R1 = UDH.PE-ID[19:4]");
         INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))       , "Read System header size                                        ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))       , "Copy possible CW per R3                                        ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_NOP                                                            , ALU_ADD( FEM, CNST(user_header_size), REG_OP(1))           , "---                                                            ; R1 = system_header_size + udh_size");
         INSTR( CE_NOP                                                            , ALU_SUB(REG_OP(2), REG_OP(3), REG_OP(2))                   , "---                                                            ; R2 -= R3: Move R2 to outer header per CW size (R3)");
         INSTR( CE_LCOPY(PKT, R_OFST(1,0), R_SIZE(SZ,0), LFEM_ESI_LSB)            , ALU_NOP                                                    , "Try to add ESI-label[15:0]                                     ; ---");
         INSTR( CE_COPY(PKT, R_OFST(1,-1), R_SIZE(SZ,0))                          , ALU_SUB( CNST(2), REG_OP(SZ), REG_OP(SZ) )                 , "Try to add ESI-label[31:16]                                    ; Invert RSZ");

        
         INSTR( CE_LCOPY(GEN, R_OFST(2,0), R_SIZE(SZ,0), LFEM_ZERO_BIT8)          , ALU_NOP                                                   , "Try to add IML[15:0] BOS bit cleared                             ; ---");
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                           , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ))                 , "If RSZ != 0 (After invert), add the 2 LSbytes of the IML label   ; RSZ = R2 - R0");
         INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)                 , ALU_NOP                                                   , "---                                                              ; ---");
         INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(SZ,-2))                         , ALU_SUB(REG_OP(SZ), CNST(8), REG_OP(SZ))                  , "Copy IML MSBytes and LSP                                         ; ---");
         INSTR( CE_NOP                                                            , ALU_SUB(FEM, CNST(0), REG_OP(SZ) )                        , "RSZ=tag enable indication");
         INSTR( CE_COPY(GEN, R_OFST(2,-20), R_SIZE(SZ,-2))                        , ALU_NOP                                                   , "---                                                              ; ---");

        
         INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                            , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
         INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))                         , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
         INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                            , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "Copy SA                                                          ; ---");
         INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))                         , ALU_NOP                                                   , "Copy DA                                                          ; ---");
        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
         INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )                , ALU_NOP                                                   , "Copy Additional 1B based on the REG_SZ size");
        }


        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_EVPN_BRIDGE_ESI);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);        
        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_EVPN_BRIDGE_ESI);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_COPY(GEN, R_OFST(3,-60), R_SIZE(SZ,-8))                        , ALU_NOP                                                    , "copy forwarding header                                          ; ---");

        
         INSTR( CE_READ(PKT, R_OFST(1,-5))                                        , ALU_SET( 0x0002, REG_OP(SZ) )                              , "Read PE-ID[15:0] from UDH                                       ; RSZ = 2: used for ESI copy");
         INSTR( CE_READ(PKT, R_OFST(1,-6))                                        , ALU_NOP                                                    , "Read PE-ID[19:4] from UDH                                       ; ---");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, 0)                                , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Read PE-ID[15:0] from EEDB data                                 ; R1 = UHD.PE-ID[15:0]");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, -1)                               , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Read PE-ID[19:4] from EEDB data                                 ; R1 = UHD.PE-ID[19:4]");
         INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))       , "Read System header size                                         ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_NOP                                                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))       , "---                                                             ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_NOP                                                            , ALU_ADD( FEM, CNST(user_header_size), REG_OP(1))           , "---                                                             ; R1 = system_header_size + udh_size");
         INSTR( CE_NOP                                                            , ALU_NOP                                                    , "---                                                             ; ---");
         INSTR( CE_LCOPY(PKT, R_OFST(1,0), R_SIZE(SZ,0), LFEM_ESI_LSB)            , ALU_NOP                                                    , "Try to add ESI-label[15:0]                                      ; ---");
         INSTR( CE_COPY(PKT, R_OFST(1,-1), R_SIZE(SZ,0))                          , ALU_SUB( CNST(2), REG_OP(SZ), REG_OP(SZ) )                 , "Try to add ESI-label[31:16]                                     ; Invert RSZ");

        
         INSTR( CE_LCOPY(GEN, R_OFST(2,0), R_SIZE(SZ,0), LFEM_ZERO_BIT8)          , ALU_NOP                                                    , "Try to add IML[15:0] BOS bit cleared                            ; ---");
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                           , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ))                  , "If RSZ != 0 (After invert), add the 2 LSbytes of the IML label  ; RSZ = R2 - R0");
         INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)                 , ALU_NOP                                                    , "---                                                             ; ---");
         INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(SZ,-2))                         , ALU_SUB(REG_OP(SZ), CNST(8), REG_OP(SZ))                   , "Copy IML MSBytes and LSP                                        ; ---");
         INSTR( CE_NOP                                                            , ALU_SUB(FEM, CNST(0), REG_OP(SZ) )                         , "RSZ=tag enable indication");
         INSTR( CE_COPY(GEN, R_OFST(2,-20), R_SIZE(SZ,-2))                        , ALU_NOP                                                    , "---                                                             ; ---");

        
         INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                            , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                    , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                             ; ---");
         INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))                         , ALU_NOP                                                    , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                             ; ---");
         INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                            , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                    , "Copy SA                                                         ; ---");
         INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))                         , ALU_NOP                                                    , "Copy DA                                                         ; ---");
        if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
         INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )                , ALU_NOP                                                    , "Copy Additional 1B based on the REG_SZ size");
        }

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        uint16 advanced_extension_mpls_label_mode;

        advanced_extension_mpls_label_mode = (soc_property_get(unit, spn_ROO_EXTENSION_LABEL_ENCAPSULATION, 0) && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "advanced_extension_label_mode", 0))?1:0;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_LREAD(GEN, R_OFST(2,-10), LFEM_BIT_0_M_4)                      , ALU_SET( 0x0, REG_OP(SZ) )                                 , "Read the 2nd inner-most label bos and x 4(cw_size)             ; RSZ = 0");
         INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))                              , ALU_SUB( REG_OP(3), REG_OP(2), REG_OP(SZ) )                , "Copy forwarding header: 8Byte                                  ; RSZ = R3 - R2");
         INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                , ALU_JMP_IF(FEM, EQ, REG_OP(SZ), BRANCH_EVPN_BRIDGE_ESI_FRR, JUMP_POINT_EVPN_BRIDGE_ESI_FRR)   ,"Read System header size      ; Jump if CW size = 0 (no cw)");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(6))                            , ALU_SUB(REG_OP(SZ),CNST(22),REG_OP(SZ))                    , "Copy forwarding header: 6Byte                                  ; R2 -= (8 + 6 + 8)");
         INSTR( CE_COPY(GEN, R_OFST(3,-28), R_SIZE(SZ,-14))                       , ALU_ADD( FEM, CNST(user_header_size), REG_OP(1))           , "Copy forwarding header                                         ; R1 = system_header_size + udh_size");
         INSTR( CE_COPY(GEN, R_OFST(3,-44), R_SIZE(SZ,0))                         , ALU_SUB( REG_OP(2), REG_OP(0), REG_OP(SZ) )                , "Copy forwarding header                                         ; RSZ = R2 - R1 : encap size");

        
         INSTR( CE_COPY(GEN, R_OFST(3,-60), R_SIZE(SZ,-8))                        , ALU_SET( 0x0000, REG_OP(3) )                               , "Copy forwarding header                                         ; R3 = 0: initial CW size");

        
         INSTR( CE_READ(PKT, R_OFST(1,-5))                                        , ALU_SET( 0x0002, REG_OP(SZ) )                              , "Read PE-ID[15:0] from UDH                                      ; RSZ = 2: used for ESI copy");
         INSTR( CE_READ(PKT, R_OFST(1,-6))                                        , ALU_SET_IF(REG_OP(SZ), GT, CNST(4), CNST(4), REG_OP(3))    , "Read PE-ID[19:4] from UDH                                      ; If SZ > 4(means >=8, has CW), R3 = 4");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, 0)                                , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Read PE-ID[15:0] from EEDB data                                ; R1 = UDH.PE-ID[15:0]");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, -1)                               , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Read PE-ID[19:4] from EEDB data                                ; R1 = UDH.PE-ID[19:4]");
         INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))       , "Read System header size                                        ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))       , "Copy possible CW per R3                                        ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)                    , ALU_ADD( FEM, CNST(user_header_size), REG_OP(3))           , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label                    ; R3 = system_header_size + udh_size");
         INSTR( CE_NOP                                                            , ALU_SUB( REG_OP(2), REG_OP(3), REG_OP(2) )                 , "---                                                            ; R2 -= R3: Move R2 to outer header per CW size (R3)");
         INSTR( CE_LCOPY(PKT, R_OFST(3,0), R_SIZE(SZ,0), LFEM_ESI_LSB)            , ALU_SUB( FEM, CNST(0), REG_OP(1) )                         , "Try to add ESI-label[15:0]                                     ; R1 = {FRR_EXP[2:0], S[0:0], TTL[7:0]}");
         INSTR( CE_COPY(PKT, R_OFST(3,-1), R_SIZE(SZ,0))                          , ALU_SUB( CNST(2), REG_OP(SZ), REG_OP(SZ) )                 , "Try to add ESI-label[31:16]                                    ; Invert RSZ");

        
         INSTR( CE_LCOPY(GEN, R_OFST(2,0), R_SIZE(SZ,0), LFEM_ZERO_BIT8)          , ALU_NOP                                                    , "Try to add IML[15:0] BOS bit cleared                           ; ---");
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5, LFEM_LSHIFT_12)          , ALU_NOP                                                    , "FEM = {FRR-label[3:0],12'h0} from Eesdata2                     ; ---");
        } else {
            if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_LREAD(GEN, R_OFST(0,-4), LFEM_LSHIFT_12)               , ALU_NOP                                                    , "FEM = {FRR-label[3:0],12'h0} from vlan tag                     ; ---");
            } else {
                 INSTR( CE_LREAD(GEN, C_OFST(32), LFEM_LSHIFT_12)                 , ALU_NOP                                                    , "FEM = {FRR-label[3:0],12'h0} from vlan tag                     ; ---");
            }
        }
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                           , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ))                 , "If RSZ != 0 (After invert), add the 2 LSbytes of the IML label  ; RSZ = R2 - R0");
         INSTR( CE_LREAD(GEN, R_OFST(0,-9), LFEM_4_LSBS)                          , ALU_ADD( FEM, REG_OP(1), REG_OP(1))                       , "---                                                             ; R1 += FEM [== {Label[3:0],EXP[2:0],0,TTL[7:0]}]");
         INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(SZ,-2))                         , ALU_SET(0x8847,   REG_OP(2) )                             , "Copy IML MSBytes and LSP       ; R2=0x8847");
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(0), CNST(12), REG_OP(3))                   , " Add FRR[15:0]                                                   ; R3 = R0 - 12 == Size to copy before {DA,SA}");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))                , ALU_NOP                                                   , "Add FRR[31:16] from EesData2                                     ; ---");
        } else {
            if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB(FEM, CNST(4), REG_OP(3))                          , " Add FRR[15:0]   ; R3 = FEM - 4 == Size OuterVLAN");
                 INSTR( CE_COPY(GEN, C_OFST(39), C_SIZE(2))                       , ALU_NOP                                                   , "Add FRR[31:16] from candidate   ;---");
            } else {
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB(REG_OP(0), CNST(16), REG_OP(3))                   , " Add FRR[15:0]                                                   ; R3 = R0 - 16 == Size to copy before {DA,SA,OuterVLAN}");
                 INSTR( CE_COPY(GEN, C_OFST(31), C_SIZE(2))                           , ALU_NOP                                               , "Add FRR[31:16] from candidate                                    ; ---");
            }
        }
        
        if (advanced_extension_mpls_label_mode) {
             INSTR( CE_FCOPY(PrgeDataFieldR2,0, C_SIZE(2))                        , ALU_NOP                                                   , "Copy Eth-Type                              ; ---");             
             INSTR( CE_COPY(GEN, C_OFST(32), R_SIZE(3,0))                         , ALU_NOP                                                   , "Copy  OuterVLAN?                              ; ---");
        } else {
             INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(3,0))                        , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
             INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(3,-8))                     , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
        }
         INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                               , ALU_NOP                                                   , "Copy SA                                                          ; ---");
         INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                               , ALU_NOP                                                   , "Copy DA                                                          ; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_EVPN_BRIDGE_ESI_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);        
        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_EVPN_BRIDGE_ESI_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_COPY(GEN, R_OFST(3,-60), R_SIZE(SZ,-8))                        , ALU_NOP                                                   , "Copy forwarding header                                         ; ---");

        
         INSTR( CE_READ(PKT, R_OFST(1,-5))                                        , ALU_SET( 0x0002, REG_OP(SZ) )                             , "Read PE-ID[15:0] from UDH                                      ; RSZ = 2: used for ESI copy");
         INSTR( CE_READ(PKT, R_OFST(1,-6))                                        , ALU_NOP                                                   , "Read PE-ID[19:4] from UDH                                      ; ---");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, 0)                                , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Read PE-ID[15:0] from EEDB data                                ; R1 = UDH.PE-ID[15:0]");
         INSTR( CE_FREAD(PrgeDataFieldEesData2, -1)                               , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Read PE-ID[19:4] from EEDB data                                ; R1 = UDH.PE-ID[19:4]");
         INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))      , "Read System header size                                        ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_NOP                                                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))      , "---                                                            ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
         INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)                    , ALU_ADD( FEM, CNST(user_header_size), REG_OP(3))          , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label                    ; R3 = system_header_size + udh_size");
         INSTR( CE_NOP                                                            , ALU_NOP                                                   , "---                                                            ; ---");
         INSTR( CE_LCOPY(PKT, R_OFST(3,0), R_SIZE(SZ,0), LFEM_ESI_LSB)            , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Try to add ESI-label[15:0]                                     ; R1 = EXP[2:0],S,TTL[7:0]");
         INSTR( CE_COPY(PKT, R_OFST(3,-1), R_SIZE(SZ,0))                          , ALU_SUB( CNST(2), REG_OP(SZ), REG_OP(SZ) )                , "Try to add ESI-label[31:16]                                    ; Invert RSZ");

        
         INSTR( CE_LCOPY(GEN, R_OFST(2,0), R_SIZE(SZ,0), LFEM_ZERO_BIT8)          , ALU_NOP                                                   , "Try to add IML[15:0] BOS bit cleared                           ; ---");
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5, LFEM_LSHIFT_12)          , ALU_NOP                                                   , "FEM = {FRR-label[3:0],12'h0} from Eesdata2                     ; ---");
        } else {
            if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_LREAD(GEN, R_OFST(0,-4), LFEM_LSHIFT_12)               , ALU_NOP                                                   , "FEM = {FRR-label[3:0],12'h0} from vlan tag                     ; ---");
            } else {
                 INSTR( CE_LREAD(GEN, C_OFST(32), LFEM_LSHIFT_12)                 , ALU_NOP                                                   , "FEM = {FRR-label[3:0],12'h0} from vlan tag                     ; ---");
            }
        }
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                           , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ))                 , "If RSZ != 0 (After invert), add the 2 LSbytes of the IML label ; RSZ = R2 - R0");
         INSTR( CE_LREAD(GEN, R_OFST(0,-9), LFEM_4_LSBS)                          , ALU_ADD( FEM, REG_OP(1), REG_OP(1))                       , "---                                                            ; R1 += FEM [== {Label[3:0],EXP[2:0],0,TTL[7:0]}]");
         INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(SZ,-2))                         , ALU_SET(0x8847,   REG_OP(2) )                             , "Copy IML MSBytes and LSP       ; R2=0x8847");
        if (SOC_IS_JERICHO_PLUS(unit)) {            
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(0), CNST(12), REG_OP(3))                   , " Add FRR[15:0]                                                 ; R3 = R0 - 12 == Size to copy before {DA,SA}");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))                , ALU_NOP                                                   , "Add FRR[31:16] from EesData2                                   ; ---");
        } else {
            if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB(FEM, CNST(4), REG_OP(3))                          , " Add FRR[15:0]                                                 ; R3 = FEM - 4 == Size OuterVLAN");
                 INSTR( CE_COPY(GEN, C_OFST(39), C_SIZE(2))                       , ALU_NOP                                                   , "Add FRR[31:16] from candidate   ;---");
            } else {
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB(REG_OP(0), CNST(16), REG_OP(3))                   , " Add FRR[15:0]                                                 ; R3 = R0 - 16 == Size to copy before {DA,SA,OuterVLAN}");
                 INSTR( CE_COPY(GEN, C_OFST(31), C_SIZE(2))                       , ALU_NOP                                                   , "Add FRR[31:16] from candidate                                  ; ---");

            }
        }
        
        if (advanced_extension_mpls_label_mode) {
             INSTR( CE_FCOPY(PrgeDataFieldR2,0, C_SIZE(2))                        , ALU_NOP                                                   , "Copy Eth-Type                                                  ; ---");             
             INSTR( CE_COPY(GEN, C_OFST(32), R_SIZE(3,0))                         , ALU_NOP                                                   , "Copy  OuterVLAN?                                               ; ---");
        } else {
             INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(3,0))                        , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                            ; ---");
             INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(3,-8))                     , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                            ; ---");
        }
         INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                               , ALU_NOP                                                   , "Copy SA                                                        ; ---");
         INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                               , ALU_NOP                                                   , "Copy DA                                                        ; ---");

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get( unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

         INSTR( CE_LREAD(GEN, R_OFST(0,20),LFEM_8_LSBS)               , ALU_SET( 17, REG_OP(SZ))                                    , "Reed IPv4.protocol into FEM    ; RSZ = 17");
         INSTR( CE_NOP                                                 , ALU_SUB( REG_OP(3), REG_OP(1), REG_OP(SZ))                 , "---                            ; RSZ = R3 - R1");
         INSTR( CE_NOP                                                , ALU_JMP_IF(FEM, EQ, REG_OP(SZ), BRANCH_IP_OVER_UDP, JUMP_POINT_IP_OVER_UDP) ,"---            ; jump if UDP and action needed");
         INSTR( CE_NOP                                                 , ALU_NOP                                                     , "---                           ; ---");
         INSTR( CE_NOP                                                 , ALU_NOP                                                     , "---                           ; ---");
         INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "---                           ; RSZ -= 16 (Prepare for PP-Copy loop with seperate size register)");
        
        for (j = 0; j < 11; j++) {
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                        , "copy all candidate headers ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                        , "copy all candidate headers ; ---");
        }
        
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_IP_OVER_UDP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_IP_OVER_UDP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
        for (j = 0; j < 4; j++) {
            INSTR( CE_COPY(GEN, R_OFST(3,16), R_SIZE(SZ,0))              , ALU_SUB( REG_OP(3), CNST(16), REG_OP(3))                  , "Copy till UDP header with offset + 8B ;  R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,8))              , ALU_SUB( REG_OP(SZ), CNST(16), REG_OP(SZ))                , "Copy till UDP header with offset + 8B ; RSZ -= 16");
        }

         INSTR( CE_READ(GEN, R_OFST(1,-4))                            , ALU_NOP                                                   , "Read UDP.length                      ; ---");
         INSTR( CE_NOP                                                , ALU_SUB( REG_OP(1), CNST(6), REG_OP(1) )                  , "---                                  ; R1 -= 6");
         INSTR( CE_COPY(GEN, R_OFST(1,0), C_SIZE(2))                   , ALU_SUB( FEM, CNST(8), REG_OP(3))                        , "Copy UDP.checksun                    ; R3 = UDP.length - 8");
         INSTR( CE_NOP                                                 , ALU_NOP                                                   , "---                                 ; ---");
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))               , ALU_NOP                                                   , "Copy UDP.length                      ; ---");
         INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))          , ALU_NOP                                                   , "Copy UDP.dest_port                   ; ---");

        
        for (j = 0; j < 4; j++) {
            INSTR( CE_COPY(GEN, R_OFST(1,0), R_SIZE(1,0))             , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))                        , "copy all candidate headers ; R1 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(1,-16), R_SIZE(1,-8))          , ALU_NOP                                                        , "copy all candidate headers ; ---");
        }

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        uint16 advanced_extension_mpls_label_mode;

        advanced_extension_mpls_label_mode = (soc_property_get(unit, spn_ROO_EXTENSION_LABEL_ENCAPSULATION, 0) && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "advanced_extension_label_mode", 0))?1:0;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_NOP                                                , ALU_SUB(REG_OP(3) ,REG_OP(0) , REG_OP(SZ))    , " ---                                         ; Rsz = R3-R0 (calc native IP length + ETH + Enc)");
             INSTR( CE_NOP                                                , ALU_NOP                                       , " ---                                         ; ---");
             INSTR( CE_NOP                                                , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "---                                          ; Rsz -= 16 (Prepare for PP-Copy loop with seperate size register)");
            
            for (i = 0; i < 6; i++) {
                INSTR( CE_COPY( GEN, R_OFST(3, 0) , R_SIZE(SZ, 0) )             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "copy IP/ETH/Enc hdrs ");
                INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(SZ, 8) )             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "copy IP/ETH/Enc hdrs ");
            }

             INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)        , ALU_NOP                                       , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label   ; ---");
             INSTR( CE_NOP                                                , ALU_NOP                                       , "---                                          ; ---");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5, LFEM_LSHIFT_12)  , ALU_SUB(FEM, CNST(0), REG_OP(3))             , "FEM = {FRR-label[3:0],12'h0}                 ; R3 = {EXP[2:0],S,TTL[7:0]}");
             INSTR( CE_NOP                                                , ALU_NOP                                       , "---                                          ; ---");   
             INSTR( CE_NOP                                                , ALU_ADD(FEM, REG_OP(3), REG_OP(3))            , "---                                          ; R3 += FEM [== {Label[3:0],EXP[2:0],S,TTL[7:0]}]");
             INSTR( CE_NOP                                                , ALU_NOP                                       , "---                                          ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))               , ALU_NOP                                       , "Adding FRR[15:0]                         ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))        , ALU_NOP                                       , "Adding FRR[31:16] from EesData2          ; ---");

            
             INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "copy link layer");
             INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))             , ALU_NOP                                       , "copy link layer");
             INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "copy link layer");
             INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))             , ALU_NOP                                       , "copy link layer");
             INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                , ALU_NOP                                       , "copy link layer");
        }else {
             INSTR( CE_NOP                                                , ALU_SUB( REG_OP(3), REG_OP(2), REG_OP(SZ) ), " ---                                             ;Rsz = R3-R2 (calc native IP length)");
             INSTR( CE_NOP                                                , ALU_SUB( REG_OP(2), REG_OP(0), REG_OP(1)  ), " ---                                             ;R1 = R2-R0 (calc Overlay length)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))             , ALU_SUB( REG_OP(3), CNST(16), REG_OP(3)  ), "Copy 8B from offset R3                           ; R3 = R3-16 (calc next size)");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))            , ALU_SUB( REG_OP(SZ), CNST(24), REG_OP(SZ) ), "Copy 8B from offset R3-16                        ; rsz=rsz-24");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))           , ALU_SUB( REG_OP(3), CNST(16), REG_OP(3)  ), "Copy Remainder from offset R3 (updated in instr2); r3=r3-16");
            if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SET(104, REG_OP(SZ) )   , "Copy 8B from offset R3-16. size rsz              ; RSZ=104 (offset to inner VLAN)");
                 INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))      , ALU_NOP                                                          , "Copy 8B from offset R3-16. size rsz-8            ; ----");
                 INSTR( CE_LREAD(RES, R_OFST(SZ,-5), LFEM_4_LSBS)       , ALU_SET(100, REG_OP(3)  ), "extract ees-data3[3:0] -> vlan_tag_size          ; R3 = 100");
            } else {
                 INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_NOP                                         , "Copy 8B from offset R3-16. size rsz              ; ---");
                 INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))      , ALU_SET(100, REG_OP(SZ) ), "Copy 8B from offset R3-16. size rsz-8            ; RSZ=100 (offset to inner VLAN)");
                 INSTR( CE_FLREAD(PrgeDataFieldEesData3, 0, LFEM_4_LSBS), ALU_SET(104, REG_OP(3)  ), "extract ees-data3[3:0] -> vlan_tag_size          ; R3 = 101");
            }
             INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))            , ALU_SUB( REG_OP(0) , CNST(16)   , REG_OP(0)  ), "Copy 8B from Native Eth @ offset R0              ; Calc next size R0=R0-16");
             INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))           , ALU_SUB( FEM       , CNST(0)    , REG_OP(0)  ), "Copy 8B from Native Eth @ offset R0-16           ; R0 = Tag-Size");
             INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))            , ALU_NOP,                   "Copy Remainder bytes from Native Eth @ offset R0 ; r2 = offset to overlay MSB");
             INSTR( CE_COPY(GEN, R_OFST(2,0)  , R_SIZE(1,0))            , ALU_SUB( REG_OP(2) , REG_OP(1)  , REG_OP(2)  ), "Copy 8B from offset R2 (Overlay)                 ; ---");
             INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(1,-8))           , ALU_NOP                                         , "Copy Next 8B from offset R2 (Overlay)            ; ---");
            if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_LREAD(GEN, R_OFST(2,6), LFEM_FRR_EXP_S_TTL)  , ALU_SET(0x8847 , REG_OP(1) )  , "FEM = EXP[2:0],0,TTL[7:0] for the FRR label      ; R1=0x8847");
                 INSTR( CE_NOP                                          , ALU_NOP                                              , "---                                               ;if(tag-size==8),RSZ=104");
            } else {
                 INSTR( CE_LREAD(GEN, R_OFST(2,6), LFEM_FRR_EXP_S_TTL)  , ALU_NOP                                         , "FEM = EXP[2:0],0,TTL[7:0] for the FRR label      ; ---");
                 INSTR( CE_NOP                                          , ALU_NOP                                         , "---                                               ; ---");
            }
             INSTR( CE_LREAD(RES, R_OFST(SZ,0), LFEM_LSHIFT_12)         , ALU_SUB( FEM, CNST(0)    , REG_OP(2)  ), "FEM = {FRR-label[3:0],12'h0}                     ; R2 = {EXP[2:0],S,TTL[7:0]}");
             INSTR( CE_NOP                                              , ALU_NOP                                         , "---                                               ; ---");
             INSTR( CE_NOP                                              , ALU_ADD( FEM, REG_OP(2)  , REG_OP(2)  ), "---                                              ; R2 += FEM [== {Label[3:0],EXP[2:0],S,TTL[7:0]}]");
             INSTR( CE_NOP                                              , ALU_NOP                                         , "---                                              ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))             , ALU_NOP                                         , "Add FRR[15:0]                                    ; ---");
             INSTR( CE_COPY(RES, R_OFST(SZ,-1), C_SIZE(2))              , ALU_NOP                                         , "Add FRR[31:16]                                   ; ---");
           if (advanced_extension_mpls_label_mode) {
                 INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))         , ALU_NOP                                         , "copy from fixed ethertype             ; ---");
            } else {
                 INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))   , ALU_NOP                                         , "copy from ees_data1[15:0] ether-type             ; ---");
            }
             INSTR( CE_COPY(RES, R_OFST(3,0) , R_SIZE(0,-4))            , ALU_NOP                                         , "copy from ees_data3 vlan tag with size r0-4(vlan_tag size), offset r3 ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData1, -4, C_SIZE(5))      , ALU_NOP                                         , "copy from ees_data1[55:16] SA 5 LSbytes          ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(7))       , ALU_NOP                                         , "copy from ees_data2[55:0] DA 6bytes, SA 1MSbyte  ; ---");
        }
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        uint16 advanced_extension_mpls_label_mode;

        advanced_extension_mpls_label_mode = (soc_property_get(unit, spn_ROO_EXTENSION_LABEL_ENCAPSULATION, 0) && soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "advanced_extension_label_mode", 0))?1:0;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(3) , REG_OP(0)  , REG_OP(SZ) ), " --- ;Rsz = R3-R0 (calc native + mpls size)");
         INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))      , ALU_SUB(   REG_OP(SZ), CNST(24)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-24");
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");

        if (advanced_extension_mpls_label_mode) {
            
             INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)  , ALU_NOP                                         , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label ; ---");
             INSTR(  CE_LREAD(GEN, R_OFST(0,-9), LFEM_4_LSBS)           , ALU_NOP                                         , "NOP");
             INSTR( CE_LREAD(GEN, R_OFST(0,-4), LFEM_LSHIFT_12)       , ALU_SUB(   FEM       , CNST(0)    , REG_OP(3)  ), "FEM = {FRR-label[3:0],12'h0} from vlan tag ; R3 = EXP[2:0],S,TTL[7:0]");
             INSTR( CE_NOP                                          , ALU_SUB(   FEM , CNST(4)   , REG_OP(2)  ), "--- ; R2 = size of {Outervlan?}");
             INSTR( CE_NOP                                          , ALU_ADD(   FEM       , REG_OP(3)  , REG_OP(3)  ), "--- ; R3 += FEM [== {Label[3:0],EXP[2:0],0,TTL[7:0]}]");
             INSTR( CE_NOP                                          , ALU_SET(   0x8847              , REG_OP(1)  )        , "NOP:R1=0x8847");
             INSTR( CE_FCOPY(PrgeDataFieldR3,0, C_SIZE(2))          , ALU_NOP                                         , "Add FRR[15:0] ; ---");
             INSTR( CE_COPY(GEN, R_OFST(0,-5), C_SIZE(2))             , ALU_NOP                                         , "Add FRR[31:16] ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1,0, C_SIZE(2))          , ALU_NOP                                         , "Add ether type  ; ---");
            
            
             INSTR( CE_COPY(GEN, C_OFST(32)  , R_SIZE(2,0))        , ALU_NOP                                         , "Copy InnerVLAN?");
             INSTR( CE_COPY(GEN, C_OFST(24)   , C_SIZE(6)  )        , ALU_NOP                                         , "Copy SA; ---");
             INSTR( CE_COPY(GEN, C_OFST(12)   , C_SIZE(6)  )        , ALU_NOP                                         , "Copy DA; ---");


        } else {
            
             INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)  , ALU_NOP                                         , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label ; ---");
             INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
             INSTR( CE_LREAD(GEN, C_OFST(32), LFEM_LSHIFT_12)       , ALU_SUB(   FEM       , CNST(0)    , REG_OP(3)  ), "FEM = {FRR-label[3:0],12'h0} from vlan tag ; R3 = EXP[2:0],S,TTL[7:0]");
             INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(0) , CNST(16)   , REG_OP(2)  ), "--- ; R2 = size of {InnerVLAN?,Eth-type}");
             INSTR( CE_NOP                                          , ALU_ADD(   FEM       , REG_OP(3)  , REG_OP(3)  ), "--- ; R3 += FEM [== {Label[3:0],EXP[2:0],0,TTL[7:0]}]");
             INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
             INSTR( CE_FCOPY(PrgeDataFieldR3,0, C_SIZE(2))          , ALU_NOP                                         , "Add FRR[15:0] ; ---");
             INSTR( CE_COPY(GEN, C_OFST(31), C_SIZE(2))             , ALU_NOP                                         , "Add FRR[31:16] ; ---");
            
            
             INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(2,0))        , ALU_NOP                                         , "Copy Eth-Type and InnerVLAN?");
             INSTR( CE_COPY(GEN, C_OFST(24)   , C_SIZE(6)  )        , ALU_NOP                                         , "Copy SA; ---");
             INSTR( CE_COPY(GEN, C_OFST(12)   , C_SIZE(6)  )        , ALU_NOP                                         , "Copy DA; ---");
        }
        
        if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists == 1)) {
            INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)      , ALU_NOP                           , "Extract Resolved.Data.tm-port-var (1B)" );
            INSTR( CE_NOP                                                 , ALU_NOP                           , "NOP");
            INSTR( CE_NOP                                                 , ALU_ADD( FEM, CNST(0), REG_OP(SZ) ), "ALU: RSZ = LFEM (tm-port-var value)");
            INSTR( CE_NOP                                                 , ALU_NOP                           , "NOP");
            INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )    , ALU_NOP                           , "Copy Additional 1B based on the REG_SZ size");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

   res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
       unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
  
       res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC2_JER);
       SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
       res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
       SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        
         INSTR( CE_NOP                                      , ALU_SUB( REG_OP(3) , REG_OP(1)    , REG_OP(SZ) ), " -- ; Rsz = R3-R1 (forwarding haeder + first mpls header)");
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , C_SIZE(8))   , ALU_SUB( REG_OP(3), CNST(16)     , REG_OP(3)), " --- ; ---");

         INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,-8))   , ALU_SUB( REG_OP(SZ), CNST(24)     , REG_OP(SZ) ),   "Copy 8B from offset R3    ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16)) , ALU_NOP,                      "Copy 8B from offset R3-16    ; RSZ = RSZ-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))    , ALU_SUB( REG_OP(3), CNST(16)     , REG_OP(3) ),    "Copy 8B from offset R3 ; R3 = R3-16"   );
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile4, 0 , LFEM_SHIFT_BIT4_TO_BIT1) , ALU_NOP,                       " Read ExtLabel1-Valid ; --");
        }
        else
        {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile2, 0 , LFEM_SHIFT_BIT4_TO_BIT1) , ALU_NOP,                       " Read ExtLabel1-Valid ; --");
        }
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))   , ALU_NOP,                                          "Copy 8B from offset R3    ; RSZ = RSZ-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-16))  , ALU_ADD( FEM,CNST(0),REG_OP(SZ)),                 "Copy 8B from offset R3-16 ; RSZ=FEM "  );


        
         INSTR( CE_LREAD(PKT, C_OFST(20)  , LFEM_LSHIFT_12)                   , ALU_NOP, "Copy 4 LSBS of load-balance-key, ; ------"   );
         INSTR( CE_LREAD(PKT, C_OFST(20)  , LFEM_LSHIFT_4_BITOR_RSHIFT_4)     , ALU_NOP, "Copy 16 msb of EL ;--"   );

         INSTR( CE_NOP                                                        , ALU_ADD(FEM,CNST(0),REG_OP(3)) , "---;R3=el 16Lsb"   );
         INSTR( CE_LREAD(GEN, R_OFST(1,0)  , LFEM_MPLS_EXP_TTL)               , ALU_ADD(FEM,CNST(0),REG_OP(3)), " Copy {exp,ttl} from B2 label;R3=FEM"   );
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_ADD(REG_OP(1),CNST(0),REG_OP(2)) , "Copy 16lsb of EL;R2=R1");
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_ADD(FEM,CNST(0x7000),REG_OP(3))  , "Copy 16msb of EL,R3=ELI");
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile5, 0, LFEM_SHIFT_BIT4_TO_BIT1) , ALU_SET( 0 ,REG_OP(1)   )            , "Read ExtLabel2-Valid;R1=0");
        }
        else
        {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile3, 0, LFEM_SHIFT_BIT4_TO_BIT1) , ALU_SET( 0 ,REG_OP(1)   )            , "Read ExtLabel2-Valid;R1=0");
        }

         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(1),REG_OP(0),REG_OP(3)) , "COPY 16 lsb of ELI;R3=R1-R0");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SET_IF(FEM, EQ, CNST(2), CNST(2), REG_OP(SZ)), "Copy 16msb of ELI;If FEM==2,RSZ=2");

        
         INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_12_LSBS)              , ALU_NOP            ,                        "Read MPLS EXP,S,TTL;--");
         INSTR( CE_NOP                                                , ALU_NOP,                                    "--;--");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12) , ALU_SUB( FEM       , CNST(0)      , REG_OP(1)), "READ ext label 4lsb; R1 = FEM");
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                , ALU_NOP,   "Copy 8B from offset R2+8 ; --");
         INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(3,-8))             , ALU_ADD( FEM     , REG_OP(1)  , REG_OP(1)  ),   "Copy 8B from offset R2-8 ; R1 = R1+label[3:0] ");
         INSTR( CE_NOP                                                , ALU_NOP, "READ ext label 4lsb; R1 = FEM");
		
        if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))            , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))     , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
        }

        
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");

       res = arad_egr_prge_mgmt_build_program_end(unit);
       SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
   }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
    
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_NON_BOS_ELI_AT_ENC1_JER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
              SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
    

        
         INSTR( CE_NOP                                      , ALU_SUB( REG_OP(3) , REG_OP(1)    , REG_OP(SZ) ), " -- ; Rsz = R3-R1 (forwarding haeder + second mpls header)");
         INSTR( CE_NOP                                      , ALU_SUB( REG_OP(3), CNST(8)     , REG_OP(3) ),   " --- ; ---");

         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-4))   , ALU_SUB( REG_OP(SZ), CNST(20)     , REG_OP(SZ) ),  "Copy 8B from offset R3    ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-12)) , ALU_SUB( REG_OP(3), CNST(16)    , REG_OP(3)  ), "Copy 8B from offset R3-16    ; RSZ = RSZ-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))    , ALU_SUB( REG_OP(SZ), CNST(8)     , REG_OP(SZ) ),  "Copy 8B from offset R3 ; R3 = R3-16"   );
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile4, 0    , LFEM_SHIFT_BIT4_TO_BIT1) , ALU_NOP, " Read ExtLabel1-Valid ; RSZ = RSZ-8B-4B (remove Label B2 size)");
        }
        else 
        {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile2, 0    , LFEM_SHIFT_BIT4_TO_BIT1) , ALU_NOP, " Read ExtLabel1-Valid ; RSZ = RSZ-8B-4B (remove Label B2 size)");
        }
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))   , ALU_NOP,                                          "Copy 8B from offset R3    ; RSZ = RSZ-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))  , ALU_ADD( FEM,CNST(0),REG_OP(SZ)),  "Copy 8B from offset R3-16 ; RSZ=FEM "  );     	
	
    
        
         INSTR( CE_LREAD(PKT, C_OFST(20)  , LFEM_LSHIFT_12)                   , ALU_NOP, "Copy 4 LSBS of load-balance-key, ; ------"   );
         INSTR( CE_LREAD(PKT, C_OFST(20)  , LFEM_LSHIFT_4_BITOR_RSHIFT_4)     , ALU_NOP, "Copy 16 LSBs of  mpls1 enc, set BoS ;--"   );
    
         INSTR( CE_NOP                                                        , ALU_ADD(FEM,CNST(0),REG_OP(3)) , "---;R3=el 16Lsb"   );
         INSTR( CE_LREAD(GEN, R_OFST(1,8)  , LFEM_MPLS_EXP_TTL)              , ALU_ADD(FEM,CNST(0),REG_OP(3)), " Copy {exp,ttl} from 1st label;R3=FEM"   );
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_ADD(REG_OP(1),CNST(0),REG_OP(2)) , "Copy 16lsb of EL;R2=R1");
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_ADD(FEM,CNST(0x7000),REG_OP(3))  , "Copy 16msb of EL,R3=ELI");
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile5, 0, LFEM_SHIFT_BIT4_TO_BIT1), ALU_SET( 0 ,REG_OP(1)   )            , "Read ExtLabel2-Valid;R1=0");
        }
        else {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile3, 0, LFEM_SHIFT_BIT4_TO_BIT1), ALU_SET( 0 ,REG_OP(1)   )            , "Read ExtLabel2-Valid;R1=0");
        }

         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(1),REG_OP(0),REG_OP(3)) , "COPY 16 lsb of ELI;R3=R1-R0");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SET_IF(FEM, EQ, CNST(2), CNST(2), REG_OP(SZ)), "Copy 16msb of ELI;R1=FEM");

        
         INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_12_LSBS)              , ALU_ADD(REG_OP(3),CNST(4),REG_OP(3))            , "Read MPLS EXP,S,TTL;R3=R3+4");
         INSTR( CE_NOP                                                , ALU_NOP,"--;IF R1>0,RSZ = 2");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12) , ALU_SUB( FEM       , CNST(0)      , REG_OP(1)), "READ ext label 4lsb; R1 = FEM");
         INSTR( CE_COPY(GEN, R_OFST(2,8), R_SIZE(3,0))                , ALU_NOP,                                    "Copy 8B from offset R2+8 ; --");
         INSTR( CE_COPY(GEN, R_OFST(2,-8), R_SIZE(3,-8))              , ALU_ADD( FEM     , REG_OP(1)  , REG_OP(1)  ),   "Copy 8B from offset R2-8 ; R1 = R1+label[3:0] ");
         INSTR( CE_NOP                                                , ALU_NOP, "READ ext label 4lsb; R1 = FEM");

        if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))            , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))     , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
        }

        
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
    

    
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        
         INSTR( CE_NOP                                          , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " -- ; Rsz = R3-R2 (forwarding haeder + second mpls header)");
         INSTR( CE_NOP                                          , ALU_NOP,                                          " -- ; ---");

         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))     , ALU_SUB( REG_OP(3), CNST(16)     , REG_OP(3) ),    "Copy 8B from offset R3    ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,-8))  , ALU_SUB( REG_OP(SZ), CNST(24)     , REG_OP(SZ)  ), "Copy 8B from offset R3-16    ; RSZ = FEM");
         INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-16))     , ALU_SUB( REG_OP(3), CNST(16)     , REG_OP(3) ),    "Copy 8B from offset R3 ; R3 = R3-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_NOP,                                           "Copy 8B from offset R3    ; RSZ = RSZ-16");
         INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))      , ALU_NOP,                                           "Copy 8B from offset R3-32 ;--- "  );


        
         INSTR( CE_LREAD(PKT, C_OFST(20)  , LFEM_LSHIFT_12)                   , ALU_NOP, "Copy 4 LSBS of load-balance-key, ; ------"   );
         INSTR( CE_LREAD(PKT, C_OFST(20)  , LFEM_LSHIFT_4_BITOR_RSHIFT_4)     , ALU_NOP, "Copy 16 MSBs EL  ;--"   );

         INSTR( CE_LREAD(GEN, R_OFST(2,0)  , LFEM_MPLS_EXP_TTL)               , ALU_ADD(FEM,CNST(256),REG_OP(3)) , "Copy {exp,ttl} from B2 label;R3=el 16Lsb,set BoS"   );
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile4, 0,LFEM_SHIFT_BIT4_TO_BIT1)  , ALU_ADD(FEM,CNST(0),REG_OP(3)), " Read ExtLabel1-Valid;R3=FEM"   );
        } 
        else
        {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile2, 0,LFEM_SHIFT_BIT4_TO_BIT1)  , ALU_ADD(FEM,CNST(0),REG_OP(3)), " Read ExtLabel1-Valid;R3=FEM"   );
        }
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_ADD(FEM,CNST(0x7000),REG_OP(3)) , "Copy 16lsb of EL;R3=FEM");
         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_SUB( FEM, CNST(0)     , REG_OP(SZ)) ,  "Copy 16msb of EL,R3=ELI");
         INSTR( CE_COPY(GEN, R_OFST(2,0),C_SIZE(0))                           , ALU_SET( 0 ,REG_OP(1)   ),                  "--;R1=0");



         INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                       , ALU_NOP , "COPY 16 lsb of ELI;R1=RSZ");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SUB(FEM,CNST(256),REG_OP(1)) , "COPY 16 lsb of ELI;R1=FEM-256");
         INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_12_LSBS)                      , ALU_NOP  , "Read C2 EXP,S,TTL;if FEM==2,RSZ=2");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(2),REG_OP(0),REG_OP(3)), "Copy 16msb of ELI;R3=R2-R0");


        
        if (SOC_IS_JERICHO_PLUS(unit)) {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile5, 0, LFEM_SHIFT_BIT4_TO_BIT1)  , ALU_SUB( FEM       , CNST(0)      , REG_OP(1)),  "Read ExtLabel2-Valid;R1=FEM");
        }
        else
        {
             INSTR( CE_FLREAD(PrgeDataFieldOutLifProfile3, 0, LFEM_SHIFT_BIT4_TO_BIT1)  , ALU_SUB( FEM       , CNST(0)      , REG_OP(1)),  "Read ExtLabel2-Valid;R1=FEM");
        }
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12) , ALU_NOP, "READ ext label 4lsb; R1 = FEM");
         INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(3,-2))              , ALU_SET_IF(FEM, EQ, CNST(2), CNST(2), REG_OP(SZ)) ,"Copy 8B from offset R2-4 ; --");
         INSTR( CE_COPY(GEN, R_OFST(2,-20), R_SIZE(3,-10))            , ALU_ADD( FEM     , REG_OP(1)  , REG_OP(1)  ),   "Copy 8B from offset R2-20 ; R1 = R1+label[3:0] ");
         INSTR( CE_NOP                                                , ALU_NOP           , "---;---");
		
        if (soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0)) {
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))            , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))     , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
        }
		

        
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(1)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding haeder + second mpls header)");
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");

         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );

        
         INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M) , ALU_SUB(REG_OP(1) , CNST(0),REG_OP(2))                           , "Read ExtLabel1-Valid, R2=R1");
         INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
         INSTR( CE_NOP                                                                                                 , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
         INSTR(  CE_FLREAD(PrgeDataFieldEesData2, 0 , LFEM_LSHIFT_12)        , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of DataLabel1");
         INSTR(  CE_NOP        ,                                                                                           ALU_NOP, " --- ; R1 = 2LSB of DataLabel1");
         INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                                                  , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
         INSTR( CE_FCOPY(PrgeDataFieldEesData1, -5, C_SIZE(2))                   ,ALU_SUB(REG_OP(2) , REG_OP(0),REG_OP(3) ) , "Copy DataLabel1 2LSB, R3=R2-R0");
         INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)            , ALU_NOP, "Copy DataLabel1 2MSB");
     
         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                   ,ALU_SET(2,REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, R2=2");
         INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(3,-8))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "Copy DataLabel1 2MSB");     
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
         INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
      
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        
         INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
         INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
         INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
    
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
    
        
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding haeder + second mpls header)");
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");

         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );

         INSTR( CE_LREAD(GEN, R_OFST(2,0), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M)      , ALU_NOP   ,                                       "Read ExtLabel1-Valid,----");
         INSTR( CE_COPY(GEN, R_OFST(2,0), C_SIZE(0))                      , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "----- ; R3 = {EXP,BOS=1,TTL}");
         INSTR(   CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(4))    ,       ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), " Copy  Datalabel 4 Bytes ; RSZ=extLabel size");
         INSTR( CE_NOP          ,                                                                                     ALU_SUB( FEM       , CNST(0X100)      , REG_OP(1) ), " --- ; R1 = 2LSB of Gen mpls label + bos=1");
         INSTR(CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     ,  ALU_SUB(REG_OP(2),REG_OP(0),REG_OP(1))      , "Copy DataLabel1 2LSB, R1= R2");
         INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                 ,  ALU_NOP      , "Copy Gen Label 2LSB,------");
         INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)      , REG_OP(1) ), "Copy Coe flag, R1=extLabel 2LSB + R3");
         INSTR(  CE_COPY(GEN, R_OFST(2,-4), R_SIZE(1,-2))                 , ALU_SET(2,REG_OP(2))    , "Copy Rest of Gen mpls label, R2=2");
         INSTR( CE_NOP                                                                                         ,      ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "If (!CoE)  R2=0");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
         INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP , "Copy ExtLabel1 2MSB");

         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        
         INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
         INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
         INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }


        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
        
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (forwarding haeder + second mpls header)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
        
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M)      , ALU_SUB(REG_OP(2) , CNST(0),REG_OP(2))                           , "Read ExtLabel1-Valid, R2=R1");
             INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4  , LFEM_LSHIFT_12)    , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
             INSTR( CE_NOP                                                    , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
             INSTR(  CE_FLREAD(PrgeDataFieldEesData2, 0 , LFEM_LSHIFT_12)     , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of DataLabel1");
             INSTR(  CE_NOP                                                   , ALU_NOP, " --- ; R1 = 2LSB of DataLabel1");
             INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                  , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
             INSTR( CE_FCOPY(PrgeDataFieldEesData1, -5, C_SIZE(2))            , ALU_SUB(REG_OP(2) , REG_OP(0),REG_OP(3) ) , "Copy DataLabel1 2LSB, R3=R2-R0");
             INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_NOP, "Copy DataLabel1 2MSB");
    
             INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                    , ALU_SET(2,REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, R2=2");
             INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(3,-8))                 , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "Copy DataLabel1 2MSB");     
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
          
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
            
             INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
             INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
             INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
             INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      
        
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        }
        



    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding header)");
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(SZ) , CNST(4)      , REG_OP(SZ)  ), " --- ; R3 -= 4 (Adjust offset)");
         INSTR( CE_NOP                                                    , ALU_NOP  , " ---,----");

          
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");

        
         INSTR( CE_LREAD(GEN, R_OFST(2,8), LFEM_MPLS_EXP_BOS_TTL)          , ALU_NOP                                         , "Read MPLS EXP,S,TTL");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M)       , ALU_NOP                           , "Read ExtLabel1-Valid, ");
         INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
         INSTR( CE_NOP                                                     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
         INSTR(  CE_FLREAD(PrgeDataFieldEesData2, 0 , LFEM_LSHIFT_12)     , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of DataLabel1");
         INSTR(  CE_NOP                                                   , ALU_NOP, " --- ; ");
         INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                  , ALU_ADD( FEM       , CNST(0)    , REG_OP(1)  ), " copy datalabel 2LSB ; R1 = 2LSB of ExtLabel2");
         INSTR( CE_FCOPY(PrgeDataFieldEesData1, -5, C_SIZE(2))            , ALU_SUB(REG_OP(2) , REG_OP(0),REG_OP(3) ) , "Copy dataLabel 2MSB, R3=R2-R0");
         INSTR(     CE_NOP                                                , ALU_NOP, "------------");
         INSTR( CE_LREAD(GEN, R_OFST(2,0), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
         INSTR(  CE_NOP                                                   , ALU_NOP, " --- ; ");
         INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)        , ALU_ADD( FEM       , REG_OP(1)    , REG_OP(1)  ), " --- ; R1 = extlabel 2LSB + (exp,ttl)");

         INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                    , ALU_SET(2,REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, R2=2");
         INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(3,-8))                 , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "if(!coe), R2=0");     
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
         INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");

         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        
         INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
         INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
         INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_NOP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding haeder + second mpls header)");
         INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");

         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
         INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
         INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");


        
         INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M) , ALU_SUB(REG_OP(1) , CNST(0),REG_OP(2))                           , "Read ExtLabel1-Valid, R2=R1");
         INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
         INSTR( CE_NOP                                                                                                 , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
         INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         ,  ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
         INSTR( CE_NOP                                                                                , ALU_SET(2,REG_OP(2)), "Copy DataLabel1 2MSB,R2=2");
     
         INSTR( CE_NOP                    ,                                                           ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, ");
         INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
         INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
      
         INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
         INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        
         INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
         INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
         INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
         INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = arad_egr_prog_editor_mpls_extended_4_jer(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), " ---                           ; R3 = {EXP,S,TTL}");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , "Read ExtLabel1[3:0]<<12        ; ---");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                           ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB            ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB            ; ---");

            
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
        } else {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
             INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " Read ProgVar                  ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB            ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB            ; ---");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), " ---                            ; RSZ=R0-12");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");

             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH                       ; R1=0X8100");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH                       ; ");
            
             INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)  ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)              ; ---");
             INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH                       ; ---");
             INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH                       ; ---");      
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            
            if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_frr_label_ttl_mode", 0) == 1) {
                 INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
            } else {
                 INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)            , ALU_NOP                                         , "Read MPLS EXP,S(set to 0), set TTL=255");
            }
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                           ; ---");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
             INSTR( CE_NOP                                                    , ALU_NOP                                          , " ---                           ; ---");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                           ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy FRR ExtLabel1 2LSB        ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel1 2MSB        ; --");

            
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
        } else {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                            ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " ---                            ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)        , ALU_NOP                                         , "Read MPLS EXP,S(set to 0), set TTL=255  ; ---");
             INSTR( CE_NOP                                                    , ALU_SET(2, REG_OP(2))                           , " ---                            ; R2=2");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , "Read ExtLabel1[3:0]<<12        ; ---");
             INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                            ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy FRR ExtLabel1 2LSB        ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel1 2MSB        ; ---");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), " ---                            ; RSZ=R0-12");
             INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                             ; --- ");

             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH                       ; R1=0X8100");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH                       ; ---");
            
             INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)  ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)              ; ---");
             INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH                       ; ---");
             INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH                       ; ---");
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            
            if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_frr_label_ttl_mode", 0) == 1) {
                 INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
                 INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
            } else {
                 INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
                 INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)            , ALU_NOP                                         , "Read MPLS EXP,S(set to 0), set TTL=255 ; R2=2");
            }
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL=255}");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel2");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB            ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB            ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy FRR ExtLabel2 2LSB        ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel2 2MSB        ; ---");

            
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
        } else {
            
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
             INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
             INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
             INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            
             INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
             INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)            , ALU_SET(2, REG_OP(2))                           , "Read MPLS EXP,S(set to 0), set TTL=255 ; R2=2");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
             INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12       ; R3 = {EXP,S,TTL=255}");
             INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
             INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel2");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
             INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "Copy FRR ExtLabel2 2LSB        ; RSZ=R0-12");
             INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel2 2LSB        ; ---");

             INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH                       ; R1=0X8100");
             INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH                       ; ---");
            
             INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)  ; ---");
             INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)              ; ---");
             INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH                       ; ---");
             INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH                       ; ---");      
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        if (customer_ftmh_dsp_extension_add) {
            ftmh_size += 2;
        }

        fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0) && (soc_property_get(unit, spn_SPLIT_HORIZON_FORWARDING_GROUPS_MODE, 1) == 1)) {
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

            
            INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(14), REG_OP(SZ))                                             , "---                                       ; RSZ = R3 - 14 (candidate-size - |BDA,BSA,BTAG|)");
            INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                                              , "---                                       ; R3 -= 8");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))          , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                                             , "Copy ETH                                  ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                                              , "Copy ETH                                  ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                                             , "Copy ETH                                  ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                                              , "Copy ETH                                  ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                                             , "Copy ETH                                  ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SET(6, REG_OP(1))                                                                 , "Copy PBB except BDA,BSA                   ; R1 = 6");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SET(0, REG_OP(SZ))                                                                , "Copy PBB except BDA,BSA                   ; RSZ = 0");

            
            INSTR( CE_LCOPY(GEN, C_OFST(14*2), C_SIZE(2), LFEM_SPB_STAMP_LEFT_NIBBLE_8)   , ALU_NOP                                                         , "Copy {4'h8, BTAG[11:0]} from EES-Data3    ; ---");

            
            INSTR( CE_LREAD(PKT, C_OFST(fld_val<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)         , ALU_SET_IF(REG_OP(0), NEQ, CNST(0), REG_OP(1), REG_OP(SZ))  , "FEM = PPH.Forwarding-Header-Offset        ; if (R0 != 0) RSZ = R1");
            INSTR( CE_LREAD(GEN, C_OFST(2*2), LFEM_SPB_READ_BDA_WITHOUT_ORIENTATION)     , ALU_SET(0, REG_OP(SZ))                                           , "Read the BDA MSB without BDA[47], BDA[43] ; RSZ = 0");
            INSTR( CE_NOP                                           , ALU_SET_IF(FEM, EQ, CNST(0), REG_OP(SZ), REG_OP(SZ))                                  , "---                                       ; if (FEM == 0) RSZ = RSZ (override previous instr)");
            INSTR( CE_NOP                                           , ALU_ADD(FEM, CNST(0), REG_OP(3))                                                      , "---                                       ; R3 = FEM");
            INSTR( CE_NOP                                           , ALU_SET(3, REG_OP(1))                                                                 , "---                                       ; R1 = 3");
            INSTR( CE_LREAD(GEN, C_OFST(1*2), LFEM_BIT_0)           , ALU_SUB(CNST(6), REG_OP(SZ), REG_OP(SZ))                                              , "FEM = BDA[40]                             ; RSZ = 6 - RSZ");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(SZ,0))  , ALU_SET(0, REG_OP(2))                                                                 , "BSA Copy attempt from prog var            ; R2 = 0");
            INSTR( CE_COPY(GEN, C_OFST(12*2), R_SIZE(SZ,0))         , ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(2))                                    , "BSA Copy attempt from candidate           ; if (FEM == 1) R2 = R1");
            INSTR( CE_NOP                                           , ALU_SET_IF(REG_OP(0), EQ, CNST(0), CNST(0), REG_OP(2))                                , "---                                       ; if (R0 == 0) R2 = 0 (reset R2)");
            INSTR( CE_LREAD(GEN, C_OFST(14*2), LFEM_SPB_READ_BITS_FROM_BTAG_FIELD) ,  ALU_NOP                                                               , "Read the missing BDA bits from BTAG field ; ---");
            INSTR( CE_NOP                                           , ALU_SUB(CNST(3), REG_OP(2), REG_OP(2))                                                , "---                                       ; R2 = 3 - R2");
            INSTR( CE_COPY(GEN, C_OFST(22*2), R_SIZE(2,0))          , ALU_ADD(FEM, REG_OP(3), REG_OP(3))                                                    , "BDA LSB copy attempt from ISID            ; R3 += FEM (Add the two missing bits to the BDA MSB)");
            INSTR( CE_COPY(GEN, C_OFST(6*2), R_SIZE(2,0))           , ALU_NOP                                                                               , "BDA LSB copy attempt from candidate       ; ---");
            INSTR( CE_COPY(GEN, C_OFST(3*2), C_SIZE(1))             , ALU_NOP                                                                               , "Copy BDA[31:24]                           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))          , ALU_NOP                                                                               , "Copy the fixed BDA MSB                    ; ---");

        } else {
            
            INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ))                         , "---                                 ; RSZ = R3 - 12 (candidate-size - |BDA,BSA|)");
            INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                          , "---                                 ; R3 -= 8");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))          , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                         , "Copy ETH                            ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                          , "Copy ETH                            ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                         , "Copy ETH                            ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                          , "Copy ETH                            ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                         , "Copy ETH                            ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SET(6, REG_OP(1))                                             , "Copy PBB except BDA,BSA             ; R1 = 6");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SET(0, REG_OP(SZ))                                            , "Copy PBB except BDA,BSA             ; RSZ = 0");

            
            INSTR( CE_LREAD(PKT, C_OFST(fld_val<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)         , ALU_SET_IF(REG_OP(0), NEQ, CNST(0), REG_OP(1), REG_OP(SZ))        , "FEM = PPH.Forwarding-Header-Offset  ; if (R0 != 0) RSZ = R1 (reset RSZ)");
            INSTR( CE_NOP                                                                     , ALU_SET(0, REG_OP(SZ))                                            , "---                                 ; RSZ = 0");
            INSTR( CE_NOP                                                                     , ALU_SET_IF(FEM, EQ, CNST(0), REG_OP(SZ), REG_OP(SZ))             , "---                                 ; if (FEM == 0) RSZ = RSZ (override previous instr)");
            INSTR( CE_NOP                                                                     , ALU_SET(3, REG_OP(1))                                             , "---                                 ; R1 = 3");
            INSTR( CE_LREAD(GEN, C_OFST(1*2), LFEM_BIT_0)                                     , ALU_SUB(CNST(6), REG_OP(SZ), REG_OP(SZ))                          , "FEM = BDA[40]                       ; RSZ = 6 - RSZ");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(SZ,0))                            , ALU_SET(0, REG_OP(2))                                             , "BSA Copy attempt from prog var      ; R2 = 0");
            INSTR( CE_COPY(GEN, C_OFST(12*2), R_SIZE(SZ,0))                                   , ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(2))                , "BSA Copy attempt from candidate     ; if (FEM == 1) R2 = R1");
            INSTR( CE_NOP                                                                     , ALU_SET_IF(REG_OP(0), EQ, CNST(0), CNST(0), REG_OP(2))            , "---                                 ; if (R0 == 0) R2 = 0 (reset R2)");
            INSTR( CE_NOP                                                                     , ALU_NOP                                                           , "---                                 ; ---");
            INSTR( CE_NOP                                                                     , ALU_SUB(CNST(3), REG_OP(2), REG_OP(2))                            , "---                                 ; R2 = 3 - R2");
            INSTR( CE_COPY(GEN, C_OFST(22*2), R_SIZE(2,0))                                    , ALU_NOP                                                           , "BDA LSB copy attempt from ISID      ; ---");
            INSTR( CE_COPY(GEN, C_OFST(6*2), R_SIZE(2,0))                                     , ALU_NOP                                                           , "BDA LSB copy attempt from candidate ; ---");
            INSTR( CE_COPY(GEN, C_OFST(3*2), C_SIZE(3))                                       , ALU_NOP                                                           , "Copy BDA MSB                        ; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (SOC_IS_JERICHO_PLUS(unit)) {
            
            INSTR( CE_FLREAD(PrgeDataFieldNativeLLSize, 0, LFEM_8_LSBS)         , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "Extract Native LL size                   ; RSZ = R3 - R2 (candidate-size - |BDA,BSA|)");
            INSTR( CE_FLREAD(PrgeDataFieldNativeLLSize, 0, LFEM_8_LSBS)         , ALU_SUB(REG_OP(3), CNST(8), REG_OP(3))        , "Extract Native LL size                   ; R3 -= 8");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                      , ALU_SUB(REG_OP(SZ), FEM, REG_OP(SZ))          , "Copy Native-L3                           ; RSZ = RSZ - FEM");
            INSTR( CE_NOP                                                       , ALU_ADD(REG_OP(2), FEM, REG_OP(2))            , "---                                      ; R2 += FEM (eth-type)");
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "---                                      ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                           ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                           ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                           ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                           ; RSZ -= 16");

            
            INSTR( CE_FREAD(PrgeDataFieldProgVar, -12)                           , ALU_SET(outrif_range_lower_limit, REG_OP(3))         , "");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SET(2, REG_OP(SZ))                               , "");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SUB(FEM, CNST(0), REG_OP(3))                     , "Extract out-rif from pph");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, LT, REG_OP(3), CNST(0), REG_OP(SZ))  , "Extract out-rif from pph");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, GT, REG_OP(3), CNST(0), REG_OP(SZ))  , "");
            INSTR( CE_NOP                                                        , ALU_SET(6, REG_OP(3))                                , "");

            
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                      , ALU_NOP                                                   , "Copy ETH-Type         ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(SZ,0))                        , ALU_SET_IF(REG_OP(SZ), EQ, CNST(0), CNST(0), REG_OP(3))   , "Copy CVID [=16'd0]    ; ---");
            INSTR( CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,0))                     , ALU_SUB(REG_OP(2), REG_OP(1), REG_OP(SZ))                 , "Copy CTPID            ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(3,0))                         , ALU_SET_IF(REG_OP(SZ), NEQ, CNST(0), CNST(0), REG_OP(SZ)) , "Copy CSA [=48'd0]     ; ---");
            INSTR( CE_COPY(GEN, C_OFST(12), R_SIZE(3,0))                        , ALU_NOP                                                   , "Copy BDA              ; ---");

            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,0))   , ALU_SUB(REG_OP(2),  CNST(16), REG_OP(2))  , "Copy 8B from generated offset R2, Size RSZ; ALU: R2 = R2-16 (calc next generated reference)");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "Copy 8B from offset R2-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,-16)) , ALU_NOP                                   , "Copy 8B from offset R2, Size RSZ-16; ALU: R2 = R2-16 (calc next generated reference)");

            
            INSTR( CE_COPY(GEN, R_OFST(1,0), C_SIZE(3))                         , ALU_SUB(CNST(6), REG_OP(3), REG_OP(SZ))       , "Copy ISID[23:0]                          ; ---");
            INSTR( CE_COPY(GEN, C_OFST(38), C_SIZE(7))                          , ALU_NOP                                       , "Copy BTAG,...,PBB                        ; ---");

            
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(3,0))              , ALU_NOP                                       , "If OutRIF is not in special range, Copy BSA from program-var... ; ---");
            INSTR( CE_COPY(GEN, C_OFST(12*2), R_SIZE(SZ,0))                      , ALU_NOP                                       , "...Else, Copy BSA from candidate header                         ; ---");
            INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                          , ALU_NOP                                       , "Copy BDA (again)                         ; ---");

        } else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0) && (soc_property_get(unit, spn_SPLIT_HORIZON_FORWARDING_GROUPS_MODE, 1) == 1)) {

            
            INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))             , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                                             , "Copy Native-L3                                ; RSZ = R3 - 12 (candidate-size - |BDA,BSA|)");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(8))           , ALU_SUB(REG_OP(3),  CNST(16) , REG_OP(3))                                             , "Copy Native-L3                                ; R3 -= 16");
            INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_SPB_READ_BDA_WITHOUT_ORIENTATION)       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))           , "Read the BDA MSB without BDA[47], BDA[43]     ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-16))        , ALU_NOP                                                                               , "Copy Native-L3                                ; ---");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))       , ALU_ADD(FEM, CNST(0), REG_OP(1))                                                      , "Copy Native-L3                                ; R1 = FEM");
            INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-16))      , ALU_NOP                                                                               , "Copy Native-L3                                ; ---");

                
                INSTR( CE_FREAD(PrgeDataFieldProgVar, -12), ALU_SET(outrif_range_lower_limit, REG_OP(3)) , "Read OutRIF range upper limit from prog var   ; R3 = OutRIF range lower limit");
                INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SET(6, REG_OP(SZ))                                               , "Read OutRIF from header                       ; RSZ = 6");
                INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SUB(FEM, CNST(0), REG_OP(3))                                     , "Read OutRIF from header                       ; R3 = FEM (OutRIF range upper limit)");
                INSTR( CE_FLREAD(PrgeDataFieldEesData3, -14, LFEM_SPB_READ_BITS_FROM_BTAG_FIELD)    , ALU_SET_IF(FEM, LT, REG_OP(3), CNST(0), REG_OP(SZ))   , "Read the missing BDA bits from BTAG field     ; if OutRIF < range lower limit, RSZ = 0");
                INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, GT, REG_OP(3), CNST(0), REG_OP(SZ))                  , "---                                           ; if OutRIF > range upper limit, RSZ = 0");
                INSTR( CE_NOP                                                        , ALU_ADD(FEM, REG_OP(1), REG_OP(1))                                   , "---                                           ; R1 = FEM (missing BDA bits)");

            
                INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,-4))                ,  ALU_NOP                                                                   , "Copy ETH-Type                                 ; ---");
                INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(SZ,-4))                  ,  ALU_SUB(REG_OP(SZ), CNST(0), REG_OP(3))                                   , "Copy CVID [=16'd0]                            ; R3 = RSZ");
                INSTR( CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-4))               ,  ALU_SUB(REG_OP(2), CNST(0), REG_OP(SZ))                                   , "Copy CTPID                                    ; RSZ = R2");
                INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(3,0))                    ,  ALU_SET_IF(REG_OP(SZ), NEQ, CNST(0), CNST(0), REG_OP(SZ))                 , "Copy CSA [=48'd0]                             ; if RSZ was not 0, RSZ = 0");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, R_SIZE(3,-2))       ,  ALU_NOP                                                                   , "Copy BDA LSBs from EES-Data2                  ; ---");
                INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(3,-4))              ,  ALU_NOP                                                                   , "Copy BDA MSBs from R1                         ; ---");


                INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,0))   , ALU_SUB(REG_OP(2),  CNST(16), REG_OP(2))                                                , "Copy 8B from generated offset R2, Size RSZ; ALU: R2 = R2-16 (calc next generated reference)");
                INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                                               , "Copy 8B from offset R2-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,-16)) , ALU_NOP                                                                                 , "Copy 8B from offset R2, Size RSZ-16; ALU: R2 = R2-16 (calc next generated reference)");

            
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))    , ALU_NOP                                                                               , "Copy ISID[15:0] from EES-Data1                ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(6))   , ALU_SUB(CNST(6), REG_OP(3), REG_OP(SZ))                                               , "Copy BTAG,...,ISID[23:8] from EES-Data3       ; RSZ = 6 - R3 (Either 6 or 0)");

            
            INSTR( CE_FLCOPY(PrgeDataFieldEesData3, -14, C_SIZE(2), LFEM_SPB_STAMP_LEFT_NIBBLE_8)   , ALU_NOP                                               , "Copy {4'h8, BTAG[11:0]} from EES-Data3        ; ---");

            
	    INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(3,0))  , ALU_NOP  , "If OutRIF is in special range, Copy BSA from program-var... ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -4, R_SIZE(SZ,0))          , ALU_NOP  , "...Else, Copy BSA from Ees1 field (Virtual BMAC) ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(4))   , ALU_NOP , "Copy BDA (again) from EES-Data2                                 ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))          , ALU_NOP , "Copy BDA 2 MSB from R3                                          ; ---");

        } else {

            
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "---                                     ; RSZ = R3 - 12 (candidate-size - |BDA,BSA|)");
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))      , "---                                     ; R3 -= 8");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                      , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                          ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                          ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                          ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                          ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                          ; RSZ -= 16");

            
            INSTR( CE_FREAD(PrgeDataFieldProgVar, -12)                           , ALU_SET(outrif_range_lower_limit, REG_OP(3))         , "Read OutRIF range upper limit from prog var   ; R3 = OutRIF range lower limit");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SET(2, REG_OP(SZ))                               , "Read OutRIF from header                       ; RSZ = 6");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SUB(FEM, CNST(0), REG_OP(3))                     , "Read OutRIF from header                       ; R3 = FEM (OutRIF range upper limit)");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, LT, REG_OP(3), CNST(0), REG_OP(SZ))  , "---                                   ; if OutRIF < range lower limit, RSZ = 0");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, GT, REG_OP(3), CNST(0), REG_OP(SZ))  , "---                                           ; if OutRIF > range upper limit, RSZ = 0");
            INSTR( CE_NOP                                                        , ALU_SET(6, REG_OP(3))                                , "");

            
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                ,  ALU_SET(6, REG_OP(1))                                                      , "Copy ETH-Type             ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(SZ,0))                  ,  ALU_SET_IF(REG_OP(SZ), EQ, CNST(0), CNST(0), REG_OP(3))      , "Copy CVID [=16'd0]        ; ---");
            INSTR( CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,0))               ,  ALU_SUB(REG_OP(2), CNST(0), REG_OP(SZ))                      , "Copy CTPID                ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(3,0))                   ,  ALU_SET_IF(REG_OP(SZ), NEQ, CNST(0), CNST(0), REG_OP(SZ))    , "Copy CSA [=48'd0]         ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, R_SIZE(3,0))       ,  ALU_SET_IF(REG_OP(3), EQ, CNST(0), CNST(0), REG_OP(1))                                                      , "Copy BDA from EES-Data2   ; ---");


            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,0))   , ALU_SUB(REG_OP(2),  CNST(16), REG_OP(2))  , "Copy 8B from generated offset R2, Size RSZ; ALU: R2 = R2-16 (calc next generated reference)");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "Copy 8B from offset R2-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,-16)) , ALU_NOP                                   , "Copy 8B from offset R2, Size RSZ-16; ALU: R2 = R2-16 (calc next generated reference)");

            
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))                , ALU_NOP                                   , "Copy ISID[15:0] from EES-Data1          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(8))               , ALU_SUB(CNST(6), REG_OP(3), REG_OP(3))    , "Copy BTAG,...,ISID[23:8] from EES-Data3 ; ---");

            
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(1,0))            , ALU_NOP, "If inside range copy BSA from progream-var (Nodal)              ; ---");
	    INSTR( CE_FCOPY(PrgeDataFieldEesData1, -4, R_SIZE(3,0))          , ALU_NOP  , "...Else copy BSA from EEs1 (Virtual BMAC); ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(6))            , ALU_NOP                                   , "Copy BDA (again) from EES-Data2         ; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (SOC_IS_JERICHO_PLUS(unit)) {
            
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                        , ALU_SUB(REG_OP(3), CNST(20), REG_OP(2))                     , "FEM = PPH.Forward-Header-Offset  ; R2 = R3 - 20 (Natives offset w/o L3)");
            INSTR( CE_NOP                                               , ALU_NOP                                                     , "---                              ; ---");
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_ADD(FEM, CNST(20), REG_OP(1))                           , "FEM = System Headers Size        ; R1 = 20 + FEM");
            INSTR( CE_NOP                                               , ALU_SUB( REG_OP(2), CNST(12), REG_OP(SZ))                   , "---                              ; RSZ = R2 - 12");
            INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(1))                          , "---                              ; R1 += FEM (Now contains the offset for copying L3 from original header)");
            INSTR( CE_NOP                                               , ALU_NOP                                                     , "---                              ; ---");

            INSTR( CE_COPY(PKT, R_OFST(1, 0), C_SIZE(8))                , ALU_NOP                                            , "Copy Native L3                             ; ---");
            INSTR( CE_COPY(PKT, R_OFST(1,-16), C_SIZE(8))               , ALU_NOP                                            , "Copy Native L3                             ; ---");
            INSTR( CE_COPY(PKT, R_OFST(1,-32), C_SIZE(4))               , ALU_SUB( REG_OP(SZ), CNST(16), REG_OP(SZ))         , "Copy Native L3                             ; RSZ -= 16 (Prepare for PP-Copy loop with seperate size register including BTAG, ... , ISID)");

            
            for (i = 0; i < 6; i++) {
                INSTR( CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))         , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                  , "Copy Natives                             ; R2 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ ,8))        , ALU_SUB( REG_OP(SZ), CNST(16), REG_OP(SZ))               , "Copy Natives                             ; RSZ -= 16");
            }

            
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(3))         , ALU_NOP                                   , "Copy 0xffffff from progream-var          ; ---");
            INSTR( CE_COPY(GEN, C_OFST(6), C_SIZE(3))                   , ALU_NOP                                   , "Copy BDA[47:24]                          ; ---");
            INSTR( CE_COPY(GEN, R_OFST(0, 0), C_SIZE(3))                 , ALU_NOP                                  , "Copy ISID[23:0]                          ; ---");
            INSTR( CE_COPY(GEN, C_OFST(6), C_SIZE(3))                   , ALU_NOP                                   , "Copy BDA[47:24] (again)                  ; ---");
        } else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0) && (soc_property_get(unit, spn_SPLIT_HORIZON_FORWARDING_GROUPS_MODE, 1) == 1)) {
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                                  , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))         , "FEM = PPH.Forward-Header-Offset  ; RSZ = R3 - R2 (Native L3 size)");
            INSTR( CE_NOP                                               , ALU_NOP                                                     , "---                              ; ---");
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_ADD(FEM, REG_OP(SZ), REG_OP(1))                         , "FEM = System Headers Size        ; R1 = RSZ + FEM");
            INSTR( CE_NOP                                               , ALU_NOP                                                     , "---                              ; ---");
            INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(1))                          , "---                              ; R1 += FEM (Now contains the offset for copying L3 from original header)");
            INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "---                              ; RSZ -= 16");

            for (i = 0; i < 2; i++) {
                INSTR( CE_COPY(PKT, R_OFST(1, 0), R_SIZE(SZ, 0))         , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))     , "Copy Native L3                             ; R1 -= 16");
                INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(SZ ,8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))   , "Copy Native L3                             ; RSZ -= 16");
            }

            
            for (i = 0; i < 2; i++) {
                INSTR( CE_COPY(GEN, R_OFST(2, 0), R_SIZE(2, 0))         , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))   , "Copy Native L2                             ; R2 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))        , ALU_NOP                                   , "Copy Native L2                             ; ---");
            }

            INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_SPB_READ_BDA_WITHOUT_ORIENTATION) , ALU_SET(0, REG_OP(3))                           , "Read the BDA MSB without BDA[47], BDA[43] ; R3 = 0");
            INSTR( CE_NOP                                                                       , ALU_NOP                                         , "NOP");
            INSTR( CE_FLREAD(PrgeDataFieldEesData3, -14, LFEM_SPB_READ_BITS_FROM_BTAG_FIELD)    , ALU_ADD(FEM, REG_OP(3), REG_OP(3))              , "Read the missing BDA bits from BTAG field ; R3 += FEM");

            
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))    , ALU_NOP                                                           , "Copy ISID[15:0] from EES-Data1               ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(6))   , ALU_ADD(FEM, REG_OP(3), REG_OP(3))                                , "Copy EtherType,...,ISID[23:8] from EES-Data3 ; R3 += FEM");

            
            INSTR( CE_FLCOPY(PrgeDataFieldEesData3, -14, C_SIZE(2), LFEM_SPB_STAMP_LEFT_NIBBLE_8)   , ALU_NOP                           , "Copy {4'h8, BTAG[11:0]} from EES-Data3 ; ---");

            
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(3))     , ALU_NOP                                                           , "Copy 0xffffff from progream-var         ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -8, C_SIZE(1))   , ALU_NOP                                                           , "Copy BDA[31:24] from EES-Data2          ; ---");
            INSTR( CE_FLCOPY(PrgeDataFieldR3, 0, C_SIZE(2),LFEM_ZERO_BIT8) , ALU_NOP                                               , "Copy BDA 2 MSB from R3                  ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))    , ALU_NOP                                                           , "Copy ISID[15:0] from EES-Data1          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(1))   , ALU_NOP                                                           , "Copy ISID[23:8] from EES-Data3          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -8, C_SIZE(1))   , ALU_NOP                                                           , "Copy BDA[31:24] (again) from EES-Data2  ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))          , ALU_NOP                                                           , "Copy BDA 2 MSB from R3                  ; ---");

        } else {
            
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                                  , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))         , "FEM = PPH.Forward-Header-Offset  ; RSZ = R3 - R2 (Native L3 size)");
            INSTR( CE_NOP                                               , ALU_NOP                                                     , "---                              ; ---");
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_ADD(FEM, REG_OP(SZ), REG_OP(1))                         , "FEM = System Headers Size        ; R1 = RSZ + FEM");
            INSTR( CE_NOP                                               , ALU_NOP                                                     , "---                              ; ---");
            INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(1))                          , "---                              ; R1 += FEM (Now contains the offset for copying L3 from original header)");
            INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "---                              ; RSZ -= 16");

            for (i = 0; i < 2; i++) {
                INSTR( CE_COPY(PKT, R_OFST(1, 0), R_SIZE(SZ, 0))         , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))     , "Copy Native L3                             ; R1 -= 16");
                INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(SZ ,8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))   , "Copy Native L3                             ; RSZ -= 16");
            }

            
            for (i = 0; i < 2; i++) {
                INSTR( CE_COPY(GEN, R_OFST(2, 0), R_SIZE(2, 0))         , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))   , "Copy Native L2                             ; R2 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))        , ALU_NOP                                   , "Copy Native L2                             ; ---");
            }

            
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))        , ALU_NOP                                   , "Copy ISID[15:0] from EES-Data1           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(8))       , ALU_NOP                                   , "Copy BTAG,...,ISID[23:8] from EES-Data3  ; ---");

            
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(3))         , ALU_NOP                                   , "Copy 0xffffff from progream-var          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -8, C_SIZE(1))   , ALU_NOP                                                           , "Copy BDA[31:24] from EES-Data2          ; ---");
            INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -10, C_SIZE(2),LFEM_ZERO_BIT8)   , ALU_NOP                                          , "Copy BDA[47:32] from EES-Data2          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))        , ALU_NOP                                   , "Copy ISID[15:0] from EES-Data1           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(1))       , ALU_NOP                                   , "Copy ISID[23:8] from EES-Data3           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -8, C_SIZE(3))       , ALU_NOP                                   , "Copy BDA[47:24] (again) from EES-Data2   ; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 400, exit);
    if (prog_used != -1) {
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 401, exit);

        
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 372, exit);

          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "1: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "2: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "3: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "4: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "5: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "6: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "7: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "8: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "9: copy generated header"                     );
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                          , ALU_NOP                                         , "10: copy generated header"                     );
           INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT)         , ALU_SET(ftmh_size + 1, REG_OP(2))               , "11: Extract DSP_EXT from FTMH ,the value can be 0 or 2 (which i will use as a size), ALU: R2 = ftmh_size + 1 (1 = to reach to OAM_TS[39:32])  ");
           INSTR( CE_FLREAD(PrgeDataFieldTod1588, -8, LFEM_RSHIFT_1_FIRST_BIT_ONLY)  , ALU_SET(unit, REG_OP(3))                        , "12: Extract TOD 1588[33] ,ALU : R3 = Unit");
           INSTR( CE_LREAD(PKT, R_OFST(2, 0),LFEM_RSHIFT_1_FIRST_BIT_ONLY)           , ALU_ADD(FEM, REG_OP(2), REG_OP(2))              , "13: Extract OAM_TS[33] ,ALU : R2 = ftmh size + 1 , FEM = DSP EXT (0 or 2B), R2 = R2 + FEM ");
           INSTR( CE_FLREAD(PrgeDataFieldTod1588, -8,LFEM_EXTRACT_FTMH_SIZE)         , ALU_SUB(FEM, CNST(0), REG_OP(0))                , "14: Extract Tod 1588[47:34] ,ALU: R0 = FEM = Tod_1588[33]");
           INSTR( CE_NOP                                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))               , "15: ,ALU : SZ = FEM = OAM[33]");                                                                                                    
           INSTR( CE_LREAD(PKT, R_OFST(2, 0),LFEM_OAM_TS_EXTRACT_TOD)                , ALU_SUB(FEM, CNST(0), REG_OP(1))                , "16: Extract OAM_TS[33:32],ALU : R1 = Tod 1588[47:34]");
           INSTR( CE_NOP                                                             , ALU_SUB(REG_OP(SZ), REG_OP(0), REG_OP(SZ))      , "17: ,ALU: RSZ = OAM[33] - R0 ,R0 = Tod_1588[33], if timestamp wrap then RSZ will be set ,in any other case it;s reset");
           INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BITS_0_M)                , ALU_SUB(FEM, CNST(0), REG_OP(0))                , "18: Extract the first bit of the TmPortVar ,if it's set then SSP should be stamp in the header , ALU : R1 = R1 - SZ , R1 = TOD_1588[47:34] , SZ = OAM_TS[33] - Tod_1588[33]");
           INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_LSHIFT_2)                       , ALU_SUB(REG_OP(1), REG_OP(SZ), REG_OP(1))       , "19: Extract Tod 1588[47:34] and shift the value by 2 bits left,ALU: R0 = OAM_TS[33:32] ");
           INSTR( CE_NOP                                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))               , "20: ,ALU: SZ = TmPortVar - first - bit");
           INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT1_CLR_BIT0)           , ALU_SUB(FEM, CNST(0), REG_OP(1))                , "21: Extract the second bit of the TmPortVar ,if it's set then Timestamp should be stamp in the header,ALU : R1 = R1 + Tod 1588[47:34] shited by 2");
           INSTR( CE_FCOPY(PrgeDataFieldSrcSysPort, 0, R_SIZE(SZ, 0))                , ALU_NOP                                         , "22: Copy system port ,ALU : NOP");
           INSTR( CE_FCOPY(PrgeDataFieldR3, 0, R_SIZE(SZ, 0))                        , ALU_SUB(FEM, CNST(0), REG_OP(3))                , "23: copy unit,ALU: R3 = TmPortVar - Second - bit");
           INSTR( CE_NOP                                                             , ALU_SET(0, REG_OP(SZ))                          , "24: ,ALU: SZ = 0");
           INSTR( CE_COPY(PKT, R_OFST(2, 2 * 4), R_SIZE(3, 0))                       , ALU_ADD(REG_OP(1) , REG_OP(0) , REG_OP(1))      , "25: copy OAM_TS[15:0],ALU: R1 = TOD_1588[47:32] + R0 = OAM-TS[33:32]");
           INSTR( CE_COPY(PKT, R_OFST(2, 2 * 2), R_SIZE(3, 0))                       , ALU_NOP                                         , "26: copy OAM_TS[31:16],ALU: NOP");
           INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(3, 0))                         , ALU_NOP                                         , "27: copy R1 -> Tod_1588[47:32] ,ALU: NOP");
           INSTR( CE_FCOPY(PrgeDataFieldTod1588, -12, R_SIZE(3, 0))                  , ALU_NOP                                         , "28: copy Tod_1588[63:48] ,ALU: NOP");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 402, exit);
    }

    
    res = arad_egr_prog_editor_ipsec_programs_instr_load(unit);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_LI, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {    
        
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_IPV4_SIZE_WITH_ETH_IP_KEYr(unit, REG_PORT_ANY, 0x12));

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_LI);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);

        
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "0: Rsz = R3-R2"                                                      );
        INSTR( CE_NOP                                               , ALU_NOP                                        , "1: NOP"                                                              );
        INSTR( CE_COPY(GEN, R_OFST(3,8), R_SIZE(SZ, 0))             , ALU_NOP                                       , "2: Copy 8B start from R3+4B"                                         );
        INSTR( CE_COPY(GEN, R_OFST(3,-8), R_SIZE(SZ, -8))           , ALU_NOP                                       , "3: Copy anything between R3~R2"                                      );
        INSTR( CE_COPY(GEN, R_OFST(3,-24), R_SIZE(SZ, -16))         , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))     , "4: Copy anything between R3~R2, Rsz = Rsz - 24"                      );
        INSTR( CE_READ(GEN, R_OFST(0,8))                            , ALU_NOP                                       , "5: Read IPv4 header length from generated header"                    );
        INSTR( CE_COPY(GEN, R_OFST(3,-40), R_SIZE(SZ, 0))           , ALU_NOP                                       , "6: Copy anything between R3~R2"                                      );
        INSTR( CE_COPY(GEN, R_OFST(3,-56), R_SIZE(SZ, -8))          , ALU_SUB(FEM, CNST(20), REG_OP(3))             , "7: Copy anything between R3~R2"                                      );
        INSTR( CE_COPY(GEN, R_OFST(3,-72), R_SIZE(SZ, -16))         , ALU_NOP                                       , "8: Copy anything between R3~R2"                                      );
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(4))       , ALU_NOP                                       , "9: Copy Content ID from EES1"                                        );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 4, C_SIZE(2))         , ALU_NOP                                       , "10:Copy 2B zeros (checksum)"                                         );
        INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))              , ALU_NOP                                       , "11:UDP length = IPv4 length - 20"                                    );
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, -9, C_SIZE(2))       , ALU_NOP                                       , "12:Copy UDP dst port from EES1"                                      );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))         , ALU_NOP                                       , "13:Copy UDP src port from porgram var"                               );
        INSTR( CE_COPY(GEN, R_OFST(0,40), C_SIZE(8))                , ALU_NOP                                       , "14:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,24), C_SIZE(8))                , ALU_NOP                                       , "15:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,8), C_SIZE(8))                 , ALU_NOP                                       , "16:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,-8), R_SIZE(0, -4))            , ALU_SUB(REG_OP(0), CNST(20), REG_OP(0))       , "17:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,-24), R_SIZE(0,-12))           , ALU_NOP                                       , "18:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0, 0))              , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "19:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "20:Copy IP tunnel & link layer"                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0, 0))              , ALU_NOP                                       , "21:Copy IP tunnel & link layer"                                      );
        if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) && SOC_IS_JERICHO(unit)) {
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0),     ALU_NOP,                            "22:Extract Resolved.Data.tm-port-var (1B)" );
            INSTR(CE_NOP,                                               ALU_NOP,                            "23:NOP");
            INSTR(CE_NOP,                                               ALU_SUB(FEM, CNST(0), REG_OP(SZ)),  "24:RSZ = FEM (tm-port-var value)");
            INSTR(CE_NOP,                                               ALU_NOP,                            "25:NOP");
            INSTR(CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0)),    ALU_NOP,                            "26:Copy Additional 1B based on the REG_SZ size");
        }    
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    if (SOC_IS_QAX(unit)) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_LI_IPV6);
            SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);

            
            ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
            ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;

            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                         , ALU_SET(0, REG_OP(2))                         , "0: FEM=fwd_header_offset; R2=0"                                             );
            INSTR( CE_FREAD(PrgeDataFieldEesData2, -2)                   , ALU_NOP                                       , "1: FEM=dip_ptr"                                                             );
            INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_IPV6_EXTRACT_FTMH)      , ALU_SUB(FEM, CNST(0) ,REG_OP(SZ))             , "2: FEM=FTMH.packet_size; Rsz=fwd_header_offset"                             );
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_7_LSBS)    , ALU_SUB(FEM, CNST(0) ,DATA_ADDR)              , "3: FEM=system_hdr_size; DATA_ADDR=sip_ptr"                                  );
            INSTR( CE_FREAD(PrgeDataFieldEesData2, -4)                   , ALU_ADD(FEM, CNST(10) ,REG_OP(1))             , "4: FEM=sip_ptr; R1=FTMH.packet_size+10-udh_size"                            );
            INSTR( CE_NOP                                                , ALU_ADD(FEM, REG_OP(SZ) ,REG_OP(SZ))          , "5: Rsz=fwd_header_offset+system_hdr_size"                                   );
            INSTR( CE_NOP                                                , ALU_SUB(FEM, CNST(0) ,DATA_ADDR)              , "6: DATA_ADDR=sip_ptr"                                                       );
            INSTR( CE_NOP                                                , ALU_SUB(REG_OP(1), REG_OP(SZ) ,REG_OP(1))     , "7: R1=FTMH.packet_size+10-fwd_header_offset-system_hdr_size"                );
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(4))        , ALU_NOP                                       , "8: Copy SHIM from EES1"                                                     );
            INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))               , ALU_NOP                                       , "9: UDP.check_sum=0"                                                         );
            INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))               , ALU_NOP                                       , "10:UDP.length=R1"                                                           );
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -9, C_SIZE(2))        , ALU_NOP                                       , "11:Copy UDP dst port from EES1"                                             );
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))          , ALU_NOP                                       , "12:Copy UDP src port from porgram var"                                      );
            INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(8))  , ALU_NOP                                       , "13:Copy DIP from prog mem"                                                  );
            INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, -16, C_SIZE(8)), ALU_NOP                                       , "14:Copy DIP from prog mem"                                                  );
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(4))        , ALU_NOP                                       , "15:Copy SIP[31:0] from EES2"                                                );
            INSTR( CE_FLREAD(PrgeDataFieldDataMemoryEntry, -26, LFEM_TOS), ALU_NOP                                       , "16:FEM=traffic_class"                                                       );
            INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(8))  , ALU_SET(17, REG_OP(2))                        , "17:Copy SIP[95:32] from prog_mem"                                           );
            INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, -16, C_SIZE(5)), ALU_ADD(FEM, CNST(0x6000), REG_OP(2))         , "18:Copy {hop_limit[7:0], SIP[127:96]}; R2={4'b6, traffic_class[7:0], 4'b0}" );
            INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))               , ALU_NOP                                       , "19:Next_Header=17(UDP) "                                                    );
            INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))               , ALU_NOP                                       , "20:IPv6.payload_length=R1 "                                                 );
            INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, -28, C_SIZE(2)), ALU_SET(0x86DD, REG_OP(1))                    , "21:Copy flow_label[15:0]; R1=0x86DD"                                        );
            INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))               , ALU_NOP                                       , "22:Copy R2"                                                                 );
            INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))               , ALU_NOP                                       , "23:Copy R1"                                                                 );
            INSTR( CE_COPY(GEN, R_OFST(0, -4), R_SIZE(0, -2))            , ALU_SUB(REG_OP(0), CNST(18), REG_OP(0))       , "24:Copy link layer excluding ethertype"                                     );
            INSTR( CE_COPY(GEN, R_OFST(0, -20), R_SIZE(0, -10))          , ALU_NOP                                       , "25:Copy link layer"                                                         );
            INSTR( CE_COPY(GEN, R_OFST(0, 0), R_SIZE(0, 0))              , ALU_NOP                                       , "26:Copy link layer"                                                         );
            INSTR( CE_COPY(GEN, R_OFST(0, -16), R_SIZE(0, -8))           , ALU_NOP                                       , "27:Copy link layer"                                                         );

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 470, exit);
    if (prog_used != -1) {    
        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EGRESS_ACL_TWO_PASS_EDITING);
        SOC_SAND_CHECK_FUNC_RESULT(res, 480, exit);

        
        INSTR( CE_LREAD(PKT, R_OFST(2,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                 , ALU_NOP                                      , "0: Extract forward header offset; ---"                                );
        INSTR( CE_NOP                                            , ALU_NOP                                      , "1: NOP"                                                               );
        INSTR( CE_NOP                                            , ALU_ADD(FEM, REG_OP(3), REG_OP(0))           , "2: ---; R0 = fwd header offset(FEM) + system hdr size(R3)"            );
        INSTR( CE_NOP                                            , ALU_NOP                                      , "3: NOP"                                                               );
        INSTR( CE_COPY(PKT, R_OFST(0,32), C_SIZE(8))             , ALU_SET(0x86DD, REG_OP(1))                   , "4: Copy forwarding header; R1 = IPv6 Ethertype"                       );
        INSTR( CE_COPY(PKT, R_OFST(0,16), C_SIZE(8))             , ALU_NOP                                      , "5: Copy fowarding header; ---"                                        );
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_SUB(CNST(52), REG_OP(3), REG_OP(1))      , "6: Copy Ethertype; R1(padding size)=48+4(from DA)-system_hdr_size(R3)");
        INSTR( CE_FCOPY(PrgeDataFieldTmPortVar, 0, C_SIZE(8))    , ALU_NOP                                      , "7: Copy {DA[31:0], SA[47:0]}; ---"                                    );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(1, 0))   , ALU_ADD(REG_OP(1), CNST(10), REG_OP(0))      , "8: Copy padding zeroes; R0(fwd_hdr_offset) = R1(padding_size)+10(dummy_eth-4)");
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(1, -8))  , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))      , "9: Copy padding zeroes; R1 -= 16"                                     );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(1, -16)) , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(1))     , "10:Copy padding zeroes; R1 = system_hdr_size - FTMH header size"      );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(1, -8))  , ALU_ADD(REG_OP(0), REG_OP(0), REG_OP(0))     , "11:Copy padding zeroes; R0 = R0 << 1"                                 );
        INSTR( CE_LREAD(PKT, R_OFST(2,4), LFEM_BIT_0)            , ALU_NOP                                      , "12:Extract PPH[40]; ---"                                              );
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(1, -2))          , ALU_SUB(REG_OP(1), CNST(18), REG_OP(1))      , "13:Copy PPH header until PPH[40];"                                    );
        INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(1, -10))       , ALU_ADD(FEM, REG_OP(0), REG_OP(0))           , "14:Copy PPH header until PPH[40]; R0 = {R0(fwd_hdr_offset << 1) | PPH[40]}");
        INSTR( CE_COPY(PKT, R_OFST(3,-32), R_SIZE(1, 0))         , ALU_NOP                                      , "15:Copy PPH header until PPH[40];"                                    );
        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))           , ALU_NOP                                      , "16:Copy R0; ---"                                                      );
        INSTR( CE_COPY(PKT, R_OFST(2,2), R_SIZE(2, 1))           , ALU_SUB(REG_OP(2), CNST(17), REG_OP(2))      , "17:Copy PPH[55:48] and FTMH;"                                         );
        INSTR( CE_COPY(PKT, R_OFST(2,-14), R_SIZE(2, -7))        , ALU_NOP                                      , "18:Copy FTMH;"                                                        );
        INSTR( CE_COPY(PKT, R_OFST(2,-30), R_SIZE(2, 0))         , ALU_NOP                                      , "19:Copy FTMH;"                                                        );
        
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 490, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_SRC_ENCAP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);

         INSTR(CE_NOP                                              , ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ))                 , "0; ALU: RSZ=R3-12, calc Generated Header size - (Native Eth DA:SA size)");
         INSTR(CE_NOP                                              , ALU_NOP                                                   , "---; ---");
         INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0))          , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
         INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
        for (i = 0; i < 4; i++) {
             INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))               , "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
             INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))              , "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
        }

         INSTR(CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(6))       , ALU_NOP                                                  , "Copy SA from EES1,size r0; ---");
         INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))                  , ALU_NOP                                                  , "copy DA from generated header; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 455, exit);

        
        if (!soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ipfpm_debug", 0)) {
            INSTR(CE_COPY(GEN, R_OFST(3, -16), C_SIZE(0)),          ALU_NOP,                                    "0: Get checksum");
            INSTR(CE_FLREAD(PrgeDataFieldAceVar, 0, LFEM_5_LSBS),   ALU_SET(0, REG_OP(SZ)),                     "1: Get IP_Header.TOS");
            INSTR(CE_NOP,                                           ALU_ADD(FEM, CNST(0), REG_OP(0)),           "2: r0=checksum");
            INSTR(CE_NOP,                                           ALU_ADD(FEM, CNST(0), REG_OP(1)),           "3: r1=IP_Header.TOS.5lsb");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "4: Nop");
            INSTR(CE_COPY(GEN, R_OFST(3, -36), C_SIZE(0)),          ALU_SET_IF(REG_OP(0), LT, REG_OP(1), CNST(1), REG_OP(SZ)), "5:if(r0<r1), rsz=1");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), C_SIZE(8)),            ALU_SUB(REG_OP(0), REG_OP(1), REG_OP(0)),   "6:");
            INSTR(CE_NOP,                                           ALU_ADD(FEM, REG_OP(1), REG_OP(1)),         "7: r1=New TOS");
            INSTR(CE_NOP,                                           ALU_SUB(REG_OP(0), REG_OP(SZ), REG_OP(0)),  "8: r0=r0-rsz");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "9:");
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),          ALU_NOP,                                    "10: Copy new Checksum");
            INSTR(CE_COPY(GEN, R_OFST(3, -20), C_SIZE(8)),          ALU_SUB(REG_OP(3), CNST(19), REG_OP(3)),    "11: Copy Next 8Bytes");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)),          ALU_NOP,                                    "12: Copy new TOS");
            for (i = 0; i < 4; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),    ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),    "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),  ALU_NOP,                                    "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            }
        } else {
            INSTR(CE_NOP,                                           ALU_ADD(REG_OP(3), CNST(0), REG_OP(SZ)),    "0:");
            for (i = 0; i < 6; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),    ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),    ": Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),  ALU_NOP,                                    ": Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            }
            INSTR(CE_NOP,                                           ALU_ADD(REG_OP(SZ), CNST(0), REG_OP(3)),    "13:");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "14:");
            INSTR(CE_COPY(RES, C_OFST(175), C_SIZE(8)),             ALU_NOP,                                    "15: Copy R0-R1-R2-R3 to Original header");
            INSTR(CE_COPY(RES, C_OFST(59), C_SIZE(1)),              ALU_NOP,                                    "16: ACE Variable");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_UPDATE_TOS_RECOVER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 455, exit);

        
        if (!soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ipfpm_debug", 0)) {
            INSTR(CE_COPY(GEN, R_OFST(3, -16), C_SIZE(0)),          ALU_NOP,                                    "0: Get checksum");
            INSTR(CE_FLREAD(PrgeDataFieldAceVar, 0, LFEM_5_LSBS),   ALU_SET(0, REG_OP(SZ)),                     "1: Get IP_Header.TOS.5lsb");
            INSTR(CE_LREAD(GEN, R_OFST(3, -16), LFEM_IS_LAG),       ALU_ADD(FEM, CNST(0), REG_OP(0)),           "2: r0=checksum");
            INSTR(CE_NOP,                                           ALU_ADD(FEM, CNST(0), REG_OP(1)),           "3: r1=IP_Header.TOS.5lsb");
            INSTR(CE_NOP,                                           ALU_ADD(FEM, CNST(0), REG_OP(2)),           "4: r2=MSB(old checksum)");
            INSTR(CE_NOP,                                           ALU_ADD(REG_OP(0), REG_OP(1), REG_OP(0)),   "5: r0=r0+r1,new checksum");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "6: Nop");
            INSTR(CE_FLREAD(PrgeDataFieldR0, 0, LFEM_IS_LAG),       ALU_NOP,                                    "7: Get MSB of new checksum");
            INSTR(CE_COPY(GEN, R_OFST(3, -36), C_SIZE(0)),          ALU_NOP,                                    "8: ");
            INSTR(CE_COPY(GEN, R_OFST(3, 0), C_SIZE(8)),            ALU_SET_IF(FEM, NEQ, REG_OP(2), CNST(1), REG_OP(SZ)), "9: rsz=1 if checksum overflow");
            INSTR(CE_NOP,                                           ALU_SUB(FEM, REG_OP(1), REG_OP(1)),         "10: r1=new TOS, copy SIP + DIP");
            INSTR(CE_NOP,                                           ALU_SET(0xffff, REG_OP(2)),                 "11: ");
            INSTR(CE_NOP,                                           ALU_ADD(REG_OP(0), REG_OP(SZ), REG_OP(0)),  "12: r0=r0+rsz");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "13: ");
            INSTR(CE_NOP,                                           ALU_SET_IF(REG_OP(0), EQ, REG_OP(2), CNST(0), REG_OP(0)), "14: ");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "15: ");
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),          ALU_NOP,                                    "16: ");
            INSTR(CE_COPY(GEN, R_OFST(3, -20), C_SIZE(8)),          ALU_SUB(REG_OP(3), CNST(19), REG_OP(3)),    "17: ");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)),          ALU_NOP,                                    "18: ");
            for (i = 0; i < 4; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),    ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),    "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),  ALU_NOP,                                    "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            }
        } else {
            INSTR(CE_NOP,                                           ALU_ADD(REG_OP(3), CNST(0), REG_OP(SZ)),    "0:");
            for (i = 0; i < 6; i++) {
                INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),    ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)),    "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),  ALU_NOP,                                    "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            }
            INSTR(CE_NOP,                                           ALU_ADD(REG_OP(SZ), CNST(0), REG_OP(3)),    "13: ");
            INSTR(CE_NOP,                                           ALU_NOP,                                    "14: ");
            INSTR(CE_COPY(RES, C_OFST(175), C_SIZE(8)),             ALU_NOP,                                    "15: Copy R0-R1-R2-R3 to Original header");
            INSTR(CE_COPY(RES, C_OFST(59), C_SIZE(1)),              ALU_NOP,                                    "16: ACE Variable");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PPPOE_OVER_IP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 455, exit);

        
        INSTR(CE_NOP,                                            ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ)),                    "00:                                     rsz=r3-r2(ip-hdr-size)");
        INSTR(CE_NOP,                                            ALU_SUB(REG_OP(3),CNST(0),REG_OP(1)),                        "01:                                     r1=r3");
        INSTR(CE_NOP,                                            ALU_NOP,                                                    "02:                                     ");
        INSTR(CE_COPY(GEN,R_OFST(1,0),R_SIZE(SZ,0)),            ALU_SUB(REG_OP(SZ),CNST(16),REG_OP(SZ)),                    "03: Copy IP header up tp 40 bytes        r1=fem1-r1(pppoe-length)");
        INSTR(CE_COPY(GEN,R_OFST(1,-16),R_SIZE(SZ,-8)),            ALU_SUB(REG_OP(1),CNST(24),REG_OP(1)),                        "04: Copy IP header                     if(fem0==r3) r0=r2(UDH)");
        INSTR(CE_COPY(GEN,R_OFST(1,-32),R_SIZE(SZ,0)),            ALU_SUB(REG_OP(SZ),CNST(16),REG_OP(SZ)),                    "05: Copy IP header                        rsz=rsz-16");
        INSTR(CE_COPY(GEN,R_OFST(1,0),R_SIZE(SZ,-8)),            ALU_NOP,                                                    "06: Copy IP header                        ");
        INSTR(CE_COPY(GEN,R_OFST(1,-16),R_SIZE(SZ,0)),            ALU_NOP,                                                    "07: Copy IP header                        ");
        
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize,0,LFEM_8_LSBS),    ALU_SET(0x21, REG_OP(0)),                                    "08: fem0=res[sys-hdr-size]                r0=0x21");
        INSTR(CE_READ(GEN,R_OFST(2,0)),                            ALU_SET(0x86DD,REG_OP(SZ)),                                    "09: fem1=gen[ethertype]                rsz=0x86dd(ipv6-ethertype)");
        INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize,0,LFEM_8_LSBS),    ALU_SUB(FEM,CNST(0),REG_OP(1)),                                "10: fem0=res[net-hdr-size]                r1=fem0(sys-hdr-size+{-2+2})");
        INSTR(CE_NOP,                                            ALU_SET_IF(FEM,EQ,REG_OP(SZ),CNST(0x57),REG_OP(0)),            "11:                                     if(fem1==0x86dd) r0=0x57");
        INSTR(CE_NOP,                                            ALU_ADD(FEM,REG_OP(1),REG_OP(1)),                            "12: Nop                                ");
        INSTR(CE_NOP,                                            ALU_NOP,                                                    "13: Nop                                ");
        INSTR(CE_READ(PKT,R_OFST(1,0)),                            ALU_NOP,                                                    "14: fem0=pkt[r1+2+{2-2}](UDH)            r1=r1+fem0(net+sys-hdr-size - 2)");
        INSTR(CE_LREAD(PKT,C_OFST(4),LFEM_EXTRACT_FTMH_SIZE),    ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(3)),                        "15: fem1=pkt[2](ftmh-hdr-size)            r3=r3-r2");
        INSTR(CE_NOP,                                            ALU_SUB(FEM,CNST(0),REG_OP(SZ)),                            "16:                                     rsz=fem0(UDH)");
        INSTR(CE_NOP,                                            ALU_SUB(FEM,REG_OP(1),REG_OP(1)),                            "17:                                     r1=fem1-r1(pppoe-length)");
        INSTR(CE_NOP,                                            ALU_SET_IF(REG_OP(3),EQ,CNST(0),REG_OP(SZ),REG_OP(0)),        "18:                                     if(r3==0) r0=rsz(UDH)");
        INSTR(CE_NOP,                                            ALU_ADD(REG_OP(1),REG_OP(3),REG_OP(1)),                        "19:                                     r1=r1+r3");
        
        INSTR(CE_FCOPY(PrgeDataFieldR0,0,C_SIZE(2)),            ALU_NOP,                                                    "20: copy PPP-Protocol-ID                ");
        INSTR(CE_FCOPY(PrgeDataFieldR1,0,C_SIZE(2)),            ALU_NOP,                                                    "21: copy PPPOE-length                    ");
        INSTR(CE_FCOPY(PrgeDataFieldEesData2,-1,C_SIZE(2)),        ALU_NOP,                                                    "22: Copy PPPoE.Session_ID                rsz=r2-2");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar,0,C_SIZE(4)),        ALU_NOP,                                                    "23: Copy PPPoE.VER/TYPE/Code+EtherType");
        
        INSTR(CE_COPY(GEN,R_OFST(2,-4),R_SIZE(2,-2)),            ALU_SUB(REG_OP(2),CNST(18),REG_OP(2)),                        "24: Copy LL header, no ethertype        r2=r2-18");
        INSTR(CE_COPY(GEN,R_OFST(2,-20),R_SIZE(2,-10)),            ALU_NOP,                                                    "25: Copy LL header, up to 24 bytes        ");
        INSTR(CE_COPY(GEN,R_OFST(2,0),R_SIZE(2,0)),                ALU_NOP,                                                    "26: Copy LL header                        ");
        
        INSTR(CE_NOP,                                            ALU_NOP,                                                    "27: Nop                                ");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2TP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_L2TP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 455, exit);
    
        
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize,0,LFEM_8_LSBS),    ALU_NOP,                                                    "00: fem0=sysHdrSize                      ");
        INSTR(CE_LREAD(PKT,C_OFST(4),LFEM_EXTRACT_FTMH_SIZE),    ALU_NOP,                                                    "01: fem1=ftmhSize                      ");
        INSTR(CE_FLREAD(PrgeDataFieldNwkHdrSize,0,LFEM_8_LSBS),    ALU_ADD(FEM,CNST(2),REG_OP(1)),                             "02: fem0=netHdrSize                    r1=sysHdrSize+2");
        INSTR(CE_NOP,                                            ALU_SUB(FEM,CNST(0),REG_OP(SZ)),                            "03:                                    rsz=ftmhSize");
        INSTR(CE_NOP,                                            ALU_ADD(FEM,REG_OP(1),REG_OP(1)),                            "04:                                     r1=r1+netHdrSize (net includes UDH)");
        INSTR(CE_NOP,                                            ALU_SET(0xFF03,REG_OP(2)),                                    "05:                                     r2=0xff03");
        INSTR(CE_COPY(PKT,R_OFST(1,-4),C_SIZE(2)),                ALU_SUB(REG_OP(SZ),REG_OP(1),REG_OP(1)),                    "06: copy PPP-proto-id                    r1=rsz-r1 (=payload-size)");
        INSTR(CE_FCOPY(PrgeDataFieldR2,0,C_SIZE(2)),            ALU_NOP,                                                    "07: copy 0xFF03                        ");
        INSTR(CE_FCOPY(PrgeDataFieldEesData1,-4,C_SIZE(4)),        ALU_ADD(REG_OP(1),CNST(18),REG_OP(2)),                        "08: copy tunnel&session                r2=r1+18 (16=UDP+L2TP+FF03-prefix+PPP-proto)");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar,0,C_SIZE(4)),        ALU_NOP,                                                    "09: copy L2TP start-word&udp-checksum    ");
        INSTR(CE_FCOPY(PrgeDataFieldR2,0,C_SIZE(2)),            ALU_SET(0xFFDC,REG_OP(SZ)),                                    "10: copy UDP length                    rsz=~35");
        INSTR(CE_READ(GEN,R_OFST(3,-16)),                         ALU_SUB(REG_OP(3),CNST(8),REG_OP(3)),                        "11: fem0=gen[ip-checksum]                r3=r3-8");
        INSTR(CE_READ(GEN,R_OFST(3,-32)),                         ALU_SET(0xFFDD,REG_OP(2)),                                     "12: fem0=gen[ip-length]                  r2=~35+1");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar,-8,C_SIZE(4)),        ALU_ADD(FEM,CNST(0),REG_OP(0)),                                "13: copy udp-dst&src-port                r0=checksum");
        INSTR(CE_NOP,                                            ALU_ADD(FEM,CNST(18),REG_OP(1)),                            "14:                                     r1=ip-length+18");
        
        INSTR(CE_COPY(GEN,R_OFST(3,16),C_SIZE(8)),                ALU_SET_IF(REG_OP(0),GE,CNST(33),REG_OP(2),REG_OP(SZ)),        "15: copy last 8 bytes of ip-header        if(cs>=35) rsz=r2");
        INSTR(CE_NOP,                                            ALU_SET_IF(REG_OP(0),LT,CNST(0),REG_OP(2),REG_OP(SZ)),        "16:                                     if(cs<0) rsz=r2");
        INSTR(CE_NOP,                                            ALU_NOP,                                                    "17:                                    ");
        INSTR(CE_NOP,                                            ALU_ADD(REG_OP(0),REG_OP(SZ),REG_OP(0)),                    "18:                                     cs=cs+rsz (update ip-chksum)");
        INSTR(CE_NOP,                                            ALU_SET(0x11,REG_OP(2)),                                    "19:                                     r2=0x11 (UDPoIP)");
        INSTR(CE_FCOPY(PrgeDataFieldR0,0,C_SIZE(2)),            ALU_NOP,                                                    "20: copy ip-checksum                    ");
        INSTR(CE_FCOPY(PrgeDataFieldR2,0,C_SIZE(1)),            ALU_NOP,                                                    "21: copy IP-Protocol-UDP                ");
        INSTR(CE_COPY(GEN,R_OFST(3,-6),C_SIZE(5)),                ALU_SUB(REG_OP(3),CNST(8),REG_OP(3)),                        "22: Copy next 5 bytes of IP header        r3=r3-8");
        INSTR(CE_FCOPY(PrgeDataFieldR1,0,C_SIZE(2)),            ALU_NOP,                                                    "23: copy ip-length                        ");
        
        INSTR(CE_COPY(GEN,R_OFST(3,-4),R_SIZE(3,-2)),            ALU_SUB(REG_OP(3),CNST(18),REG_OP(3)),                        "24: copy rest of IP-hdr & LL-hdr        r3=r3-18");
        INSTR(CE_COPY(GEN,R_OFST(3,-20),R_SIZE(3,-10)),         ALU_SUB(REG_OP(3),CNST(8),REG_OP(3)),                        "25: Copy LL header                         r3=r3-8");
        INSTR(CE_COPY(GEN,R_OFST(3,0),R_SIZE(3,0)),             ALU_SUB(REG_OP(3),CNST(8),REG_OP(3)),                        "26: Copy LL header                     r3=r3-8");
        INSTR(CE_NOP,                                            ALU_NOP,                                                    "27: Nop");
        
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 470, exit);
    if (prog_used != -1) {
        ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_0);
        SOC_SAND_CHECK_FUNC_RESULT(res, 471, exit);

        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 472, exit);

        if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == 0) {
            LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Generalized recycle header set but LB extension is not defined.\n")));
        }

        
        INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT)      , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ)), "0: FEM=DSP extension size; Rsz=R3-R2");
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)              , ALU_NOP                                  , "1: FEM=system header size");
        INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2_M_6)                       , ALU_ADD(FEM, CNST(ftmh_size), REG_OP(3)) , "2: FEM=OAM_TS header size; R3=FTMH+DSP");
        INSTR(CE_NOP                                                          , ALU_ADD(FEM, CNST(0), REG_OP(1))         , "3: R1=system header size");
        INSTR(CE_NOP                                                          , ALU_ADD(FEM, REG_OP(3), REG_OP(3))       , "4: R3=FTMH+DSP+OAM_TS");
        INSTR(CE_NOP                                                          , ALU_ADD(REG_OP(1), REG_OP(SZ), REG_OP(1)), "5: R1=system header size + forward header size (Rsz)");
        INSTR(CE_LREAD(PKT, R_OFST(3,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)     , ALU_NOP                                  , "6: FEM=forward header offset");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "7: NOP");
        INSTR(CE_NOP                                                          , ALU_ADD(FEM, REG_OP(1), REG_OP(1))       , "8: R1=system header size + forward header offset + forward header size");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "9: NOP");
        INSTR(CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0))                         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "10:Copy forwarding header from original packet");
        INSTR(CE_COPY(PKT, R_OFST(1,-16), R_SIZE(SZ,-8))                      , ALU_NOP                                  , "11:Copy forwarding header from original packet");
        INSTR(CE_COPY(PKT, R_OFST(1,-32), R_SIZE(SZ,0))                       , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ)), "12:Copy forwarding header from original packet; Rsz=R2-R0");
        INSTR(CE_COPY(PKT, R_OFST(1,-48), R_SIZE(SZ,-8))                      , ALU_NOP                                  , "13:Copy forwarding header from original packet");
        INSTR(CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                         , ALU_NOP                                  , "14:Copy generated tunnel");
        INSTR(CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8))                      , ALU_NOP                                  , "15:Copy generated tunnel");
        INSTR(CE_COPY(GEN, R_OFST(0,0), C_SIZE(2))                            , ALU_NOP                                  , "16:Copy Ethertype");
        INSTR(CE_COPY(PKT, R_OFST(3,14), C_SIZE(2))                           , ALU_NOP                                  , "17:Copy InRIF LSBits");
        INSTR(CE_LREAD(PKT, R_OFST(3, 1), LFEM_BIT_0_M_3)                     , ALU_NOP                                  , "18:FEM=FHEI_3B");
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)              , ALU_NOP                                  , "19:FEM=system header size");
        INSTR(CE_LREAD(PKT, R_OFST(3, 1), LFEM_BIT_1_M_5)                     , ALU_ADD(FEM, REG_OP(3), REG_OP(SZ))      , "20:FEM=FHEI_5B; Rsz=FTMH+DSP+OAM_TS+FHEI_3B");
        INSTR(CE_LCOPY(PKT, R_OFST(3,10), C_SIZE(1), LFEM_2_LSBS)             , ALU_ADD(FEM, CNST(0), REG_OP(1))         , "21:Copy InRIF MSBits;R1=system header size");
        INSTR(CE_LCOPY(PKT, R_OFST(3,10), C_SIZE(2), LFEM_BITS_2_17_RSHIFT_2) , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))      , "22:Copy OutRIF; R3=FTMH+DSP+OAM_TS+FHEI_3B+FHEI_5B");
        INSTR(CE_COPY(PKT, C_OFST(20), C_SIZE(1))                             , ALU_NOP                                  , "23: Copy FTMH.LB_EXT");
        INSTR(CE_COPY(PKT, C_OFST(12), C_SIZE(6))                             , ALU_NOP                                  , "24:Copy FTMH[71:24];");
        INSTR(CE_COPY(PKT, R_OFST(3,14), C_SIZE(2))                           , ALU_NOP                                  , "25:Copy FHEI[15:0](In-DSCP, In-TTL);");
        INSTR(CE_FCOPY(PrgeDataFieldAceVar, 0, C_SIZE(1))                     , ALU_NOP                                  , "26:Copy ACE variable;");
        INSTR(CE_COPY(PKT, R_OFST(1, 4), C_SIZE(2))                           , ALU_NOP                                  , "27:Copy 1st 2 bytes of UDH;");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 473, exit);
    }
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 480, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_GENERALIZED_RCY_HEADER_1);
        SOC_SAND_CHECK_FUNC_RESULT(res, 481, exit);

        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 482, exit);

        if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == 0) {
            LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Generalized recycle header set but LB extension is not defined.\n")));
        }

        
        INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT)      , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ)), "0: FEM=DSP extension size; Rsz=R3-R0");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "1: NOP");
        INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2_M_6)                       , ALU_ADD(FEM, CNST(ftmh_size), REG_OP(2)) , "2: FEM=OAM_TS heade size; R2=FTMH+DSP");
        INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                         , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))                      , ALU_ADD(FEM, REG_OP(2), REG_OP(2))       , "4: Copy generated header; R2=FTMH+DSP+OAM_TS");
        INSTR(CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))                       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "5: Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-8))                      , ALU_NOP                                  , "6: Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))                       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "7: Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))                      , ALU_NOP                                  , "8: Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-96), R_SIZE(SZ,0))                       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "9: Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-112), R_SIZE(SZ,-8))                     , ALU_NOP                                  , "10:Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(3,-128), R_SIZE(SZ,0))                      , ALU_NOP                                  , "11:Copy generated header");
        INSTR(CE_COPY(GEN, R_OFST(0,0), C_SIZE(2))                            , ALU_NOP                                  , "12:Copy Ethertype");
        INSTR(CE_COPY(PKT, R_OFST(2,14), C_SIZE(2))                           , ALU_NOP                                  , "13:Copy InRIF LSBits");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "14: NOP");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "15: NOP");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "16: NOP");
        INSTR(CE_NOP                                                          , ALU_NOP                                  , "17: NOP");
        INSTR(CE_LREAD(PKT, R_OFST(2, 1), LFEM_BIT_0_M_3)                     , ALU_NOP                                  , "18:FEM=FHEI_3B");
        INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)              , ALU_NOP                                  , "19:FEM=system header size");
        INSTR(CE_LREAD(PKT, R_OFST(2, 1), LFEM_BIT_1_M_5)                     , ALU_ADD(FEM, REG_OP(2), REG_OP(1))       , "20:FEM=FHEI_5B; R1=FTMH+DSP+OAM_TS+FHEI_3B");
        INSTR(CE_LCOPY(PKT, R_OFST(2,10), C_SIZE(1), LFEM_2_LSBS)             , ALU_ADD(FEM, CNST(0), REG_OP(2))         , "21:Copy InRIF MSBits; R2=system header size");
        INSTR(CE_LCOPY(PKT, R_OFST(2,10), C_SIZE(2), LFEM_BITS_2_17_RSHIFT_2) , ALU_ADD(FEM, REG_OP(1), REG_OP(1))       , "22:Copy OutRIF; R1=FTMH+DSP+OAM_TS+FHEI_3B+FHEI_5B");
        INSTR(CE_COPY(PKT, C_OFST(20), C_SIZE(1))                             , ALU_NOP                                  , "23:Copy FTMH.LB_EXT");
        INSTR(CE_COPY(PKT, C_OFST(12), C_SIZE(6))                             , ALU_NOP                                  , "24:Copy FTMH[71:24];");
        INSTR(CE_COPY(PKT, R_OFST(1,14), C_SIZE(2))                            , ALU_NOP                                 , "25:Copy FHEI[15:0](In-DSCP, In-TTL);");
        INSTR(CE_FCOPY(PrgeDataFieldAceVar, 0, C_SIZE(1))                     , ALU_NOP                                  , "26:Copy ACE variable;");
        INSTR(CE_COPY(PKT, R_OFST(2, 4), C_SIZE(2))                           , ALU_NOP                                  , "27:Copy 1st 2 bytes of UDH;");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 483, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_20BYTE_PREFIX_HEADER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
         INSTR( CE_FLREAD(PrgeDataFieldOutLif, 0, LFEM_LSHIFT_1)                      , ALU_NOP                                 , " Read OutLIF x 2 ; --- "   );
         INSTR( CE_NOP                                                                , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                                , ALU_ADD( FEM, CNST(0) ,REG_OP(0) )      , " --- ; R0 = FEM (OutLIF x 2) "   );
         INSTR( CE_NOP                                                                , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                                , ALU_ADD( REG_OP(0), CNST(0) ,DATA_ADDR ), " --- ; Read Data Memory Entry from index OutLIFx2 "   );
         INSTR( CE_NOP                                                                , ALU_ADD( REG_OP(0), CNST(1) ,DATA_ADDR ), " --- ; Read Data Memory Entry from index OutLIFx2+1 "   );
         INSTR( CE_NOP                                                                , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                                , ALU_NOP                                 , " --- ; --- "   );

         INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0  , C_SIZE(8))                , ALU_NOP                                 , " Copy 8 LSB from 1st data memory entry ; --- "   );
         INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, -16, C_SIZE(8))                , ALU_NOP                                 , " Copy 8 MSB from 1st data memory entry ; --- "   );

         INSTR( CE_NOP                                                               , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                               , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                               , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                               , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                               , ALU_NOP                                 , " --- ; --- "   );
         INSTR( CE_NOP                                                               , ALU_NOP                                 , " --- ; --- "   );

         INSTR( CE_FCOPY(PrgeDataFieldDataMemoryEntry, 0, C_SIZE(4))                 , ALU_NOP                                 , " Copy 4 LSB from 2nd data memory entry ; --- "   );

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        ftmh_size += ARAD_EGR_PROG_EDITOR_CONFIG_ADD_FTMH_DSP_EXTENSION(unit) * ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE;  

        
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IOAM_MPLS);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                 , " FEM=SysHdrSize; Rsz=R3-R2 ");
        INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_NOP                           , " FEM=PPH.fwd_hdr_ofst; --- ");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))           , ALU_SUB(FEM, CNST(0),REG_OP(0))                         , " Copy GenHdr(R2-R3); R0=SysHdrSize ");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))        , ALU_SUB(FEM, CNST(0),REG_OP(1))                         , " Copy GenHdr(R2-R3); R1=PPH.fwd_hdr_ofst ");
        INSTR( CE_READ(PKT, R_OFST(0,(user_header_size+14)<<1))  , ALU_SET(8,REG_OP(0))                                   , " FEM=EtherType; R0=8 ");
        INSTR( CE_READ(PKT, R_OFST(0,(user_header_size+18)<<1))  , ALU_ADD( REG_OP(1), REG_OP(0), REG_OP(1) )             , " FEM=EtherType; R1=SysHdrSize+fwd_hdr_ofst ");
        INSTR( CE_FREAD(PrgeDataFieldProgVar, 0)                 , ALU_SET_IF(FEM, EQ, CNST(0x8847), REG_OP(0), REG_OP(SZ)), " FEM=prog_var; IF EtherType=0x8847 THEN Rsz=8(untag) ");
        INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-16))       , ALU_SET_IF(FEM, EQ, CNST(0x8847), REG_OP(0), REG_OP(SZ)), " Copy GenHdr(R2-R3); IF EtherType=0x8847 THEN Rsz=8(single tag) ");
        INSTR( CE_NOP                                            , ALU_SUB(FEM, CNST(0), REG_OP(0))                        , " ---; R0=prog_var(ELI label val) ");
        INSTR( CE_READ(PKT, R_OFST(1, -11))                      , ALU_SET(0, REG_OP(3))                                   , " FEM=packet[fwd_hdr_ofst-44:-16]; R3=0 ");
        INSTR( CE_LREAD(PKT, R_OFST(1, -15), LFEM_4_LSBS)        , ALU_NOP                                                 , " FEM=packet[fwd_hdr_ofst-60:-4] ; --- ");
        INSTR( CE_LREAD(GEN, R_OFST(2, 0), LFEM_ZERO_BIT8)       , ALU_SET_IF(FEM, NEQ, REG_OP(0), REG_OP(3), REG_OP(SZ))  , " FEM=GenHdr.bos_label & ~bos; IF packet[fwd_hdr_ofst-44:-16]!=ELI labe THEN Rsz=0");
        INSTR( CE_NOP                                            , ALU_SET_IF(FEM, NEQ, CNST(0), REG_OP(3), REG_OP(SZ))    , " --- ; IF packet[fwd_hdr_ofst-60:-4]!=0 THEN Rsz=0 ");
        INSTR( CE_NOP                                            , ALU_SUB(FEM, CNST(0), REG_OP(0))                        , " --- ; R0 = GenHdr.bos_label & ~bos ");
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0))           , ALU_SUB(CNST(2), REG_OP(SZ), REG_OP(3))                 , " Copy packet[fwd_hdr_ofst:-64]; R3=2-Rsz ");
        INSTR( CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(SZ,-6))       , ALU_NOP                                                 , " Copy 0(non-IOAM) or 2(IOAM) bytes from R0; --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))            , ALU_NOP                                                 , " Copy 2(non-IOAM) or 0(IOAM) bytes from GenHdr; --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(2,-2))          , ALU_SUB(REG_OP(2), CNST(18), REG_OP(2))                 , " Copy GenHdr(0-R2-2); --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,-20), R_SIZE(2,-10))        , ALU_NOP                                                 , " Copy GenHdr(0-R2-2); --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                 , " Copy GenHdr(0-R2-2); --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                                 , " Copy GenHdr(0-R2-2); --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))            , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                 , " Copy GenHdr(0-R2-2); --- ");
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))         , ALU_NOP                                                 , " Copy GenHdr(0-R2-2); --- ");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    
    res = arad_egr_prge_mgmt_program_management_main(unit);
    if (res != SOC_E_NONE) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE error - Could not load managed programs.\n\r")));
    }

    
    SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_load_required_lfems(unit));

    SOC_REG_ABOVE_64_CLEAR(header_editing_size); 

    
    header_editing_size[PP_FWD_CODE_ETHERNET] = ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE;
    if (SOC_IS_JERICHO_PLUS(unit) && ((SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_encap_mode == SOC_DPP_IP6_TUNNEL_ENCAP_MODE_LARGE) || 
        (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_encap_mode == SOC_DPP_IP4_TUNNEL_ENCAP_MODE_LARGE))) {
        header_editing_size[PP_FWD_CODE_IPV4_UC] = 12;
        header_editing_size[PP_FWD_CODE_IPV4_MC] = 12;
        header_editing_size[PP_FWD_CODE_IPV6_UC] = 8;
        header_editing_size[PP_FWD_CODE_IPV6_MC] = 8;
    } else {
        header_editing_size[PP_FWD_CODE_IPV4_UC] = 20;
        header_editing_size[PP_FWD_CODE_IPV4_MC] = 20;
        header_editing_size[PP_FWD_CODE_IPV6_UC] = 16;
        header_editing_size[PP_FWD_CODE_IPV6_MC] = 16;
    }
    header_editing_size[PP_FWD_CODE_MPLS] = 4;
    header_editing_size[PP_FWD_CODE_TRILL] = 6;
    header_editing_size[PP_FWD_CODE_ETHERNET_AFTER_TERMINATION] = 20;

    
    header_editing_size_to_reg_val(header_editing_size, header_editing_size_val);

    SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_HEADER_EDITING_SIZEr(unit, REG_PORT_ANY, header_editing_size_val));

    
    if (SOC_IS_JERICHO_PLUS(unit)) {
        int ethernet_header_editing_size[2] = {0x00006186, 0x18618618};
        int ethernet_header_editing_size_count = 0;

        
        ethernet_header_editing_size_count = soc_property_get_csv(unit, "custom_feature_ethernet_header_editing_size", 2, ethernet_header_editing_size);
        if ((ethernet_header_editing_size_count != 2) && (ethernet_header_editing_size_count != 0)) {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("custom_feature_ethernet_header_editing_size configuration wrong.\n\r")));
        }
        COMPILER_64_SET(ethernet_header_editing_size_val, ethernet_header_editing_size[0], ethernet_header_editing_size[1]);

        SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_ETHERNET_HEADER_EDITING_SIZEr(unit, ethernet_header_editing_size_val));
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_basic_epni_tm_config()",0,0);
}

uint32
  arad_egr_prog_editor_prog_sel_mirror_command_set (
    SOC_SAND_IN int unit,
    ARAD_EGR_PROG_EDITOR_PROGRAMS program,
    uint32 selection_value
  )
{
    uint32 res;
    int    program_sel;
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA prog_sel_tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));

    for (program_sel = 0; program_sel < ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); program_sel++)
    {
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prog_sel_tbl_data);

        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, program_sel, &prog_sel_tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (prog_sel_tbl_data.program == prog_used) {
            prog_sel_tbl_data.mirror_command = selection_value;
            prog_sel_tbl_data.mirror_command_mask = 0;
            prog_sel_tbl_data.valid = 1;

            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, program_sel, &prog_sel_tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}

uint32
  arad_egr_prog_editor_config_dut_by_queue_database(
    SOC_SAND_IN int unit
  ) 
{
  uint32    res;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  

  

      res = arad_egr_prog_editor_basic_epni_tm_config(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in config_dut_by_queue_database()", 0, 0);
}

uint32 
  arad_egr_prog_editor_stacking_lfems_set(
    SOC_SAND_IN int unit,
    SOC_SAND_IN SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK tm_port_profile_stack,
    SOC_SAND_IN uint32 bitmap) 
{
    uint32
        res, 
        my_tm_domain, 
        local_bitmap = 0x0;
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  
        lfem_field_select_map_tbl_data;
    lfem_map 
        lfem_arr_0[16];
    int 
        i;
    uint64
        reg_val64;
  
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    
    if (((tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK1) || (tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK_ALL)) && 
        (lfem_stacking_8_index[unit] != -1)) {

        
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, READ_IHB_LBP_GENERAL_CONFIG_0r(unit, REG_PORT_ANY, &reg_val64));
        my_tm_domain = soc_reg64_field32_get(unit, IHB_LBP_GENERAL_CONFIG_0r, reg_val64, TM_DOMAINf);
        if (my_tm_domain < 16) {
            local_bitmap = bitmap | (1 << my_tm_domain);
        } else {
            SOC_SAND_CHECK_FUNC_RESULT(SOC_SAND_GEN_ERR, 20, exit);
        }

        
        for (i = 0 ; i < 16 ; i++) {
            
            lfem_arr_0[i].val1 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8][2*i+1]; 
            lfem_arr_0[i].val2 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8][2*i+2]; 
        }

        
        for (i = 0 ; i < 16 ; i++) {
            if ((1 << i) & local_bitmap) {
                lfem_arr_0[15 - i].val1 = 1;
                lfem_arr_0[15 - i].val2 = 1;
            }
        }
        
        lfem_map_arr_to_lfem_field_select_map(lfem_arr_0, &lfem_field_select_map_tbl_data);
        res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, lfem_stacking_8_map[unit], lfem_stacking_8_index[unit], 
                                                             &lfem_field_select_map_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
    }

    
    if (((tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK2) || (tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK_ALL)) && 
        (lfem_stacking_10_index[unit] != -1)) {

        
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 40, exit, READ_IHB_LBP_GENERAL_CONFIG_0r(unit, REG_PORT_ANY, &reg_val64));
        my_tm_domain = soc_reg64_field32_get(unit, IHB_LBP_GENERAL_CONFIG_0r, reg_val64, TM_DOMAINf);
        if (my_tm_domain < 16) {
            local_bitmap = bitmap | (1 << my_tm_domain);
        } else {
            SOC_SAND_CHECK_FUNC_RESULT(SOC_SAND_GEN_ERR, 50, exit);
        }   

        
        for (i = 0 ; i < 16 ; i++) {
            
            lfem_arr_0[i].val1 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10][2*i+1]; 
            lfem_arr_0[i].val2 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10][2*i+2]; 
        }

        
        for (i = 0 ; i < 16 ; i++) {
            if ((1 << i) & local_bitmap) {
                lfem_arr_0[15 - i].val1 = 1;
                lfem_arr_0[15 - i].val2 = 1;
            }
        }

        lfem_map_arr_to_lfem_field_select_map(lfem_arr_0, &lfem_field_select_map_tbl_data);
        res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, lfem_stacking_10_map[unit], lfem_stacking_10_index[unit], 
                                                             &lfem_field_select_map_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_stacking_lfems_set()", bitmap, local_bitmap);
}


uint32
arad_egr_prog_l2_encap_external_cpu_program_info_set(
   SOC_SAND_IN int unit,
   SOC_SAND_IN uint32 pp_port_var,
   SOC_SAND_IN uint64 prge_var
 )
{
    soc_port_t local_port;
    SOC_TMC_PORT_HEADER_TYPE header_type_out;
    uint32 is_valid, res = SOC_SAND_OK;
   
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (local_port = 0; local_port < ARAD_NOF_LOCAL_PORTS(unit); ++local_port) {

        res = soc_port_sw_db_is_valid_port_get(unit, local_port, &is_valid);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 15, exit);
        if (!is_valid) {
            continue;
        }
        res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.header_type_out.get(unit,local_port,&header_type_out);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 25, exit);

        if(header_type_out==SOC_TMC_PORT_HEADER_TYPE_L2_ENCAP_EXTERNAL_CPU) {

            res = arad_egr_prog_editor_pp_pct_var_set(unit,local_port,pp_port_var);
            SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);
        }
    }

    res = arad_pp_prge_program_var_set(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, prge_var);
    SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);

exit:
   SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_l2_encap_external_cpu_program_info_set()", 0, 0);

}

uint32
arad_egr_prog_l2_encap_external_cpu_program_info_get(
   SOC_SAND_IN int unit,
   SOC_SAND_OUT uint32 *pp_port_var,
   SOC_SAND_OUT uint64 *prge_var
 )
{
    soc_port_t local_port;
    int core;
    SOC_TMC_PORT_HEADER_TYPE header_type_out;
    uint32 port_ndx, is_valid, res = SOC_SAND_OK;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);


    for (local_port = 0; local_port < ARAD_NOF_LOCAL_PORTS(unit); ++local_port) {

        res = soc_port_sw_db_is_valid_port_get(unit, local_port, &is_valid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
        if (!is_valid) {
            continue;
        }

        res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.header_type_out.get(unit,local_port,&header_type_out);
        SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

        if(header_type_out==SOC_TMC_PORT_HEADER_TYPE_L2_ENCAP_EXTERNAL_CPU) {
            
            res = soc_port_sw_db_local_to_pp_port_get(unit, local_port, &port_ndx, &core);
            SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);
            res = arad_egr_prog_editor_pp_pct_var_get(unit,port_ndx,pp_port_var);
            SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);

            break;    
        }
    }

    res = arad_pp_prge_program_var_get(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, prge_var);
    SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);

exit:
   SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_l2_encap_external_cpu_program_info_get()", 0, 0);

}

uint32
arad_egr_prog_vxlan_program_info_set(
   SOC_SAND_IN int unit,
   SOC_SAND_IN uint16 udp_dest_port
 )
{
  ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA 
      prge_program_tbl_data;
  uint32 res = SOC_SAND_OK;
  uint32 entry_u32[2];
  int prog_used;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

      entry_u32[0] = COMPILER_64_LO(prge_program_tbl_data.program_var);
      entry_u32[1] = COMPILER_64_HI(prge_program_tbl_data.program_var);

      
      entry_u32[1] &= 0x0000FFFF;
      entry_u32[1] |= udp_dest_port << 16;

      COMPILER_64_SET(prge_program_tbl_data.program_var, entry_u32[1], entry_u32[0]);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }
exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_vxlan_program_info_set()", udp_dest_port, 0);
}

int
  arad_egr_prog_editor_program_pointer_get(
    SOC_SAND_IN   int                                 unit,
    SOC_SAND_IN   ARAD_EGR_PROG_EDITOR_PROGRAMS       program_id,
    SOC_SAND_OUT  uint32                              *program_pointer
  )
{
    int prog_used;
    SOCDNX_INIT_FUNC_DEFS;

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program_id, &prog_used));
    if (prog_used != -1) {
        SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, program_id, program_pointer));
    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG("ARAD_EGR_PROG_EDITOR_PROGRAM_NOT_USED_ERR")));
    }

exit:
    SOCDNX_FUNC_RETURN;
}

int
  arad_egr_prog_editor_profile_get(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                     eg_tm_profile,
    SOC_SAND_OUT uint32                     *internal_profile
  )
{   
    int tm_profiles;
    SOCDNX_INIT_FUNC_DEFS;

    if (eg_tm_profile == ARAD_PRGE_TM_SELECT_NONE) {
        *internal_profile = ARAD_PRGE_TM_SELECT_NONE;
        SOC_EXIT;
    }
    else {
        SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, eg_tm_profile, &tm_profiles));
        if (tm_profiles != -1) {
            *internal_profile = tm_profiles;
            SOC_EXIT;
        }
    }
    
    SOCDNX_EXIT_WITH_ERR_NO_MSG(SOC_E_INTERNAL);

exit:
    SOCDNX_FUNC_RETURN;
}

uint32
  arad_egr_prog_editor_tm_profile_enum_get(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                        internal_profile,
    SOC_SAND_OUT uint32                         *eg_tm_profile
  )
{   
  uint32 tm_profile_idx;
  int tm_profiles;
  soc_error_t rv;
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  *eg_tm_profile = -1;
  for (tm_profile_idx = 0; tm_profile_idx<ARAD_PRGE_TM_SELECT_NOF_PROFILES ; tm_profile_idx++) {
      rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile_idx, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
      if (tm_profiles == internal_profile) {
          *eg_tm_profile = tm_profile_idx;
          break;
      }
  }
  if (*eg_tm_profile == -1) {
      SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - tm profile not exist. \n\r")));
  }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_tm_profile_enum_get()", internal_profile, 0);
}

uint32
  arad_egr_prog_editor_pp_pct_var_set(
    SOC_SAND_IN uint32 unit,
    SOC_SAND_IN uint32 port,
    SOC_SAND_IN uint32 value
  ) {
    ARAD_PP_EPNI_PP_PCT_TBL_DATA
      tbl_data;
    int
      res = SOC_SAND_OK;
	int core=0;
    uint32 pp_port;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    SOC_SAND_CHECK_DRIVER_AND_DEVICE;

    res = soc_port_sw_db_local_to_pp_port_get(unit, port, &pp_port, &core);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);    


    res = arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core,  pp_port, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

    tbl_data.prge_var = value;

    res = arad_pp_epni_pp_pct_tbl_set_unsafe(unit, core, pp_port, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 30, exit);

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in soc_ppd_eg_epni_pp_pct_prge_var_set()", port, value);
}

uint32
  arad_egr_prog_editor_pp_pct_var_get(
    SOC_SAND_IN uint32 unit,
    SOC_SAND_IN uint32 port,
    SOC_SAND_OUT uint32 *value
  ) {
    int
      res = SOC_SAND_OK;
    ARAD_PP_EPNI_PP_PCT_TBL_DATA
      tbl_data;
	int core=0;
    uint32 pp_port;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = soc_port_sw_db_local_to_pp_port_get(unit, port, &pp_port, &core);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit); 

    res = arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core, pp_port, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

    *value = tbl_data.prge_var;

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in soc_ppd_eg_epni_pp_pct_prge_var_get()", unit, port);
}


int
  arad_egr_prog_editor_profile_set(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  int                        core,
    SOC_SAND_IN  uint32                     q_pair,
    SOC_SAND_IN  uint32                     prog_editor_profile
  )
{   
    ARAD_EGQ_PCT_TBL_DATA        pct_tbl_data;
    soc_port_t port_ndx;
    soc_port_if_t interface;

    uint32 base_q_pair, nof_pairs, curr_q_pair;
    uint32 pp_port, tm_port;
    int core_tmp;
    uint32 tm_profile;

    ARAD_PP_EPNI_PP_PCT_TBL_DATA pp_pct_tbl_data;

    SOCDNX_INIT_FUNC_DEFS;
    
    if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "conn_to_np_enable", 0)) {
        port_ndx = q_pair;    
        
        SOCDNX_IF_ERR_EXIT(soc_port_sw_db_interface_type_get(unit, port_ndx, &interface));
        if ((prog_editor_profile != 0) && (interface == SOC_PORT_IF_RCY)) {
            
             
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_local_to_pp_port_get(unit, port_ndx, &pp_port, &core_tmp));
            SOCDNX_IF_ERR_EXIT(arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core_tmp, pp_port, &pp_pct_tbl_data));
            pp_pct_tbl_data.prge_profile = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP - 1;
            SOCDNX_IF_ERR_EXIT(arad_pp_epni_pp_pct_tbl_set_unsafe(unit, core_tmp, pp_port, &pp_pct_tbl_data));

            
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_local_to_tm_port_get(unit, port_ndx, &tm_port, &core_tmp));
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_tm_port_to_base_q_pair_get(unit, core_tmp, tm_port, &base_q_pair));
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_tm_port_to_out_port_priority_get(unit, core_tmp, tm_port, &nof_pairs));
            SOCDNX_IF_ERR_EXIT(arad_egr_prog_editor_profile_get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profile));

            for (curr_q_pair = base_q_pair; curr_q_pair < base_q_pair + nof_pairs; curr_q_pair++) {
                SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_get_unsafe(unit, core, curr_q_pair, &pct_tbl_data));
                
                pct_tbl_data.prog_editor_profile = tm_profile;
                SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_set_unsafe(unit, core, curr_q_pair, &pct_tbl_data));
            }
        }
    } else {
        SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_get_unsafe(unit, core, q_pair, &pct_tbl_data));
        
        pct_tbl_data.prog_editor_profile  = prog_editor_profile; 
        
        SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_set_unsafe(unit, core, q_pair, &pct_tbl_data));
    }

exit:
    SOCDNX_FUNC_RETURN;
}


int
  arad_egr_prog_editor_pp_profile_set(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  int                        port,
    SOC_SAND_IN  uint32                     prog_editor_profile
  )
{   
    soc_port_t port_ndx;
    soc_port_if_t interface;

    uint32 pp_port;
    int core_tmp;

    ARAD_PP_EPNI_PP_PCT_TBL_DATA pp_pct_tbl_data;

    SOCDNX_INIT_FUNC_DEFS;

    port_ndx = port;        
    SOCDNX_IF_ERR_EXIT(soc_port_sw_db_interface_type_get(unit, port_ndx, &interface));
    SOCDNX_IF_ERR_EXIT(soc_port_sw_db_local_to_pp_port_get(unit, port_ndx, &pp_port, &core_tmp));
    SOCDNX_IF_ERR_EXIT(arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core_tmp, pp_port, &pp_pct_tbl_data));
    pp_pct_tbl_data.prge_profile = prog_editor_profile;
    SOCDNX_IF_ERR_EXIT(arad_pp_epni_pp_pct_tbl_set_unsafe(unit, core_tmp, pp_port, &pp_pct_tbl_data));

exit:
    SOCDNX_FUNC_RETURN;
}



int
  arad_pp_prge_program_var_set(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   program,
     SOC_SAND_IN    uint64                          var
  )
{
    ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA      prge_program_tbl_data; 
    uint32 res = SOC_SAND_OK;
    uint32 entry_u32[2];
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;


    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {
        res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOCDNX_SAND_IF_ERR_EXIT(res);

        entry_u32[0] = COMPILER_64_LO(var);
        entry_u32[1] = COMPILER_64_HI(var); 

        COMPILER_64_SET(prge_program_tbl_data.program_var, entry_u32[1], entry_u32[0]);
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOCDNX_SAND_IF_ERR_EXIT(res);
    }

exit:
    SOCDNX_FUNC_RETURN;
}


int
  arad_pp_prge_program_var_get(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   program,
     SOC_SAND_OUT   uint64                          *var
  )
{
    ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA      prge_program_tbl_data; 
    uint32 res = SOC_SAND_OK;
    uint32 entry_u32[2];
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;


    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {
        res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOCDNX_SAND_IF_ERR_EXIT(res);

        entry_u32[0] = COMPILER_64_LO(prge_program_tbl_data.program_var);
        entry_u32[1] = COMPILER_64_HI(prge_program_tbl_data.program_var); 

        COMPILER_64_SET(*var, entry_u32[1], entry_u32[0]);

    }


exit:
    SOCDNX_FUNC_RETURN;
}

uint32 _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(int unit,
                                                                  uint32 outlif_profile_index,
                                                                  uint32 profile_value,
                                                                  uint32 profile_mask,
                                                                  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA *tbl_data
  ) {
    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_UNAVAIL, (_BSL_SOCDNX_MSG("Error: Program selection by outlif profile is available in Jericho and above\n\r")));
    }

    switch (outlif_profile_index) {
    case 1:
        tbl_data->first_out_lif_profile |= profile_value;
        tbl_data->first_out_lif_profile_mask &= profile_mask;
        tbl_data->first_out_lif_profile_valid = 1;
        tbl_data->first_out_lif_profile_valid_mask = 0;
        break;
    case 2:
        tbl_data->second_out_lif_profile |= profile_value;
        tbl_data->second_out_lif_profile_mask &= profile_mask;
        tbl_data->second_out_lif_profile_valid = 1;
        tbl_data->second_out_lif_profile_valid_mask = 0;
        break;
    case 3:
        tbl_data->third_out_lif_profile |= profile_value;
        tbl_data->third_out_lif_profile_mask &= profile_mask;
        tbl_data->third_out_lif_profile_valid = 1;
        tbl_data->third_out_lif_profile_valid_mask = 0;
        break;
    case 4:
        tbl_data->forth_out_lif_profile |= profile_value;
        tbl_data->forth_out_lif_profile_mask &= profile_mask;
        tbl_data->forth_out_lif_profile_valid = 1;
        tbl_data->forth_out_lif_profile_valid_mask = 0;
        break;
    case 5:
        tbl_data->fifth_out_lif_profile |= profile_value;
        tbl_data->fifth_out_lif_profile_mask &= profile_mask;
        break;
    case 6:
        tbl_data->sixth_out_lif_profile |= profile_value;
        tbl_data->sixth_out_lif_profile_mask &= profile_mask;
        break;
    default:
        SOCDNX_EXIT_WITH_ERR(SOC_E_PARAM, (_BSL_SOCDNX_MSG("Error: Unrecognized outlif profile index %d. Valid range is 1-4\n\r")));
    }
exit:
    SOCDNX_FUNC_RETURN;
}


uint32
  arad_egr_prog_editor_prog_sel_inlif_profile_set(int unit,
                                                   SOC_OCC_MGMT_INLIF_APP inlif_app,
                                                   ARAD_EGR_PROG_EDITOR_PROGRAMS program,
                                                   uint32 selection_value
  ) {

    uint32 res;
    uint32 tcam_line;
    uint32 profile_mask = 0;
    uint32 profile_value = 0;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA
        tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        return SOC_E_UNAVAIL;
    }

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {

        res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_INLIF, inlif_app, selection_value,
                                             &profile_value, NULL, &profile_mask);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: inlif profile not defined\n\r")));
        }

    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r")));
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            
            tbl_data.value_1 |= profile_value << 6;
            tbl_data.value_1_mask &= (profile_mask << 6) | 0x3F;

            
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}



uint32
  arad_egr_prog_editor_prog_sel_outlif_profile_set(int unit,
                                                   SOC_OCC_MGMT_OUTLIF_APP outlif_app,
                                                   ARAD_EGR_PROG_EDITOR_PROGRAMS program,
                                                   uint32 selection_value,
                                                   uint32 outlif_profile_index
  ) {

    uint32 res;
    uint32 tcam_line;
    uint32 profile_mask = 0;
    uint32 profile_value = 0;

    int    special_case_prog = 0;
    uint32 profile_mask_alt  = 0;
    uint32 profile_value_alt = 0;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA
        tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_WARM_BOOT(unit)) {
        
        LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Warning: outlif profile for egress editing is not reinserted during warm boot.\n")));
        goto exit;
    }

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_UNAVAIL, (_BSL_SOCDNX_MSG("Error: Program selection by outlif profile is available in Jericho and above\n\r")));
    }

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {

        res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_OUTLIF, outlif_app, selection_value,
                                             &profile_value, NULL, &profile_mask);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: outlif profile not defined\n\r")));
        }

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0)) {
            res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_OUTLIF, SOC_OCC_MGMT_OUTLIF_APP_CUSTOM_P_TAGGED_TYPE, ARAD_EGR_PROG_EDITOR_OUTLIF_TYPE_1,
                                                 &profile_value_alt, NULL, &profile_mask_alt);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: outlif profile not defined\n\r")));
            }
        }

    } else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r"))); 
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            if (outlif_profile_index == ARAD_EGR_PROG_OUTLIF_PROFILE_INDEX_ALL) {
                uint8 outlif_profile_found = 0;

                
                if (tbl_data.first_out_lif_profile_mask == 0) {
                    tbl_data.first_out_lif_profile = profile_value;
                    tbl_data.first_out_lif_profile_mask = profile_mask;
                    outlif_profile_found = 1;
                }
                else if (tbl_data.second_out_lif_profile_mask == 0) {
                    tbl_data.second_out_lif_profile = profile_value;
                    tbl_data.second_out_lif_profile_mask = profile_mask;
                    outlif_profile_found = 1;
                }
                else if (tbl_data.third_out_lif_profile_mask == 0) {
                    tbl_data.third_out_lif_profile = profile_value;
                    tbl_data.third_out_lif_profile_mask = profile_mask;
                    outlif_profile_found = 1;
                }
                else if (tbl_data.forth_out_lif_profile_mask == 0) {
                    tbl_data.forth_out_lif_profile = profile_value;
                    tbl_data.forth_out_lif_profile_mask = profile_mask;
                    outlif_profile_found = 1;
                }
                else if (tbl_data.fifth_out_lif_profile_mask == 0) {
                    tbl_data.fifth_out_lif_profile = profile_value;
                    tbl_data.fifth_out_lif_profile_mask = profile_mask;
                    outlif_profile_found = 1;
                }
                else if (tbl_data.sixth_out_lif_profile_mask == 0) {
                    tbl_data.sixth_out_lif_profile = profile_value;
                    tbl_data.sixth_out_lif_profile_mask = profile_mask;
                    outlif_profile_found = 1;
                }

                if (!outlif_profile_found) {
                    LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Warning: program %d entry %d has no outlif profile mask equals to 0\n"), program, tcam_line));
                }
            }
            else {
                
                res = _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(unit, outlif_profile_index, profile_value, profile_mask, &tbl_data);
                SOCDNX_IF_ERR_EXIT(res);

                if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0)) {
                    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                                           unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &special_case_prog));

                    if ((tbl_data.program == special_case_prog) && (tbl_data.learn_ext_exist_mask == 0x0) && (tbl_data.learn_ext_exist == 0x1)) {
                        if (outlif_profile_index == 1) {
                            tbl_data.first_out_lif_profile      = profile_value_alt;
                            tbl_data.first_out_lif_profile_mask = profile_mask_alt;
                        } else {
                            tbl_data.third_out_lif_profile      = profile_value_alt;
                            tbl_data.third_out_lif_profile_mask = profile_mask_alt;
                        }
                        
                        SOCDNX_IF_ERR_EXIT(res); 
                    }
                }
            }

            
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}


uint32
  arad_egr_prog_editor_prog_sel_outlif_profile_single_entry_set(int unit,
                                                                SOC_OCC_MGMT_OUTLIF_APP outlif_app,
                                                                ARAD_EGR_PROG_EDITOR_PROGRAMS program,
                                                                uint32 selection_entry,
                                                                uint32 selection_value,
                                                                uint32 outlif_profile_index
  ) {

    uint32 res;
    uint32 tcam_line;
    uint32 profile_mask = 0;
    uint32 profile_value = 0;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA
        tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_UNAVAIL, (_BSL_SOCDNX_MSG("Error: Program selection by outlif profile is available in Jericho and above\n\r")));
    }

    if (SOC_WARM_BOOT(unit)) {
        
        LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Warning: outlif profile for egress editing is not reinserted during warm boot.\n")));
        goto exit;
    }

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {

        res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_OUTLIF, outlif_app, selection_value,
                                             &profile_value, NULL, &profile_mask);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: outlif profile not defined\n\r")));
        }

    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r")));
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            if ((--selection_entry) == 0) {
                
                res = _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(unit, outlif_profile_index, profile_value, profile_mask, &tbl_data);
                SOCDNX_IF_ERR_EXIT(res);

                
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
                if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                    SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
                }
                break;
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}


uint32 arad_egr_prog_editor_prog_sel_value1_set(int unit, ARAD_EGR_PROG_EDITOR_PROGRAMS program, uint32 value1)
{
    uint32 res;
    uint32 tcam_line;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, program, &prog_used));
    if (prog_used == -1) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r")));
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            tbl_data.value_1 = value1;
            
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;

}



uint32
  arad_egr_prog_editor_program_by_name_find(
    SOC_SAND_IN  int                            unit,
    SOC_SAND_IN  char                          *prog_name,
    SOC_SAND_OUT ARAD_EGR_PROG_EDITOR_PROGRAMS *prog
  ){

    char* next_prog_name;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    SOC_SAND_CHECK_NULL_INPUT(prog_name);
    SOC_SAND_CHECK_NULL_INPUT(prog);

    for (*prog = 0; *prog < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; (*prog)++) {
        arad_egr_prog_editor_prog_name_get_by_id(*prog, &next_prog_name);
        if (!sal_strncasecmp(prog_name, next_prog_name, sal_strlen(prog_name))) {
            SOC_SAND_EXIT_NO_ERROR;
        }
    }

    SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error - Program %s not found. \n\r"), prog_name));

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_program_by_name_find()", 0, 0);
}

int
  arad_egr_prog_editor_print_all_programs_data(int unit)
{
    int program_id, lfem_map, lfem_idx;
    ARAD_EGR_PROG_EDITOR_LFEM lfem;
    char* prog_name;
    char* lfem_name;
    uint32 program_pointer;
    int prog_used;
    soc_error_t rv;

    SOCDNX_INIT_FUNC_DEFS;

    for (program_id = 0; program_id < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; program_id++) {
        arad_egr_prog_editor_prog_name_get_by_id(program_id, &prog_name);
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, program_id, &prog_used);
        SOCDNX_IF_ERR_EXIT(rv);
        if (prog_used != -1) {
            LOG_CLI((BSL_META_U(unit,
                                "========================================================================\n")));
            LOG_CLI((BSL_META_U(unit,
                                "program %d: %s\n"), program_id, prog_name));
            LOG_CLI((BSL_META_U(unit,
                                "selected program: %d\n"), prog_used));
            rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                program_id, &program_pointer);
            SOCDNX_IF_ERR_EXIT(rv);
            LOG_CLI((BSL_META_U(unit,
                                "entries used: %d, %d\n"), _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer), _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer)));
            LOG_CLI((BSL_META_U(unit,
                                "LFEMS used:\n")));
            for (lfem_map = 0; lfem_map < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); lfem_map++) {
                for (lfem_idx = 0; lfem_idx < ARAD_PP_EG_PROG_NOF_FEM(unit); lfem_idx++) {
                    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.lfem_bk.get(
                        unit, program_id, lfem_map, lfem_idx, &lfem);
                    SOCDNX_IF_ERR_EXIT(rv);
                    if (lfem < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                        
                        arad_egr_prog_editor_lfem_name_get_by_id(lfem, &lfem_name);

                        LOG_CLI((BSL_META_U(unit,
                                            "    Map: %d, Entry: %d, LFEM: %s\n"), lfem_map, lfem_idx, lfem_name));
                    }
                }
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}

int
  arad_egr_prog_editor_print_chosen_program(int unit, uint32 first_instruction, uint8 raw_output, char **prog_name, uint8 print_to_xml)
{
    int program_id;
    soc_error_t rv;
    uint32 program_pointer;
    

    SOCDNX_INIT_FUNC_DEFS;

    for (program_id = 0; program_id < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; program_id++) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            program_id, &program_pointer);
        SOCDNX_IF_ERR_EXIT(rv);
        if (_ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer) == first_instruction) {
            if (*prog_name!=NULL) {
                if (!print_to_xml) {
                    if (!raw_output) {
                        LOG_CLI((BSL_META_U(unit,
                                            "OR\n")));
                    }
                    else {
                        cli_out(",");
                    }
                }
            }
            arad_egr_prog_editor_prog_name_get_by_id(program_id, prog_name);
            if (*prog_name!=NULL) {
                if (!print_to_xml) {
                    if (!raw_output) {
                        LOG_CLI((BSL_META_U(unit,
                                            "Program %s was selected\n"), *prog_name));
                    }
                    else {
                        cli_out("%s\n",*prog_name);
                    }
                }
            }     
        }
    }

    if (*prog_name==NULL) {
        if (!print_to_xml) {
            if (!raw_output) {
                LOG_CLI((BSL_META_U(unit,
                                    "Default NULL program was selected\n")));
            }
            else {
                cli_out("Default(NOPs)\n");
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}






#if ARAD_DEBUG_IS_LVL1

#endif 


#include <soc/dpp/SAND/Utils/sand_footer.h>


#endif 

#undef _ERR_MSG_MODULE_NAME
