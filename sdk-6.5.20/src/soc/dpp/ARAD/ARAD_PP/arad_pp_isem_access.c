#include <shared/bsl.h>

#include <soc/mcm/memregs.h>
#if defined(BCM_88650_A0)
/*
 * 
 *
 * This license is set out in https://raw.githubusercontent.com/Broadcom-Network-Switching-Software/OpenBCM/master/Legal/LICENSE file.
 * 
 * Copyright 2007-2020 Broadcom Inc. All rights reserved.
 */

#ifdef _ERR_MSG_MODULE_NAME
  #error "_ERR_MSG_MODULE_NAME redefined"
#endif

#define _ERR_MSG_MODULE_NAME BSL_SOC_LIF
#include <soc/mem.h>




#include <shared/swstate/access/sw_state_access.h>

#include <soc/dcmn/error.h>
#include <soc/dpp/SAND/Utils/sand_header.h>

#include <soc/dpp/SAND/Management/sand_general_macros.h>
#include <soc/dpp/SAND/Management/sand_error_code.h>
#include <soc/dpp/SAND/Management/sand_general_macros.h>
#include <soc/dpp/SAND/Management/sand_low_level.h>
#include <soc/dpp/SAND/Utils/sand_os_interface.h>

#include <soc/dpp/ARAD/arad_tbl_access.h>
#include <soc/dpp/ARAD/arad_reg_access.h>
#include <soc/dpp/ARAD/arad_api_ports.h>
#include <soc/dpp/ARAD/arad_init.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_vsi.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_isem_access.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_ce_instruction.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_sw_db.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_port.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_frwrd_fcf.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_mpls_term.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_vtt.h>
#include <soc/dpp/drv.h>

#ifdef CRASH_RECOVERY_SUPPORT
#include <soc/hwstate/hw_log.h>
#include <soc/dcmn/dcmn_crash_recovery.h>
#endif 

#include <soc/dpp/PPD/ppd_api_port.h>

#ifdef PLISIM
    #include <sim/dpp/ChipSim/chip_sim_em.h>
#else
    #include <soc/dpp/ARAD/arad_sim_em.h>
#endif





#define ARAD_PP_ISEM_ACCESS_DEBUG                                     (0)

#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_LSB                        (0)
#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_MSB                        (2)
#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_LSB                         (11)
#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_MSB                         (SOC_IS_JERICHO(unit)? 60:51)
#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_PAYLOAD_LSB                     (SOC_IS_JERICHO(unit)? 61:52)
#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_PAYLOAD_MSB                     (SOC_IS_JERICHO(unit)? 77:67)
#define ARAD_PP_ISEM_ACCESS_ENTRY_REQ_SIZE                            (3)

#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_LSB(bos_key_feature)       (bos_key_feature ? 1:0)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_MSB(bos_key_feature)       (bos_key_feature ? 20:19)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_NOF_BITS(bos_key_feature)  (ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_MSB(bos_key_feature) - ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_LSB(bos_key_feature) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_LSB                   1
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_MSB                   20
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_NOF_BITS              (ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_MSB - ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_LSB + 1) 

#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB                    (0)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_MSB                    (0)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_NOF_BITS               (ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_MSB - ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_LSB               (0)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_MSB               (0)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_NOF_BITS          (ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_MSB - ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_LSB                    (0)
#define ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_MSB                    (15)
#define ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_NOF_BITS               (ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_MSB - ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_LSB                    		  (0)
#define ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_MSB                    		  (3)
#define ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_NOF_BITS               		  (ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_MSB - ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_LSB                    	  (4)
#define ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_MSB                    	  (7)
#define ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_NOF_BITS               	  (ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_MSB - ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_LSB                    		  (0)
#define ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_MSB                    		  (3)
#define ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_NOF_BITS               		  (ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_MSB - ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_LSB(bos_key_feature)         (bos_key_feature ? 21:20)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_MSB(bos_key_feature)         (bos_key_feature ? 32:31)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_NOF_BITS(bos_key_feature)    (ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_MSB(bos_key_feature) - ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_LSB(bos_key_feature) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_LSB(bos_key_feature)   (bos_key_feature ? 33:32)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_MSB(bos_key_feature)   (bos_key_feature ? 33:32)
#define ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_NOF_BITS(bos_key_feature)(ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_MSB(bos_key_feature) - ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_LSB(bos_key_feature) + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_LSB                  (12)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_MSB                  (31)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_NOF_BITS             (ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_MSB - ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_LSB                  (44)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_MSB                  (63)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_NOF_BITS             (ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_MSB - ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_LSB              (40)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_MSB              (40)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_NOF_BITS         (ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_MSB - ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_VID_MASK_BIT_START          (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_VID_MASK_BIT_END            (11)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_TTL_MASK_BIT_START   (32)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_TTL_MASK_BIT_END     (39)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_MASK_BIT_START   (40)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_MASK_BIT_END     (40)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_EXP_MASK_BIT_START   (41)
#define ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_EXP_MASK_BIT_END     (43)


#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_LSB            (0)
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_MSB            (SOC_IS_JERICHO(unit) ? (8):(7))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_NOF_BITS       (ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_LSB       (SOC_IS_JERICHO(unit)? (9) :(8))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_MSB       (SOC_IS_JERICHO(unit)? (10) :(9))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_NOF_BITS  (ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_LSB              (SOC_IS_JERICHO(unit)? (11) :(10))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_MSB              (SOC_IS_JERICHO(unit)? (22) :(21))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_NOF_BITS         (ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_LSB              (SOC_IS_JERICHO(unit)? (23) :(22))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_MSB              (SOC_IS_JERICHO(unit)? (34) :(33))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_NOF_BITS         (ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_LSB              (SOC_IS_JERICHO(unit)? (23) :(22))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_MSB              (SOC_IS_JERICHO(unit)? (23) :(22))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_NOF_BITS         (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_LSB               (SOC_IS_JERICHO(unit)? (24):(23))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_MSB               (SOC_IS_JERICHO(unit)? (26):(25))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_NOF_BITS         (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_VLAN_DOMAIN_LSB        (12)
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_VLAN_DOMAIN_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_LSB    (SOC_IS_JERICHO(unit)? (21):(20))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_MSB    (SOC_IS_JERICHO(unit)? (22): (21))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_NOF_BITS  (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_LSB          (0)
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_MSB          (11)
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_LSB          (SOC_IS_JERICHO(unit) ? (23) : (22))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_MSB          (SOC_IS_JERICHO(unit) ? (34) : (33))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_LSB          (SOC_IS_JERICHO(unit) ? (35) : (34))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_MSB          (SOC_IS_JERICHO(unit) ? (35) : (34))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_LSB          (SOC_IS_JERICHO(unit) ? (36) : (35))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_MSB          (SOC_IS_JERICHO(unit) ? (38) : (37))
#define ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_MSB - ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB                     (0)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_MSB                     (31)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS                (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VT_LOOKUP_FOUND_LSB (0)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VT_LOOKUP_FOUND_MSB (0)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VT_LOOKUP_FOUND_NOF_BITS (1)


#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_NOF_BITS(unit) ((SOC_DPP_CONFIG(unit))->pp.vxlan_tunnel_term_in_sem_my_vtep_index_nof_bits)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_LSB (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VT_LOOKUP_FOUND_MSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_MSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_LSB + ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_NOF_BITS(unit) - 1)


#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_NOF_BITS (32)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_LSB(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_MSB(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_LSB(unit) + ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_NOF_BITS - 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_NOF_BITS(unit) ((SOC_DPP_CONFIG(unit))->pp.vxlan_tunnel_term_in_sem_vrf_nof_bits)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_LSB(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_MSB (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_LSB(unit) + ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_NOF_BITS(unit) - 1)


#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_LSB                (12)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MSB                (43)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_NOF_BITS           (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_LSB                (44)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MSB                (75)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_NOF_BITS           (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_LSB      (76)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MSB      (83)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_LSB      (84)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_MSB      (87)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_LSB           (88)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_MSB           (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_LSB + 7)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_NOF_BITS      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_LSB           (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_MSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_MSB           (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_LSB + 7)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_NOF_BITS      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_LSB      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_MSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_MSB      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_LSB + 8)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_LSB      (0)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MSB      (31)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_LSB      (32)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MSB      (63)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_LSB            (64)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_LSB + SOC_DPP_DEFS_GET(unit, vrf_nof_bits) - 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_NOF_BITS(unit) (SOC_DPP_DEFS_GET(unit, vrf_nof_bits))

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_LSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_LSB(unit))
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_LSB(unit)    (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MSB(unit)    (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_LSB(unit) + 7)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MSB(unit) \
                                                                                     - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_LSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_LSB(unit) + 15)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MSB(unit) \
                                                                                       - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_LSB(unit) + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_LSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MSB(unit) + 3 + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_LSB(unit))
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_LSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_MSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_LSB(unit) + 3)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_MSB(unit) \
                                                                                       - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_LSB(unit) + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_LSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_LSB(unit) + 5)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_LSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_LSB(unit) + 5)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_LSB(unit) + 1) 

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_LSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_LSB(unit) + 3)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_LSB(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_LSB(unit))
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_LSB(unit)    (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_MSB(unit)    (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_LSB(unit) + 3)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_MSB(unit) \
                                                                                          - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_LSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_MSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_LSB(unit) + 4)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_MSB(unit) \
                                                                                            - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_LSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_MSB(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_LSB(unit))
#define ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_MSB(unit)  \
                                                                                            - ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_LSB(unit) + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_LSB                   (24)
#define ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_MSB                   (29)
#define ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_NOF_BITS              (ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_MSB - ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB                          (0)
#define ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_MSB                          (23)
#define ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_NOF_BITS                     (ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_MSB - ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_LSB                  (24)
#define ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_MSB                  (43)
#define ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_NOF_BITS             (ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_MSB - ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TEST1_ISID_MSB                        (15)
#define ARAD_PP_ISEM_ACCESS_KEY_TEST1_ISID_NOF_BITS                   (ARAD_PP_ISEM_ACCESS_KEY_TEST1_ISID_MSB - ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_LSB                   (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_MSB                   (15)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_NOF_BITS              (ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_MSB - ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_LSB      (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_MSB      (14)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_LSB      (15)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_MSB      (22)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_LSB             (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_MSB             (15)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_LSB                   (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_MSB                   (SOC_IS_JERICHO(unit)? 8 : 7)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_NOF_BITS              (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_MSB - ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_LSB        (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_LSB + ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_NOF_BITS)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_MSB        (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_LSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_MSB - ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_LSB        (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_LSB + ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_NOF_BITS)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_MSB        (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_LSB + 11)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_LSB        (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_LSB + ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_NOF_BITS)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_MSB        (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_LSB + 11)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_LSB        (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_MSB        (11)
#define ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_LSB + 1)




#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_LSB             (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_MSB             (23)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_LSB             (24)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_MSB             (27)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_VAL             (2)


#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_LSB             (28)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_MSB             (35)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_LSB(unit)                  (0)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MSB(unit)                  (127)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_NOF_BITS(unit)             (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_LSB(unit)                  (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MSB(unit)                  (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MSB(unit) + (SOC_DPP_CONFIG(unit))->pp.ip6_tunnel_term_in_tcam_vrf_nof_bits)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_NOF_BITS(unit)             ((SOC_DPP_CONFIG(unit))->pp.ip6_tunnel_term_in_tcam_vrf_nof_bits)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_LSB(unit)           (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_MSB(unit)           (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_LSB(unit) + 2)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_MSB(unit) \
                                                                                            - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_LSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_ERROR_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_MSB(unit)      (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_LSB(unit) + 0)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_MSB(unit) \
                                                                                            - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_LSB(unit)          (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_MSB(unit)          (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_LSB(unit) + 2)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_NOF_BITS(unit)     (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_MSB(unit) \
                                                                                            - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_LSB(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_OPTION_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_MSB(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_LSB(unit) + 3)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_NOF_BITS(unit)   (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_MSB(unit) \
                                                                                            - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_LSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_LSB(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_MSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MSB(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_LSB(unit) + 3)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_NOF_BITS(unit)   (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MSB(unit) \
                                                                                           - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_LSB(unit)             (160)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_MSB(unit)             (167)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_NOF_BITS(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_MSB(unit) \
                                                                                           - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_LSB(unit)             (168)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_MSB(unit)             (171)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_NOF_BITS(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_MSB(unit) \
                                                                                           - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_LSB(unit)       (172)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_MSB(unit)       (172)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_NOF_BITS(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_MSB(unit) \
                                                                                           - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_LSB(unit) + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_LSB(unit)                  (12)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_MSB(unit)                  (139)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_NOF_BITS(unit)             (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_LSB(unit)          (140)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_MSB(unit)          (147)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_NOF_BITS(unit)     (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_MSB(unit) \
                                                                                                - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_LSB(unit)        (151)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_MSB(unit)        (154)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_NOF_BITS(unit)   (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_MSB(unit) \
                                                                                                - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_LSB(unit) + 1)
    

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_LSB(unit)                  (0)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MSB(unit)                  (127)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_NOF_BITS(unit)             (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_LSB(unit)                  (128)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MSB(unit)                  (141)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_NOF_BITS(unit)             (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_LSB(unit)      (142)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_MSB(unit)      (142)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_NOF_BITS(unit) (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_MSB(unit) \
                                                                                                - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_LSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_LSB(unit)            (143)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_MSB(unit)            (148)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_NOF_BITS(unit)       (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_MSB(unit) \
                                                                                                - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_LSB(unit) + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_LSB(unit)        (149)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MSB(unit)        (152)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_NOF_BITS(unit)   (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MSB(unit) \
                                                                                                - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_LSB(unit) + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_LSB(unit)             (160)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_MSB(unit)             (167)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_NOF_BITS(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_LSB(unit)             (168)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_MSB(unit)             (171)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_NOF_BITS(unit)        (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_LSB(unit)       (172)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_MSB(unit)       (172)
#define ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_NOF_BITS(unit)  (ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_MSB(unit) \
                                                                                                    - ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_LSB(unit) + 1)





#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB               (0)
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_MSB(unit)         (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 5 : (SOC_IS_JERICHO(unit) ? 3 : 2))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS(unit)    (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB + 1)
                
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_LSB(unit)              (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit)? 6 : (SOC_IS_JERICHO(unit) ? 4 : 3))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_MSB(unit)              (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 21: (SOC_IS_JERICHO(unit) ? 14: 13))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS(unit)         (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 22: (SOC_IS_JERICHO(unit) ? 15 : 14))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 33: (SOC_IS_JERICHO(unit) ? 26 : 25))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 34 : (SOC_IS_JERICHO(unit) ? 27 : 26))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 45 : (SOC_IS_JERICHO(unit) ? 38 : 37))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_LSB               (0)
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_MSB(unit)         (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 5: (SOC_IS_JERICHO(unit) ? 3 : 2))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_NOF_BITS(unit)    (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_LSB + 1)
   
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_LSB(unit)              (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 6 : (SOC_IS_JERICHO(unit) ? 4 : 3))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_MSB(unit)              (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 21 : (SOC_IS_JERICHO(unit) ? 14 : 13))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_NOF_BITS(unit)         (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_LSB(unit) + 1)
      
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 22 : (SOC_IS_JERICHO(unit) ? 15 : 14))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 37 : (SOC_IS_JERICHO(unit) ? 30 : 29))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_LSB(unit) + 1)
  
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 38 : (SOC_IS_JERICHO(unit) ? 31 : 30))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 49 : (SOC_IS_JERICHO(unit) ? 42 : 41))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_LSB(unit) + 1)
  
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 50 : (SOC_IS_JERICHO(unit) ? 43 : 42))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 50 : (SOC_IS_JERICHO(unit) ? 43 : 42))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_LSB(unit) + 1)
  
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 51 : (SOC_IS_JERICHO(unit) ? 44 : 43))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 53 : (SOC_IS_JERICHO(unit) ? 46 : 45))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_LSB(unit) + 1)
  
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_LSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 54 : (SOC_IS_JERICHO(unit) ? 47 : 46))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_MSB(unit)           (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit) ? 65 : (SOC_IS_JERICHO(unit) ? 58 : 57))
#define ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_LSB(unit) + 1)   




#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB               (0)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_MSB(unit)         ( SOC_IS_JERICHO(unit) ? 8 : 7)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_NOF_BITS(unit)    (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit)            (SOC_IS_JERICHO(unit) ? 9 : 8)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_MSB(unit)            (SOC_IS_JERICHO(unit) ? 24 : 23)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit)           (SOC_IS_JERICHO(unit) ? 25 : 24)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_MSB(unit)           (SOC_IS_JERICHO(unit) ? 36 : 35)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_LSB(unit) + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_LSB(unit)           (SOC_IS_JERICHO(unit) ? 37 : 36)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_MSB(unit)           (SOC_IS_JERICHO(unit) ? 48 : 47)
#define ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_NOF_BITS(unit)      (ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_MSB(unit) - ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_LSB(unit) + 1)   




#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB               (0)
#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_MSB               (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB + 6)
#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS          (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_MSB - ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_LSB                    (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB + ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS)
#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_MSB                    (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_LSB + 15)
#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS               (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_MSB - ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_LSB                 (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_LSB + ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS)
#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_MSB                 (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_LSB + 11)
#define ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS            (ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_LSB (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_MSB (31)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_LSB (32)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_MSB (39)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_LSB (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_MSB (127)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_LSB (128)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_MSB (134)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_SET_LSB (40)
#define ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_SET_MSB (47)
#define ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_NOF_BITS (ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_SET_MSB - ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_SET_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_LSB             (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_MSB             (23)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_LSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_LSB             (24)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_MSB             (27)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_LSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_VAL             (2)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_LSB             (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_MSB             (23)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_LSB + 1)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_LSB              (24)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_MSB              (31)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_NOF_BITS         (ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_LSB             (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_MSB             (7)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_LSB             (8)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_MSB             (20)
#define ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_NOF_BITS        (ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_MSB - ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_LSB                 (0)
#define ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_MSB                 (31)
#define ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_NOF_BITS            (ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_LSB                 (0)
#define ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_MSB                 (27)
#define ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_NOF_BITS            (ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_MSB - ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_LSB                 (28)
#define ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_MSB                 (36)
#define ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_NOF_BITS            (ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_MSB - ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_LSB          (0)
#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_MSB          (11)
#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_LSB         (SOC_IS_JERICHO(unit)? (13):(12))
#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_MSB         (SOC_IS_JERICHO(unit)? (20):(19))
#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_MSB - ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_LSB           (SOC_IS_JERICHO(unit)? (21):(20))
#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_MSB           (SOC_IS_JERICHO(unit)? (32):(31))
#define ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_LSB + 1)


#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_LSB         (0)
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_MSB        (SOC_IS_JERICHO(unit)? (8):(7))
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_NOF_BITS   (ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_MSB - ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_LSB + 1)

#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB          (SOC_IS_JERICHO(unit)? (9):(8))
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_MSB          (SOC_IS_JERICHO(unit)? (20):(19))
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB + 1)                             
                               
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_LSB          (SOC_IS_JERICHO(unit)? (21):(20))
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_MSB          (SOC_IS_JERICHO(unit)? (32):(31))
#define ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_NOF_BITS     (ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_MSB - ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_LSB + 1)



#define ARAD_PP_ISEM_ACCESS_KEY_2BITS_INITIAL_VID (0)
#define ARAD_PP_ISEM_ACCESS_KEY_2BITS_OUTER_VID   (2)
#define ARAD_PP_ISEM_ACCESS_KEY_2BITS_DOUBLE_TAG  (3)


#define ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_LSB       (161)
#define ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_MSB       (166)
#define ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_NOF_BITS  (ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_MSB - ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_LSB + 1)







#define ARAD_PP_FS_INST_OFFSET_SELECT_OFF   0
#define ARAD_PP_FS_INST_OFFSET_SELECT_SIZE  3
#define ARAD_PP_FS_INST_OFFSET_SELECT_MASK  0x3
#define ARAD_PP_FS_INST_INPUT_SELECT_OFF    (ARAD_PP_FS_INST_OFFSET_SELECT_OFF + ARAD_PP_FS_INST_OFFSET_SELECT_SIZE)
#define ARAD_PP_FS_INST_INPUT_SELECT_SIZE   1
#define ARAD_PP_FS_INST_INPUT_SELECT_MASK   0x1
#define ARAD_PP_16B_FS_INST_SHIFT_OFF       (ARAD_PP_FS_INST_INPUT_SELECT_OFF + ARAD_PP_FS_INST_INPUT_SELECT_SIZE)
#define ARAD_PP_16B_FS_INST_SHIFT_SIZE      8
#define ARAD_PP_16B_FS_INST_SHIFT_MASK      0xff
#define ARAD_PP_32B_FS_INST_SHIFT_OFF       (ARAD_PP_FS_INST_INPUT_SELECT_OFF + ARAD_PP_FS_INST_INPUT_SELECT_SIZE)
#define ARAD_PP_32B_FS_INST_SHIFT_SIZE      7
#define ARAD_PP_32B_FS_INST_SHIFT_MASK      0x7f
#define ARAD_PP_16B_FS_INST_SIZE_OFF        (ARAD_PP_16B_FS_INST_SHIFT_OFF + ARAD_PP_16B_FS_INST_SHIFT_SIZE)
#define ARAD_PP_16B_FS_INST_SIZE_SIZE       4
#define ARAD_PP_16B_FS_INST_SIZE_MASK       0xf
#define ARAD_PP_32B_FS_INST_SIZE_OFF        (ARAD_PP_32B_FS_INST_SHIFT_OFF + ARAD_PP_32B_FS_INST_SHIFT_SIZE)
#define ARAD_PP_32B_FS_INST_SIZE_SIZE       5
#define ARAD_PP_32B_FS_INST_SIZE_MASK       0x1f



#define ARAD_PP_ISEM_ACCESS_32B_INST_X_ZEROS(X) ((SOC_IS_JERICHO(unit)? 0x0088: 0x0088) | ((X-1) << 11))
#define ARAD_PP_ISEM_ACCESS_32B_INST_X_ONES(X)  ((SOC_IS_JERICHO(unit)? 0x0048: 0x0048) | ((X-1) << 11))

#define ARAD_PP_ISEM_ACCESS_16B_INST_PP_TT_PORT_KEY_VAR                                                          (0xf448)
#define ARAD_PP_ISEM_ACCESS_16B_INST_PP_TT_PORT_KEY_VAR_X_LSBS(X)                                                (0x448 | ((X-1) << 12))
 
#define ARAD_PP_ISEM_ACCESS_16B_INST_X_ZEROS(X) ((SOC_IS_JERICHO(unit)? 0x0148: 0x0148) | ((X-1) << 12))
#define ARAD_PP_ISEM_ACCESS_16B_INST_X_ONES(X)  ((SOC_IS_JERICHO(unit)? 0x00C8: 0x00C8) | ((X-1) << 12))
#define ARAD_PP_ISEM_ACCESS_32B_INST_32_ONES    (ARAD_PP_ISEM_ACCESS_32B_INST_X_ONES(32))
#define ARAD_PP_ISEM_ACCESS_32B_INST_2_ONES     (ARAD_PP_ISEM_ACCESS_32B_INST_X_ONES(2))
#define ARAD_PP_ISEM_ACCESS_32B_INST_1_ONES     (ARAD_PP_ISEM_ACCESS_32B_INST_X_ONES(1))
#define ARAD_PP_ISEM_ACCESS_32B_INST_2_ZEROS    (ARAD_PP_ISEM_ACCESS_32B_INST_X_ZEROS(2))
#define ARAD_PP_ISEM_ACCESS_32B_INST_1_ZEROS    (ARAD_PP_ISEM_ACCESS_32B_INST_X_ZEROS(1))
#define ARAD_PP_ISEM_ACCESS_16B_INST_2_ONES     (ARAD_PP_ISEM_ACCESS_16B_INST_X_ONES(2))
#define ARAD_PP_ISEM_ACCESS_16B_INST_1_ONES     (ARAD_PP_ISEM_ACCESS_16B_INST_X_ONES(1))
#define ARAD_PP_ISEM_ACCESS_16B_INST_2_ZEROS    (ARAD_PP_ISEM_ACCESS_16B_INST_X_ZEROS(2)) 
#define ARAD_PP_ISEM_ACCESS_16B_INST_1_ZEROS    (ARAD_PP_ISEM_ACCESS_16B_INST_X_ZEROS(1))



#define ARAD_PP_16B_INST_OFFSET_0_ENH_MPLS_KEY0    0x66
#define ARAD_PP_32B_INST_OFFSET_0_ENH_MPLS_KEY0    0x31


#define ARAD_PP_16B_INST_MPLS(mpls_lbl, offset, num_of_bits) \
	                            ((((num_of_bits-1) & ARAD_PP_16B_FS_INST_SIZE_MASK ) << ARAD_PP_16B_FS_INST_SIZE_OFF) | \
	                            ((((ARAD_PP_16B_INST_OFFSET_0_ENH_MPLS_KEY0 + ((mpls_lbl-1) * 12)) - offset/4) & ARAD_PP_16B_FS_INST_SHIFT_MASK) << ARAD_PP_16B_FS_INST_SHIFT_OFF) | \
	                               ( 1 << ARAD_PP_FS_INST_INPUT_SELECT_OFF) | \
	                               ( 0 << ARAD_PP_FS_INST_OFFSET_SELECT_OFF))

#define ARAD_PP_32B_INST_MPLS(mpls_lbl, offset, num_of_bits) \
	                            ((((num_of_bits-1) & ARAD_PP_32B_FS_INST_SIZE_MASK ) << ARAD_PP_32B_FS_INST_SIZE_OFF) | \
	                            ((((ARAD_PP_32B_INST_OFFSET_0_ENH_MPLS_KEY0 + ((mpls_lbl-1) * 6)) - offset/8) & ARAD_PP_32B_FS_INST_SHIFT_MASK) << ARAD_PP_32B_FS_INST_SHIFT_OFF) | \
	                               ( 1 << ARAD_PP_FS_INST_INPUT_SELECT_OFF) | \
	                               ( 0 << ARAD_PP_FS_INST_OFFSET_SELECT_OFF))

#define ARAD_PP_ISEM_ACCESS_16B_INST_INITIAL_VSI_12_BIT           (SOC_IS_JERICHO_PLUS(unit) ? 0xbae8 : (SOC_IS_JERICHO(unit)?(0xb9E8) : (0xb5e8)))

#define ARAD_PP_MPLS_1_19_16   (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(1,16,4): (ARAD_PP_CE_MPLS_1_19_16))
#define ARAD_PP_MPLS_1_15_0    (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(1,0,16): (ARAD_PP_CE_MPLS_1_15_0))
#define ARAD_PP_MPLS_2_19_16   (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(2,16,4): (ARAD_PP_CE_MPLS_2_19_16))
#define ARAD_PP_MPLS_2_15_0    (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(2,0,16): (ARAD_PP_CE_MPLS_2_15_0))
#define ARAD_PP_MPLS_3_19_16   (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(3,16,4): (ARAD_PP_CE_MPLS_3_19_16))
#define ARAD_PP_MPLS_3_15_0    (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(3,0,16): (ARAD_PP_CE_MPLS_3_15_0))
#define ARAD_PP_MPLS_4_19_16   (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(4,16,4): (ARAD_PP_CE_MPLS_4_19_16))
#define ARAD_PP_MPLS_4_15_0    (SOC_IS_JERICHO(unit)? ARAD_PP_16B_INST_MPLS(4,0,16): (ARAD_PP_CE_MPLS_4_15_0))

#define ARAD_PP_MPLS_1_31_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(1,0,32): (ARAD_PP_CE_MPLS_1_31_0))
#define ARAD_PP_MPLS_2_31_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(2,0,32): (ARAD_PP_CE_MPLS_2_31_0))
#define ARAD_PP_MPLS_3_31_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(3,0,32): (ARAD_PP_CE_MPLS_3_31_0))
#define ARAD_PP_MPLS_4_31_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(4,0,32): (ARAD_PP_CE_MPLS_4_31_0))
#define ARAD_PP_MPLS_1_19_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(1,0,20): (ARAD_PP_CE_MPLS_1_19_0))
#define ARAD_PP_MPLS_2_19_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(2,0,20): (ARAD_PP_CE_MPLS_2_19_0))
#define ARAD_PP_MPLS_3_19_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(3,0,20): (ARAD_PP_CE_MPLS_3_19_0))
#define ARAD_PP_MPLS_4_19_0    (SOC_IS_JERICHO(unit)? ARAD_PP_32B_INST_MPLS(4,0,20): (ARAD_PP_CE_MPLS_4_19_0))





#define  ARAD_PP_ISEM_ACCESS_VT_PROFILE_PON_ANY_MASK   (0x3)
#define  ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX_NOF_BITS (0x2)


#define ARAD_PP_ISEM_ACCESS_PON_ETHERTYPE_PRIO    (1)
#define ARAD_PP_ISEM_ACCESS_PON_OUTER_DEI_PRIO    (1)
#define ARAD_PP_ISEM_ACCESS_PON_OUTER_PCP_PRIO    (10)
#define ARAD_PP_ISEM_ACCESS_PON_OUTER_VID_PRIO    (50)
#define ARAD_PP_ISEM_ACCESS_PON_INNER_VID_PRIO    (50)
#define ARAD_PP_ISEM_ACCESS_PON_TUNNEL_ID_PRIO    (50)
#define ARAD_PP_ISEM_ACCESS_PON_VD_PRIO           (50)






          




typedef enum
{
  ARAD_PP_ISEM_ACCESS_ACTION_TYPE_DELETE = 0,
  ARAD_PP_ISEM_ACCESS_ACTION_TYPE_INSERT = 1,
  ARAD_PP_ISEM_ACCESS_ACTION_TYPE_DEFRAG = 4
}ARAD_PP_ISEM_ACCESS_ACTION_TYPE;


#define SET_VT_PROGRAM_ID(unit, program_name) \
  { \
    if (last_vt_program_id > (SOC_DPP_DEFS_GET(unit, nof_vtt_programs) -1)) \
    { \
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR, 8100, exit); \
    } \
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.set((unit), (program_name), (last_vt_program_id)); \
    SOC_SAND_CHECK_FUNC_RESULT(res, (program_name), exit); \
    last_vt_program_id++; \
  }

#define SET_TT_PROGRAM_ID(program_name) \
  { \
    if (last_tt_program_id > (SOC_DPP_DEFS_GET(unit, nof_vtt_programs)-1)) \
    { \
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR, 8110, exit); \
    } \
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.set((unit), (program_name), (last_tt_program_id)); \
    SOC_SAND_CHECK_FUNC_RESULT(res, (program_name), exit); \
    last_tt_program_id++; \
  }

#define SET_VT_PROGRAM_SELECTION(prog_idx) \
  { \
    prog_idx++; \
    if (prog_idx > (SOC_DPP_DEFS_GET(unit, nof_vtt_program_selection_lines)-1)) \
    { \
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR, 8120, exit); \
    } \
  }

#define SET_VT_2_PROGRAM_SELECTION(prog_idx) \
  { \
    prog_idx++; \
    if (prog_idx+1 > (SOC_DPP_DEFS_GET(unit, nof_vtt_program_selection_lines)-1)) \
    { \
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR, 8130, exit); \
    } \
  }


#define SET_TT_PROGRAM_SELECTION(prog_idx) \
  { \
    prog_idx++; \
    if (prog_idx > (SOC_DPP_DEFS_GET(unit, nof_vtt_program_selection_lines)-1)) \
    { \
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR, 8140, exit); \
    } \
  }


#define ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(valid_prog) \
  ((valid_prog != -1) ? (tmp+1):tmp)
   

CONST STATIC SOC_PROCEDURE_DESC_ELEMENT
  Arad_pp_procedure_desc_element_isem_access[] =
{
  
  SOC_PROCEDURE_DESC_ELEMENT_DEF(ARAD_PP_ISEM_ACCESS_GET_PROCS_PTR),
  SOC_PROCEDURE_DESC_ELEMENT_DEF(ARAD_PP_ISEM_ACCESS_GET_ERRS_PTR),
  

  
  SOC_PROCEDURE_DESC_ELEMENT_DEF_LAST
};

CONST STATIC SOC_ERROR_DESC_ELEMENT
  Arad_pp_error_desc_element_isem_access[] =
{
  
  

  {
    ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR,
    "ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR",
    "Unknown key type. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_NOT_READY_ERR,
    "ARAD_PP_ISEM_ACCESS_NOT_READY_ERR",
    "Sem is not ready. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_MPLS_IN_RIF_NOT_SUPPORTED_ERR,
    "ARAD_PP_ISEM_ACCESS_MPLS_IN_RIF_NOT_SUPPORTED_ERR",
    "MPLS_IN_RIF entries are not supported when working in mpls core mode. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_LABEL_INDEX_OUT_OF_RANGE_ERR,
    "ARAD_PP_ISEM_ACCESS_LABEL_INDEX_OUT_OF_RANGE_ERR",
    "label_index is out of range. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_LABEL_INDEX_NOT_SUPPORTED_ERR,
    "ARAD_PP_ISEM_ACCESS_LABEL_INDEX_NOT_SUPPORTED_ERR",
    "label_index is not supported when working in mpls labels share mode. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_PROG_SEL_INCORRECT_DEF_ALLOCATION_ERR,
    "ARAD_PP_ISEM_ACCESS_PROG_SEL_INCORRECT_DEF_ALLOCATION_ERR",
    "default allocation of program selection excess nof entries. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_PROG_SEL_USR_INDEX_OUT_OF_RANGE_ERR,
    "ARAD_PP_ISEM_ACCESS_PROG_SEL_USR_INDEX_OUT_OF_RANGE_ERR",
    "user define entry index excess nof entries. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_PROG_SEL_INVALID_LIF_KEY_RANGE_ERR,
    "ARAD_PP_ISEM_ACCESS_PROG_SEL_INVALID_LIF_KEY_RANGE_ERR",
    "invalid convertion lif key from , to program selection. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_AC_KEY_SET_NOT_SUPPORTED_ERR,
    "ARAD_PP_ISEM_ACCESS_AC_KEY_SET_NOT_SUPPORTED_ERR",
    "ac map key is not supported when working in simple vlan translation mode. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR,
    "ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR",
    "Illegal configuration of vlan translation programs in vtt: inmatch soc properties. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR,
    "ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR",
    "Trying to add entry in TCAM when key type is not supported for TCAM. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },
  {
    ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR,
    "ARAD_PP_ISEM_ACCESS_PROGRAMS_FULL_ERR",
    "Number of allocated VT, TT programs is over the possible number of programs. \n\r ",
    SOC_SAND_SVR_ERR,
    FALSE
  },

  
SOC_ERR_DESC_ELEMENT_DEF_LAST
};





ARAD_PP_ISEM_ACCESS_PROGRAMS_SOC_PROPERTIES g_prog_soc_prop[BCM_MAX_NUM_UNITS] = {{0}};
int                                         is_g_prog_soc_prop_initilized[BCM_MAX_NUM_UNITS] = {0};   

extern ARAD_PP_DBAL_VTT_PROGRAM_INFO           vt_dbal_programs[ARAD_PP_DBAL_VT_NOF_PROGRAMS];
extern ARAD_PP_DBAL_VT_PROGRAM_SELECTION_INFO  vt_dbal_program_selection[ARAD_PP_DBAL_VT_NOF_PROGRAM_SELECTION];
extern ARAD_PP_DBAL_VTT_PROGRAM_INFO           tt_dbal_programs[ARAD_PP_DBAL_TT_NOF_PROGRAMS];
extern ARAD_PP_DBAL_TT_PROGRAM_SELECTION_INFO  tt_dbal_program_selection[ARAD_PP_DBAL_TT_NOF_PROGRAM_SELECTION];










STATIC
uint32
   arad_pp_vtt_prog_sel_cam_key_program_1st_vt_vd_double_lookup_initialvid_set(
     int unit,     
     int prog_indx,
     int prog_sel
   )
{
  uint32
    res;  
  ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_1st_cam_tbl;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  ARAD_CLEAR(&prog_selection_1st_cam_tbl, ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1);

  
  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_get_unsafe(unit, prog_indx, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  
  
  prog_selection_1st_cam_tbl.packet_format_qualifier_1       = ARAD_PP_ISEM_ACCESS_QLFR_ETH_NULL;  
  prog_selection_1st_cam_tbl.packet_format_qualifier_1_mask  = (ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_NXT_PROTOCOL | ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_ENCAP | ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_OUTER_TPID | ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_OUTER_PCP | ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_INNER_TPID);
  prog_selection_1st_cam_tbl.packet_format_code              = ARAD_PARSER_PFC_ETH;  
  prog_selection_1st_cam_tbl.packet_format_code_mask         = ARAD_PARSER_PFC_MATCH_TYPE;
  prog_selection_1st_cam_tbl.in_pp_port_vt_profile         = (SOC_PPC_PORT_DEFINED_VT_PROFILE_DOUBLE_TAG_PRIORITY);  
  prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask    = (ARAD_PP_ISEM_ACCESS_VT_PROFILE_MASK_INITIAL_VID); 
                                                                      
  prog_selection_1st_cam_tbl.llvp_prog_sel                 = prog_sel;
  prog_selection_1st_cam_tbl.valid                         = (0x1);

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_set_unsafe(unit, prog_indx, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

exit:
 SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_vtt_prog_sel_cam_key_program_1st_vt_vd_double_lookup_initialvid_set", prog_indx, prog_sel);
}


STATIC
uint32
   arad_pp_vtt_prog_sel_cam_key_program_1st_vt_vd_outer_set(
     int unit,
     uint32 prog_indx0, 
     uint32 prog_indx1, 
     uint32 port_profile,
     uint32 prog_sel
   )
{
  uint32
    res;  
  ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_1st_cam_tbl;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  ARAD_CLEAR(&prog_selection_1st_cam_tbl, ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1);

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_get_unsafe(unit, prog_indx0, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  
  
  prog_selection_1st_cam_tbl.packet_format_qualifier_1     = (ARAD_PP_ISEM_ACCESS_QLFR_ETH_OUTER_TPID1);
  prog_selection_1st_cam_tbl.packet_format_qualifier_1_mask = (ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_NXT_PROTOCOL | ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_ENCAP);
  prog_selection_1st_cam_tbl.packet_format_code           = ARAD_PARSER_PFC_ETH;
  prog_selection_1st_cam_tbl.packet_format_code_mask      = ARAD_PARSER_PFC_MATCH_TYPE;

  if (port_profile == SOC_PPC_NOF_PORT_DEFINED_VT_PROFILES) 
  {
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile         = (0x0);  
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask    = (ARAD_PP_ISEM_ACCESS_VT_PROFILE_MASK_EXCEPT_INITIAL_VID);
  } 
  else 
  {
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile         = (port_profile);  
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask    = (0x0);
  }

  
  prog_selection_1st_cam_tbl.llvp_prog_sel                   = prog_sel;
  prog_selection_1st_cam_tbl.valid                     = (0x1);

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_set_unsafe(unit, prog_indx0, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_get_unsafe(unit, prog_indx1, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  
  
  prog_selection_1st_cam_tbl.packet_format_qualifier_1     = (ARAD_PP_ISEM_ACCESS_QLFR_ETH_OUTER_TPID2);
  prog_selection_1st_cam_tbl.packet_format_qualifier_1_mask = (ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_NXT_PROTOCOL | ARAD_PP_ISEM_ACCESS_QLFR_ETH_MASK_ENCAP);
  prog_selection_1st_cam_tbl.packet_format_code           = ARAD_PARSER_PFC_ETH;
  prog_selection_1st_cam_tbl.packet_format_code_mask      = ARAD_PARSER_PFC_MATCH_TYPE;
  if (port_profile == SOC_PPC_NOF_PORT_DEFINED_VT_PROFILES) 
  {
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile         = (0x0);  
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask    = (ARAD_PP_ISEM_ACCESS_VT_PROFILE_MASK_EXCEPT_INITIAL_VID);
  } 
  else 
  {
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile         = (port_profile);  
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask    = (0x0);
  }
  prog_selection_1st_cam_tbl.llvp_prog_sel                   = prog_sel;
  prog_selection_1st_cam_tbl.valid                     = (0x1);

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_set_unsafe(unit, prog_indx1, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

exit:
 SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_vtt_prog_sel_cam_key_program_1st_vt_vd_outer_set", prog_indx0, prog_sel);
}



STATIC
uint32
  arad_pp_vtt_prog_sel_cam_key_program_1st_set(
    int unit,
    ARAD_PP_ISEM_ACCESS_PROGRAMS_SOC_PROPERTIES *prog_soc_prop
  )
{
    uint32 res, prog_indx = 0;
    int prog_used;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    
    if(prog_soc_prop->custom_feature_vt_tst2)
    {
        ARAD_DO_NOTHING_AND_EXIT;
    }

    if (SOC_DPP_PP_ENABLE(unit)) {
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_TM_PROG, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_TM_PROG, exit);
    } else {
        
        prog_used = PROG_VT_TM_PROG;
    }
    if (prog_used != -1)
    {
        if (SOC_IS_ARADPLUS_A0(unit) && SOC_DPP_CONFIG(unit)->pp.oam_statistics)
        {
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_TM_STAT].priority[unit]  = prog_indx;
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_TM_STAT].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_TM_STAT;
        }
        else
        {
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_TM].priority[unit]  = prog_indx;
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_TM].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_TM;
        }
    }
    
    if (SOC_DPP_CONFIG(unit)->arad->init.pp_enable == FALSE)
    {
        ARAD_DO_NOTHING_AND_EXIT;
    }
    if (SOC_DPP_CONFIG_CUSTOM_PP_PORT_IS_VENDOR2()) {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_CUSTOM_PP_PORT_TUNNEL].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_CUSTOM_PP_PORT_TUNNEL].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VT_CUSTOM_PP_PORT_TUNNEL;
        prog_indx++;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_TAG_1_M3_PLUS_ELI].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_TAG_1_M3_PLUS_ELI].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL;
        prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_UNTAGGED_M3_PLUS_ELI].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_UNTAGGED_M3_PLUS_ELI].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL;
        prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_3MTSE_PLUS_FRR_OUTERVID_L2_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_3MTSE_PLUS_FRR_OUTERVID_L2_L1, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_TAG_1_M2_PLUS].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_TAG_1_M2_PLUS].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L1;
        prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_3MTSE_PLUS_FRR_INITIALVID_L2_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_3MTSE_PLUS_FRR_INITIALVID_L2_L1, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_UNTAGGED_M2_PLUS].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_UNTAGGED_M2_PLUS].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L1;
        prog_indx++;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_2MTSE_PLUS_FRR_VDxOUTERVID_FRR, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_2MTSE_PLUS_FRR_VDxOUTERVID_FRR, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxOUTERVID_FRR;
        prog_indx++;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_2MTSE_PLUS_FRR_VDxINITIALVID_FRR, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_2MTSE_PLUS_FRR_VDxINITIALVID_FRR, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxINITIALVID_FRR;
        prog_indx++;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_2MTSE_PLUS_FRR_DOUBLE_TAG_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_2MTSE_PLUS_FRR_DOUBLE_TAG_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR;
        prog_indx++;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_2MTSE_PLUS_FRR_DOUBLE_TAG_PCP_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_2MTSE_PLUS_FRR_DOUBLE_TAG_PCP_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR;
        prog_indx++;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER, exit);
    if ((prog_used != -1)  && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID_OR_OUTER_VID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID_OR_OUTER_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_OR_OUTER_VID_L1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER, exit);
    if ((prog_used != -1)  && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID, exit);
    if ((prog_used != -1)  && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
         SET_VT_2_PROGRAM_SELECTION(prog_indx);
         vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_PRIORITY_INITIAL_VID].priority[unit]  = prog_indx;
         vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_PRIORITY_INITIAL_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_PRIORITY_INITIAL_VID;
         prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_DOUBLE_TAG_INITIAL_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_DOUBLE_TAG_INITIAL_VID, exit);
    if ((prog_used != -1)  && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
         SET_VT_2_PROGRAM_SELECTION(prog_indx);
         vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_INITIAL_VID].priority[unit]  = prog_indx;
         vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_INITIAL_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_INITIAL_VID;
         prog_indx++; 
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxOUTERVID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxOUTERVID, exit);
    if ((prog_used != -1) && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_TAG_1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_TAG_1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTERVID;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxINITIALVID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxINITIALVID, exit);
    if ((prog_used != -1) && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_UNTAGGED].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_3MTSE_PLUS_FRR_UNTAGGED].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxINITIALVID;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER, exit);
    if ((prog_used != -1) && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_L1;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_TEST2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_TEST2, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_TEST2].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_TEST2].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VT_TEST2;
        prog_indx++;
    }
    
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_PON_UNTAGGED, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_PON_UNTAGGED, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_UNTAGGED].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_UNTAGGED].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_UNTAGGED;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_PRIORITY_TAG].priority[unit]  = (prog_indx+1);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_PRIORITY_TAG].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_UNTAGGED;
        prog_indx++;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_PON_ONE_TAG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_PON_ONE_TAG, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_ONE_TAG_1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_ONE_TAG_1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_ONE_TAG;

        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_ONE_TAG_2].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_ONE_TAG_2].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_ONE_TAG;
    }
    
    {
        
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_PON_TWO_TAGS, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_PON_TWO_TAGS, exit);
        if (prog_used != -1)
        {
            SET_VT_PROGRAM_SELECTION(prog_indx);
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_TWO_TAGS].priority[unit]  = prog_indx;
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_TWO_TAGS].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_TWO_TAGS;
        }
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_PON_TWO_TAGS_VS_TUNNEL_ID, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_PON_TWO_TAGS_VS_TUNNEL_ID, exit);
        if (prog_used != -1)
        {
            SET_VT_PROGRAM_SELECTION(prog_indx);
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_TWO_TAGS_VS_TUNNEL_ID].priority[unit]  = prog_indx;
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_TWO_TAGS_VS_TUNNEL_ID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_TWO_TAGS_VS_TUNNEL_ID;
        }
    }
    if (!soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gpon_application_enable", 0)) {
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_PON_ONE_TAG, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_PON_ONE_TAG, exit);
        if (prog_used != -1)
        {
            SET_VT_PROGRAM_SELECTION(prog_indx);
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_IGNORE_2ND_TAG].priority[unit]  = prog_indx;
            vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_PON_IGNORE_2ND_TAG].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_PON_ONE_TAG;
        }
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_MPLS_PORT_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_MPLS_PORT_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_MPLS_PORT_L1].priority[unit] = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_MPLS_PORT_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_MPLS_PORT_L1;
    }
    
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_SECTION_OAM_ONE_TAG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_SECTION_OAM_ONE_TAG, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SECTION_OAM_ONE_TAG_1].priority[unit]= prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SECTION_OAM_ONE_TAG_1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_SECTION_OAM_ONE_TAG;
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SECTION_OAM_ONE_TAG_2].priority[unit]= prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SECTION_OAM_ONE_TAG_2].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_SECTION_OAM_ONE_TAG;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_SECTION_OAM_TWO_TAGS, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_SECTION_OAM_TWO_TAGS, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SECTION_OAM_DOUBLE_TAGS].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SECTION_OAM_DOUBLE_TAGS].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_SECTION_OAM_TWO_TAGS;
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTERVID_L1FRR, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTERVID_L1FRR, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1FRR].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1FRR].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_OUTERVID_L1FRR;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_OUTERVID_FRR_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_OUTERVID_FRR_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_INDX_VD_OUTERVID_FRR_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_INDX_VD_OUTERVID_FRR_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDX_VD_OUTERVID_FRR_L1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_L1FRR, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_L1FRR, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1FRR].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1FRR].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_INITIALVID_L1FRR;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_INITIALVID_FRR_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_INITIALVID_FRR_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_INDX_VD_INITIALVID_FRR_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_INDX_VD_INITIALVID_FRR_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDX_VD_INITIALVID_FRR_L1;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_EVB_S_TAG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_EVB_S_TAG, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EVB_S_TAG].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EVB_S_TAG].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_EVB_S_TAG;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_EVB_UN_C_TAG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_EVB_UN_C_TAG, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EVB_UN_C_TAG].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EVB_UN_C_TAG].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_EVB_UN_C_TAG;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_EXTENDER_PE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_EXTENDER_PE, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EXTENDER_PE].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EXTENDER_PE].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_EXTENDER_PE;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_EXTENDER_PE_UT, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_EXTENDER_PE_UT, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EXTENDER_PE_UT].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_EXTENDER_PE_UT].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_EXTENDER_PE_UT;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_SINGLE_TAG_5_IP_TUPLE_Q_IN_Q, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_SINGLE_TAG_5_IP_TUPLE_Q_IN_Q, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SINGLE_TAG_5_TUPLE_QINQ].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_SINGLE_TAG_5_TUPLE_QINQ].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_SINGLE_TAG_5_TUPPLE_QINQ;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_DOUBLE_TAG_5_IP_TUPLE_Q_IN_Q, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_DOUBLE_TAG_5_IP_TUPLE_Q_IN_Q, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_5_TUPLE_QINQ].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_5_TUPLE_QINQ].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_5_TUPPLE_QINQ;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_DESIGNATED_VID_TRILL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_DESIGNATED_VID_TRILL, exit);
    if (prog_soc_prop->trill_mode &&
        (prog_used != -1))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_DESIGNATED_VID_TRILL].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_DESIGNATED_VID_TRILL].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_DESIGNATED_VID_TRILL;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_TRILL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_TRILL, exit);
    if (prog_soc_prop->trill_mode &&
        (prog_used != -1))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_TRILL].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_TRILL].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_TRILL;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_TRILL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_TRILL, exit);
    if (prog_soc_prop->trill_mode &&
        (prog_used != -1))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_TRILL].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_TRILL].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_TRILL;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER_TRILL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER_TRILL, exit);
    if (prog_soc_prop->trill_mode &&
        (prog_used != -1))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID_TRILL].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID_TRILL].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_TRILL;
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_GENERALIZED_RCH0, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_GENERALIZED_RCH0, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_GENERALIZED_RCH0].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_GENERALIZED_RCH0].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_GENERALIZED_RCH0;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_GENERALIZED_RCH1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_GENERALIZED_RCH1, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_GENERALIZED_RCH1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_GENERALIZED_RCH1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_GENERALIZED_RCH1;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID_OR_OUTER_VID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID_OR_OUTER_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_OR_OUTER_VID_L1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_PRIORITY_INITIAL_VID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_PRIORITY_INITIAL_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_PRIORITY_INITIAL_VID;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_DOUBLE_TAG_INITIAL_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_DOUBLE_TAG_INITIAL_VID, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_INITIAL_VID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_INITIAL_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_INITIAL_VID;
        prog_indx++; 
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_TRILL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_TRILL, exit);
    if (prog_soc_prop->mpls_1_database == ARAD_PP_ISEM_ACCESS_ID_ISEM_B &&
        (prog_used != -1))
    {
        
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        res = arad_pp_vtt_prog_sel_cam_key_program_1st_vt_vd_outer_set(unit,prog_indx,prog_indx+1,
                                                                       SOC_PPC_PORT_DEFINED_VT_PROFILE_DOUBLE_TAG_PRIORITY,
                                                                       prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_TRILL, exit);
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_TRILL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_TRILL, exit);
    if (prog_soc_prop->mpls_1_database == ARAD_PP_ISEM_ACCESS_ID_ISEM_B &&
        (prog_used != -1))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        res = arad_pp_vtt_prog_sel_cam_key_program_1st_vt_vd_double_lookup_initialvid_set(unit,prog_indx, prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_TRILL, exit);
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_OR_VD_OUTER_PCP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_OR_VD_OUTER_PCP, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_OR_VD_OUTER_PCP].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_OR_VD_OUTER_PCP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_OUTER_OR_VD_OUTER_PCP;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxINITIALVID_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxINITIALVID_L1, exit);
    if ((prog_soc_prop->port_vlan_pcp_lookup && (prog_used != -1)) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_L1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP, exit);
    if ((prog_used != -1) && ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP;
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_OR_VD_OUTER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_OR_VD_OUTER, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_OR_VD_OUTER].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_OR_VD_OUTER].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_OUTER_OR_VD_OUTER;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_OR_VD_INITIALVID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_OR_VD_INITIALVID, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_OR_VD_INITIALVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_OR_VD_INITIALVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_INITIALVID_OR_VD_INITIALVID;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_OR_VD_OUTER_INNER].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_OR_VD_OUTER_INNER].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_OUTER_INNER_OR_VD_OUTER_INNER;
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV4_OUTER_VID_AFTER_RECYCLE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV4_OUTER_VID_AFTER_RECYCLE, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxOUTERVID_AFTER_RCY].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxOUTERVID_AFTER_RCY].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV4_VDxOUTERVID_AFTER_RCY;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV4_INITIAL_VID_AFTER_RECYCLE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV4_INITIAL_VID_AFTER_RECYCLE, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxINITIALVID_AFTER_RCY].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxINITIALVID_AFTER_RCY].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV4_VDxINITIALVID_AFTER_RCY;
        prog_indx++; 
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV4_PORT, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV4_PORT, exit);
    if (prog_used != -1) {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_PORT_TERMINATION].priority[unit] = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_PORT_TERMINATION].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV4_PORT;
    }
    


  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_VRRP, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_VRRP, exit);
  if (SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam && prog_used != -1)
  {
    SET_VT_PROGRAM_SELECTION(prog_indx);
    vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_VRRP].priority[unit]  = prog_indx;
    vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_VRRP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_UNTAGGED_VRRP;
  }

  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_DOUBLE_TAG_VRRP, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_DOUBLE_TAG_VRRP, exit);
  if (SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam && prog_used != -1)
  {
    SET_VT_2_PROGRAM_SELECTION(prog_indx);
    vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_VRRP].priority[unit]  = prog_indx;
    vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_VRRP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_VRRP;
    prog_indx++; 
  }

  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_SINGLE_TAG_VRRP, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_SINGLE_TAG_VRRP, exit);
  if (SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam && prog_used != -1)
  {
    SET_VT_PROGRAM_SELECTION(prog_indx);
    vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_VRRP].priority[unit]  = prog_indx;
    vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_VRRP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_ONE_TAG_VRRP;
  }


  
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV4_OUTER_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV4_OUTER_VID, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxOUTERVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxOUTERVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV4_VDxOUTERVID;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV4_INITIAL_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV4_INITIAL_VID, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxINITIALVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV4_VDxINITIALVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV4_VDxINITIALVID;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV6_OUTER_VID_AFTER_RECYCLE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV6_OUTER_VID_AFTER_RECYCLE, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxOUTERVID_AFTER_RECYCLE].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxOUTERVID_AFTER_RECYCLE].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV6_VDxOUTERVID_AFTER_RECYCLE;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV6_INITIAL_VID_AFTER_RECYCLE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV6_INITIAL_VID_AFTER_RECYCLE, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxINITIALVID_AFTER_RECYCLE].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxINITIALVID_AFTER_RECYCLE].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV6_VDxINITIALVID_AFTER_RECYCLE;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV6_OUTER_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV6_OUTER_VID, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxOUTERVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxOUTERVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV6_VDxOUTERVID;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_IPV6_INITIAL_VID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_IPV6_INITIAL_VID, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxINITIALVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_IPV6_VDxINITIALVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_IPV6_VDxINITIALVID;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxOUTERVID_L1_L2ELI, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxOUTERVID_L1_L2ELI, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1_L2ELI].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1_L2ELI].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_L1_L2ELI;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxINITIALVID_L1_L2ELI, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxINITIALVID_L1_L2ELI, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1_L2ELI].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1_L2ELI].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_L1_L2ELI;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_OUTERVID_L3, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_OUTERVID_L3, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxOUTERVID_L3].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxOUTERVID_L3].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDEXED_VDxOUTERVID_L3;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_INITIALVID_L3, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_INITIALVID_L3, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxINITIALVID_L3].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxINITIALVID_L3].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDEXED_VDxINITIALVID_L3;
        prog_indx++; 
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxOUTERVID_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxOUTERVID_L1, exit);
    
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_L1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxINITIALVID_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxINITIALVID_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_L1;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_MPLS4_OUTERVID_L1L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_MPLS4_OUTERVID_L1L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxOUTERVID_MPLS4_L1L2].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxOUTERVID_MPLS4_L1L2].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDEXED_VDxOUTERVID_MPLS4_L1L2;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_MPLS4_INITIALVID_L1L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_MPLS4_INITIALVID_L1L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxINITIALVID_MPLS4_L1L2].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxINITIALVID_MPLS4_L1L2].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDEXED_VDxINITIALVID_MPLS4_L1L2;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_OUTERVID_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_OUTERVID_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxOUTERVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxOUTERVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDEXED_VDxOUTERVID_L1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_INITIALVID_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_INITIALVID_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxINITIALVID_L1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INDEXED_VDxINITIALVID_L1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_INDEXED_VDxINITIALVID_L1;
        prog_indx++; 
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxOUTERVID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxOUTERVID, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTERVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTERVID;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxINITIALVID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxINITIALVID, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_INITIALVID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxINITIALVID;
        prog_indx++; 
    }
    
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP;
    }
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_VD_OUTER_INNER_VID].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_L1;
    }
    
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_EXPLICIT_NULL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_EXPLICIT_NULL, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_EXP_NULL_TST1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_EXP_NULL_TST1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_UNTAGGED_EXP_NULL_TST1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_VRRP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_VRRP, exit);
    if (!(SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam) && prog_soc_prop->custom_feature_vrrp_scaling_tcam && prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_VRRP].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_VRRP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_UNTAGGED_VRRP;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_TST1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_UNTAGGED_TST1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_UNTAGGED_TST1;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_DOUBLE_TAG_EXPLICIT_NULL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_DOUBLE_TAG_EXPLICIT_NULL, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_EXP_NULL_TST1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_EXP_NULL_TST1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_EXP_NULL_TST1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_DOUBLE_TAG_VRRP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_DOUBLE_TAG_VRRP, exit);
    if (!(SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam) && prog_soc_prop->custom_feature_vrrp_scaling_tcam && prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_VRRP].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_VRRP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_VRRP;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_DOUBLE_TAG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_DOUBLE_TAG, exit);
    if (prog_used != -1)
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_TST1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_DOUBLE_TAG_TST1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_TST1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_SINGLE_TAG_EXPLICIT_NULL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_SINGLE_TAG_EXPLICIT_NULL, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_VT_2_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_EXP_NULL_TST1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_EXP_NULL_TST1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_ONE_TAG_EXP_NULL_TST1;
        prog_indx++; 
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_SINGLE_TAG_VRRP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_SINGLE_TAG_VRRP, exit);
    if (!(SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam) && prog_soc_prop->custom_feature_vrrp_scaling_tcam && prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_VRRP].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_VRRP].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_ONE_TAG_VRRP;
    }
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_SINGLE_TAG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_SINGLE_TAG, exit);
    if (prog_used != -1)
    {
        SET_VT_PROGRAM_SELECTION(prog_indx);
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_TST1].priority[unit]  = prog_indx;
        vt_dbal_program_selection[ARAD_PP_DBAL_VT_PROG_SELECTION_ONE_TAG_TST1].prog_name[unit] = ARAD_PP_DBAL_VT_PROG_ONE_TAG_TST1;
    }
    

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_vtt_prog_sel_cam_key_program_1st_set()", prog_indx, 0);
}

STATIC
uint32
   arad_pp_vtt_prog_sel_cam_key_program_2nd_tt_ip_router_compatiblemc_2nd_prog_set(
     int unit,
     uint32 prog_indx, 
     uint32 prog_sel,
     uint32 ipv4_comp_mc_disable,
	 uint32 is_bridging_program
   )
{
  uint32
    res;
  ARAD_PP_IHP_VTT2ND_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_2nd_cam_tbl;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  ARAD_CLEAR(&prog_selection_2nd_cam_tbl, ARAD_PP_IHP_VTT2ND_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1);

  
  res = arad_pp_ihp_isem_2nd_program_selection_cam_tbl_get_unsafe(unit, prog_indx, &prog_selection_2nd_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  prog_selection_2nd_cam_tbl.enable_routing_mask              = 1;
  prog_selection_2nd_cam_tbl.packet_format_code               = ARAD_PARSER_PFC_IPV6_ETH;
  if(ipv4_comp_mc_disable)
      prog_selection_2nd_cam_tbl.packet_format_code_mask      = ARAD_PARSER_PFC_MATCH_ANY_ENCAP_ANY_TYPE;        
  else
      prog_selection_2nd_cam_tbl.packet_format_code_mask      = ARAD_PARSER_PFC_MATCH_ANY_ENCAP_ANY_TYPE_ANY_IP; 
  prog_selection_2nd_cam_tbl.packet_is_compatible_mc          = 0x1;
  prog_selection_2nd_cam_tbl.packet_is_compatible_mc_mask     = 0x0;
  prog_selection_2nd_cam_tbl.llvp_prog_sel                    = prog_sel;
  if (is_bridging_program) {
      prog_selection_2nd_cam_tbl.ptc_tt_profile          = ARAD_PORTS_TT_PROFILE_FORCE_BRIDGE_FWD; 
      prog_selection_2nd_cam_tbl.ptc_tt_profile_mask     = 0x00;
  }
  prog_selection_2nd_cam_tbl.valid                            = 0x1;
  
  res = arad_pp_ihp_isem_2nd_program_selection_cam_tbl_set_unsafe(unit, prog_indx, &prog_selection_2nd_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

exit:
 SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_vtt_prog_sel_cam_key_program_2nd_tt_ip_router_compatiblemc_2nd_prog_set", prog_indx, prog_sel);
}

static int ipmc_second_pass_caused_by_rpf_fail(int unit){
    int result = 0;
    int port_ndx=0;

    for(port_ndx=0; port_ndx< ARAD_PORT_NOF_PP_PORTS ; port_ndx++ ) {
        if (soc_property_port_suffix_num_get(unit, port_ndx, -1,spn_CUSTOM_FEATURE,"rpf_failing_recycle_enable", FALSE)==1) {
            result = 1;
        }
    }
    return result;
}

STATIC
uint32
  arad_pp_isem_prog_sel_cam_key_program_2nd(
    int unit,
    ARAD_PP_ISEM_ACCESS_PROGRAMS_SOC_PROPERTIES *prog_soc_prop
  )
{
    uint32 prog_indx = 0;
    uint32 res;
    int prog_used;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if (SOC_DPP_PP_ENABLE(unit)) {
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_TM_PROG, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_TM_PROG, exit);
    } else {
        
        prog_used = PROG_TT_TM_PROG;
    }
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TM].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_TM;
    }

    
    if (SOC_DPP_CONFIG(unit)->arad->init.pp_enable == FALSE) {
        ARAD_DO_NOTHING_AND_EXIT;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L2TP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L2TP, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_L2TP].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_L2TP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_L2TP;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_BFD_STAT_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_BFD_STAT_PROG, exit);
    if (prog_used != -1)
    {
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BFD_STAT].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BFD_STAT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BFD_STAT;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_OAM_STAT_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_OAM_STAT_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_OAM_STAT].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_OAM_STAT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_OAM_STAT;
    }

    
    if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 20 ||
        SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 21)
    {
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M1].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M1].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M2_HIT_SEM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M2_HIT_SEM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L2_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L2_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M2_MISS_SEM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M2_MISS_SEM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M2].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_IML_SEM_HIT].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_IML_SEM_HIT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L2_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_IML_SEM_MISS].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_IML_SEM_MISS].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1;
        }


        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1_L1;
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_ELI].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_HIT_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_TFL_L3_L3;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L3_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L3_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_MISS_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_HIT_SEM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_HIT_SEM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L2_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L2_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_MISS_SEM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_MISS_SEM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_HIT_SEM_AND_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_HIT_SEM_AND_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L2_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L2_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_HIT_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L3_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L3_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_MISS_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L2_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L2_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_MISS_SEM_AND_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_MISS_SEM_AND_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L1_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_GAL].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_GAL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L3_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_HIT_SEM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_HIT_SEM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L2_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L2_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_MISS_SEM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_MISS_SEM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_GAL_HIT_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_GAL_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_TFL_L3_L3;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L3_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L3_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_GAL_MISS_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_GAL_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_TFL_L4_L3, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_TFL_L4_L3, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_HIT_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_TFL_L4_L3;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L3_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L3_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_MISS_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_HIT_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_TFL_L3_L3;
        }

        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_3MTSE_PLUS_FRR_L3_L1, &prog_used);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_3MTSE_PLUS_FRR_L3_L1, exit);
        if (prog_used != -1)
        {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_MISS_TCAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_3MTSE_PLUS_FRR_M3_PLUS_ELI_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1;
        }
    }

    
    if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 22 ||
        SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 23)
        {
            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_L1_L1, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_L1_L1, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M1].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M1].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L1_L1;
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R1_ELI].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R1_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L1_L1;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M2_HIT_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M2_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L2;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_L2_L1, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_L2_L1, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M2_MISS_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M2_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R3_GAL_HIT_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R3_GAL_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L2;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_L2_L1, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_L2_L1, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R3_GAL_MISS_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R3_GAL_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1;
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_R2_IML].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_R2_IML].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_L1_L1, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_L1_L1, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M2].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L1_L1;
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_ELI].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L1_L1;	    	        SET_TT_PROGRAM_SELECTION(prog_indx);
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_ELI_GAL].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_ELI_GAL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L1_L1;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_ELI_HIT_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_ELI_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L2;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_L2_L1, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_L2_L1, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_ELI_MISS_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_ELI_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1;
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R2_ELI].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_R2_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_TFL_L3_L2, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_TFL_L3_L2, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_HIT_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_HIT_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L3_L2;
            }

            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_2MTSE_PLUS_FRR_L2_L1, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_2MTSE_PLUS_FRR_L2_L1, exit);
            if (prog_used != -1)
            {
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_MISS_TCAM].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_2MTSE_PLUS_FRR_M3_PLUS_NO_RANGE_MISS_TCAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1;
            }
        }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_MPLS_PORT_L3_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_MPLS_PORT_L3_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS_PORT_L3_L2].priority[unit] = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS_PORT_L3_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_MPLS_PORT_L3_L2;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_GENERALIZED_RCH_MPLS_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_GENERALIZED_RCH_MPLS_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_GENERALIZED_RCH_MPLS].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_GENERALIZED_RCH_MPLS].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_GENERALIZED_RCH_MPLS;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_EXTENDER_UNTAG_CHECK_IP_MC, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_EXTENDER_UNTAG_CHECK_IP_MC, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_UNTAG_CHECK_IP_MC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_UNTAG_CHECK_IP_MC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_EXTENDER_UNTAG_CHECK_IP_MC;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_EXTENDER_IP_MC_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_EXTENDER_IP_MC_PROG, exit);
    if (SOC_IS_JERICHO(unit) && (prog_used != -1))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_CB_IP_MC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_CB_IP_MC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_EXTENDER_CB_IP_MC;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_EXTENDER_UNTAG_CHECK_IP_UC, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_EXTENDER_UNTAG_CHECK_IP_UC, exit);
    if (SOC_IS_JERICHO(unit) && (prog_used != -1))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_UNTAG_CHECK_IP_UC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_UNTAG_CHECK_IP_UC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_EXTENDER_UNTAG_CHECK_IP_UC;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_EXTENDER_IP_UC_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_EXTENDER_IP_UC_PROG, exit);
    if (SOC_IS_JERICHO(unit) && (prog_used != -1))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_CB_IP_UC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_CB_IP_UC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_EXTENDER_CB_IP_UC;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_EXTENDER_UNTAG_CHECK, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_EXTENDER_UNTAG_CHECK, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_UNTAG_CHECK].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_UNTAG_CHECK].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_EXTENDER_UNTAG_CHECK;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_EXTENDER_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_EXTENDER_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_CB].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_EXTENDER_CB].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_EXTENDER_CB;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IP_DISABLE_FOR_EXPLICIT_NULL_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IP_DISABLE_FOR_EXPLICIT_NULL_PROG, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IP_DISABLE_ON_LIF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IP_DISABLE_ON_LIF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IP_DISABLE_ON_LIF;
        prog_indx += 3;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_DISABLE_FOR_EXPLICIT_NULL_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_DISABLE_FOR_EXPLICIT_NULL_PROG, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_DISABLE_ON_LIF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_DISABLE_ON_LIF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_DISABLE_ON_LIF;
        prog_indx += 3;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV6_DISABLE_FOR_EXPLICIT_NULL_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV6_DISABLE_FOR_EXPLICIT_NULL_PROG, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_DISABLE_ON_LIF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_DISABLE_ON_LIF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV6_DISABLE_ON_LIF;
        prog_indx +=3;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_FOR_EXPLICIT_NULL_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_FOR_EXPLICIT_NULL_PROG, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_FOR_EXPLICIT_NULL].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_FOR_EXPLICIT_NULL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_FOR_EXPLICIT_NULL;
        prog_indx++; 
        prog_indx++; 
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_VLAN_DOMAIN_MPLS_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_VLAN_DOMAIN_MPLS_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_VLAN_DOMAIN_MPLS_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_VLAN_DOMAIN_MPLS_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_VLAN_DOMAIN_MPLS_L2;

        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
        prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_TUNNEL_FOR_TWO_EXPLICIT_NULL_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_TUNNEL_FOR_TWO_EXPLICIT_NULL_PROG, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TUNNEL_FOR_TWO_EXPLICIT_NULL].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TUNNEL_FOR_TWO_EXPLICIT_NULL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_TUNNEL_TWO_EXPLICIT_NULL;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_MLDP_AFTER_RECYCLE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_MLDP_AFTER_RECYCLE, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_MLDP_OVERLAY_AFTER_RCY].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_MLDP_OVERLAY_AFTER_RCY].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MLDP_OVERLAY_AFTER_RCY;
        prog_indx++; 
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_MPLS4_L3_L4, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_MPLS4_L3_L4, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS4_L3_L4].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS4_L3_L4].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_MPLS4_L3_L4;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_MPLS4_NOP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_MPLS4_NOP, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS4_NOP].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS4_NOP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_MPLS4_NOP;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L3, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L3, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNINDEXED_MPLS_L3].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNINDEXED_MPLS_L3].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MPLS_L3;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;
            
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L3_L4, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L3_L4, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS_L3_L4].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS_L3_L4].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L3_L4;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;
            
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2ELI_INRIF, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2ELI_INRIF, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2ELI_INRIF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2ELI_INRIF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2ELI_INRIF;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
              prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L2_L3ELI, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L2_L3ELI, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNINDEXED_MPLS_L2_L3_ELI].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNINDEXED_MPLS_L2_L3_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MPLS_L2_L3_ELI;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2_L3ELI_INRIF, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2_L3ELI_INRIF, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2_L3ELI_INRIF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2_L3ELI_INRIF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2_L3ELI_INRIF;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L2_L3ELI, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L2_L3ELI, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_L3_ELI].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_L3_ELI].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L2_L3_ELI;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNINDEXED_MPLS_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNINDEXED_MPLS_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MPLS_L2;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2_INRIF, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2_INRIF, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2_INRIF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2_INRIF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2_INRIF;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L1].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L1].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L1;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L1_GAL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L1_GAL, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L1_GAL].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L1_GAL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L1_GAL;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2_GAL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2_GAL, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2_GAL].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2_GAL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2_GAL;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L2_L3_GAL, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L2_L3_GAL, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_L3_GAL].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_L3_GAL].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L2_L3_GAL;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_GAL_ONLY, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_GAL_ONLY, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_GAL_ONLY].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_GAL_ONLY].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_GAL_ONLY;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L2_GAL_ONLY, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L2_GAL_ONLY, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_GAL_ONLY].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_GAL_ONLY].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L2_GAL_ONLY;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L3_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L3_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS_L3_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_MPLS_L3_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L3_L2;

        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
            prog_indx++;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L2_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L2_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L2_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L2_L2;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEXED_L1_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_AS_ORDER_L2_L3, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_AS_ORDER_L2_L3, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L2_L3].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L2_L3].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L2_L3;
        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
            prog_indx++;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_AS_ORDER_L2_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_AS_ORDER_L2_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L2_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L2_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L2_L2;
        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
            prog_indx++;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_AS_ORDER_L1_L2, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_AS_ORDER_L1_L2, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L1_L2].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L1_L2].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L1_L2;
        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
            prog_indx++;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_AS_ORDER_L1_L1, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_AS_ORDER_L1_L1, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L1_L1].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_L1_L1].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L1_L1;
        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
            prog_indx++;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_AS_ORDER_NOP, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_AS_ORDER_NOP, exit);
    if ((prog_used != -1) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
        (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_NOP].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_INDEX_AS_ORDER_NOP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_NOP;
        if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
            prog_indx++;

        if (prog_soc_prop->mpls_tp_mac_address)
            prog_indx++;

        if (prog_soc_prop->port_raw_mpls)
            prog_indx++;
    }

    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV6_ROUTER_2ND_PROG_AFTER_RECYCLE, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV6_ROUTER_2ND_PROG_AFTER_RECYCLE, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER_AFTER_RECYCLE].priority[unit]	= prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER_AFTER_RECYCLE].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER_AFTER_RECYCLE;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER_COMP_DEST_FOUND_AFTER_RECYCLE].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER_COMP_DEST_FOUND_AFTER_RECYCLE].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER_COMP_DEST_FOUND;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG, exit);
    if (SOC_IS_ARADPLUS_AND_BELOW(unit) && (prog_used != -1))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_PWE_GRE_IPMC_RCY].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_PWE_GRE_IPMC_RCY].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_PWE_GRE_DIP_FOUND;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG_IPMC_RCY, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG_IPMC_RCY, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_DIP_FOUND_IPMC_RCY].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_DIP_FOUND_IPMC_RCY].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_DIP_FOUND_IPMC_RCY;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_PORT_VXLAN_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_PORT_VXLAN_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_VXLAN_PORT].priority[unit] = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_VXLAN_PORT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_VXLAN_PORT;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_PORT_L2_GRE_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_PORT_L2_GRE_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_L2_GRE_PORT].priority[unit] = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_L2_GRE_PORT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_L2_GRE_PORT;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_L3_GRE_PORT_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_L3_GRE_PORT_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_L3_GRE_PORT].priority[unit] = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_L3_GRE_PORT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_L3_GRE_PORT;
        prog_indx++; 
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_DIP_SIP_VRF_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_DIP_SIP_VRF_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_UC_DIP_SIP_VRF].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_UC_DIP_SIP_VRF].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_DIP_SIP_VRF;
        prog_indx++; 
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_MAC_IN_MAC_MC_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_MAC_IN_MAC_MC_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_MIM_MC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_MIM_MC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MIM_MC;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_MAC_IN_MAC_WITH_BTAG_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_MAC_IN_MAC_WITH_BTAG_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_MIM_WITH_BTAG].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_MIM_WITH_BTAG].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MIM_WITH_BTAG;
        prog_indx++; 
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_ARP_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_ARP_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_ARP].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_ARP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_ARP;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_PPPOE_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_PPPOE_PROG, exit);
    if (prog_used != -1)
    {
    SET_TT_PROGRAM_SELECTION(prog_indx);
    tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PPPOE].priority[unit]  = prog_indx;
    tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PPPOE].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_PPPOE;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IP_ROUTER_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IP_ROUTER_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER;

        if (SOC_DPP_CONFIG(unit)->pp.rch_port0_in_exists || SOC_DPP_CONFIG(unit)->pp.rch_port1_in_exists) {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_GENERALIZED_RCH_IP].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_GENERALIZED_RCH_IP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER;
        }

        if (prog_soc_prop->custom_feature_vrrp_scaling_tcam || SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam)
            prog_indx++;
    }


    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_BRIDGE_STAR_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_BRIDGE_STAR_2ND_PROG, exit);
    if ((prog_used != -1) && (ipmc_second_pass_caused_by_rpf_fail(unit)|| SOC_DPP_CONFIG(unit)->pp.force_bridge_forwarding))
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        res = arad_pp_vtt_prog_sel_cam_key_program_2nd_tt_ip_router_compatiblemc_2nd_prog_set(unit,prog_indx,prog_used,prog_soc_prop->ipv4mc_bidir_enable,1);
        SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_BRIDGE_STAR_2ND_PROG, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IP_ROUTER_CompatibleMc_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IP_ROUTER_CompatibleMc_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_COMPATIBLE_MC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_COMPATIBLE_MC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_COMPATIBLE_MC;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_MC_DIP_NOT_FOUND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_MC_DIP_NOT_FOUND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_MC_DIP_NOT_FOUND].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_MC_DIP_NOT_FOUND].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_MC_DIP_NOT_FOUND;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_UC_DIP_NOT_FOUND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_UC_DIP_NOT_FOUND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_UC_DIP_NOT_FOUND].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_UC_DIP_NOT_FOUND].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_UC_DIP_NOT_FOUND;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV6_ROUTER_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV6_ROUTER_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER_COMP_DEST_FOUND].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV6_ROUTER_COMP_DEST_FOUND].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER_COMP_DEST_FOUND;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_PWE_GRE_DIP_FOUND].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_PWE_GRE_DIP_FOUND].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_PWE_GRE_DIP_FOUND;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_DIP_FOUND].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_DIP_FOUND].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_DIP_FOUND;

        if (prog_soc_prop->custom_feature_vrrp_scaling_tcam || SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_IP_ROUTER_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_IP_ROUTER_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_TUNNELS].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_IPV4_ROUTER_TUNNELS].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER;

        if (prog_soc_prop->custom_feature_vrrp_scaling_tcam || SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam)
            prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_TRILL_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_TRILL_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TRILL_ONE_TAG].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TRILL_ONE_TAG].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_TRILL_ONE_TAG;
        prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_TRILL_2ND_PROG_TWO_VLANS_AT_NATIVE_ETH, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_TRILL_2ND_PROG_TWO_VLANS_AT_NATIVE_ETH, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TRILL_TWO_TAGS].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TRILL_TWO_TAGS].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_TRILL_TWO_TAGS;
        prog_indx++;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_TRILL_2ND_PROG_TRILL_TRAP_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_TRILL_2ND_PROG_TRILL_TRAP_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TRILL_TRAP].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_TRILL_TRAP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_TRILL_TRAP;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_FC_WITH_VFT_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_FC_WITH_VFT_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_FC_WITH_VFT].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_FC_WITH_VFT].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_FC_WITH_VFT;

        if (soc_property_get(unit, spn_FCOE_NPV_BRIDGE_MODE, 0)) {
            prog_indx++;    
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_FC_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_FC_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_FC].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_FC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_FC;

        if (soc_property_get(unit, spn_FCOE_NPV_BRIDGE_MODE, 0)) {
            prog_indx++;    
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_BRIDGE_STAR_2ND_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_BRIDGE_STAR_2ND_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;

        if(SOC_IS_JERICHO_PLUS(unit)) {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            
            res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_MYMAC_IP_DISABLED_TRAP_PROG, &prog_used);
            SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_MYMAC_IP_DISABLED_TRAP_PROG, exit);
            if (prog_used != -1) {
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR_ROUTE_DISABLE_IP].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR_ROUTE_DISABLE_IP].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_MYMAC_IP_DISABLED_TRAP;
                SET_TT_PROGRAM_SELECTION(prog_indx);
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR_ROUTE_DISABLE].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR_ROUTE_DISABLE].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
            } else {
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR_ROUTE_DISABLE].priority[unit]  = prog_indx;
                tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_STAR_ROUTE_DISABLE].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
            }
        }

        
        if(SOC_IS_JERICHO(unit) && prog_soc_prop->oam_enable){
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_OAM].priority[unit]  = prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_BRIDGE_OAM].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
        }


        
        if (SOC_DPP_CONFIG(unit)->pp.custom_pon_ipmc) {
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IP_BRIDGE_COMPATIBLE_MC].priority[unit]	= prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IP_BRIDGE_COMPATIBLE_MC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IPV4_BRIDGE_UC].priority[unit]	= prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IPV4_BRIDGE_UC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IPV6_BRIDGE_UC].priority[unit]	= prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IPV6_BRIDGE_UC].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
            SET_TT_PROGRAM_SELECTION(prog_indx);
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IPV4_BRIDGE_DIP_FOUND].priority[unit]	= prog_indx;
            tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_PON_IPV4_BRIDGE_DIP_FOUND].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR;
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_DIP6_COMPRESSION_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_DIP6_COMPRESSION_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_DIPV6_COMPRESSED].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_DIPV6_COMPRESSED].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_DIPV6_COMPRESSED;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_UNKNOWN_L3_PROG, &prog_used);
    SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_UNKNOWN_L3_PROG, exit);
    if (prog_used != -1)
    {
        SET_TT_PROGRAM_SELECTION(prog_indx);
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNKNOWN_L3].priority[unit]  = prog_indx;
        tt_dbal_program_selection[ARAD_PP_DBAL_TT_PROG_SELECTION_UNKNOWN_L3].prog_name[unit] = ARAD_PP_DBAL_TT_PROG_TT_UNKNOWN_L3;
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_prog_sel_cam_key_program_2nd()", prog_indx, 0);
}

uint32 arad_pp_isem_prog_programs_init(int unit)
{
  uint32
    i,
    tmp,
	res,
    last_tt_program_id = 0,
    last_vt_program_id = 0;
  int prog_used;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

#define prog_soc_prop g_prog_soc_prop[unit]
  
  for (i = 0; i < PROG_VT_NOF_PROGS; i++) {
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.set(unit, i, -1);
      SOC_SAND_CHECK_FUNC_RESULT(res, i, exit);
  }

  for (i = 0; i < PROG_TT_NOF_PROGS; i++) {
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.set(unit, i, -1);
      SOC_SAND_CHECK_FUNC_RESULT(res, i, exit);
  }

   
  
  if(SOC_DPP_CONFIG(unit)->pp.custom_feature_vt_tst2)
  {
      SET_VT_PROGRAM_ID(unit, PROG_VT_TM_PROG);
      if(SOC_IS_ARADPLUS_A0(unit) && (SOC_DPP_CONFIG(unit)->pp.oam_statistics))
        vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_TM_STAT].prog_used[unit] = (last_vt_program_id - 1);
      else
        vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_TM                       ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_INNER_PCP_1_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_INNER_PCP_1_TST2].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_INNER_PCP_2_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_INNER_PCP_2_TST2].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_PCP_1_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_PCP_1_TST2      ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_PCP_2_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_PCP_2_TST2      ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_INNER_1_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_INNER_1_TST2    ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_INNER_2_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_INNER_2_TST2    ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_1_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_1_TST2          ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_OUTER_2_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_OUTER_2_TST2          ].prog_used[unit] = (last_vt_program_id - 1);

      SET_VT_PROGRAM_ID(unit, PROG_VT_UNTAGGED_TST2);
      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_UNTAGGED_TST2         ].prog_used[unit] = (last_vt_program_id - 1);

      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "EoE_test2_enable", 0)) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_TEST2);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VT_TEST2                 ].prog_used[unit] = (last_vt_program_id - 1);
      }
      

  }
  else
  {
      SET_VT_PROGRAM_ID(unit, PROG_VT_TM_PROG);
      if(!(SOC_IS_ARADPLUS_A0(unit) && (SOC_DPP_CONFIG(unit)->pp.oam_statistics)))
      {
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_TM].prog_used[unit] = (last_vt_program_id - 1);
      }
      
      if(SOC_DPP_CONFIG(unit)->pp.custom_feature_mpls_port_termination_lif_id)
      {
         SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_MPLS_PORT_L1);
         vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_MPLS_PORT_L1].prog_used[unit] = (last_vt_program_id - 1);
      }

      if(SOC_IS_ARADPLUS_A0(unit) && (SOC_DPP_CONFIG(unit)->pp.oam_statistics))
      {
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_TM_STAT].prog_used[unit] = (last_vt_program_id - 1);
      }

      if (SOC_DPP_CONFIG_CUSTOM_PP_PORT_IS_VENDOR2()) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_CUSTOM_PP_PORT_TUNNEL);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VT_CUSTOM_PP_PORT_TUNNEL].prog_used[unit] = (last_vt_program_id - 1);
      }
      
      
      if (!prog_soc_prop.port_vlan_pcp_lookup && !prog_soc_prop.match_port_vlan_critiria_64K && !prog_soc_prop.custom_feature_vt_tst1)
      {
          
          if (SOC_IS_JERICHO(unit))
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_VDxINITIALVID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID].prog_used[unit] = (last_vt_program_id - 1);
              if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
              {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_VDxOUTERVID);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTERVID].prog_used[unit] = (last_vt_program_id - 1);
              }
          }
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_INNER);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_L1].prog_used[unit] = (last_vt_program_id - 1);
          if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_OR_OUTER_VID_L1].prog_used[unit] = (last_vt_program_id - 1);
          }
          if (SOC_DPP_CONFIG(unit)->pp.port_use_initial_vlan_only_enabled)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_PRIORITY_INITIAL_VID].prog_used[unit] = (last_vt_program_id - 1);
          }
          if (SOC_DPP_CONFIG(unit)->pp.port_use_initial_vlan_only_enabled)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_DOUBLE_TAG_INITIAL_VID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_INITIAL_VID].prog_used[unit] = (last_vt_program_id - 1);
          }

          
          if (!prog_soc_prop.trill_mode && prog_soc_prop.mpls_1_database == ARAD_PP_ISEM_ACCESS_ID_ISEM_B)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_TRILL);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_TRILL].prog_used[unit] = (last_vt_program_id - 1);
              if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled) {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_TRILL);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_TRILL].prog_used[unit] = (last_vt_program_id - 1);
              }
          }
      }
      else if ((prog_soc_prop.port_vlan_pcp_lookup) && (!prog_soc_prop.match_port_vlan_critiria_64K))
      {
          
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_OR_VD_OUTER_PCP);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_OUTER_OR_VD_OUTER_PCP].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VDxINITIALVID_L1); 
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_L1].prog_used[unit] = (last_vt_program_id - 1);
          if (SOC_IS_JERICHO(unit))
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_VDxINITIALVID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID].prog_used[unit] = (last_vt_program_id - 1);
          }
      }
      else if ((!prog_soc_prop.port_vlan_pcp_lookup) && (prog_soc_prop.match_port_vlan_critiria_64K))
      {
          
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_OR_VD_INITIALVID);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_INITIALVID_OR_VD_INITIALVID].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_OR_VD_OUTER);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_OUTER_OR_VD_OUTER].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_OUTER_INNER_OR_VD_OUTER_INNER].prog_used[unit] = (last_vt_program_id - 1);
      }
      else if (prog_soc_prop.custom_feature_vt_tst1) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_UNTAGGED_TST1].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_SINGLE_TAG);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_ONE_TAG_TST1].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_DOUBLE_TAG);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_TST1].prog_used[unit] = (last_vt_program_id - 1);
          if (prog_soc_prop.explicit_null_arad_plus_support) {
              SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_EXPLICIT_NULL);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_UNTAGGED_EXP_NULL_TST1].prog_used[unit] = (last_vt_program_id - 1);
              SET_VT_PROGRAM_ID(unit, PROG_VT_VD_SINGLE_TAG_EXPLICIT_NULL);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_ONE_TAG_EXP_NULL_TST1].prog_used[unit] = (last_vt_program_id - 1);
              SET_VT_PROGRAM_ID(unit, PROG_VT_VD_DOUBLE_TAG_EXPLICIT_NULL);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_EXP_NULL_TST1].prog_used[unit] = (last_vt_program_id - 1);
          }
          if (prog_soc_prop.custom_feature_vrrp_scaling_tcam)
          {
            SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_VRRP);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_UNTAGGED_VRRP].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_VD_SINGLE_TAG_VRRP);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_ONE_TAG_VRRP].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_VD_DOUBLE_TAG_VRRP);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_VRRP].prog_used[unit] = (last_vt_program_id - 1);
           }
      }
      else
      {
          
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 60, exit);
      }
      
      if (prog_soc_prop.vrrp_scaling_tcam)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_VRRP);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_UNTAGGED_VRRP].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_SINGLE_TAG_VRRP);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_ONE_TAG_VRRP].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_DOUBLE_TAG_VRRP);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_VRRP].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      
      if ((!prog_soc_prop.port_vlan_pcp_lookup) && (!prog_soc_prop.match_port_vlan_critiria_64K) && (!prog_soc_prop.custom_feature_vt_tst1))
      {
          if (!prog_soc_prop.mpls_use_in_rif)
          {
              if (prog_soc_prop.eli_enable)
              {
                  
                  SET_VT_PROGRAM_ID(unit, PROG_VT_VDxINITIALVID_L1_L2ELI);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_L1_L2ELI].prog_used[unit] = (last_vt_program_id - 1);
                  if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
                  {
                      SET_VT_PROGRAM_ID(unit, PROG_VT_VDxOUTERVID_L1_L2ELI);
                      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_L1_L2ELI].prog_used[unit] = (last_vt_program_id - 1);
                  }
              }
          }
          if (!prog_soc_prop.mpls_index && !prog_soc_prop.mpls_use_in_rif)
          {
              
              SET_VT_PROGRAM_ID(unit, PROG_VT_VDxINITIALVID_L1);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_L1].prog_used[unit] = (last_vt_program_id - 1);
              if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
              {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_VDxOUTERVID_L1);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_L1].prog_used[unit] = (last_vt_program_id - 1);
              }
              if ((prog_soc_prop.fast_reroute_labels_enable) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
            	  (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
              {
                  
                  SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_L1FRR);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_INITIALVID_L1FRR].prog_used[unit] = (last_vt_program_id - 1);
                  if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
                  {
                      SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTERVID_L1FRR);
                      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_OUTERVID_L1FRR].prog_used[unit] = (last_vt_program_id - 1);
                  }
              }
          }
          else if (prog_soc_prop.mpls_index && (!prog_soc_prop.mpls_use_in_rif))
          {
              
              SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_INITIALVID_L1);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDEXED_VDxINITIALVID_L1].prog_used[unit] = (last_vt_program_id - 1);
              if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
              {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_OUTERVID_L1);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDEXED_VDxOUTERVID_L1].prog_used[unit] = (last_vt_program_id - 1);
              }
              if ((prog_soc_prop.fast_reroute_labels_enable) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
            		  (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
              {
                  
                  SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_INITIALVID_FRR_L1);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDX_VD_INITIALVID_FRR_L1].prog_used[unit] = (last_vt_program_id - 1);
                  if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
                  {
                      SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_OUTERVID_FRR_L1);
                      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDX_VD_OUTERVID_FRR_L1].prog_used[unit] = (last_vt_program_id - 1);
                  }
              }
              if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "four_independent_mpls_termination_enable", 0)){
                  SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_MPLS4_INITIALVID_L1L2);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDEXED_VDxINITIALVID_MPLS4_L1L2].prog_used[unit] = (last_vt_program_id - 1);
                  SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_MPLS4_OUTERVID_L1L2);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDEXED_VDxOUTERVID_MPLS4_L1L2].prog_used[unit] = (last_vt_program_id - 1);
              } 
          }
          else
          {
              
              SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_INITIALVID_L3);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDEXED_VDxINITIALVID_L3].prog_used[unit] = (last_vt_program_id - 1);
              if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
              {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_OUTERVID_L3);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDEXED_VDxOUTERVID_L3].prog_used[unit] = (last_vt_program_id - 1);
              }
              if ((prog_soc_prop.fast_reroute_labels_enable) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
            		  (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
              {
                  
                  SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_INITIALVID_FRR_L1);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDX_VD_INITIALVID_FRR_L1].prog_used[unit] = (last_vt_program_id - 1);
                  if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
                  {
                      SET_VT_PROGRAM_ID(unit, PROG_VT_INDX_VD_OUTERVID_FRR_L1);
                      vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_INDX_VD_OUTERVID_FRR_L1].prog_used[unit] = (last_vt_program_id - 1);
                  }
              }
          }
      }

    if (soc_property_get(unit, spn_PWE_TERMINATION_PORT_MODE_ENABLE, 0) ){
	    
	    SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1);
	    vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1].prog_used[unit] = (last_vt_program_id - 1);
    }
      
      if (prog_soc_prop.trill_mode)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_INITIALVID_TRILL);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID_TRILL].prog_used[unit] = (last_vt_program_id - 1);
          if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
          {
              if (!prog_soc_prop.trill_disable_designated_vlan_check && prog_soc_prop.designated_vlan_inlif_enable) {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_VD_DESIGNATED_VID_TRILL);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VD_DESIGNATED_VID_TRILL].prog_used[unit] = (last_vt_program_id - 1);
              }
              SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_TRILL);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTERVID_TRILL].prog_used[unit] = (last_vt_program_id - 1);
          }
          SET_VT_PROGRAM_ID(unit, PROG_VT_VD_OUTER_INNER_TRILL);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTER_INNER_VID_TRILL].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (prog_soc_prop.pon_enable)
      {
          if (!soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gpon_application_enable", 0)) {
              SET_VT_PROGRAM_ID(unit, PROG_VT_PON_TWO_TAGS);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_PON_TWO_TAGS].prog_used[unit] = (last_vt_program_id - 1);
              SET_VT_PROGRAM_ID(unit, PROG_VT_PON_TWO_TAGS_VS_TUNNEL_ID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_PON_TWO_TAGS_VS_TUNNEL_ID].prog_used[unit] = (last_vt_program_id - 1);
          }
          SET_VT_PROGRAM_ID(unit, PROG_VT_PON_UNTAGGED);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_PON_UNTAGGED].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_PON_ONE_TAG);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_PON_ONE_TAG].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (prog_soc_prop.section_oam_enable)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_SECTION_OAM_ONE_TAG);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_SECTION_OAM_ONE_TAG].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_SECTION_OAM_TWO_TAGS);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_SECTION_OAM_TWO_TAGS].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id || 
          SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id_vxlan ||
          SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id_gre) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_IPV4_INITIAL_VID_AFTER_RECYCLE);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV4_VDxINITIALVID_AFTER_RCY].prog_used[unit] = (last_vt_program_id - 1);
          if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_IPV4_OUTER_VID_AFTER_RECYCLE);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV4_VDxOUTERVID_AFTER_RCY].prog_used[unit] = (last_vt_program_id - 1);
          }
      }

      
      if (SOC_DPP_CONFIG(unit)->pp.custom_feature_ip_port_termination_lif_id) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_IPV4_PORT);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV4_PORT].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (prog_soc_prop.ipv4_term_enable) {
          if (!SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam) {
              SET_VT_PROGRAM_ID(unit, PROG_VT_IPV4_INITIAL_VID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV4_VDxINITIALVID].prog_used[unit] = (last_vt_program_id - 1);
              if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
              {
                  SET_VT_PROGRAM_ID(unit, PROG_VT_IPV4_OUTER_VID);
                  vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV4_VDxOUTERVID].prog_used[unit] = (last_vt_program_id - 1);
              }
          }
      }

      
      if (prog_soc_prop.ipv6_term_dip_sip_enable) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_IPV6_INITIAL_VID_AFTER_RECYCLE);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV6_VDxINITIALVID_AFTER_RECYCLE].prog_used[unit] = (last_vt_program_id - 1);
          if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_IPV6_OUTER_VID_AFTER_RECYCLE);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV6_VDxOUTERVID_AFTER_RECYCLE].prog_used[unit] = (last_vt_program_id - 1);
          }
      }  
      
      if (prog_soc_prop.ipv6_term_dip_sip_enable) {
          SET_VT_PROGRAM_ID(unit, PROG_VT_IPV6_INITIAL_VID);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV6_VDxINITIALVID].prog_used[unit] = (last_vt_program_id - 1);
          if (SOC_DPP_CONFIG(unit)->pp.port_use_outer_vlan_and_initial_vlan_enabled)
          {
              SET_VT_PROGRAM_ID(unit, PROG_VT_IPV6_OUTER_VID);
              vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_IPV6_VDxOUTERVID].prog_used[unit] = (last_vt_program_id - 1);
          }
      }      

      
      if (prog_soc_prop.evb_enable)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_EVB_UN_C_TAG);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_EVB_UN_C_TAG].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_EVB_S_TAG);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_EVB_S_TAG].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (prog_soc_prop.extender_cb_enable)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_EXTENDER_PE);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_EXTENDER_PE].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_EXTENDER_PE_UT);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_EXTENDER_PE_UT].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (prog_soc_prop.q_in_q_ip_5_tuple)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_DOUBLE_TAG_5_IP_TUPLE_Q_IN_Q);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_DOUBLE_TAG_5_TUPPLE_QINQ].prog_used[unit] = (last_vt_program_id - 1);
          SET_VT_PROGRAM_ID(unit, PROG_VT_SINGLE_TAG_5_IP_TUPLE_Q_IN_Q);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_SINGLE_TAG_5_TUPPLE_QINQ].prog_used[unit] = (last_vt_program_id - 1);
      }

      if (SOC_DPP_CONFIG(unit)->pp.test2)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_TEST2);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VT_TEST2].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 20 || SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 21)
        {
            SET_VT_PROGRAM_ID(unit, PROG_VT_VDxINITIALVID);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxINITIALVID].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_VDxOUTERVID);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_VDxOUTERVID].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_3MTSE_PLUS_FRR_INITIALVID_L2_L1);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L1].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_3MTSE_PLUS_FRR_OUTERVID_L2_L1);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L1].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL].prog_used[unit] = (last_vt_program_id - 1);
        }
      
      if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 22 || SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 23)
        {
            SET_VT_PROGRAM_ID(unit, PROG_VT_2MTSE_PLUS_FRR_VDxINITIALVID_FRR);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxINITIALVID_FRR].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_2MTSE_PLUS_FRR_VDxOUTERVID_FRR);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxOUTERVID_FRR].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR].prog_used[unit] = (last_vt_program_id - 1);
            SET_VT_PROGRAM_ID(unit, PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR);
            vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR].prog_used[unit] = (last_vt_program_id - 1);

        }


      if (SOC_DPP_CONFIG(unit)->pp.rch_port0_in_exists)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_GENERALIZED_RCH0);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_GENERALIZED_RCH0].prog_used[unit] = (last_vt_program_id - 1);
      }

      if (SOC_DPP_CONFIG(unit)->pp.rch_port1_in_exists)
      {
          SET_VT_PROGRAM_ID(unit, PROG_VT_GENERALIZED_RCH1);
          vt_dbal_programs[ARAD_PP_DBAL_VT_PROG_GENERALIZED_RCH1].prog_used[unit] = (last_vt_program_id - 1);
      }

      
      tmp = 0;
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxINITIALVID_L1, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxINITIALVID_L1, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_OR_VD_INITIALVID, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_OR_VD_INITIALVID, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_INITIALVID_L1, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_INITIALVID_L1, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_INITIALVID_L3, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_INITIALVID_L3, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      if (tmp > 1)
      {
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 300, exit); 
      }

      tmp = 0;
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_DOUBLE_TAG, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_DOUBLE_TAG, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      if (tmp > 1)
      {
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 310, exit); 
      }

      tmp = 0;
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VDxOUTERVID_L1, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VDxOUTERVID_L1, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_OR_VD_OUTER_PCP, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_OR_VD_OUTER_PCP, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTER_OR_VD_OUTER, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTER_OR_VD_OUTER, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_OUTERVID_L1, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_OUTERVID_L1, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_SINGLE_TAG, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_SINGLE_TAG, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      if (tmp > 1)
      {
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 320, exit); 
      }

      tmp = 0;
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_OUTERVID_FRR_L1, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_OUTERVID_FRR_L1, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_OUTERVID_L1FRR, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_OUTERVID_L1FRR, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      if (tmp > 1)
      {
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 330, exit); 
      }

      tmp = 0;
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      if (tmp > 1)
      {
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 320, exit); 
      }

      tmp = 0;
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_VD_INITIALVID_L1FRR, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_VD_INITIALVID_L1FRR, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, PROG_VT_INDX_VD_INITIALVID_FRR_L1, &prog_used);
      SOC_SAND_CHECK_FUNC_RESULT(res, PROG_VT_INDX_VD_INITIALVID_FRR_L1, exit);
      tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
      if (tmp > 1)
      {
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 320, exit); 
      }
  }
  

   

   

  
  SET_TT_PROGRAM_ID(PROG_TT_TM_PROG);
  tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_TM].prog_used[unit] = (last_tt_program_id - 1);
   
  if (SOC_DPP_CONFIG(unit)->pp.custom_feature_mpls_port_termination_lif_id) {
      SET_TT_PROGRAM_ID(PROG_TT_INDX_MPLS_PORT_L3_L2);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_MPLS_PORT_L3_L2].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  if (SOC_IS_ARADPLUS_A0(unit) && SOC_DPP_CONFIG(unit)->pp.oam_statistics){
      SET_TT_PROGRAM_ID(PROG_TT_OAM_STAT_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_OAM_STAT].prog_used[unit] = (last_tt_program_id - 1);
      SET_TT_PROGRAM_ID(PROG_TT_BFD_STAT_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_BFD_STAT].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  SET_TT_PROGRAM_ID(PROG_TT_BRIDGE_STAR_2ND_PROG);
  tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_BRIDGE_STAR].prog_used[unit] = (last_tt_program_id - 1);

  if (SOC_DPP_MYMAC_IP_DISABLED_TRAP_IS_ENABLED(unit)) {
    SET_TT_PROGRAM_ID(PROG_TT_MYMAC_IP_DISABLED_TRAP_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MYMAC_IP_DISABLED_TRAP].prog_used[unit] = (last_tt_program_id - 1);
  }

  if (prog_soc_prop.compression_ip6_enable) {
    SET_TT_PROGRAM_ID(PROG_TT_DIP6_COMPRESSION_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_DIPV6_COMPRESSED].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  
  if ((!prog_soc_prop.port_vlan_pcp_lookup) && (!prog_soc_prop.match_port_vlan_critiria_64K))
  {
    if ((!prog_soc_prop.mpls_index) && (!prog_soc_prop.mpls_use_in_rif)) 
    {
      
      SET_TT_PROGRAM_ID(PROG_TT_L2);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MPLS_L2].prog_used[unit] = (last_tt_program_id - 1);
      if (prog_soc_prop.eli_enable) 
      {      
        SET_TT_PROGRAM_ID(PROG_TT_L2_L3ELI);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MPLS_L2_L3_ELI].prog_used[unit] = (last_tt_program_id - 1);
      }

      if ((prog_soc_prop.fast_reroute_labels_enable) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
    	  (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
      {
        
        SET_TT_PROGRAM_ID(PROG_TT_L3);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MPLS_L3].prog_used[unit] = (last_tt_program_id - 1);
      }
    }
    else if (prog_soc_prop.mpls_index && prog_soc_prop.mpls_use_in_rif)
    {
       
      SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L2_INRIF);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2_INRIF].prog_used[unit] = (last_tt_program_id - 1);
      if (prog_soc_prop.eli_enable) 
      {
        SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L2_L3ELI_INRIF);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2_L3ELI_INRIF].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L2ELI_INRIF);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2ELI_INRIF].prog_used[unit] = (last_tt_program_id - 1);
      }
      if ((prog_soc_prop.fast_reroute_labels_enable) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
    	  (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
      {
        
        SET_TT_PROGRAM_ID(PROG_TT_INDX_L3_L4);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L3_L4].prog_used[unit] = (last_tt_program_id - 1);
      }     
    }
    else if (prog_soc_prop.mpls_index && (!prog_soc_prop.mpls_use_in_rif)) {
      if (prog_soc_prop.tunnel_termination_in_tt_only) 
      {
          SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L2);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L1);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L1].prog_used[unit] = (last_tt_program_id - 1);
          if (SOC_DPP_CONFIG(unit)->pp.explicit_null_support) 
          {
            SET_TT_PROGRAM_ID(PROG_TT_INDX_L2_L2);
            tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L2_L2].prog_used[unit] = (last_tt_program_id - 1);
            SET_TT_PROGRAM_ID(PROG_TT_INDX_L3_L2);
            tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L3_L2].prog_used[unit] = (last_tt_program_id - 1);
          }
          if (prog_soc_prop.pwe_gal_support) 
          {
            SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L2_GAL);
            tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L2_GAL].prog_used[unit] = (last_tt_program_id - 1);
            SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_L1_GAL);
            tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_L1_GAL].prog_used[unit] = (last_tt_program_id - 1);
            if (prog_soc_prop.explicit_null_arad_plus_support) 
            {
                SET_TT_PROGRAM_ID(PROG_TT_INDX_L2_L3_GAL);
                tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L2_L3_GAL].prog_used[unit] = (last_tt_program_id - 1);
            }
          }
      }
      else if (prog_soc_prop.tunnel_termination_ordered_by_index) {
          SET_TT_PROGRAM_ID(PROG_TT_INDX_AS_ORDER_L2_L3);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L2_L3].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_INDX_AS_ORDER_L2_L2);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L2_L2].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_INDX_AS_ORDER_L1_L2);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L1_L2].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_INDX_AS_ORDER_L1_L1);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_L1_L1].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_INDX_AS_ORDER_NOP);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_AS_ORDER_NOP].prog_used[unit] = (last_tt_program_id - 1);
      } 
      else 
      {
        
        SET_TT_PROGRAM_ID(PROG_TT_INDX_L3_L2);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L3_L2].prog_used[unit] = (last_tt_program_id - 1);

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gal_lookup_exactly", 1)) {
            SET_TT_PROGRAM_ID(PROG_TT_INDX_L1_GAL_ONLY);
            tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L1_GAL_ONLY].prog_used[unit] = (last_tt_program_id - 1);

            SET_TT_PROGRAM_ID(PROG_TT_INDX_L2_GAL_ONLY);
            tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L2_GAL_ONLY].prog_used[unit] = (last_tt_program_id - 1);
        }
        
        if (prog_soc_prop.eli_enable) 
        {
          SET_TT_PROGRAM_ID(PROG_TT_INDX_L2_L3ELI);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L2_L3_ELI].prog_used[unit] = (last_tt_program_id - 1);
        }
        if ((prog_soc_prop.fast_reroute_labels_enable) && !((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20) &&
      		(SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)))
        {
          
          SET_TT_PROGRAM_ID(PROG_TT_INDX_L3_L4);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEXED_L3_L4].prog_used[unit] = (last_tt_program_id - 1);
        } 
      }
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "four_independent_mpls_termination_enable", 0)) {
          SET_TT_PROGRAM_ID(PROG_TT_INDX_MPLS4_L3_L4);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_MPLS4_L3_L4].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_INDX_MPLS4_NOP);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_INDEX_MPLS4_NOP].prog_used[unit] = (last_tt_program_id - 1);

      }
    }
  }

    if (soc_property_get(unit, spn_PWE_TERMINATION_PORT_MODE_ENABLE, 0) ){
        
        SET_TT_PROGRAM_ID(PROG_TT_VLAN_DOMAIN_MPLS_L2);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_VLAN_DOMAIN_MPLS_L2].prog_used[unit] = (last_tt_program_id - 1);
    }

  
  
  
  if (SOC_DPP_CONFIG(unit)->pp.custom_feature_l2_gre_port_termination)
  {
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_PORT_L2_GRE_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_L2_GRE_PORT].prog_used[unit] = (last_tt_program_id - 1);
  }

 if (SOC_DPP_CONFIG(unit)->pp.custom_feature_vxlan_port_termination)
  {
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_PORT_VXLAN_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_VXLAN_PORT].prog_used[unit] = (last_tt_program_id - 1);
  }


  
  
  if (prog_soc_prop.ipv4_term_enable || 
    SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id || 
    SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id_vxlan || 
    SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id_gre)
  {
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_DIP_FOUND].prog_used[unit] = (last_tt_program_id - 1);
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG_IPMC_RCY);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_DIP_FOUND_IPMC_RCY].prog_used[unit] = (last_tt_program_id - 1);
  }
  
  if (prog_soc_prop.ipv6_term_enable) {
      SET_TT_PROGRAM_ID(PROG_TT_IPV6_ROUTER_2ND_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER].prog_used[unit] = (last_tt_program_id - 1);
      if (prog_soc_prop.ipv6_term_dip_sip_enable) {
          SET_TT_PROGRAM_ID(PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER_COMP_DEST_FOUND].prog_used[unit] = (last_tt_program_id - 1);
          
          SET_TT_PROGRAM_ID(PROG_TT_IPV6_ROUTER_2ND_PROG_AFTER_RECYCLE);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV6_ROUTER_AFTER_RECYCLE].prog_used[unit] = (last_tt_program_id - 1);
      }
  }
  
  if (!prog_soc_prop.compression_ip6_enable) {
    SET_TT_PROGRAM_ID(PROG_TT_IP_ROUTER_CompatibleMc_2ND_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_COMPATIBLE_MC].prog_used[unit] = (last_tt_program_id - 1);
  }
  SET_TT_PROGRAM_ID(PROG_TT_IP_ROUTER_2ND_PROG);
  tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER].prog_used[unit] = (last_tt_program_id - 1);

  
  if (SOC_IS_ARADPLUS_AND_BELOW(unit) && prog_soc_prop.nvgre_enable) 
  {
    
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_PWE_GRE_DIP_FOUND].prog_used[unit] = (last_tt_program_id - 1);
  }

  if (prog_soc_prop.ipv4mc_bidir_enable) 
  {
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_MC_DIP_NOT_FOUND_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_MC_DIP_NOT_FOUND].prog_used[unit] = (last_tt_program_id - 1);
    SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_UC_DIP_NOT_FOUND_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_UC_DIP_NOT_FOUND].prog_used[unit] = (last_tt_program_id - 1);
  }
  
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "vtt_unknown_l3", 1) ) {
      SET_TT_PROGRAM_ID(PROG_TT_UNKNOWN_L3_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_TT_UNKNOWN_L3].prog_used[unit] = (last_tt_program_id - 1);
  }
  
  if (SOC_DPP_CONFIG(unit)->pp.custom_feature_ip_l3_gre_port_termination_lif_id) {
      SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_L3_GRE_PORT_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_L3_GRE_PORT].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  if (prog_soc_prop.ipv4_term_dip_sip_enable == 3) {
      SET_TT_PROGRAM_ID(PROG_TT_IPV4_ROUTER_DIP_SIP_VRF_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_ROUTER_DIP_SIP_VRF].prog_used[unit] = (last_tt_program_id - 1);
  }
  
  
  if (SOC_IS_JERICHO(unit) && (!SOC_IS_JERICHO_PLUS(unit) || SOC_IS_QAX_A0(unit)) && SOC_DPP_CONFIG(unit)->pp.explicit_null_support)
  {
      if (soc_property_get(unit,spn_L3_DISABLED_ON_LIF_MODE , 0) == 2) {
          SET_TT_PROGRAM_ID(PROG_TT_IPV4_DISABLE_FOR_EXPLICIT_NULL_PROG);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_DISABLE_ON_LIF].prog_used[unit] = (last_tt_program_id - 1);
          SET_TT_PROGRAM_ID(PROG_TT_IPV6_DISABLE_FOR_EXPLICIT_NULL_PROG);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV6_DISABLE_ON_LIF].prog_used[unit] = (last_tt_program_id - 1);
      } else if (soc_property_get(unit,spn_L3_DISABLED_ON_LIF_MODE , 0) == 1){
          SET_TT_PROGRAM_ID(PROG_TT_IP_DISABLE_FOR_EXPLICIT_NULL_PROG);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IP_DISABLE_ON_LIF].prog_used[unit] = (last_tt_program_id - 1);
      }

      SET_TT_PROGRAM_ID(PROG_TT_IPV4_FOR_EXPLICIT_NULL_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_IPV4_FOR_EXPLICIT_NULL].prog_used[unit] = (last_tt_program_id - 1);
      SET_TT_PROGRAM_ID(PROG_TT_TUNNEL_FOR_TWO_EXPLICIT_NULL_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_TUNNEL_TWO_EXPLICIT_NULL].prog_used[unit] = (last_tt_program_id - 1);
  }
  

 
  if (prog_soc_prop.mim_enable) 
  {
      SET_TT_PROGRAM_ID(PROG_TT_MAC_IN_MAC_WITH_BTAG_PROG);
      tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MIM_WITH_BTAG].prog_used[unit] = (last_tt_program_id - 1);
      if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) 
      {
          SET_TT_PROGRAM_ID(PROG_TT_MAC_IN_MAC_MC_PROG);
          tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MIM_MC].prog_used[unit] = (last_tt_program_id - 1);
      }
  }

  
  SET_TT_PROGRAM_ID(PROG_TT_ARP_2ND_PROG);
  tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_ARP].prog_used[unit] = (last_tt_program_id - 1);

  
  if (prog_soc_prop.trill_mode) 
  {
    SET_TT_PROGRAM_ID(PROG_TT_TRILL_2ND_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_TRILL_ONE_TAG].prog_used[unit] = (last_tt_program_id - 1);
    SET_TT_PROGRAM_ID(PROG_TT_TRILL_2ND_PROG_TWO_VLANS_AT_NATIVE_ETH);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_TRILL_TWO_TAGS].prog_used[unit] = (last_tt_program_id - 1);
    SET_TT_PROGRAM_ID(PROG_TT_TRILL_2ND_PROG_TRILL_TRAP_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_TRILL_TRAP].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  if (prog_soc_prop.fcoe_enable) 
  {
    SET_TT_PROGRAM_ID(PROG_TT_FC_WITH_VFT_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_FC_WITH_VFT].prog_used[unit] = (last_tt_program_id - 1);
    SET_TT_PROGRAM_ID(PROG_TT_FC_PROG);
    tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_FC].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  if (SOC_DPP_CONFIG(unit)->pp.mldp_support) {
       SET_TT_PROGRAM_ID(PROG_TT_MLDP_AFTER_RECYCLE);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_MLDP_OVERLAY_AFTER_RCY].prog_used[unit] = (last_tt_program_id - 1);

   }

  
  if (SOC_DPP_CONFIG(unit)->extender.port_extender_init_status) {
       SET_TT_PROGRAM_ID(PROG_TT_EXTENDER_UNTAG_CHECK_IP_MC);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_EXTENDER_UNTAG_CHECK_IP_MC].prog_used[unit] = (last_tt_program_id - 1);
       SET_TT_PROGRAM_ID(PROG_TT_EXTENDER_IP_MC_PROG);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_EXTENDER_CB_IP_MC].prog_used[unit] = (last_tt_program_id - 1);
       SET_TT_PROGRAM_ID(PROG_TT_EXTENDER_UNTAG_CHECK_IP_UC);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_EXTENDER_UNTAG_CHECK_IP_UC].prog_used[unit] = (last_tt_program_id - 1);
       SET_TT_PROGRAM_ID(PROG_TT_EXTENDER_IP_UC_PROG);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_EXTENDER_CB_IP_UC].prog_used[unit] = (last_tt_program_id - 1);
       SET_TT_PROGRAM_ID(PROG_TT_EXTENDER_UNTAG_CHECK);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_EXTENDER_UNTAG_CHECK].prog_used[unit] = (last_tt_program_id - 1);
       SET_TT_PROGRAM_ID(PROG_TT_EXTENDER_PROG);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_EXTENDER_CB].prog_used[unit] = (last_tt_program_id - 1);
  }

    
    if (SOC_DPP_PPPOE_IS_ENABLE(unit)) {
        SET_TT_PROGRAM_ID(PROG_TT_PPPOE_PROG);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_PPPOE].prog_used[unit] = (last_tt_program_id - 1);
    }
    
    
    if (SOC_DPP_L2TP_IS_ENABLE(unit)) {
        SET_TT_PROGRAM_ID(PROG_TT_L2TP); 
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_L2TP].prog_used[unit] = (last_tt_program_id - 1);
    }
    
    
    if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 20 || SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 21)
      {
        SET_TT_PROGRAM_ID(PROG_TT_3MTSE_PLUS_FRR_L1_L1);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1_L1].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_TFL_L3_L3].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_3MTSE_PLUS_FRR_L3_L1);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L3_L1].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_3MTSE_PLUS_FRR_TFL_L4_L3);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_TFL_L4_L3].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_3MTSE_PLUS_FRR_L1);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L1].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_3MTSE_PLUS_FRR_L2_L1);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_3MTSE_PLUS_FRR_L2_L1].prog_used[unit] = (last_tt_program_id - 1);
      }
   
   if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 22 || SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 23)
      {
        SET_TT_PROGRAM_ID(PROG_TT_2MTSE_PLUS_FRR_L1_L1);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L1_L1].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L2].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_2MTSE_PLUS_FRR_L2_L1);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L2_L1].prog_used[unit] = (last_tt_program_id - 1);
        SET_TT_PROGRAM_ID(PROG_TT_2MTSE_PLUS_FRR_TFL_L3_L2);
        tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_2MTSE_PLUS_FRR_L3_L2].prog_used[unit] = (last_tt_program_id - 1);
      }

    
    if (SOC_IS_JERICHO(unit)) {
        res = (MBCM_PP_DRIVER_CALL(unit,mbcm_pp_mpls_termination_first_label_bit_map_init,(unit, 0)));
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
    }

  
  if (SOC_DPP_CONFIG(unit)->pp.rch_port0_in_exists || SOC_DPP_CONFIG(unit)->pp.rch_port1_in_exists) {
       SET_TT_PROGRAM_ID(PROG_TT_GENERALIZED_RCH_MPLS_PROG);
       tt_dbal_programs[ARAD_PP_DBAL_TT_PROG_GENERALIZED_RCH_MPLS].prog_used[unit] = (last_tt_program_id - 1);
  }

  
  tmp = 0;
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L3, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L3, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L3_L4, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L3_L4, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  if (tmp > 1) 
  {
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 400, exit); 
  }

  tmp = 0;
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L2_L3ELI, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L2_L3ELI, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2_L3ELI_INRIF, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2_L3ELI_INRIF, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L2_L3ELI, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L2_L3ELI, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  if (tmp > 1) 
  {
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 410, exit); 
  }
  
  tmp = 0;
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_L2, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_L2, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L1_L2_INRIF, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L1_L2_INRIF, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, PROG_TT_INDX_L3_L2, &prog_used);
  SOC_SAND_CHECK_FUNC_RESULT(res, PROG_TT_INDX_L3_L2, exit);
  tmp = ARAD_PP_ISEM_ACCESS_IS_PROGRAM_VALID_AND_INCR(prog_used);
  if (tmp > 1) 
  {
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 420, exit); 
  }
  
   
     

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_prog_programs_init()", last_vt_program_id, last_tt_program_id);
}

STATIC 
uint32
  arad_pp_isem_prog_sel_cam_init(
    int unit
  )
{
  uint32
    res;
  ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_1st_cam_tbl;
  ARAD_PP_IHP_VTT2ND_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_2nd_cam_tbl;
  uint32
    data[SOC_SAND_MAX(ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_ENTRY_SIZE,ARAD_PP_IHP_VTT2ND_KEY_PROGRAM_SELECTION_CAM_TBL_ENTRY_SIZE)];

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
    
  ARAD_CLEAR(&prog_selection_1st_cam_tbl, ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1);
  ARAD_CLEAR(&prog_selection_2nd_cam_tbl, ARAD_PP_IHP_VTT2ND_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1);

  prog_selection_1st_cam_tbl.valid = 0;
  prog_selection_1st_cam_tbl.packet_format_qualifier_1_mask     = 0x7FF;
  prog_selection_1st_cam_tbl.packet_format_qualifier_2_mask     = 0x7FF;
  prog_selection_1st_cam_tbl.packet_format_code_mask            = ARAD_PARSER_PFC_MATCH_ANY;
  prog_selection_1st_cam_tbl.ptc_vt_profile_mask                = 0x3;
  prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask         = ARAD_PP_ISEM_ACCESS_VT_PROFILE_MASK;
  prog_selection_1st_cam_tbl.parser_leaf_context_mask           = ARAD_PARSER_PLC_MATCH_ANY;
  if(SOC_IS_JERICHO(unit))
  {      
      prog_selection_1st_cam_tbl.incoming_tag_structure_mask    = 0xF;
      prog_selection_1st_cam_tbl.packet_format_qualifier_0_mask = 0x7;
  }

  res = arad_pp_ihp_isem_1st_program_selection_convert_tbl_data_to_data(unit,&prog_selection_1st_cam_tbl,data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);


  
  res = arad_fill_table_with_entry(unit, IHP_VTT_1ST_KEY_PROG_SEL_TCAMm, MEM_BLOCK_ANY, data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 13, exit);

  prog_selection_2nd_cam_tbl.valid                                          = 0x0;
  prog_selection_2nd_cam_tbl.packet_format_qualifier_1_mask                 = 0x7FF;
  prog_selection_2nd_cam_tbl.packet_format_qualifier_2_mask                 = 0x7FF;
  if (SOC_IS_ARADPLUS_AND_BELOW(unit))
  {  
      prog_selection_2nd_cam_tbl.packet_format_qualifier_3_outer_vid_bits_mask  = 0x7;
  }
  prog_selection_2nd_cam_tbl.packet_format_code_mask                        = ARAD_PARSER_PFC_MATCH_ANY;
  prog_selection_2nd_cam_tbl.ptc_tt_profile_mask                            = 0x3;
  prog_selection_2nd_cam_tbl.in_pp_port_tt_profile_mask                     = 0x7;
  prog_selection_2nd_cam_tbl.parser_leaf_context_mask                       = ARAD_PARSER_PLC_MATCH_ANY;
  prog_selection_2nd_cam_tbl.isa_lookup_found_mask                          = 0x1;
  prog_selection_2nd_cam_tbl.isb_lookup_found_mask                          = 0x1;
  prog_selection_2nd_cam_tbl.tcam_lookup_match_mask                         = 0x1;
  prog_selection_2nd_cam_tbl.vt_processing_profile_mask                     = 0x7;
  prog_selection_2nd_cam_tbl.da_is_all_r_bridges_mask                       = 0x1;
  prog_selection_2nd_cam_tbl.packet_is_compatible_mc_mask                   = 0x1;
  prog_selection_2nd_cam_tbl.my_mac_mask                                    = 0x1;
  prog_selection_2nd_cam_tbl.vlan_is_designated_mask                        = 0x1;
  if(SOC_IS_ARAD_B0_AND_ABOVE(unit))
  {
      prog_selection_2nd_cam_tbl.my_b_mac_mc_mask                           = 0x1;
  }
  if(SOC_IS_JERICHO(unit))
  {
      prog_selection_2nd_cam_tbl.in_pp_port_tt_profile_mask                 = 0x1F;
      prog_selection_2nd_cam_tbl.vt_in_lif_profile_mask                     = 0xF; 
      prog_selection_2nd_cam_tbl.packet_format_qualifier_3_mask             = 0x7FF;
  }

  res = arad_pp_ihp_isem_2nd_program_selection_convert_tbl_data_to_data(unit,&prog_selection_2nd_cam_tbl,data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);

  res = arad_fill_table_with_entry(unit, IHP_VTT_2ND_KEY_PROG_SEL_TCAMm, MEM_BLOCK_ANY, data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_prog_sel_cam_init()", 0, 0);
}

#define ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_FIELD_CHANGE(field_1,field_2) \
{ \
  uint32 __tmp; \
  __tmp = field_1; \
  field_1 = field_2; \
  field_2 = __tmp; \
}

#define ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_BITS_CHANGE(new,old,value_1,value_2) \
{ \
  if (old & value_1) \
  { \
    new |= value_2; \
    new &= ~value_1; \
  } \
  if (old & value_2) \
  { \
    new |= value_1; \
    new &= ~value_2; \
  } \
}



uint32
  arad_pp_vtt_1st_lookup_program_swap_sem(
    int unit,
    uint32 swap,
    ARAD_PP_IHP_VTT1ST_KEY_CONSTRUCTION_TBL_DATA* tbl_data
  )
{
  uint32
    tmp;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  if(swap)
  {
      ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_FIELD_CHANGE(tbl_data->isa_key_valids_1,tbl_data->isb_key_valids_1);
      ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_FIELD_CHANGE(tbl_data->isa_key_valids_2,tbl_data->isb_key_valids_2);
  }
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_FIELD_CHANGE(tbl_data->isa_and_mask,tbl_data->isb_and_mask);
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_FIELD_CHANGE(tbl_data->isa_lookup_enable,tbl_data->isb_lookup_enable);
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_FIELD_CHANGE(tbl_data->isa_or_mask,tbl_data->isb_or_mask);
  tmp = tbl_data->vlan_translation_0_pd_bitmap;
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_BITS_CHANGE(tbl_data->vlan_translation_0_pd_bitmap,tmp,0x2,0x1);
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_BITS_CHANGE(tbl_data->vlan_translation_0_pd_bitmap,tmp,0x10,0x8);
  tmp = tbl_data->vlan_translation_1_pd_bitmap;
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_BITS_CHANGE(tbl_data->vlan_translation_1_pd_bitmap,tmp,0x2,0x1);
  ARAD_PP_VTT_1ST_LOOKUP_PROGRAM_SWAP_BITS_CHANGE(tbl_data->vlan_translation_1_pd_bitmap,tmp,0x10,0x8);

  ARAD_DO_NOTHING_AND_EXIT;

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_vtt_1st_lookup_program_swap_sem()", 0, 0);
}


STATIC
uint32
  arad_pp_vtt_find_namespace_database(
    int unit,
    SOC_PPC_MPLS_TERM_NAMESPACE_TYPE namespace_required,
    uint32 mpls_1_database,
    uint32 mpls_1_namespace,
    uint32 mpls_2_database,
    uint32 mpls_2_namespace,
    uint32 mpls_3_database,
    uint32 mpls_3_namespace,
    SOC_PPC_MPLS_TERM_NAMESPACE_TYPE *namespace,
    uint32 *database
  )
{

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  *namespace = mpls_3_namespace;
  *database  = mpls_3_database;

  if (namespace_required == SOC_PPC_MPLS_TERM_NAMESPACE_L1)
  {
    if (ARAD_PP_VTT_FIND_NAMESPACE_L1(mpls_1_namespace)) {
      *namespace = mpls_1_namespace;
      *database  = mpls_1_database;
    } else if (ARAD_PP_VTT_FIND_NAMESPACE_L1(mpls_2_namespace)) {
      *namespace = mpls_2_namespace;
      *database  = mpls_2_database;
    } 
  }

  if (namespace_required == SOC_PPC_MPLS_TERM_NAMESPACE_L2)
  {
    if (ARAD_PP_VTT_FIND_NAMESPACE_L2(mpls_1_namespace)) 
    {
      *namespace = mpls_1_namespace;
      *database  = mpls_1_database;
    } 
    else if (ARAD_PP_VTT_FIND_NAMESPACE_L2(mpls_2_namespace)) 
    {
      *namespace = mpls_2_namespace;
      *database  = mpls_2_database;
    }    
  }
  
  if (namespace_required == SOC_PPC_MPLS_TERM_NAMESPACE_L3)
  {
    if (ARAD_PP_VTT_FIND_NAMESPACE_L3(mpls_1_namespace)) 
    {
      *namespace = mpls_1_namespace;
      *database  = mpls_1_database;
    } 
    else if (ARAD_PP_VTT_FIND_NAMESPACE_L3(mpls_2_namespace)) 
    {
      *namespace = mpls_2_namespace;
      *database  = mpls_2_database;
    }    
  }

  ARAD_DO_NOTHING_AND_EXIT;
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_vtt_find_namespace_database()", namespace_required, 0);
}







uint32
   arad_pp_isem_access_tcam_callback(
      SOC_SAND_IN int unit,
      SOC_SAND_IN uint32  user_data
    )
{  
  uint32
    res = SOC_SAND_OK;
  uint32
    tcam_db_id,
    access_profile_id;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]

  
  tcam_db_id = user_data;

  res = sw_state_access[unit].dpp.soc.arad.tm.tcam.tcam_db.access_profile_id.get(unit,tcam_db_id,0, &access_profile_id);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

  switch (user_data) 
  {
  case ARAD_PP_ISEM_ACCESS_TCAM_MPLS_FRR_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_SPOOF_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_TT_IPV6_SPOOF_COMPRESSION:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV4_TT_ETH_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_SRC_PORT_DA_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_VRRP_VSI_DA_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_TST2_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_TEST2_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_TT_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_TT_DIP_COMPRESSION_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_ETH_INNER_OUTER_PCP_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_DIP_SIP_VRF_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV4_MATCH_VT_DB_PROFILE :
  case ARAD_PP_ISEM_ACCESS_VT_CLASSIFICATIONS_EFP :
  case ARAD_PP_ISEM_ACCESS_TCAM_MPLS_EXPLICIT_NULL_VT_DB_PROFILE :
  case ARAD_PP_ISEM_ACCESS_TCAM_TT_TRILL_TRANSPARENT_SERVICE:
  case ARAD_PP_ISEM_ACCESS_TCAM_CUSTOM_PP_LSP_ECMP_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_VT_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_TT_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_CASCADE_VT_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_TT_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_L4B_L5L_PROFILE:
    break;

  case ARAD_PP_ISEM_ACCESS_TCAM_PON_EXTEND_LKP_DB_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_PROFILE:
  case ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_DOU_TAGS_PROFILE:

    break;

  default:
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR, 300, exit);
  }

  ARAD_DO_NOTHING_AND_EXIT;
exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_tcam_callback()", 0, 0);
}

STATIC 
uint32
  arad_pp_isem_tcam_init_unsafe(
    int unit,
    uint8 fast_reroute_labels_enable,
    uint8 spoof_ipv6_enable,
    uint8 trill_mode,    
    uint8 ipv4_term_dip_sip_enable,
    uint8 ipv6_term_enable,
    uint8 ipv6_term_dip_sip_enable,
    uint8 port_vlan_pcp_lookup_enable,
    uint8 use_pon_tcam_lkup,
    uint8 q_in_q_ip_5_tuple_enable,
    uint8 custom_feature_vt_tst1,
    uint8 trill_transparent_service,
    uint8 explicit_null_arad_plus_support,
    uint8 compression_ip6_enable,
    uint8 compression_spoof_ip6_enable,
    uint8 custom_feature_vt_tst2,
    uint8 custom_feature_vrrp_scaling_tcam,
    uint8 vrrp_scaling_tcam,
    uint8 section_oam_enable
  )
{
  uint32
    res = SOC_SAND_OK;
  SOC_SAND_SUCCESS_FAILURE
    success;
  ARAD_TCAM_ACCESS_INFO
    tcam_access_info;
  int use_small_banks_mode_vrrp = vrrp_scaling_tcam ? SOC_DPP_CONFIG(unit)->pp.use_small_banks_mode_vrrp : soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "use_small_banks_mode_vrrp", 0);
  int use_small_banks_mode_efp  =  soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,  "use_small_banks_mode_efp", 0);
  int use_small_banks_mode_null =  soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "use_small_banks_mode_null", 0);

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

                                                                  

  if (custom_feature_vrrp_scaling_tcam || vrrp_scaling_tcam)
  {
    arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                ARAD_TCAM_BANK_OWNER_VT, 
                                                ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                ARAD_PP_ISEM_ACCESS_TCAM_VRRP_VSI_DA_PROFILE);    

    if ( use_small_banks_mode_vrrp == 1) { 
      tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORCE;
    } else if (use_small_banks_mode_vrrp == 2) { 
      tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORBID;
    }

    res = arad_tcam_access_create_unsafe(unit, ARAD_PP_ISEM_ACCESS_TCAM_VRRP_VSI_DA_PROFILE, &tcam_access_info, &success);
    SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
  }

  if (SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1)
  {
      arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_SRC_PORT_DA_DB_PROFILE); 

      res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_SRC_PORT_DA_DB_PROFILE,&tcam_access_info,&success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
  }

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,  "conn_to_np_enable", 0))
  {
      arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_CUSTOM_PP_LSP_ECMP_PROFILE); 
      res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_CUSTOM_PP_LSP_ECMP_PROFILE,&tcam_access_info,&success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
  }

  if(custom_feature_vt_tst2)
  {
      arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_TST2_PROFILE);

      res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_TST2_PROFILE,&tcam_access_info,&success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 9, exit);
  }
  else
  {
      if (fast_reroute_labels_enable) 
      {
    	  if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23) {
        	  arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info,
                                                      ARAD_TCAM_BANK_OWNER_VT,
                                                      ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS,
													  ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE);

              res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE,&tcam_access_info,&success);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
    	  }
    	  else {
         	  arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info,
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_MPLS_FRR_DB_PROFILE);

             res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_MPLS_FRR_DB_PROFILE,&tcam_access_info,&success);
             SOC_SAND_CHECK_FUNC_RESULT(res, 11, exit);
    	  }
      }

      if (SOC_DPP_CONFIG(unit)->pp.test2) {

          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_TEST2_PROFILE);

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_TEST2_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 9, exit);
      }

      if (port_vlan_pcp_lookup_enable) { 
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_ETH_INNER_OUTER_PCP_DB_PROFILE);               

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_ETH_INNER_OUTER_PCP_DB_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }

      if (use_pon_tcam_lkup) { 
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_PON_EXTEND_LKP_DB_PROFILE);

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_PON_EXTEND_LKP_DB_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);
      }

      if (section_oam_enable) { 
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info,
                                                  ARAD_TCAM_BANK_OWNER_VT,
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS,
                                                  ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_PROFILE);

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);
		  
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info,
                                                  ARAD_TCAM_BANK_OWNER_VT,
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS,
                                                  ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_DOU_TAGS_PROFILE);

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_DOU_TAGS_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 75, exit);
      }

      if (q_in_q_ip_5_tuple_enable) { 
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV4_MATCH_VT_DB_PROFILE);

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV4_MATCH_VT_DB_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
      }

      if (custom_feature_vt_tst1) {
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_VT_CLASSIFICATIONS_EFP);          

          if (use_small_banks_mode_efp == 1){
            tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORCE;
          } else if (use_small_banks_mode_efp == 2) {
            tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORBID;
          }

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_VT_CLASSIFICATIONS_EFP,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
      }
      if (trill_transparent_service) { 
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_TT_TRILL_TRANSPARENT_SERVICE);          

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_TT_TRILL_TRANSPARENT_SERVICE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
      }

      if (explicit_null_arad_plus_support) {
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_MPLS_EXPLICIT_NULL_VT_DB_PROFILE);          

          if (use_small_banks_mode_null == 1){
            tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORCE;
          } else if (use_small_banks_mode_null == 2){
            tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORBID;
          }

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_MPLS_EXPLICIT_NULL_VT_DB_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);

      }
  }

  if (ipv4_term_dip_sip_enable)   {

      
      if ((ipv4_term_dip_sip_enable == 3) || (ipv4_term_dip_sip_enable == 4)) {
          arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info,
                                              ARAD_TCAM_BANK_OWNER_TT,
                                              ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS,
                                              ARAD_PP_ISEM_ACCESS_TCAM_DIP_SIP_VRF_PROFILE);

          if ( soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "vt_ip_term_use_small_banks",0) ){
              tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORCE;
          }

          res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_DIP_SIP_VRF_PROFILE,&tcam_access_info,&success);
          SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
      } else {
          if(!custom_feature_vt_tst2) {
              arad_ARAD_TCAM_ACCESS_INFO_clear(&tcam_access_info);

              tcam_access_info.action_bitmap_ndx                   = ARAD_TCAM_ACTION_SIZE_FIRST_20_BITS;
              tcam_access_info.bank_owner                          = ARAD_TCAM_BANK_OWNER_VT;
              tcam_access_info.callback                            = arad_pp_isem_access_tcam_callback;
              if (ipv4_term_dip_sip_enable == 2){
                  
                  tcam_access_info.entry_size                          = ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS;
              }
              else{
                  tcam_access_info.entry_size                          = ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS;
              }
              tcam_access_info.is_direct                           = FALSE;
              tcam_access_info.min_banks                           = ARAD_PP_ISEM_ACCESS_TCAM_DEF_MIN_BANKS;
              tcam_access_info.prefix_size                         = ARAD_PP_ISEM_ACCESS_TCAM_DEF_PREFIX_SIZE;
              tcam_access_info.user_data                           = ARAD_PP_ISEM_ACCESS_TCAM_IPV4_TT_ETH_DB_PROFILE;

              if ( soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "vt_ip_term_use_small_banks",0) ){
                  tcam_access_info.use_small_banks                 = ARAD_TCAM_SMALL_BANKS_FORCE;
              }

              res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV4_TT_ETH_DB_PROFILE,&tcam_access_info,&success);
              SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
          }
      }
  }

  if (spoof_ipv6_enable && (!compression_spoof_ip6_enable)) 
  {
    arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_TT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV6_SPOOF_DB_PROFILE);    

    res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV6_SPOOF_DB_PROFILE,&tcam_access_info,&success);
    SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  if (ipv6_term_enable) 
  {
    arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_TT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV6_TT_DB_PROFILE);    

    res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV6_TT_DB_PROFILE,&tcam_access_info,&success);
    SOC_SAND_CHECK_FUNC_RESULT(res, 50, exit);

    if (ipv6_term_dip_sip_enable) {
        arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_VT_DB_PROFILE);    

        res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_VT_DB_PROFILE,&tcam_access_info,&success);
        SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);

        arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_TT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_TT_DB_PROFILE);    

        res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_TT_DB_PROFILE,&tcam_access_info,&success);
        SOC_SAND_CHECK_FUNC_RESULT(res, 61, exit);
        
        arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_VT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_CASCADE_VT_DB_PROFILE);    

        res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_CASCADE_VT_DB_PROFILE,&tcam_access_info,&success);
        SOC_SAND_CHECK_FUNC_RESULT(res, 62, exit);

        arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_TT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_160_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_TT_DB_PROFILE);    

        res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_TT_DB_PROFILE,&tcam_access_info,&success);
        SOC_SAND_CHECK_FUNC_RESULT(res, 63, exit);
    }    
  }

  if (compression_ip6_enable) {
      arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_TT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_TT_DIP_COMPRESSION_DB_PROFILE);      

      res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_TT_DIP_COMPRESSION_DB_PROFILE,&tcam_access_info,&success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);    
  }


  if (spoof_ipv6_enable && compression_spoof_ip6_enable) {
      arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                  ARAD_TCAM_BANK_OWNER_TT, 
                                                  ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                  ARAD_PP_ISEM_ACCESS_TCAM_TT_IPV6_SPOOF_COMPRESSION);

      res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_TT_IPV6_SPOOF_COMPRESSION,&tcam_access_info,&success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);    
  }

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,  "four_independent_mpls_termination_enable", 0))
  {
        arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info, 
                                                    ARAD_TCAM_BANK_OWNER_VT, 
                                                    ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS, 
                                                    ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE); 
        res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE,&tcam_access_info,&success);
        SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
  }


  if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 21) {
  	  arad_ARAD_TCAM_ACCESS_INFO_clear_and_update(&tcam_access_info,
                                                ARAD_TCAM_BANK_OWNER_VT,
                                                ARAD_TCAM_BANK_ENTRY_SIZE_80_BITS,
												ARAD_PP_ISEM_ACCESS_TCAM_L4B_L5L_PROFILE);

  	  tcam_access_info.use_small_banks  = ARAD_TCAM_SMALL_BANKS_FORCE;

      res = arad_tcam_access_create_unsafe(unit,ARAD_PP_ISEM_ACCESS_TCAM_L4B_L5L_PROFILE,&tcam_access_info,&success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_tcam_init_unsafe()", 0, 0);
}

void 
arad_pp_isem_access_deinit(int unit)
{
    is_g_prog_soc_prop_initilized[unit] = 0;   
}
uint32
  arad_pp_isem_access_init_unsafe(
    SOC_SAND_IN  int                                 unit
  )
{
  uint32
    res = SOC_SAND_OK;
  uint64 
    failure;
  uint32
      core_id,
    table_data[6] = {0};
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

#define prog_soc_prop g_prog_soc_prop[unit]

  res = arad_fill_table_with_entry(unit, IHP_VTT_1ST_LOOKUP_PROGRAM_0m, MEM_BLOCK_ANY, table_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  res = arad_fill_table_with_entry(unit, IHP_VTT_2ND_LOOKUP_PROGRAM_0m, MEM_BLOCK_ANY, table_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);


  soc_mem_field32_set(
                       unit,
                       IHP_VTT_1ST_LOOKUP_PROGRAM_1m,
                       table_data,
                       TCAM_DB_PROFILEf,
                       ARAD_TCAM_ACCESS_PROFILE_INVALID );

  res = arad_fill_table_with_entry(unit, IHP_VTT_1ST_LOOKUP_PROGRAM_1m, MEM_BLOCK_ANY, table_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  
  sal_memset(table_data,0,sizeof(table_data));
  soc_mem_field32_set(
                       unit,
                       IHP_VTT_2ND_LOOKUP_PROGRAM_1m,
                       table_data,
                       TCAM_DB_PROFILEf,
                       ARAD_TCAM_ACCESS_PROFILE_INVALID );

  res = arad_fill_table_with_entry(unit, IHP_VTT_2ND_LOOKUP_PROGRAM_1m, MEM_BLOCK_ANY, table_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);


  
  res = arad_fill_table_with_entry(unit, IHP_VTT_PTC_CONFIGm, MEM_BLOCK_ANY, table_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);  

  if (prog_soc_prop.compression_spoof_ip6_enable ||
      prog_soc_prop.compression_ip6_enable ||
      prog_soc_prop.custom_pon_ipmc) {
    arad_mgmt_pon_init(unit);
  }

  if(SOC_IS_QAX(unit))
  {
      SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, PPDB_A_ISEM_MANAGEMENT_UNIT_CONFIGURATION_REGISTERr, REG_PORT_ANY, 0, ISEM_MNGMNT_UNIT_ENABLEf,  0x1));
      SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  11,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, PPDB_B_ISEM_MANAGEMENT_UNIT_CONFIGURATION_REGISTERr, REG_PORT_ANY, 0, ISEM_MNGMNT_UNIT_ENABLEf,  0x1));

      
      SOC_SAND_SOC_IF_ERROR_RETURN(res, 1015, exit, READ_PPDB_A_ISEM_MANAGEMENT_UNIT_FAILUREr(unit, &failure));
      SOC_SAND_SOC_IF_ERROR_RETURN(res, 1016, exit, READ_PPDB_B_ISEM_MANAGEMENT_UNIT_FAILUREr(unit, &failure));

  }
  else
  {
      if (SOC_IS_JERICHO(unit)) {
          SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, IHB_ISEM_MANAGEMENT_UNIT_CONFIGURATION_REGISTERr, REG_PORT_ANY, 0, ISEM_MNGMNT_UNIT_ENABLEf,  0x1));

          
          for (core_id = 0; core_id < SOC_DPP_DEFS_GET(unit, nof_cores); core_id++) {
              SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000 + core_id, exit, READ_IHB_ISEM_MANAGEMENT_UNIT_FAILUREr(unit, core_id, &failure));
          }
      } else {
          SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, IHP_ISA_MANAGEMENT_UNIT_CONFIGURATION_REGISTERr, REG_PORT_ANY, 0, ISA_MNGMNT_UNIT_ENABLEf,  0x1));
          SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, IHP_ISB_MANAGEMENT_UNIT_CONFIGURATION_REGISTERr, REG_PORT_ANY, 0, ISB_MNGMNT_UNIT_ENABLEf,  0x1));

          
          SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, READ_IHP_ISA_MANAGEMENT_UNIT_FAILUREr(unit, &failure));
          SOC_SAND_SOC_IF_ERROR_RETURN(res, 1010, exit, READ_IHP_ISB_MANAGEMENT_UNIT_FAILUREr(unit, &failure));
      }
  }


  if ((prog_soc_prop.nvgre_enable && prog_soc_prop.e_o_ip_enable) ||
      (prog_soc_prop.nvgre_enable && prog_soc_prop.vxlan_enable) ||
      (prog_soc_prop.e_o_ip_enable && prog_soc_prop.vxlan_enable) ||
      (prog_soc_prop.custom_pon_enable && (!prog_soc_prop.tls_in_tcam_enable))) 
  {
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_SOC_PROPERTIES_ERR, 5055, exit); 
  }

  
  res = arad_pp_isem_prog_sel_cam_init(
          unit
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  
  
   res = arad_pp_vtt_prog_sel_cam_key_program_1st_set(
           unit,
           &prog_soc_prop
    );
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

  
  res = arad_pp_isem_prog_sel_cam_key_program_2nd(
          unit,
          &prog_soc_prop
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

  

    
  res = arad_pp_isem_tcam_init_unsafe(
          unit,
          prog_soc_prop.fast_reroute_labels_enable, 
          prog_soc_prop.spoof_ipv6_enable,
          prog_soc_prop.trill_mode,     
          prog_soc_prop.ipv4_term_dip_sip_enable,  
          prog_soc_prop.ipv6_term_enable,
          prog_soc_prop.ipv6_term_dip_sip_enable,
          prog_soc_prop.port_vlan_pcp_lookup,
          prog_soc_prop.use_pon_tcam_lkup,
          prog_soc_prop.q_in_q_ip_5_tuple,
          prog_soc_prop.custom_feature_vt_tst1,
          prog_soc_prop.trill_transparent_service,
          prog_soc_prop.explicit_null_arad_plus_support,
          prog_soc_prop.compression_ip6_enable,
          prog_soc_prop.compression_spoof_ip6_enable,
          prog_soc_prop.custom_feature_vt_tst2,
          prog_soc_prop.custom_feature_vrrp_scaling_tcam,
          prog_soc_prop.vrrp_scaling_tcam,
          prog_soc_prop.section_oam_enable
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

  


exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_init_unsafe()", 0, 0);
}

uint32 arad_pp_isem_access_programs_soc_properties_get( SOC_SAND_IN int  unit)
{
    uint32
       res = SOC_SAND_OK;
    uint32 value=0;
    char *propval;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

#define  prog_soc_prop     (&(g_prog_soc_prop[unit]))

    ARAD_CLEAR(prog_soc_prop, ARAD_PP_ISEM_ACCESS_PROGRAMS_SOC_PROPERTIES, 1);

    if (SOC_DPP_CONFIG(unit)->arad->init.pp_enable == FALSE) {
        ARAD_DO_NOTHING_AND_EXIT;
    }

    res = sw_state_access[unit].dpp.soc.arad.pp.oper_mode.mpls_info.fast_reroute_labels_enable.get(unit,&(prog_soc_prop->fast_reroute_labels_enable));
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

    res = sw_state_access[unit].dpp.soc.arad.pp.oper_mode.mpls_info.mpls_termination_label_index_enable.get(unit,&(prog_soc_prop->mpls_index));
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

    res = sw_state_access[unit].dpp.soc.arad.pp.oper_mode.mpls_info.lookup_include_inrif.get(unit,&(prog_soc_prop->mpls_use_in_rif));
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 30, exit);

    prog_soc_prop->port_vlan_pcp_lookup = (SOC_DPP_CONFIG(unit)->pp.vlan_match_db_mode == SOC_DPP_VLAN_DB_MODE_PCP);
    prog_soc_prop->match_port_vlan_critiria_64K = (SOC_DPP_CONFIG(unit)->pp.vlan_match_db_mode == SOC_DPP_VLAN_DB_MODE_FULL_DB);
    prog_soc_prop->spoof_enable = ((SOC_DPP_CONFIG(unit)->pp.l3_source_bind_mode == SOC_DPP_L3_SOURCE_BIND_MODE_IPV4)
                                   ||(SOC_DPP_CONFIG(unit)->pp.l3_source_bind_mode == SOC_DPP_L3_SOURCE_BIND_MODE_IP)); 
    prog_soc_prop->trill_mode = SOC_DPP_CONFIG(unit)->trill.mode;
    prog_soc_prop->trill_appointed_fwd = FALSE;
	prog_soc_prop->trill_transparent_service = SOC_DPP_CONFIG(unit)->trill.transparent_service;
    prog_soc_prop->spoof_ipv6_enable = ((SOC_DPP_CONFIG(unit)->pp.l3_source_bind_mode == SOC_DPP_L3_SOURCE_BIND_MODE_IPV6)
                                        ||(SOC_DPP_CONFIG(unit)->pp.l3_source_bind_mode == SOC_DPP_L3_SOURCE_BIND_MODE_IP)); 
    prog_soc_prop->ipv4_term_dip_sip_enable = ((SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_DIP_SIP)
                                               ||(SOC_DPP_CONFIG(unit)->pp.ingress_ipv4_tunnel_term_mode == SOC_DPP_IP_TUNNEL_L2_LKUP_MODE_SIP_DIP_JOIN));
    if (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_DIP_SIP_NEXT_PROTOCOL) {
        prog_soc_prop->ipv4_term_dip_sip_enable = 2; 
    } else if (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_DIP_SIP_VRF) { 
        prog_soc_prop->ipv4_term_dip_sip_enable = 3; 
    } else if (SOC_DPP_CONFIG(unit)->pp.ingress_ipv4_tunnel_term_mode == SOC_DPP_IP_TUNNEL_L2_LKUP_MODE_DIP_SIP_VRF_SEM_ONLY_AND_DEFAULT_TCAM) { 
        prog_soc_prop->ipv4_term_dip_sip_enable = 4; 
    }

    if (SOC_IS_JERICHO(unit) && 
        (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_DIP_SIP_VRF)) {
        prog_soc_prop->ipv6_term_dip_sip_enable = 1;
    } 
    
    prog_soc_prop->nvgre_enable = (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_NVGRE) || 
                                  (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_NVGRE);
    prog_soc_prop->vxlan_enable = (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_VXLAN) ||
                                  (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_VXLAN);
    prog_soc_prop->e_o_ip_enable = (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_ETHER) || 
                                   (SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_ETHER);
    prog_soc_prop->ipv4_term_enable = ((SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_TUNNEL_MASK)
                                       || prog_soc_prop->nvgre_enable || prog_soc_prop->vxlan_enable || prog_soc_prop->e_o_ip_enable);
    prog_soc_prop->ipv6_term_enable = ((SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_TUNNEL_MASK)
                                       || prog_soc_prop->nvgre_enable || prog_soc_prop->vxlan_enable || prog_soc_prop->e_o_ip_enable);
    if (SOC_IS_ARAD_B1_AND_BELOW(unit) && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_termination_check_bos_disable", 0) == 1)) {
        prog_soc_prop->is_bos_in_key_enable = FALSE;
    } else {
        prog_soc_prop->is_bos_in_key_enable = TRUE;
    }
#ifdef BCM_88660_A0
    if (SOC_IS_ARADPLUS(unit) && soc_property_get(unit, spn_BCM886XX_MPLS_TERMINATION_KEY_MODE, 1)) {
        prog_soc_prop->is_bos_in_key_enable = FALSE;
    }
#endif 
  propval = soc_property_get_str(unit, spn_PON_APPLICATION_SUPPORT_ENABLED);
  if (propval) {      
      if (sal_strcmp(propval, "TRUE") == 0) {
          value = 1;
      } else {
          value = 0;
      }
  }
    prog_soc_prop->pon_enable = SOC_DPP_CONFIG(unit)->pp.pon_application_enable ? 1 : (value ? 1 : 0);
    prog_soc_prop->use_pon_tcam_lkup = SOC_DPP_CONFIG(unit)->pp.pon_tcam_lkup_enable;
    prog_soc_prop->tls_db_enable = 1;
    prog_soc_prop->custom_pon_enable = SOC_DPP_CONFIG(unit)->pp.pon_custom_enable;
    prog_soc_prop->tls_in_tcam_enable = SOC_DPP_CONFIG(unit)->pp.pon_tls_in_tcam; 
    prog_soc_prop->evb_enable = SOC_DPP_CONFIG(unit)->pp.evb_enable;
    prog_soc_prop->fcoe_enable = SOC_DPP_CONFIG(unit)->pp.fcoe_enable;
    prog_soc_prop->ipv4mc_bidir_enable = SOC_DPP_CONFIG(unit)->l3.nof_rps != 0;
    prog_soc_prop->mim_enable = SOC_DPP_CONFIG(unit)->arad->pp_op_mode.mim_enable;
    prog_soc_prop->eli_enable = SOC_DPP_CONFIG(unit)->pp.mpls_eli_enable;
    prog_soc_prop->mpls_1_namespace = SOC_DPP_CONFIG(unit)->pp.mpls_namespaces[0];
    prog_soc_prop->mpls_2_namespace = SOC_DPP_CONFIG(unit)->pp.mpls_namespaces[1];
    prog_soc_prop->mpls_3_namespace = SOC_DPP_CONFIG(unit)->pp.mpls_namespaces[2];
    prog_soc_prop->mpls_1_database  = SOC_DPP_CONFIG(unit)->pp.mpls_databases[0];
    prog_soc_prop->mpls_2_database  = SOC_DPP_CONFIG(unit)->pp.mpls_databases[1];
    prog_soc_prop->mpls_3_database  = SOC_DPP_CONFIG(unit)->pp.mpls_databases[2];
    prog_soc_prop->mpls_tp_mac_address = soc_property_get(unit, spn_MPLS_TP_MYMAC_RESERVED_ADDRESS, 0);
    prog_soc_prop->trill_disable_designated_vlan_check = soc_property_get(unit, spn_TRILL_DESIGNATED_VLAN_CHECK_DISABLE, 0);
    prog_soc_prop->designated_vlan_inlif_enable = SOC_DPP_CONFIG(unit)->trill.designated_vlan_inlif_enable;
    prog_soc_prop->q_in_q_ip_5_tuple = soc_property_get(unit, spn_VLAN_TRANSLATION_MATCH_IPV4, 0);
    prog_soc_prop->custom_feature_vt_tst1 = SOC_DPP_CONFIG(unit)->pp.custom_feature_vt_tst1;
    prog_soc_prop->custom_feature_vt_tst2 = SOC_DPP_CONFIG(unit)->pp.custom_feature_vt_tst2;
    prog_soc_prop->custom_feature_vrrp_scaling_tcam =  SOC_DPP_CONFIG(unit)->pp.custom_feature_vrrp_scaling_tcam;
    prog_soc_prop->vrrp_scaling_tcam =  SOC_DPP_CONFIG(unit)->pp.vrrp_scaling_tcam;
    prog_soc_prop->ingress_full_mymac_1 = SOC_DPP_CONFIG(unit)->pp.ingress_full_mymac_1;
    prog_soc_prop->tunnel_termination_in_tt_only = SOC_DPP_CONFIG(unit)->pp.tunnel_termination_in_tt_only; 
    prog_soc_prop->tunnel_termination_ordered_by_index   = SOC_DPP_CONFIG(unit)->pp.tunnel_termination_ordered_by_index; 
    prog_soc_prop->pwe_gal_support = SOC_DPP_CONFIG(unit)->pp.gal_support;
    prog_soc_prop->explicit_null_arad_plus_support = SOC_DPP_CONFIG(unit)->pp.explicit_null_support && SOC_IS_ARADPLUS_AND_BELOW(unit);
    prog_soc_prop->port_raw_mpls = soc_property_get(unit, spn_PORT_RAW_MPLS_ENABLE, 0); 
    prog_soc_prop->compression_spoof_ip6_enable = SOC_DPP_CONFIG(unit)->pp.compression_spoof_ip6_enable;
    prog_soc_prop->compression_ip6_enable = SOC_DPP_CONFIG(unit)->pp.compression_ip6_enable;
    prog_soc_prop->test1 = SOC_DPP_CONFIG(unit)->pp.test1;
    prog_soc_prop->extender_cb_enable = SOC_DPP_CONFIG(unit)->extender.port_extender_init_status;
    prog_soc_prop->evpn_enable = soc_property_get(unit, spn_EVPN_ENABLE, 0);
    prog_soc_prop->custom_pon_ipmc = SOC_DPP_CONFIG(unit)->pp.custom_pon_ipmc;
    prog_soc_prop->oam_enable = SOC_DPP_CONFIG(unit)->pp.oam_enable;
    prog_soc_prop->oam_statistics_enable = (SOC_DPP_CONFIG(unit)->pp.oam_statistics != 0) ? 1 : 0;
    if( soc_property_suffix_num_get(unit,-1,spn_CUSTOM_FEATURE,"section_oam_counter",0))	{
        prog_soc_prop->section_oam_enable = TRUE;
    }
    else {
        prog_soc_prop->section_oam_enable = FALSE;
    }
    is_g_prog_soc_prop_initilized[unit] = 1;
exit:

#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_programs_soc_properties_get()", 0, 0);    
}


uint32
  arad_pp_sem_key_extend(
     SOC_SAND_IN  int                        unit,
     SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY             *key,
     SOC_SAND_IN  uint32                              insert_index,
     SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_KEY             *extnd_key
  )
{
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  
  sal_memcpy(extnd_key,key, sizeof(ARAD_PP_ISEM_ACCESS_KEY));

  
  if (extnd_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID) {
    extnd_key->key_info.l2_eth.outer_dei = (insert_index) ? 1:0;
  }

  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_sem_key_extend()", 0, 0);
}


uint32
  arad_pp_isem_access_sem_tables_get(
    SOC_SAND_IN  int                                  unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY                 *isem_key,
    SOC_SAND_OUT uint32                                  *nof_tables,
    SOC_SAND_OUT uint32                                  *tables_access_ids,
    SOC_SAND_OUT uint8                                   *is_duplicate_entry
  )
{
  uint8
    found;
  SOC_PPC_MPLS_TERM_NAMESPACE_TYPE
    namespace = SOC_PPC_MPLS_TERM_NOF_NAMESPACE_TYPES;
  uint32
    res = 0;
  uint8
    vt_profile = 0;
  uint8
    is_trill = FALSE,
    pon_double_lookup_enable = FALSE;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);  

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]

  SOC_SAND_CHECK_NULL_INPUT(isem_key);
  SOC_SAND_CHECK_NULL_INPUT(nof_tables);
  SOC_SAND_CHECK_NULL_INPUT(tables_access_ids);
  SOC_SAND_CHECK_NULL_INPUT(is_duplicate_entry);

  
  found = FALSE;
  *nof_tables = 1;
  *is_duplicate_entry = 0;

  
  
  switch(isem_key->key_type)
  {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID:  
    found = TRUE;
    
    
    if (prog_soc_prop.match_port_vlan_critiria_64K) 
    {
      
      *nof_tables = 2;
      *is_duplicate_entry = 0;
    } 
    else if (prog_soc_prop.port_vlan_pcp_lookup) 
    {
      
      if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD || 
          isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID || 
          isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID)
      {
        tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      }
      if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID)
      {
        tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
      }
      if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID)
      {
        tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
      }
      if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID) {
        
        *nof_tables = 2;
        tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
        tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
        *is_duplicate_entry = 1;
      }
    }    
    else 
    {    
      
      
        res = 
        sw_state_access[unit].dpp.soc.arad.pp.vt_profile_info.vlan_translation_profile.get(unit, isem_key->key_info.l2_eth.vlan_domain, &vt_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

        
        if (prog_soc_prop.trill_mode) 
        {
          is_trill = (vt_profile == SOC_PPC_PORT_DEFINED_VT_PROFILE_TRILL || vt_profile == SOC_PPC_PORT_DEFINED_VT_PROFILE_TRILL_USE_INITIAL_VID);
        }
        else
        {
          is_trill = FALSE;
        }

      if (is_trill)
      {
          
        
        tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
      }
      else if (vt_profile == SOC_PPC_PORT_DEFINED_VT_PROFILE_DOUBLE_TAG_PRIORITY ||
               vt_profile == SOC_PPC_PORT_DEFINED_VT_PROFILE_DOUBLE_TAG_PRIORITY_INITIAL_VID)
      {
        
    	  if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 22) {
    		  tables_access_ids[0] = (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B:ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
    	  }
    	  else {
    	     tables_access_ids[0] = (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_A:ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
    	  }
      }
      else if (prog_soc_prop.fast_reroute_labels_enable &&
               (vt_profile == SOC_PPC_PORT_DEFINED_VT_PROFILE_FRR_COUPLING || vt_profile == SOC_PPC_PORT_DEFINED_VT_PROFILE_FRR_COUPLING_USE_INITIAL_VID)) 
      {
        tables_access_ids[0] = (prog_soc_prop.mpls_1_database == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B:ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      }
      else if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23)
      {
    	  tables_access_ids[0] = ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 20) || (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 22)) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_A:ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
      }
      
      else {
    	  tables_access_ids[0] = (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID) ? prog_soc_prop.mpls_1_database:
                               (prog_soc_prop.mpls_1_database == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B:ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
           }
    }
    
    break;
  default:
    break;
  }
  

  
  if (SOC_IS_ARADPLUS_A0(unit) && SOC_DPP_CONFIG(unit)->pp.oam_statistics) {
	  switch (isem_key->key_type) {
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_TT:
		  found = TRUE;
		  
		  *nof_tables = 2;
		  tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
		  tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
		  *is_duplicate_entry = 1;
		  break;
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_VT:
		  found = TRUE;
		  *nof_tables = 1;
		  tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
		  break;
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_VT:
		  found = TRUE;
		  *nof_tables = 1;
		  tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
		  break;
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISA:
		  found = TRUE;
		  *nof_tables = 1;
		  tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
		  break;
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISB:
		  found = TRUE;
		  *nof_tables = 1;
		  tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
		  break;
	  default:
		  break;
	  }
	  
  }
 

  
  switch (isem_key->key_type) {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID:
    found = TRUE;
    
    if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID)
    {
      if (!prog_soc_prop.use_pon_tcam_lkup && !SOC_DPP_CONFIG_CUSTOM_PP_PORT_IS_VENDOR2()) 
      {
        SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR, 40, exit);
      }

      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
    }
    else if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL) 
    {
      
      tables_access_ids[0] = (isem_key->key_info.l2_pon.flags & ARAD_PP_ISEM_ACCESS_L2_PON_TLS) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B:ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
    }
    else if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID) 
    {
      
      tables_access_ids[0] = (prog_soc_prop.custom_pon_enable ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B:ARAD_PP_ISEM_ACCESS_ID_ISEM_A);
    }
    else 
    {
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gpon_application_enable", 0)) {
          *nof_tables = 2;
	  tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
	  tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
	  *is_duplicate_entry = 0;
      } else {
          ARAD_PP_PON_DOUBLE_LOOKUP_VD_GET(isem_key->key_info.l2_eth.vlan_domain, pon_double_lookup_enable);

      
      if (pon_double_lookup_enable)
      {
        if (SOC_IS_ARADPLUS(unit) && prog_soc_prop.custom_pon_enable) {
          tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;  
        } else {
          
          *nof_tables = 2;
          tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
          tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
          *is_duplicate_entry = 1;
        }
      }
      else
      {
        
        tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      }     
      }
    }
  default:
    
    break;
  }
  
  
  
  switch (isem_key->key_type) {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID:
    found = TRUE;
    tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
    break;

  default:
    
    break;
  }
  
  
  
  
  
  
  
  switch(isem_key->key_type)
  {
  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1: 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_ELI:  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_ELI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF_ELI:
      found = TRUE;
      if(isem_key->key_info.mpls.flags == SOC_PPC_MPLS_TERM_FLAG_DUMMY_LABEL)
      {
          tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      }else{
          tables_access_ids[0] = prog_soc_prop.mpls_1_database; 
      }
      break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2_ELI: 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_PWE_L2_GAL:
    res = arad_pp_vtt_find_namespace_database(unit, SOC_PPC_MPLS_TERM_NAMESPACE_L2,
                                        prog_soc_prop.mpls_1_database, prog_soc_prop.mpls_1_namespace,
                                        prog_soc_prop.mpls_2_database, prog_soc_prop.mpls_2_namespace,
                                        prog_soc_prop.mpls_3_database, prog_soc_prop.mpls_3_namespace,
                                        &namespace,
                                        &tables_access_ids[0]);
    SOC_SAND_CHECK_FUNC_RESULT(res, 900, exit);
        
    found = TRUE;    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:
    found = TRUE;
    res = arad_pp_vtt_find_namespace_database(unit, SOC_PPC_MPLS_TERM_NAMESPACE_L3,
                                        prog_soc_prop.mpls_1_database, prog_soc_prop.mpls_1_namespace,
                                        prog_soc_prop.mpls_2_database, prog_soc_prop.mpls_2_namespace,
                                        prog_soc_prop.mpls_3_database, prog_soc_prop.mpls_3_namespace,
                                        &namespace,
                                        &tables_access_ids[0]);
    SOC_SAND_CHECK_FUNC_RESULT(res, 900, exit);    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VLAN_DOMAIN_MPLS:
    found = TRUE;
    *nof_tables = 1;
	tables_access_ids[0] = prog_soc_prop.mpls_1_database; 
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0:
    	found = TRUE;
    	if((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 20) || (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 22)) {
    	     
    	     *nof_tables = 2;
    	     tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
    	     tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
    	     *is_duplicate_entry = 1;
        }
    	else {
          if ((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 21) || (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 23)) {
      	     
       	     *nof_tables = 2;
       	     tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
       	     tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
       	     *is_duplicate_entry = 1;
    	   }
          else {
             *nof_tables = 1;
             tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
          }
    	}
        break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_L4B_L5G:
     	found = TRUE;
     	if((SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 20) || (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode == 21)) {
     	     *nof_tables = 1;
     	     tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
         }
         break;
  default:
    
    break;
  }
  
  
  
  
  if (!found)
  {
    *is_duplicate_entry = 0;
    
    switch (isem_key->key_type)
    {
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NICK:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_RPA:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_DOUBLE_TAG:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_DOUBLE_TAG:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_INITIAL_TAG:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_UNTAG:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF:
      
      *nof_tables = 1;
      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      found = TRUE;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PBB:
      
      *nof_tables = 1;
      tables_access_ids[0] = (isem_key->key_info.pbb.bsa_nickname_valid) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B : ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      found = TRUE;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER:
     
      *nof_tables = 2;      
      found = TRUE;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_GRE:    
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VNI:        
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV4:    
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_SINGLE_TAG:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_COMPRESSED_TAG:
      
      *nof_tables = 1;
      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
      if ((isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI) &&
          ((isem_key->key_info.trill.flags & ARAD_PP_ISEM_ACCESS_TRILL_VSI_TTS) != 0)) {
          tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
      }
      found = TRUE;
      break;    
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6:    
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_EoIP:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP:  
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE:  
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL:
      
      *nof_tables = 1;
      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
      found = TRUE;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_DIP: 
      *nof_tables = 1;
      tables_access_ids[0] = (prog_soc_prop.mpls_1_database == ARAD_PP_ISEM_ACCESS_ID_ISEM_B) ? ARAD_PP_ISEM_ACCESS_ID_ISEM_B:ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
      found = TRUE;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_DESIGNATED_VID:
      found = TRUE;
        
      
      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION:
      
      *nof_tables = 1;
      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
      found = TRUE;
      break;

    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION:
      
      *nof_tables = 1;
      tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_TCAM;
      found = TRUE;
      break;
    default:
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR, 60, exit);
      break;
    }
  }
  
  if ((*nof_tables) == 2 && !(*is_duplicate_entry))
  {
     
    tables_access_ids[0] = ARAD_PP_ISEM_ACCESS_ID_ISEM_A;
    tables_access_ids[1] = ARAD_PP_ISEM_ACCESS_ID_ISEM_B;
  }

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_sem_tables_get()", 0, 0);
}

STATIC
uint32
  arad_pp_isem_access_key_type_to_prefix(
    SOC_SAND_IN int                                  unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY_TYPE           isem_key_in,
    SOC_SAND_IN  uint32                                 table_access_id,
    SOC_SAND_OUT uint32                                 *isem_prefix    
  )
{
  uint32
    res = SOC_SAND_OK;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  *isem_prefix = ARAD_PP_ISEM_ACCESS_NULL_PREFIX;

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]
  
  switch(isem_key_in)
  {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD:    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_BRIDGE_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS: 
    *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_UNINDEXED_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0:
	if(SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23) {
	    *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_L1L2_PREFIX;
	  }
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1:     
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF:
    *isem_prefix = (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1_L3) ? ARAD_PP_ISEM_ACCESS_MPLS_L1L3_PREFIX:
        ARAD_PP_ISEM_ACCESS_MPLS_L1_PREFIX ;
    break;         
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_ELI:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_ELI_UNINDEXED_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_ELI:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_L1ELI_PREFIX ;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2_ELI:
    *isem_prefix = (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1_L2) ? ARAD_PP_ISEM_ACCESS_MPLS_L1L2ELI_PREFIX:ARAD_PP_ISEM_ACCESS_MPLS_L2ELI_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:
    *isem_prefix = (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1_L2) ? ARAD_PP_ISEM_ACCESS_MPLS_L1L2_PREFIX:ARAD_PP_ISEM_ACCESS_MPLS_L2_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:
    *isem_prefix = (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1_L3) ? ARAD_PP_ISEM_ACCESS_MPLS_L1L3_PREFIX:ARAD_PP_ISEM_ACCESS_MPLS_L3_PREFIX;
    break;  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PBB:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_ISID_DOMAIN_ISID_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_DIP:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_IP_PREFIX;
    break;  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_OVERLAY_SIP_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NICK:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_TRILL_NICK_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL:
    *isem_prefix = (table_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ARAD_PP_ISEM_ACCESS_PON_UNTAGGED_PREFIX:ARAD_PP_ISEM_ACCESS_PON_TLS_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_PON_ONE_TAG_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_TRILL_FINE_A_GRAINED_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_INNER_TPID_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_RPA:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_RPA_ID_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_DOUBLE_TAG:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_FLEXIBLE_Q_IN_Q_DOUBLE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_SINGLE_TAG:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_FLEXIBLE_Q_IN_Q_SINGLE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_DOUBLE_TAG:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_INITIAL_TAG:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_UNTAG:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_BRIDGE_DT;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_COMPRESSED_TAG:  
    *isem_prefix = ARAD_PP_ISEM_ACCESS_BRIDGE_ST;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:
    *isem_prefix = prog_soc_prop.pon_enable ? ARAD_PP_ISEM_ACCESS_PON_VD_OUTER_PCP_PREFIX:ARAD_PP_ISEM_ACCESS_VD_OUTER_PCP_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV4: 
    *isem_prefix = ARAD_PP_ISEM_ACCESS_IPV4_SPOOF_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE:  
    *isem_prefix = ARAD_PP_ISEM_ACCESS_FC_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_GRE:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VNI:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_IP_VSI_PREFIX;
    break;  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_TRILL_VSI_PREFIX;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_DESIGNATED_VID:
    *isem_prefix = ARAD_PP_ISEM_ACCESS_TRILL_DESIGNATED_VID_PREFIX;
    break;  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_PWE_L2_GAL:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_PWE_GAL;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_TT:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_OAM_STAT_TT_PREFIX;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_VT:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_OAM_STAT_VT_PREFIX;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_VT:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_BFD_STAT_VT_PREFIX;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISA:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_BFD_STAT_TT_ISA_PREFIX;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISB:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_BFD_STAT_TT_ISB_PREFIX;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF:
      *isem_prefix = ARAD_PP_ISEM_ACCESS_VTEP_INDEX_SIP_VRF_MY_PREFIX;
      break; 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VLAN_DOMAIN_MPLS:
      *isem_prefix = ARAD_PP_ISEM_ACCESS_VLAN_DOMAIN_MPLS_PREFIX;
      break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2TP_TUNNEL_SESSION:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_L2TP_PREFIX;
	  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PPPOE_SESSION:
	  *isem_prefix = ARAD_PP_ISEM_ACCESS_PPPOE_PREFIX;
	  break;
  default:
    break;
  }


  if (SOC_DPP_CONFIG(unit)->pp.vtt_pwe_vid_search) {
	  switch (isem_key_in) {
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1:
		  *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_L1_PREFIX_4bit;
		  break;
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:
		  *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_L2_PREFIX_4bit;
		  break;
	  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:
		  *isem_prefix = ARAD_PP_ISEM_ACCESS_MPLS_L3_PREFIX_4bit;
		  break;
	  default:
		  break;
	  }
  }

  
  if (_BCM_PPD_PON_PP_PORT_MAPPING_BY_PASS_IN_JER(unit)) {
	  switch (*isem_prefix) {
	  case ARAD_PP_ISEM_ACCESS_PON_UNTAGGED_PREFIX:
	  case ARAD_PP_ISEM_ACCESS_PON_ONE_TAG_PREFIX:
	  case ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX:
      case ARAD_PP_ISEM_ACCESS_PON_VD_OUTER_PCP_PREFIX:
          *isem_prefix = (*isem_prefix << 2);
		  break;
	  default:
		  break;
	  }
  }

  ARAD_DO_NOTHING_AND_EXIT;

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_key_type_to_prefix()", 0, 0);    
}

uint32
  arad_pp_isem_access_prefix_to_key_type(
    SOC_SAND_IN int                                  unit,
    SOC_SAND_IN uint32                                  isem_prefix,
    SOC_SAND_IN uint32                                  lookup_num,
    SOC_SAND_IN uint32                                  tables_access_id,
    SOC_SAND_IN uint32                                  *buffer,
    SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_KEY_TYPE           *isem_key_in
  )
{
  uint32
    res = SOC_SAND_OK,
    two_bits_indicate = 0;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]

  
  *isem_key_in = ARAD_PP_ISEM_ACCESS_NOF_KEY_TYPES;
  
  if (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A || tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_B)
  {

    
    if (prog_soc_prop.pon_enable && (!prog_soc_prop.custom_pon_enable) && tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A && 
        ((isem_prefix >> (4 - ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX_NOF_BITS) == (ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX >> (4-ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX_NOF_BITS))))) 
    {
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID;
    }
    else if (prog_soc_prop.pon_enable && prog_soc_prop.custom_pon_enable && tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_B && 
        ((isem_prefix >> (4 - ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX_NOF_BITS) == (ARAD_PP_ISEM_ACCESS_CUS_PON_TWO_TAGS_PREFIX >> (4-ARAD_PP_ISEM_ACCESS_PON_TWO_TAGS_PREFIX_NOF_BITS))))) 
    {
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID;
    }
    else if (prog_soc_prop.pon_enable && tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_B &&
             ((isem_prefix >> (3) == (ARAD_PP_ISEM_ACCESS_IPV4_SPOOF_PREFIX >> (3)))))
    {
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV4;
    }
    else if(prog_soc_prop.custom_feature_vt_tst2 && lookup_num == 0)
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_AC_TST2;
    else
    {
      switch(isem_prefix)
      {
      case ARAD_PP_ISEM_ACCESS_BRIDGE_PREFIX:     
        {        
          
          
          res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_NOF_BITS, &two_bits_indicate);
          SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);

          switch (two_bits_indicate)
          {
          case ARAD_PP_ISEM_ACCESS_KEY_2BITS_INITIAL_VID:
            *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID;
            break;
          case ARAD_PP_ISEM_ACCESS_KEY_2BITS_OUTER_VID:
            *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID;
            break;
          case ARAD_PP_ISEM_ACCESS_KEY_2BITS_DOUBLE_TAG:
            *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID;
            break;
          default: 
            SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR, 100, exit); 
          }
        }
        break;
      case ARAD_PP_ISEM_ACCESS_IP_PREFIX:        
        if (prog_soc_prop.pon_enable)
        {
          *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL;
        }
        else
        {
          *isem_key_in = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_B) ? ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_DIP:ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP;
        }
        break;
      case ARAD_PP_ISEM_ACCESS_ISID_DOMAIN_ISID_PREFIX: 
        if (prog_soc_prop.pon_enable)
        {
          *isem_key_in = ARAD_PP_ISEM_ACCESS_PON_VD_OUTER_PCP_PREFIX;  
        }
        else
        {
			*isem_key_in = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ARAD_PP_ISEM_ACCESS_KEY_TYPE_PBB : ((prog_soc_prop.trill_mode == 2 ) ? ARAD_PP_ISEM_ACCESS_TRILL_VSI_PREFIX : ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE);
		}
		break;
		
		case ARAD_PP_ISEM_ACCESS_TRILL_FINE_A_GRAINED_PREFIX:
			*isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER;
		break;
		case ARAD_PP_ISEM_ACCESS_VD_OUTER_PCP_PREFIX:
			*isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID;  
        break;          
        
      case ARAD_PP_ISEM_ACCESS_MPLS_UNINDEXED_PREFIX: 
        if (prog_soc_prop.mpls_index) 
        {
          if (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1_L3) 
          {
            if (prog_soc_prop.mpls_1_database == tables_access_id)
            {
              
              *isem_key_in = (prog_soc_prop.mpls_use_in_rif) ? ((lookup_num == 0 ) ? 
                                                                ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1):
                                                               ((lookup_num == 0 ) ? 
                                                                ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1:ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3);
            }
            else
            {
              *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2;
            }
          }
          else
          {
            *isem_key_in = (prog_soc_prop.mpls_2_database == tables_access_id) ? ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3;  
          }
        } else {
          
          *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS;
        }          
        break;
      case ARAD_PP_ISEM_ACCESS_MPLS_ELI_UNINDEXED_PREFIX: 
        if (prog_soc_prop.mpls_index) 
        {
          *isem_key_in = (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1) ? ARAD_PP_ISEM_ACCESS_MPLS_L1_PREFIX:ARAD_PP_ISEM_ACCESS_MPLS_L1L2_PREFIX;
        }
        else
        {
          *isem_key_in = ARAD_PP_ISEM_ACCESS_MPLS_ELI_UNINDEXED_PREFIX;
        }        
        break;
      case ARAD_PP_ISEM_ACCESS_MPLS_L2ELI_PREFIX:       
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2_ELI;
        break;
      case ARAD_PP_ISEM_ACCESS_MPLS_L1ELI_PREFIX:           
        *isem_key_in = (prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1) ? ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_ELI:
                       ((prog_soc_prop.mpls_1_namespace == SOC_PPC_MPLS_TERM_NAMESPACE_L1_L2 && lookup_num == 0 ) ? 
                        ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_ELI:ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2_ELI);
        break;
      case ARAD_PP_ISEM_ACCESS_INNER_TPID_PREFIX:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID;
        break;
      case ARAD_PP_ISEM_ACCESS_RPA_ID_PREFIX:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_RPA;
        break;
      case ARAD_PP_ISEM_ACCESS_TRILL_NICK_PREFIX: 
        if (prog_soc_prop.pwe_gal_support) 
        {
          *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_PWE_L2_GAL;                       
        } 
        else 
        {
          *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NICK; 
        }
        break;
      case ARAD_PP_ISEM_ACCESS_IP_VSI_PREFIX:
        *isem_key_in = (prog_soc_prop.vxlan_enable ? ARAD_PP_ISEM_ACCESS_KEY_TYPE_VNI:ARAD_PP_ISEM_ACCESS_KEY_TYPE_GRE);    
        break;      
      case ARAD_PP_ISEM_ACCESS_TRILL_DESIGNATED_VID_PREFIX:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_DESIGNATED_VID;
        break;
      case ARAD_PP_ISEM_ACCESS_FLEXIBLE_Q_IN_Q_DOUBLE: 
        if (prog_soc_prop.pon_enable)
        {
          *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID;
        }
        else if (prog_soc_prop.custom_feature_vt_tst1) {          
          *isem_key_in = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? 
              ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_DOUBLE_TAG:ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_COMPRESSED_TAG;

          if (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) {
              
              
              res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_NOF_BITS, &two_bits_indicate);
              SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);
              if (two_bits_indicate) {
                  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_NOF_BITS, &two_bits_indicate);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);
                  *isem_key_in = (two_bits_indicate) ? ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_UNTAG : ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_INITIAL_TAG; 
              }              
          }
        }
        else
        {
				*isem_key_in = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ?
					ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_DOUBLE_TAG : ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_SINGLE_TAG;
			}
			break;
		  case ARAD_PP_ISEM_ACCESS_VLAN_DOMAIN_MPLS_PREFIX:
			  *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VLAN_DOMAIN_MPLS;
			  break;
		default: 
			SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR, 100, exit);
			break;
		}
	}
	if (SOC_IS_ARADPLUS_A0(unit) && SOC_DPP_CONFIG(unit)->pp.oam_statistics) {
		switch (isem_prefix) {
		case ARAD_PP_ISEM_ACCESS_OAM_STAT_TT_PREFIX:
			*isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_TT;
			break; 
		  case ARAD_PP_ISEM_ACCESS_OAM_STAT_VT_PREFIX:
			  *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_VT;
			  break;
		  case ARAD_PP_ISEM_ACCESS_BFD_STAT_VT_PREFIX:
			  *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_VT;
			  break;
		  case ARAD_PP_ISEM_ACCESS_BFD_STAT_TT_ISA_PREFIX:
			  *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISA;
			  break;
		  case ARAD_PP_ISEM_ACCESS_BFD_STAT_TT_ISB_PREFIX:
			  *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISB;
			  break;
		  default:
			  break;
		  }
	  }
  }
  else
  {
    switch(isem_prefix) 
    {
    case ARAD_PP_ISEM_ACCESS_TCAM_MPLS_FRR_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_ETH_INNER_OUTER_PCP_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_SPOOF_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV4_TT_ETH_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_TT_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_VT_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_TT_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_TT_DB_PROFILE: 
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_CASCADE_VT_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_PON_EXTEND_LKP_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_DOU_TAGS_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_TT_TRILL_TRANSPARENT_SERVICE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_MPLS_EXPLICIT_NULL_VT_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_TT_DIP_COMPRESSION_DB_PROFILE:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_TT_IPV6_SPOOF_COMPRESSION:
      *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION;
      break;
    case ARAD_PP_ISEM_ACCESS_TCAM_TST2_PROFILE:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST2_TCAM;
        break;
    case ARAD_PP_ISEM_ACCESS_TCAM_VRRP_VSI_DA_PROFILE:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_VSI_DA_DB_VRRP_TCAM;
        break;
    case ARAD_PP_ISEM_ACCESS_TCAM_SRC_PORT_DA_DB_PROFILE:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_SRC_PORT_DA_DB_TCAM;
        break;
    case ARAD_PP_ISEM_ACCESS_TCAM_CUSTOM_PP_LSP_ECMP_PROFILE:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_CUSTOM_PP_LSP_ECMP;
        break;
    case ARAD_PP_ISEM_ACCESS_TCAM_DIP_SIP_VRF_PROFILE:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF;
        break;
    case ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE:
        *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0;
        break;
    case ARAD_PP_ISEM_ACCESS_TCAM_L4B_L5L_PROFILE:
         *isem_key_in = ARAD_PP_ISEM_ACCESS_KEY_TYPE_L4B_L5G;
         break;
    default: 
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR, 100, exit);
    }
  }
  
  ARAD_DO_NOTHING_AND_EXIT;

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_prefix_to_key_type()", isem_prefix, tables_access_id);    
}

uint32
  arad_pp_isem_access_key_to_buffer(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY                *isem_key_in,
    SOC_SAND_IN  uint32                                 table_access_id,
    SOC_SAND_IN  uint32                                 insert_index, 
    SOC_SAND_OUT uint32                                 *buffer
  )
{
  uint32
    res = SOC_SAND_OK,
    tmp;
  uint32
    prefix,clean_prefix=0;
  ARAD_PP_ISEM_ACCESS_KEY
    *isem_key, isem_key_s;
  SOC_PPC_PORT_INFO
    port_info;
  uint32
    mac_U32[SOC_SAND_PP_MAC_ADDRESS_NOF_UINT32S] = {0};
  uint32 ip6_address[SOC_SAND_PP_IPV6_ADDRESS_NOF_UINT32S] = {0};
  uint32 label_offset = 0, label_nof_bits = 0;
  uint32 is_bos = 0;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  
  ARAD_PP_CLEAR(buffer, uint32, ARAD_PP_ISEM_ACCESS_KEY_SIZE);  

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]

  isem_key = &isem_key_s;

  res = arad_pp_sem_key_extend(unit,isem_key_in,insert_index,isem_key);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  
  if (table_access_id != ARAD_PP_ISEM_ACCESS_ID_TCAM) {
      res = arad_pp_isem_access_key_type_to_prefix(unit,isem_key_in->key_type,table_access_id,&prefix);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

      res = soc_sand_bitstream_set_any_field(&prefix, ARAD_PP_ISEM_ACCESS_LSB_PREFIX, ARAD_PP_ISEM_ACCESS_NOF_BITS_PREFIX, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 32, exit);
  } else {      
      uint8 prefix_fixed[ARAD_PP_SW_DB_HASH_KEY_TABLE_PART_LEN_BYTES] = {0};      

      
      prefix = arad_pp_isem_access_tcam_db_id_get(isem_key->key_type);

      
      res = soc_sand_U32_to_U8(&prefix, ARAD_PP_SW_DB_HASH_KEY_TABLE_PART_LEN_BYTES, prefix_fixed);
      
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
      sal_memcpy(&(prefix), prefix_fixed, 4);

      res = soc_sand_bitstream_set_any_field(&prefix, (ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES*2)*8, ARAD_PP_SW_DB_HASH_KEY_TABLE_PART_LEN_BYTES*8, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 22, exit);
  }
  

  switch(isem_key->key_type)
  {
  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_ELI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2_ELI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_ELI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_PWE_L2_GAL:
      if (isem_key->key_info.mpls.flags & SOC_PPC_MPLS_TERM_FLAG_DUMMY_LABEL){
            
            tmp = 0x1FFFFF;
            res = soc_sand_bitstream_set_any_field(&tmp, 1, 21, buffer);
            SOC_SAND_CHECK_FUNC_RESULT(res, 56, exit);
            res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.is_bos), ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_NOF_BITS, buffer);
            SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);

      }
      else{
          
          if (prog_soc_prop.evpn_enable) {
              label_offset = ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_LSB;
              label_nof_bits = ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_NOF_BITS;
          } else {
              label_offset = ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_LSB(prog_soc_prop.is_bos_in_key_enable);
              label_nof_bits = ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_NOF_BITS(prog_soc_prop.is_bos_in_key_enable);
          }
	        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label, label_offset, label_nof_bits, buffer);
            SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);


            if (SOC_DPP_CONFIG(unit)->pp.vtt_pwe_vid_search)
            {
              
              switch (isem_key->key_type)
              {
              case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1:
              case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:
              case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:
                
                res = soc_sand_bitstream_set_any_field(&clean_prefix, 44, 6, buffer); 
                SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);

                res = soc_sand_bitstream_set_any_field(&prefix, 46, 4, buffer); 
                SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);

                
                res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label2, 20, 26, buffer);
                SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
              default:
                break;
              }
            }


            
            if (prog_soc_prop.evpn_enable)
            {
                uint32 is_bos = 0;
                
                if (isem_key->key_info.mpls.flags & SOC_PPC_MPLS_TERM_FLAG_EVPN_IML) {
                    is_bos = isem_key->key_info.mpls.is_bos;
                    
                }
                res = soc_sand_bitstream_set_any_field(&is_bos, ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_NOF_BITS, buffer);
                SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);
            } else if (prog_soc_prop.is_bos_in_key_enable) {
                res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.is_bos), ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_NOF_BITS, buffer);
                SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);
            }
      }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_TT:
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.cfm_eth_type, ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_LSB, ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_VT:
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.opaque, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_LSB, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.pph_type, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_LSB, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_VT:
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.opaque, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_LSB, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.pph_type, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_LSB, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISA:
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.bfd_format, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_LSB, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISB:
	   res = soc_sand_bitstream_set_any_field(&isem_key->key_info.oam_stat.bfd_format, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_LSB, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_NOF_BITS, buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 33, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF_ELI:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.in_rif, ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_LSB(prog_soc_prop.is_bos_in_key_enable) , ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_NOF_BITS(prog_soc_prop.is_bos_in_key_enable) , buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 37, exit);
    
    tmp = 1;
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_LSB(prog_soc_prop.is_bos_in_key_enable), ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_VALID_NOF_BITS(prog_soc_prop.is_bos_in_key_enable), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 38, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_LSB(prog_soc_prop.is_bos_in_key_enable), ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_NOF_BITS(prog_soc_prop.is_bos_in_key_enable), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 39, exit);    

    if (prog_soc_prop.is_bos_in_key_enable) 
    {
      res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.is_bos), ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);    
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 41, exit);    

    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label2, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 42, exit);    

    if (prog_soc_prop.is_bos_in_key_enable) 
    {
      res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.is_bos), ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 43, exit);    

    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_DESIGNATED_VID:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 44, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 46, exit);
    
    
    switch (isem_key->key_type)
    {
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_DESIGNATED_VID:
      tmp = ARAD_PP_ISEM_ACCESS_KEY_2BITS_INITIAL_VID;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:
      tmp = ARAD_PP_ISEM_ACCESS_KEY_2BITS_OUTER_VID;
      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
      tmp = ARAD_PP_ISEM_ACCESS_KEY_2BITS_DOUBLE_TAG;
      break;
    default:
      tmp = 0;
    }
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_2BITS_INDICATION_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 49, exit);    

    
    switch (isem_key->key_type)
    {
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 441, exit);
      break;    
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_pcp, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_PCP_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 447, exit);

      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_dei, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_OUTER_DEI_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 447, exit);
      break;
    default:
      break;
    }    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID:

      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 4444, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 4446, exit);

      tmp = ARAD_PP_ISEM_ACCESS_KEY_2BITS_DOUBLE_TAG;
      res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_2BITS_INDICATION_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 4449, exit);    

      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_pcp, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 443, exit);
      
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_dei, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 444, exit);

      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 445, exit);

      break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID:
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID:    
    {
      uint32 gpon_enable = 0;
      uint32 lsb;
      uint32 nof_bits;

      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gpon_application_enable", 0)) {
          gpon_enable = 1;
      }

      
      res = arad_pp_port_info_get_unsafe(unit, isem_key->key_info.l2_pon.core, isem_key->key_info.l2_pon.port, &port_info);
      SOC_SAND_CHECK_FUNC_RESULT(res, 5440, exit);

      lsb = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB);
      nof_bits = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS(unit));
      res = soc_sand_bitstream_set_any_field(&port_info.vlan_domain, lsb, nof_bits, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 5445, exit);

      lsb = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_LSB : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_LSB(unit));
      nof_bits = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS(unit));
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.tunnel_id, lsb, nof_bits, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 5450, exit);
      
      
      switch (isem_key->key_type)
      {
      case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID:
	lsb = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_LSB : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_LSB(unit));
	nof_bits = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS(unit));
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.outer_vid, lsb, nof_bits, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 5455, exit);
        break;    
      case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID:
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 5460, exit);

        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 5465, exit);
        break;      
      default:
        break;
      }       
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID:
      if (isem_key->key_info.l2_pon.port_valid) 
      {
        
        res = arad_pp_port_info_get_unsafe(unit, isem_key->key_info.l2_pon.core, isem_key->key_info.l2_pon.port, &port_info);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6440, exit);

        res = soc_sand_bitstream_set_any_field(&port_info.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6445, exit);
      }
      
      if (isem_key->key_info.l2_pon.tunnel_id_valid) 
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.tunnel_id, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6450, exit);
      }
      
      if (isem_key->key_info.l2_pon.outer_vid_valid) 
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6455, exit);      
      }
      
      if (isem_key->key_info.l2_pon.inner_vid_valid) 
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6460, exit);
      }

      if (isem_key->key_info.l2_pon.outer_pcp_valid) 
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.outer_pcp, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6465, exit);
      }

      if (isem_key->key_info.l2_pon.outer_dei_valid) 
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.outer_dei, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6470, exit);
      }

      if (isem_key->key_info.l2_pon.ether_type_valid) 
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_pon.ether_type, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6475, exit);
      }
    break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID:
        if (isem_key->key_info.section_oam.outer_vid_valid)
        {
          res = soc_sand_bitstream_set_any_field(&isem_key->key_info.section_oam.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_NOF_BITS(unit), buffer);
          SOC_SAND_CHECK_FUNC_RESULT(res, 6460, exit);
        }
        if (isem_key->key_info.section_oam.ether_type_valid)
        {
          res = soc_sand_bitstream_set_any_field(&isem_key->key_info.section_oam.ether_type, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_NOF_BITS(unit), buffer);
          SOC_SAND_CHECK_FUNC_RESULT(res, 6475, exit);
        }
        res = arad_pp_port_info_get_unsafe(unit, isem_key->key_info.section_oam.core, isem_key->key_info.section_oam.port, &port_info);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6440, exit);

        res = soc_sand_bitstream_set_any_field(&port_info.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6445, exit);
    break;
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID:
        if (isem_key->key_info.section_oam.outer_vid_valid)
        {
          res = soc_sand_bitstream_set_any_field(&isem_key->key_info.section_oam.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_NOF_BITS(unit), buffer);
          SOC_SAND_CHECK_FUNC_RESULT(res, 6460, exit);
        }
        if (isem_key->key_info.section_oam.inner_vid_valid)
        {
          res = soc_sand_bitstream_set_any_field(&isem_key->key_info.section_oam.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_NOF_BITS(unit), buffer);
          SOC_SAND_CHECK_FUNC_RESULT(res, 6460, exit);
        }
        if (isem_key->key_info.section_oam.ether_type_valid)
        {
          res = soc_sand_bitstream_set_any_field(&isem_key->key_info.section_oam.ether_type, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_NOF_BITS(unit), buffer);
          SOC_SAND_CHECK_FUNC_RESULT(res, 6475, exit);
        }
        res = arad_pp_port_info_get_unsafe(unit, isem_key->key_info.section_oam.core, isem_key->key_info.section_oam.port, &port_info);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6440, exit);

        res = soc_sand_bitstream_set_any_field(&port_info.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 6445, exit);
    break;
	
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PBB:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.pbb.isid_domain, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 52, exit);
    if (isem_key->key_info.pbb.bsa_nickname_valid){
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.pbb.bsa_nickname, ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_LSB, ARAD_PP_ISEM_ACCESS_KEY_PBB_BSA_NICKNAME_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 54, exit);
    }
    if (SOC_DPP_CONFIG(unit)->pp.test1 == 0 ){
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.pbb.isid, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 54, exit);
    } else {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.pbb.isid, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TEST1_ISID_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 54, exit);
    }

    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_DIP:
      if (isem_key->key_info.ip_tunnel.flags & SOC_PPC_RIF_IP_TERM_FLAG_USE_DIP_DUMMY) {
          if (isem_key->key_info.ip_tunnel.flags & SOC_PPC_RIF_IP_TERM_FLAG_IP_GRE_TUNNEL_IS_VALID && SOC_DPP_CONFIG(unit)->pp.custom_feature_ip_l3_gre_port_termination_lif_id) {
              
              tmp = 0xffffffff; 
              res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
              tmp = 0x2f; 
              res = soc_sand_bitstream_set_any_field(&tmp, 32, 8, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 56, exit);
          } else if (isem_key->key_info.ip_tunnel.flags & SOC_PPC_RIF_IP_TERM_FLAG_IP_GRE_TUNNEL_IS_VALID && SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id_gre) {
              
              tmp = 0xffffffff; 
              res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
              tmp = 0x0;
              res = soc_sand_bitstream_set_any_field(&tmp, 32, 2, buffer);
              tmp = 0x2f; 
              res = soc_sand_bitstream_set_any_field(&tmp, 34, 8, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 56, exit);
          } else if (SOC_DPP_CONFIG(unit)->pp.ip_lif_dummy_id_vxlan) {
              
              tmp = 0xffffffff; 
              res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
              tmp = 0x0;
              res = soc_sand_bitstream_set_any_field(&tmp, 32, 2, buffer);
              tmp = 0x11; 
              res = soc_sand_bitstream_set_any_field(&tmp, 34, 8, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 56, exit);
          } else {
              
              tmp = 0xFFFFFFFF;
              res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 56, exit);
              tmp = 0x1;
              res = soc_sand_bitstream_set_any_field(&tmp, 32, 1, buffer);
              SOC_SAND_CHECK_FUNC_RESULT(res, 57, exit);
          }
      } else if (isem_key->key_info.ip_tunnel.flags & SOC_PPC_RIF_IP_TERM_FLAG_USE_DIP_EXPLICIT_NULL_DUMMY) {
         
		 tmp = 0xFFFFFFFF;
		 res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, buffer);
		 SOC_SAND_CHECK_FUNC_RESULT(res, 56, exit);
		 tmp = 0x3;
		 res = soc_sand_bitstream_set_any_field(&tmp, 32, 2, buffer);
		 tmp = isem_key->key_info.mpls.ttl;
		 res = soc_sand_bitstream_set_any_field(&tmp, 34, 8, buffer);
		 SOC_SAND_CHECK_FUNC_RESULT(res, 57, exit);
	  } else {
	      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.dip, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, buffer);
	      SOC_SAND_CHECK_FUNC_RESULT(res, 58, exit);
      }
      break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP:       
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.sip, ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 59, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF:
    tmp = 1; 
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VT_LOOKUP_FOUND_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VT_LOOKUP_FOUND_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 810, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.my_vtep_index, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 811, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.sip, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 812, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 813, exit);
    break; 

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP:       
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.dip, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);

     res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.sip, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 62, exit);

    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.dip_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 63, exit);

    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.sip_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 61, exit);

    if (prog_soc_prop.ipv4_term_dip_sip_enable == 2 ) {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ipv4_next_protocol, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 362, exit);

        soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.port_property, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 364, exit);

        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 363, exit);
    }
  break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF:   
      
          
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.dip, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.sip, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 781, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 782, exit);
      
      tmp = (isem_key->key_info.ip_tunnel.vrf_prefix_len > 0);  
      res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 783, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ipv4_next_protocol, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 784, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.gre_ethertype, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 785, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ip_gre_tunnel, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 786, exit);
      
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.port_property, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 794, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.dip_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 787, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.sip_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 788, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 789, exit);

      
      if (isem_key->key_info.ip_tunnel.vrf_prefix_len > 0) { 
          
          tmp = 1;  
          res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_MASK_NOF_BITS(unit), buffer);
          SOC_SAND_CHECK_FUNC_RESULT(res, 790, exit);
      }

      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MASK_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 791, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.gre_ethertype_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MASK_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 792, exit);
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ip_gre_tunnel_en, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_MASK_NOF_BITS(unit), buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 793, exit);

      break; 

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP: 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE: 
    res = soc_sand_bitstream_set_any_field(isem_key->key_info.ip_tunnel.dip6.ipv6_address.address, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);
    if (prog_soc_prop.ipv6_term_dip_sip_enable) {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 61, exit);
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ip_gre_tunnel, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 62, exit);
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.qualifier_next_protocol, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 63, exit);
        
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.port_property, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 64, exit);
    }
    
    
    tmp = isem_key->key_info.ip_tunnel.dip6.prefix_len;
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);
    if (prog_soc_prop.ipv6_term_dip_sip_enable) {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 66, exit);
        tmp = isem_key->key_info.ip_tunnel.port_property_en;
        res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_NOF_BITS(unit), buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 67, exit);
    }
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP: 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE:
    res = soc_sand_bitstream_set_any_field(isem_key->key_info.ip_tunnel.dip6.ipv6_address.address, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.ipv4_next_protocol, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 71, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.qualifier_next_protocol, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 72, exit);
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP:       
    res = soc_sand_bitstream_set_any_field(isem_key->key_info.ip_tunnel.sip6.ipv6_address.address, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 81, exit);      
    tmp = 1; 
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 82, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.my_vtep_index, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 83, exit);
    
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.port_property, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 84, exit);

    
    tmp = isem_key->key_info.ip_tunnel.sip6.prefix_len;
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.ip_tunnel.vrf_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 86, exit);      
    
    tmp = isem_key->key_info.ip_tunnel.port_property_en;
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_NOF_BITS(unit), buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 87, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NICK:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.nick_name, ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 64, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.vsi, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 74, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.port, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 76, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.native_inner_tpid, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 78, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_GRE:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_gre.gre_key, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    tmp = ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_VAL;
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_FLAGS_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 81, exit);
    if (SOC_IS_L2GRE_VDC_ENABLE(unit)) {
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_gre.match_port_class, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 82, exit);
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VNI:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_vni.vni_key, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
    if (SOC_IS_VXLAN_VDC_ENABLE(unit)) {
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_vni.match_port_class, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 86, exit);
    }
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE:
    tmp = ARAD_PP_FRWRD_FCF_GET_DOMAIN(isem_key->key_info.fcoe.d_id);
    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 90, exit);

    isem_key->key_info.fcoe.vsan = isem_key->key_info.fcoe.vsan<<1;
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.fcoe.vsan, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 92, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV4:
    
       
    res = soc_sand_pp_mac_address_struct_to_long(
            &(isem_key->key_info.spoof_v4.smac),
            mac_U32
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);

    tmp = 0;
    res = soc_sand_bitstream_get_any_field(mac_U32, ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_SET_LSB, ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_NOF_BITS, &tmp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 192, exit);

    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 195, exit);

    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.spoof_v4.sip, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 200, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6:
    
       
    res = soc_sand_pp_mac_address_struct_to_long(
            &(isem_key->key_info.spoof_v6.smac),
            mac_U32
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);

    tmp = 0;
    res = soc_sand_bitstream_get_any_field(mac_U32, ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_SET_LSB, ARAD_PP_ISEM_ACCESS_KEY_SPOOF_SA_8MSB_NOF_BITS, &tmp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 292, exit);

    res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);

    res = soc_sand_bitstream_set_any_field(isem_key->key_info.spoof_v6.sip6.ipv6_address.address, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
    if ((isem_key->key_info.trill.flags & ARAD_PP_ISEM_ACCESS_TRILL_VSI_TTS) == 0) {
      tmp = 0;
      res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_ZEROS_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 500, exit); 
  
      
      if (isem_key->key_info.trill.flags & ARAD_PP_ISEM_ACCESS_TRILL_VSI_VL) {
          
          tmp = ARAD_PP_ISEM_ACCESS_KEY_2BITS_OUTER_VID;
      } else {
          
          tmp = ARAD_PP_ISEM_ACCESS_KEY_2BITS_DOUBLE_TAG;
      }
  
      res = soc_sand_bitstream_set_any_field(&tmp, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 510, exit); 
      
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.high_vid, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 520, exit); 
  
      if (isem_key->key_info.trill.flags & ARAD_PP_ISEM_ACCESS_TRILL_VSI_FGL)  
      {
        res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.low_vid, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_NOF_BITS, buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 530, exit); 
      }
    } else {
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.trill.high_vid, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_NOF_BITS, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 520, exit); 
    }      

    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_RPA:       
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.rpa.dip, ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 610, exit);

    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.rpa.vrf, ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_LSB, ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 620, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_SINGLE_TAG:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 710, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 720, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_DOUBLE_TAG:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 730, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 740, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 750, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_INITIAL_TAG:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_COMPRESSED_TAG:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_UNTAG:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.vlan_domain, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 710, exit);
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 720, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_DOUBLE_TAG:
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.vlan_domain,ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 730, exit);                                                                                                                
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.outer_vid, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 740, exit);                                                                                                                
    res = soc_sand_bitstream_set_any_field(&isem_key->key_info.l2_eth.inner_vid, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 750, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION:
    
    res = soc_sand_bitstream_get_any_field(isem_key->key_info.ip6_compression.ip6.ipv6_address.address, 56, 72, ip6_address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 760, exit);
    res = soc_sand_bitstream_set_any_field(ip6_address, 0, 72, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 761, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION:
    res = soc_sand_bitstream_get_any_field(isem_key->key_info.spoof_v6.sip6.ipv6_address.address, 64, 64, ip6_address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 770, exit);
    res = soc_sand_bitstream_set_any_field(ip6_address, 0, 64, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 771, exit);
    
    tmp = isem_key->key_info.spoof_v6.vsi;
    res = soc_sand_bitstream_set_any_field(&tmp, 64, 8, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 773, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VLAN_DOMAIN_MPLS:
    res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.vlan_domain), 0, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);
    res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.label), ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, 20, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 781, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_CUSTOM_PP_LSP_ECMP:
    res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.l2_pon.outer_pcp), 0, 32,buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);
    res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.l2_pon.tunnel_id), 32, 20, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 781, exit);
    res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.l2_pon.port), 51, 9, buffer);
    SOC_SAND_CHECK_FUNC_RESULT(res, 781, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0:
	  if (SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23) {
		  if (table_access_id != ARAD_PP_ISEM_ACCESS_ID_TCAM) {
	          if (prog_soc_prop.evpn_enable) {
	              label_offset = ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_LSB;
	              label_nof_bits = ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_NOF_BITS;
	              res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label, label_offset, label_nof_bits, buffer);
	              SOC_SAND_CHECK_FUNC_RESULT(res,777, exit);

	              
	              
	              if (isem_key->key_info.mpls.flags & SOC_PPC_MPLS_TERM_FLAG_EVPN_IML) {
	                  is_bos = isem_key->key_info.mpls.is_bos;
	                  
	              }
	              res = soc_sand_bitstream_set_any_field(&is_bos, ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_EVPN_LABEL_BOS_NOF_BITS, buffer);
	              SOC_SAND_CHECK_FUNC_RESULT(res,778, exit);

	          } else {
			  res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.label), 0, 20,buffer);
	          }
		  }
		  else {
			  res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.label), 12, 20,buffer);
		  }
	  }
	  else {
		    res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.label), 12, 20,buffer);
	  }
      SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_L4B_L5G:
      res = soc_sand_bitstream_set_any_field(&isem_key->key_info.mpls.label,12, 20, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 801, exit);
      res = soc_sand_bitstream_set_any_field(&(isem_key->key_info.mpls.is_bos), 32, 1, buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 800, exit);

    break;
  default:
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR, 100, exit);
    break;
  }

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_key_to_buffer()", 0, 0);
}

STATIC uint32
  arad_pp_isem_access_entry_to_buffer(
    SOC_SAND_IN  int                          unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_ENTRY   *isem_entry,
    SOC_SAND_OUT uint32                      *buffer
  )
{
  uint32 res = SOC_SAND_OK;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  
  ARAD_PP_CLEAR(buffer, uint32, SOC_DPP_DEFS_MAX(ISEM_PAYLOAD_NOF_UINT32));

  res = soc_sand_bitstream_set_any_field(&isem_entry->sem_result_ndx, 0 , SOC_DPP_DEFS_GET(unit, isem_payload_nof_bits), buffer);
  SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_entry_to_buffer()", 0, 0);
}

uint32
  arad_pp_isem_access_entry_from_buffer(
    SOC_SAND_IN  int                         unit,
    SOC_SAND_IN  uint32                     *buffer,
    SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_ENTRY  *isem_entry
  )
{
  uint32 res = SOC_SAND_OK;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  
  ARAD_PP_CLEAR(isem_entry, ARAD_PP_ISEM_ACCESS_ENTRY, 1);

  res = soc_sand_bitstream_get_any_field(buffer, 0 , SOC_DPP_DEFS_GET(unit, isem_payload_nof_bits), &isem_entry->sem_result_ndx);
  SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_entry_from_buffer()", 0, 0);
}

uint32
    arad_pp_isem_access_tcam_db_id_get(SOC_SAND_IN ARAD_PP_ISEM_ACCESS_KEY_TYPE key_type)
{
  uint32
    tcam_db_id;

  switch (key_type)
  {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR: 
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_MPLS_FRR_DB_PROFILE;
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_ETH_INNER_OUTER_PCP_DB_PROFILE;
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV6_SPOOF_DB_PROFILE;
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV4_TT_ETH_DB_PROFILE;
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_DIP_SIP_VRF_PROFILE; 
    break; 

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV6_TT_DB_PROFILE;
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_VT_DB_PROFILE;
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV6_CASCADE_TT_DB_PROFILE;
    break;
  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_TT_DB_PROFILE;
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV6_AFTER_RECYCLE_CASCADE_VT_DB_PROFILE;
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_PON_EXTEND_LKP_DB_PROFILE;
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_SECTION_OAM_DOU_TAGS_PROFILE;
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_TT_TRILL_TRANSPARENT_SERVICE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_MPLS_EXPLICIT_NULL_VT_DB_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_TT_DIP_COMPRESSION_DB_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_TT_IPV6_SPOOF_COMPRESSION;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST2_TCAM:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_TST2_PROFILE;
    break;
 case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TEST2_TCAM:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_TEST2_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SRC_PORT_DA_DB_TCAM:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_SRC_PORT_DA_DB_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV4_MATCH_VT_DB_PROFILE: 
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_IPV4_MATCH_VT_DB_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_EFP: 
    tcam_db_id = ARAD_PP_ISEM_ACCESS_VT_CLASSIFICATIONS_EFP;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VSI_DA_DB_VRRP_TCAM:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_VRRP_VSI_DA_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_CUSTOM_PP_LSP_ECMP:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_CUSTOM_PP_LSP_ECMP_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_MPLS_KEY_0_PROFILE;
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_L4B_L5G:
    tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_L4B_L5L_PROFILE;
    break;
  default:
    tcam_db_id = ARAD_TCAM_MAX_NOF_LISTS;
    break;
  }

  return tcam_db_id;
}


STATIC
uint32
  arad_pp_isem_access_tcam_isem_key_to_stream(
      SOC_SAND_IN  int                 unit,
      SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY  *key,
      SOC_SAND_OUT uint8                  stream[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES]
  )
{
  uint32
    long_stream[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES/4];
  uint32
    res;
  

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);


  res = SOC_SAND_OK; sal_memset(long_stream, 0x0, sizeof(uint32) * ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES/4);
  SOC_SAND_CHECK_FUNC_RESULT(res,  20, exit);

  switch(key->key_type)
  {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR: 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6:   
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_CUSTOM_PP_LSP_ECMP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_L4B_L5G:

      res = arad_pp_isem_access_key_to_buffer(unit, key, ARAD_PP_ISEM_ACCESS_ID_TCAM, 0, long_stream); 
      SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);     
      break;
  default:
      SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR, 80, exit);      
      break;
  }

  res = soc_sand_U32_to_U8(
          long_stream,
          ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES,
          stream
        );
  SOC_SAND_CHECK_FUNC_RESULT(res,  100, exit);

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_pp_isem_access_tcam_isem_key_to_stream()",0,0);
}

STATIC
  uint32
    arad_pp_isem_access_tcam_entry_mask_build(
      SOC_SAND_IN  int                    unit,
      SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY   *isem_key,
      SOC_SAND_OUT ARAD_TCAM_ENTRY           *entry
  )
{
  uint32
    res;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]

  switch(isem_key->key_type)
  {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP:
    
    soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MSB + 1 - isem_key->key_info.ip_tunnel.dip_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MSB); 
    
    soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MSB + 1 - isem_key->key_info.ip_tunnel.sip_prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MSB); 
    
    if (prog_soc_prop.ipv4_term_dip_sip_enable == 2)
    {
      soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_LSB, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_LSB+isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len-1); 
      if (isem_key->key_info.ip_tunnel.port_property_en) 
      {
        soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_LSB, 
                                         ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_LSB+ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_NOF_BITS-1); 
      }
      
    }
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF: 
      
      soc_sand_bitstream_set_bit_range(entry->mask, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MSB + 1 - isem_key->key_info.ip_tunnel.dip_prefix_len, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MSB); 
      
      soc_sand_bitstream_set_bit_range(entry->mask, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MSB + 1 - isem_key->key_info.ip_tunnel.sip_prefix_len, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MSB ); 
      
      soc_sand_bitstream_set_bit_range(entry->mask, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.vrf_prefix_len, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MSB(unit)); 
      
      if (isem_key->key_info.ip_tunnel.vrf_prefix_len > 0) {
          soc_sand_bitstream_set_bit_range(entry->mask, 
                                           ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_LSB(unit), 
                                           ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_VALID_LSB(unit)); 
      }
      
      soc_sand_bitstream_set_bit_range(entry->mask, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_PROTOCOL_MSB(unit)); 

      
      soc_sand_bitstream_set_bit_range(entry->mask, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.gre_ethertype_len, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_GRE_ETHERTYPE_MSB(unit)); 

      
      soc_sand_bitstream_set_bit_range(entry->mask, 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_LSB(unit), 
                                       ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_IP_GRE_TUNNEL_LSB(unit)); 

      
      if (isem_key->key_info.ip_tunnel.port_property_en) {
          soc_sand_bitstream_set_bit_range(entry->mask,
                                           ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_LSB(unit),
                                           ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_MSB(unit));
      }

      break; 

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE:
    
    soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.dip6.prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MSB(unit));      
    if (prog_soc_prop.ipv6_term_dip_sip_enable) {
        
        soc_sand_bitstream_set_bit_range(entry->mask, 
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.vrf_prefix_len, 
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MSB(unit));
        
        soc_sand_bitstream_set_bit_range(entry->mask, 
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_LSB(unit), 
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_MSB(unit)); 
        
        soc_sand_bitstream_set_bit_range(entry->mask, 
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.qualifier_next_protocol_prefix_len, 
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_MSB(unit)); 
        
        if (isem_key->key_info.ip_tunnel.port_property_en) {
            soc_sand_bitstream_set_bit_range(entry->mask,
                                             ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_LSB(unit),
                                             ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MSB(unit));
        }
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE:
    
    soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_MSB(unit));      
    
    soc_sand_bitstream_set_bit_range(entry->mask, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_MSB(unit)); 
  
    
    soc_sand_bitstream_set_bit_range(entry->mask, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.qualifier_next_protocol_prefix_len, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_MSB(unit)); 
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP:
    
    soc_sand_bitstream_set_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.sip6.prefix_len, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MSB(unit));     
    
    soc_sand_bitstream_set_bit_range(entry->mask, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MSB(unit) + 1 - isem_key->key_info.ip_tunnel.vrf_prefix_len, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MSB(unit));
    
    soc_sand_bitstream_set_bit_range(entry->mask, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_LSB(unit), 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VT_LOOKUP_FOUND_MSB(unit));
    
    soc_sand_bitstream_set_bit_range(entry->mask, 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_LSB(unit), 
                                     ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_MSB(unit));
    
    if (isem_key->key_info.ip_tunnel.port_property_en) {
        soc_sand_bitstream_set_bit_range(entry->mask,
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_LSB(unit),
                                         ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MSB(unit));
    } 
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 135);      
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID:
    
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119);      
    soc_sand_bitstream_reset_bit(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_DEI_LSB);      
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119);      
    
    soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_VID_MASK_BIT_START, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_VID_MASK_BIT_END);          
    soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_EXP_MASK_BIT_START, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_EXP_MASK_BIT_END);          
    soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_TTL_MASK_BIT_START, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_TTL_MASK_BIT_END);              

    if (!prog_soc_prop.is_bos_in_key_enable) {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_MASK_BIT_START, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_MASK_BIT_END);          
    }    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119);      
    
    if (!isem_key->key_info.l2_pon.port_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_MSB(unit));          
    }
    if (!isem_key->key_info.l2_pon.inner_vid_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_MSB(unit));          
    }
    if (!isem_key->key_info.l2_pon.outer_vid_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_MSB(unit));          
    }
    if (!isem_key->key_info.l2_pon.outer_dei_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_MSB(unit));          
    }
    if (!isem_key->key_info.l2_pon.outer_pcp_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_MSB(unit));          
    }
    if (!isem_key->key_info.l2_pon.tunnel_id_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_MSB(unit));          
    }
    if (!isem_key->key_info.l2_pon.ether_type_valid) 
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_MSB(unit));          
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119);  
    
    if (!isem_key->key_info.section_oam.outer_vid_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_MSB(unit));          
    }
    if (!isem_key->key_info.section_oam.ether_type_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_MSB(unit));          
    }
    if (!isem_key->key_info.section_oam.port_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_MSB(unit));          
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119); 
	
    if (!isem_key->key_info.section_oam.outer_vid_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_MSB(unit));  		
    }
    if (!isem_key->key_info.section_oam.inner_vid_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_MSB(unit)); 		 
    }
    if (!isem_key->key_info.section_oam.ether_type_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_MSB(unit));  		
    }
    if (!isem_key->key_info.section_oam.port_valid)
    {
      soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_MSB(unit));  		
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119);   
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 119);   
    soc_sand_bitstream_reset_bit_range(entry->mask, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_VID_MASK_BIT_START, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_VID_MASK_BIT_END);          
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 71);      
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION:
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 71);
    if (isem_key->key_info.spoof_v6.sip6.prefix_len && 
        (SOC_SAND_PP_IPV6_ADDRESS_NOF_BITS != isem_key->key_info.spoof_v6.sip6.prefix_len)) {
      soc_sand_bitstream_reset_bit_range(entry->mask, 0,  (isem_key->key_info.spoof_v6.sip6.prefix_len-1));
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_CUSTOM_PP_LSP_ECMP:
    
    soc_sand_bitstream_set_bit_range(entry->mask, 0, 16);
    soc_sand_bitstream_set_bit_range(entry->mask, 31, 31);
    soc_sand_bitstream_set_bit_range(entry->mask, 32, 60);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L0:
    soc_sand_bitstream_set_bit_range(entry->mask, 12, 31);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_L4B_L5G:
	  if (isem_key->key_info.mpls.is_bos)
	  {
		  soc_sand_bitstream_set_bit_range(entry->mask, 32, 32);  
	  }
	  else {
		  soc_sand_bitstream_set_bit_range(entry->mask, 12, 32);  
	  }
	  break;
  default:
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR, 80, exit);      
    break;
  }  

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_tcam_entry_mask_build()", 0, 0);
}

STATIC
uint32
  arad_pp_isem_access_tcam_isem_entry_from_action(
      SOC_SAND_IN  ARAD_TCAM_ACTION           *action,
      SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_ENTRY  *entry
  )
{
  uint32
    res;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS_NO_DEVID(0);

  res = SOC_SAND_OK;
  sal_memset(
          entry,
          0x0,
          sizeof(ARAD_PP_ISEM_ACCESS_ENTRY)
        );
  SOC_SAND_CHECK_FUNC_RESULT(res,  20, exit);

  entry->sem_result_ndx = action->value[0];

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_pp_isem_access_tcam_isem_entry_from_action()",0,0);
}

STATIC
uint32
  arad_pp_isem_access_tcam_entry_get_unsafe(
    SOC_SAND_IN  int               unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY *isem_key,
    SOC_SAND_IN  uint8               exact_match,
    SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_ENTRY *isem_entry,
    SOC_SAND_OUT uint8               *found
  )
{
  uint32
    res = SOC_SAND_OK,
    data_indx;
  uint8
      hit_bit,            
    stream[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES] = {0};
  uint32
    entry_id;
  SOC_SAND_HASH_TABLE_PTR
    hash_tbl;
  uint32
    tcam_db_id;
  uint32
    priority;
  ARAD_TCAM_ENTRY
    entry;
  ARAD_TCAM_ACTION
    action;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  SOC_SAND_CHECK_DRIVER_AND_DEVICE;

  ARAD_TCAM_ENTRY_clear(&entry);
  ARAD_TCAM_ACTION_clear(&action);
  
  tcam_db_id = arad_pp_isem_access_tcam_db_id_get(
                 isem_key->key_type
               );

  if (exact_match)
  {
    
    res = sw_state_access[unit].dpp.soc.arad.pp.vtt.isem_key_to_entry_id.get(
                 unit,
                 &hash_tbl
               );
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    res = arad_pp_isem_access_tcam_isem_key_to_stream(
                 unit,
                 isem_key,
                 stream
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
    res = soc_sand_hash_table_entry_lookup(
            unit,
            hash_tbl,
            stream,
            &data_indx,
            found
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
    entry_id = data_indx;
  }
  else
  {
    
    res = arad_pp_isem_access_tcam_isem_key_to_stream(
                 unit,
                 isem_key,
                 stream
               );
    SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);

    
    entry.valid = TRUE;

    
    
    res = soc_sand_U8_to_U32(
          stream,
          ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES,
          entry.value
        );
    SOC_SAND_CHECK_FUNC_RESULT(res,  15, exit);

    res = arad_pp_isem_access_tcam_entry_mask_build(
      unit,
      isem_key,
      &entry
    );
    SOC_SAND_CHECK_FUNC_RESULT(res,  20, exit);

    res = arad_tcam_db_entry_search_unsafe(
            unit,
            tcam_db_id,
            &entry,
            &entry_id,
            found
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  }

  if (*found)
  {
    res = arad_tcam_db_entry_get_unsafe(
            unit,
            tcam_db_id,
            entry_id,
            TRUE, 
            &priority,
            &entry,
            &action,
            found,
            &hit_bit
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);

    res = arad_pp_isem_access_tcam_isem_entry_from_action(
            &action,
            isem_entry
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 50, exit);
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_tcam_entry_get_unsafe()", 0, 0);
}



uint32 
    arad_pp_isem_access_isem_entry_get_unsafe(int unit, uint32 key_buffer[ARAD_PP_ISEM_ACCESS_KEY_SIZE], uint32 entry_buffer[SOC_DPP_DEFS_MAX(ISEM_PAYLOAD_NOF_UINT32)], uint32 tbl_access_id, uint8* success)
{
    uint32 res = SOC_SAND_OK;
#if defined(CRASH_RECOVERY_SUPPORT) || defined(USING_CHIP_SIM)
    uint32 access_addr; 
#endif

#ifndef USING_CHIP_SIM
    uint32      block_port_id, temp; 
    soc_field_t tmp_fld_name;
    uint64      key_buffer_64b;
    soc_reg_t   tmp_reg_name;
#endif

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);


#ifdef CRASH_RECOVERY_SUPPORT
       if (SOC_IS_DONE_INIT(unit))
        {
            if (BCM_UNIT_DO_HW_READ_WRITE(unit))
            {


                access_addr = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ARAD_CHIP_SIM_ISEM_A_BASE:ARAD_CHIP_SIM_ISEM_B_BASE;

                res = chip_sim_exact_match_entry_get_unsafe(
                        unit,
                        access_addr,
                        key_buffer,
                        ARAD_PP_ISEM_ACCESS_KEY_SIZE * sizeof(uint32),
                        entry_buffer,
                        SOC_DPP_DEFS_GET(unit, isem_payload_nof_uint32),
                        success
                      );
                SOC_SAND_CHECK_FUNC_RESULT(res, 17, exit);

                return SOC_SAND_OK;

            }
        }
#endif 

    #ifndef USING_CHIP_SIM
          COMPILER_64_SET(key_buffer_64b, key_buffer[1], key_buffer[0]);
          if(SOC_IS_QAX(unit))
          {
              block_port_id = REG_PORT_ANY;
              tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? PPDB_A_ISEM_DIAGNOSTICS_KEYr : PPDB_B_ISEM_DIAGNOSTICS_KEYr;
          } else {
              if (SOC_IS_JERICHO(unit)) {
                  block_port_id = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? 0 : 1 ;
                  tmp_reg_name = IHB_ISEM_DIAGNOSTICS_KEYr;
              } else {
                  block_port_id = REG_PORT_ANY;
                  tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? IHP_ISA_DIAGNOSTICS_KEYr: IHP_ISB_DIAGNOSTICS_KEYr;
              }
          }
          SOC_SAND_SOC_IF_ERROR_RETURN(res, 1120, exit, soc_reg_set(unit, tmp_reg_name, block_port_id, 0, key_buffer_64b));

          if(SOC_IS_QAX(unit))
          {
              tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_DIAGNOSTICSr : PPDB_B_ISEM_DIAGNOSTICSr;
              tmp_fld_name = ISEM_DIAGNOSTICS_LOOKUPf;
          } else
          {
              if (SOC_IS_JERICHO(unit)) {
                  tmp_reg_name = IHB_ISEM_DIAGNOSTICSr;
                  tmp_fld_name = ISEM_DIAGNOSTICS_LOOKUPf;
              } else {
                  tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? IHP_ISA_DIAGNOSTICSr:IHP_ISB_DIAGNOSTICSr;
                  tmp_fld_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ISA_DIAGNOSTICS_LOOKUPf:ISB_DIAGNOSTICS_LOOKUPf;
              }
          }
          
          SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name,  0x1));
          
          res = arad_polling(
                  unit,
                  ARAD_TIMEOUT,
                  ARAD_MIN_POLLS,
                  tmp_reg_name,
                  block_port_id,
                  0,
                  tmp_fld_name,
                  0
                );
          SOC_SAND_CHECK_FUNC_RESULT(res, 32, exit);
          
          temp = 0;
          
          if(SOC_IS_QAX(unit)){
              tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_DIAGNOSTICS_LOOKUP_RESULTr : PPDB_B_ISEM_DIAGNOSTICS_LOOKUP_RESULTr;
              tmp_fld_name = ISEM_ENTRY_FOUNDf;
          } else {
              if (SOC_IS_JERICHO(unit)) {
                  tmp_reg_name = IHB_ISEM_DIAGNOSTICS_LOOKUP_RESULTr;
                  tmp_fld_name = ISEM_ENTRY_FOUNDf;
              } else {
                  tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? IHP_ISA_DIAGNOSTICS_LOOKUP_RESULTr:IHP_ISB_DIAGNOSTICS_LOOKUP_RESULTr;
                  tmp_fld_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ISA_ENTRY_FOUNDf:ISB_ENTRY_FOUNDf;
              }
          }
          SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_read(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name, &temp));
          *success = SOC_SAND_NUM2BOOL(temp);
          
          if(SOC_IS_QAX(unit)){
              tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_DIAGNOSTICS_LOOKUP_RESULTr : PPDB_B_ISEM_DIAGNOSTICS_LOOKUP_RESULTr;
              tmp_fld_name = ISEM_ENTRY_PAYLOADf;
          } else {
              if (SOC_IS_JERICHO(unit)) {
                  tmp_reg_name = IHB_ISEM_DIAGNOSTICS_LOOKUP_RESULTr;
                  tmp_fld_name = ISEM_ENTRY_PAYLOADf;
              } else {
                  tmp_reg_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? IHP_ISA_DIAGNOSTICS_LOOKUP_RESULTr:IHP_ISB_DIAGNOSTICS_LOOKUP_RESULTr;
                  tmp_fld_name = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ISA_ENTRY_PAYLOADf:ISB_ENTRY_PAYLOADf;
              }
          }
          SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_read(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name, &entry_buffer[0]));
#else 
          access_addr = (tbl_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? \
            ARAD_CHIP_SIM_ISEM_A_BASE:ARAD_CHIP_SIM_ISEM_B_BASE;
          res = chip_sim_exact_match_entry_get_unsafe(
                  unit,
                  access_addr,
                  key_buffer,
                  ARAD_PP_ISEM_ACCESS_KEY_SIZE * sizeof(uint32),
                  entry_buffer,
                  SOC_DPP_DEFS_GET(unit, isem_payload_nof_uint32),
                  success
                );
          SOC_SAND_CHECK_FUNC_RESULT(res, 17, exit);
#endif

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_isem_entry_get_unsafe()", 0, 0);
}


uint32
  arad_pp_isem_access_entry_get_unsafe(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY    *isem_key,
    SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_ENTRY  *isem_entry,
    SOC_SAND_OUT uint8                      *success
  )
{
  uint32
    res = SOC_SAND_OK;
  uint32
    key_buffer[ARAD_PP_ISEM_ACCESS_KEY_SIZE];
  uint32
    entry_buffer[SOC_DPP_DEFS_MAX(ISEM_PAYLOAD_NOF_UINT32)];

  uint32
    nof_tables,
    tbl_access_idx,
    tables_access_ids[ARAD_PP_ISEM_ACCESS_NOF_TABLES];
  uint8
      is_duplicate_entry,
      found;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  SOC_SAND_CHECK_NULL_INPUT(isem_key);
  SOC_SAND_CHECK_NULL_INPUT(isem_entry);
  SOC_SAND_CHECK_NULL_INPUT(success);

  ARAD_CLEAR(isem_entry, uint32, SOC_DPP_DEFS_GET(unit, isem_payload_nof_uint32));

  sal_memset(entry_buffer, 0x0, sizeof(uint32));

  res = arad_pp_isem_access_sem_tables_get(unit, isem_key, &nof_tables, tables_access_ids,&is_duplicate_entry);
  SOC_SAND_CHECK_FUNC_RESULT(res, 19, exit);

  *success = FALSE;
  
  for (tbl_access_idx = 0; tbl_access_idx < nof_tables; tbl_access_idx++)
  {
    if (tbl_access_idx > 0 && *success == TRUE)
    {
      
      break;
    }

    if (tables_access_ids[tbl_access_idx] != ARAD_PP_ISEM_ACCESS_ID_TCAM) {

        res = arad_pp_isem_access_key_to_buffer(unit, isem_key, tables_access_ids[tbl_access_idx], tbl_access_idx, key_buffer);        
        SOC_SAND_CHECK_FUNC_RESULT(res, 22, exit);

        res = arad_pp_isem_access_isem_entry_get_unsafe(unit, key_buffer, entry_buffer, tables_access_ids[tbl_access_idx], success);
        SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
      
        res = arad_pp_isem_access_entry_from_buffer(unit, entry_buffer, isem_entry);
        SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
    }
    else
    {
      
      res = arad_pp_isem_access_tcam_entry_get_unsafe(unit,isem_key,TRUE,isem_entry,&found);
      SOC_SAND_CHECK_FUNC_RESULT(res, 19, exit);
      *success = SOC_SAND_NUM2BOOL(found);
    }
  }
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_entry_get_unsafe()", 0, 0);
}

uint32
  arad_pp_isem_access_isem_entry_add_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  uint32                                 *key_buffer,
    SOC_SAND_IN  uint32                                 *entry_buffer,
    SOC_SAND_IN  uint32                                 tables_access_id,
    SOC_SAND_OUT SOC_SAND_SUCCESS_FAILURE               *success
  )
{
  uint32
    res;
  uint32
    buffer[ARAD_PP_ISEM_ACCESS_ENTRY_REQ_SIZE];
  uint32
    temp,  
    access_addr;
#if SOC_DPP_IS_EM_HW_ENABLE
  uint32
    is_failed,
      block_id;    
  soc_mem_t
    tmp_mem_name;
  soc_reg_t
    tmp_reg_name;
  soc_field_t
    tmp_fld_name;
#endif
#if SOC_DPP_IS_EM_HW_ENABLE
  uint32
      reason,
      block_port_id;
#endif
  uint8 is_success = TRUE;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  ARAD_PP_CLEAR(buffer, uint32, ARAD_PP_ISEM_ACCESS_ENTRY_REQ_SIZE);

#if SOC_DPP_IS_EM_HW_ENABLE
  if (SOC_IS_JERICHO(unit)) {
      block_port_id = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? 0 : 1 ;
  } else {
      block_port_id = REG_PORT_ANY;
  }
  reason = 0;
#endif



  temp = ARAD_PP_ISEM_ACCESS_ACTION_TYPE_INSERT;
  res = SOC_SAND_OK;

  res = soc_sand_bitstream_set_any_field(
          &temp,
          ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_LSB,
          ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_MSB - ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_LSB + 1,
          buffer
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 22, exit);

  res = soc_sand_bitstream_set_any_field(
          key_buffer,
          ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_LSB,
          ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_MSB - ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_LSB + 1,
          buffer
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 27, exit);

  res = soc_sand_bitstream_set_any_field(
          entry_buffer,
          ARAD_PP_ISEM_ACCESS_ENTRY_REQ_PAYLOAD_LSB,
          ARAD_PP_ISEM_ACCESS_ENTRY_REQ_PAYLOAD_MSB - ARAD_PP_ISEM_ACCESS_ENTRY_REQ_PAYLOAD_LSB + 1,
          buffer
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 32, exit);
#if SOC_DPP_IS_EM_HW_ENABLE


      if (SOC_IS_QAX(unit)) {
          tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_INTERRUPT_REGISTER_ONEr : PPDB_B_ISEM_INTERRUPT_REGISTER_ONEr;
          tmp_fld_name = ISEM_MANAGEMENT_COMPLETEDf;
      } else {
          if (SOC_IS_JERICHO(unit)) {
              tmp_reg_name = IHB_ISEM_INTERRUPT_REGISTER_ONEr;
              tmp_fld_name = ISEM_MANAGEMENT_COMPLETEDf;
          } else {
              tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? IHP_ISA_INTERRUPT_REGISTER_ONEr:IHP_ISB_INTERRUPT_REGISTER_ONEr;
              tmp_fld_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ISA_MANAGEMENT_COMPLETEDf:ISB_MANAGEMENT_COMPLETEDf;
          }
      }

      if(SOC_IS_QAX(unit)) {
          block_id = MEM_BLOCK_ALL;
          tmp_mem_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_MANAGEMENT_REQUESTm : PPDB_B_ISEM_MANAGEMENT_REQUESTm ;
      } else {
          if(SOC_IS_JERICHO(unit)) {
              block_id =  IHB_BLOCK(unit, block_port_id);
              tmp_mem_name = IHB_ISEM_MANAGEMENT_REQUESTm;
          } else {
              block_id = MEM_BLOCK_ALL;
              tmp_mem_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? IHP_ISA_MANAGEMENT_REQUESTm: IHP_ISB_MANAGEMENT_REQUESTm;
          }
      }



      
      if (! SOC_IS_DONE_INIT(unit) &&  
#ifdef CRASH_RECOVERY_SUPPORT
          BCM_UNIT_DO_HW_READ_WRITE(unit)
#else
          (0)
#endif 
          )
      {
        SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  110,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_read(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name, &temp));
        if (temp)
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_NOT_READY_ERR, 120, exit);
        }
      }

      SOC_SAND_SOC_IF_ERROR_RETURN(res, 1230, exit, soc_mem_write(unit, tmp_mem_name, block_id, 0, buffer));

      res = arad_polling(
              unit,
              ARAD_TIMEOUT,
              ARAD_MIN_POLLS,
              tmp_reg_name,
              block_port_id,
              0,
              tmp_fld_name,
              1
            );
          SOC_SAND_CHECK_FUNC_RESULT(res, 32, exit);


      
temp = 1;


 {
     uint64 failure;

      SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  150,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name,  temp));

      if (SOC_IS_QAX(unit)) {
          tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_MANAGEMENT_UNIT_FAILUREr : PPDB_B_ISEM_MANAGEMENT_UNIT_FAILUREr;

      } else {
          if (SOC_IS_JERICHO(unit)) {
              tmp_reg_name = IHB_ISEM_MANAGEMENT_UNIT_FAILUREr;
          } else {
              tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? IHP_ISA_MANAGEMENT_UNIT_FAILUREr: IHP_ISB_MANAGEMENT_UNIT_FAILUREr;
          }
      }
      SOC_SAND_SOC_IF_ERROR_RETURN(res, 1240, exit, soc_reg_get(unit, tmp_reg_name, block_port_id, 0, &failure));

      *success = SOC_SAND_SUCCESS;

      tmp_fld_name = SOC_IS_JERICHO(unit)? ISEM_MNGMNT_UNIT_FAILURE_VALIDf: 
          ((tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? ISA_MNGMNT_UNIT_FAILURE_VALIDf: ISB_MNGMNT_UNIT_FAILURE_VALIDf);
      is_failed = soc_reg64_field32_get(unit, tmp_reg_name, failure, tmp_fld_name);
      if (is_failed)
      {
          tmp_fld_name = SOC_IS_JERICHO(unit)? ISEM_MNGMNT_UNIT_FAILURE_REASONf: 
              ((tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? ISA_MNGMNT_UNIT_FAILURE_REASONf: ISB_MNGMNT_UNIT_FAILURE_REASONf);

        reason = soc_reg64_field32_get(unit, tmp_reg_name, failure, tmp_fld_name);
      }
 }

      if (is_failed)
      {        
        switch(reason)
        {
        case 0x001:
        case 0x002:
        case 0x004:
        case 0x008:
        case 0x080:
        case 0x200:
        case 0x400:
          *success = SOC_SAND_FAILURE_OUT_OF_RESOURCES_2;
        break;
        default:
        break;
        }
      }
  #if ARAD_PP_ISEM_ACCESS_DEBUG
      if (reason)
      {
        switch(reason)
        {
        case 0x001:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Change non-exist from self  ")));
          break;
        case 0x002:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Change non-exist from other ")));
          break;
        case 0x004:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Change request over static  ")));
          break;
        case 0x008:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Change-fail non exist       ")));
          break;
        case 0x010:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Learn over existing         ")));
          break;
        case 0x020:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Learn request over static   ")));
          break;
        case 0x040:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Inserted existing           ")));
          break;
        case 0x080:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Reached max entry limit     ")));
          break;
        case 0x100:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Delete unknown key          ")));
          break;
        case 0x200:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Table coherence             ")));
          break;
        case 0x400:
          LOG_INFO(BSL_LS_SOC_LIF,
                   (BSL_META_U(unit,
                               "Notice: Cam table full              ")));
          break;
        }
      }
  #endif
#endif
      if (SOC_DPP_IS_EM_SIM_ENABLE(unit) && (*success == SOC_SAND_SUCCESS)) {
          access_addr = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? \
              ARAD_CHIP_SIM_ISEM_A_BASE:ARAD_CHIP_SIM_ISEM_B_BASE;
          res = chip_sim_exact_match_entry_add_unsafe(
                  unit,
                  access_addr,
                  key_buffer,
                  ARAD_PP_ISEM_ACCESS_KEY_SIZE * sizeof(uint32),
                  entry_buffer,
                  SOC_DPP_DEFS_GET(unit, isem_payload_nof_uint32) * sizeof(uint32),
                  &is_success
                );
          SOC_SAND_CHECK_FUNC_RESULT(res, 42, exit);

          *success = is_success ? SOC_SAND_SUCCESS : SOC_SAND_FAILURE_OUT_OF_RESOURCES;
      }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_isem_entry_add_unsafe()", 0, 0);
}

STATIC
uint32
  arad_pp_isem_access_tcam_isem_entry_to_action(
      SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_ENTRY  *entry,
      SOC_SAND_OUT ARAD_TCAM_ACTION           *action
  )
{

  SOC_SAND_INIT_ERROR_DEFINITIONS_NO_DEVID(0);

  ARAD_TCAM_ACTION_clear(action);

  action->value[0] = entry->sem_result_ndx;

  ARAD_DO_NOTHING_AND_EXIT;

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_pp_isem_access_tcam_isem_entry_to_action()",0,0);
}


STATIC uint32
  arad_pp_isem_access_tcam_to_prio(
    SOC_SAND_IN  int                                      unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY                     *isem_key
  )
{
  uint32
    prio = SOC_SAND_U32_MAX;

  if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID) 
  {
    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_VD_PRIO * isem_key->key_info.l2_pon.port_valid);
    
    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_TUNNEL_ID_PRIO * isem_key->key_info.l2_pon.tunnel_id_valid);

    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_INNER_VID_PRIO * isem_key->key_info.l2_pon.inner_vid_valid);

    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_OUTER_VID_PRIO * isem_key->key_info.l2_pon.outer_vid_valid);

    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_OUTER_DEI_PRIO * isem_key->key_info.l2_pon.outer_dei_valid);

    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_OUTER_PCP_PRIO * isem_key->key_info.l2_pon.outer_pcp_valid);

    
    prio = prio - ((uint16)ARAD_PP_ISEM_ACCESS_PON_ETHERTYPE_PRIO * isem_key->key_info.l2_pon.ether_type_valid);
  }
  else if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP) {
      prio -= isem_key->key_info.ip_tunnel.sip_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.dip_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.port_property_en;
  }
  else if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF) {
      prio -= isem_key->key_info.ip_tunnel.sip_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.dip_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.vrf_prefix_len; 

  }
  else if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION) {
    prio -= isem_key->key_info.spoof_v6.sip6.prefix_len;
  }
  else if ((isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP) || 
    (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE)){
      prio -= isem_key->key_info.ip_tunnel.dip6.prefix_len;
      prio -= isem_key->key_info.ip_tunnel.vrf_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.port_property_en;
  }
  else if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP) {
      prio -= isem_key->key_info.ip_tunnel.sip6.prefix_len;
      prio -= isem_key->key_info.ip_tunnel.vrf_prefix_len;
      prio -= isem_key->key_info.ip_tunnel.port_property_en;
  }
  else
  {
    prio = 0; 
  }
   
  return prio;
}

STATIC
uint32
  arad_pp_isem_access_tcam_entry_add_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY                *isem_key,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_ENTRY              *isem_entry,
    SOC_SAND_OUT SOC_SAND_SUCCESS_FAILURE               *success
  )
{
  uint32
    res = SOC_SAND_OK,
    data_indx;
  uint32
    priority;
  uint8
    stream[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES] = {0};
  uint8
    stream_mask[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES] = {0};
  SOC_SAND_HASH_TABLE_PTR
    hash_tbl;
  SOC_SAND_HASH_TABLE_PTR
    hash_mask_tbl;
  uint8
    found, ent_add_success,
    entry_added;
  uint32
    tcam_db_id;
  ARAD_TCAM_ENTRY
    entry;
  ARAD_TCAM_ACTION
    action;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  
  ARAD_TCAM_ENTRY_clear(&entry);
  ARAD_TCAM_ACTION_clear(&action);

  
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.isem_key_to_entry_id.get(
               unit,
               &hash_tbl
             );
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt_mask.isem_key_to_entry_id.get(
               unit,
               &hash_mask_tbl
             );
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  res = arad_pp_isem_access_tcam_isem_key_to_stream(
               unit,
               isem_key,
               stream
             );
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  res = arad_pp_isem_access_tcam_isem_entry_to_action(
               isem_entry,
               &action
             );
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);


  res = soc_sand_hash_table_entry_lookup(
          unit,
          hash_tbl,
          stream,
          &data_indx,
          &found
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

  if (!found)
  {
    
    res = soc_sand_hash_table_entry_add(
            unit,
            hash_tbl,
            stream,
            &data_indx,
            &entry_added
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  }
  else
  {
    entry_added = TRUE;
  }

  if (entry_added)
  {
    
    tcam_db_id = arad_pp_isem_access_tcam_db_id_get(
                   isem_key->key_type
                 );
    res = arad_tcam_db_entry_remove_unsafe(
            unit,
            FALSE ,
            tcam_db_id,
            data_indx,
            FALSE
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);

    
    priority = arad_pp_isem_access_tcam_to_prio(
                 unit,
                 isem_key
               );

    
    entry.valid = TRUE;



    res = soc_sand_U8_to_U32(
          stream,
          ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES,
          entry.value
        );
    SOC_SAND_CHECK_FUNC_RESULT(res,  100, exit);

    res = arad_pp_isem_access_tcam_entry_mask_build(
      unit,
      isem_key,      
      &entry
    );
    SOC_SAND_CHECK_FUNC_RESULT(res,  200, exit);


    
    res = soc_sand_U32_to_U8(
            entry.mask,
            ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES,
            stream_mask
           );
    SOC_SAND_CHECK_FUNC_RESULT(res,  201, exit);
    res = soc_sand_U32_to_U8(
            &data_indx,
            4,
            stream_mask+(ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES*2)
           );
    SOC_SAND_CHECK_FUNC_RESULT(res,  201, exit);

    
    res = soc_sand_hash_table_entry_remove_by_index(
              unit,
              hash_mask_tbl,
              data_indx
            );
    SOC_SAND_CHECK_FUNC_RESULT(res, 51, exit);
    res = soc_sand_hash_table_entry_add_at_index(
            unit, 
            hash_mask_tbl, 
            stream_mask, 
            data_indx, 
            &ent_add_success
            );

    res = arad_tcam_managed_db_entry_add_unsafe(
            unit,
            tcam_db_id,
            data_indx,
            FALSE,
            priority,
            &entry,
            &action,
            success
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);

    if ((*success != SOC_SAND_SUCCESS) && (!found))
    {
      res = soc_sand_hash_table_entry_remove_by_index(
              unit,
              hash_tbl,
              data_indx
            );
      SOC_SAND_CHECK_FUNC_RESULT(res, 50, exit);
    }
  }
  else
  {
    *success = SOC_SAND_FAILURE_OUT_OF_RESOURCES;
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_tcam_entry_add_unsafe()", 0, 0);
}



uint32
  arad_pp_isem_access_tcam_rewrite_entry(
     SOC_SAND_IN  int                        unit,
     SOC_SAND_IN  uint8                      entry_exists,
     SOC_SAND_IN  ARAD_TCAM_GLOBAL_LOCATION  *global_location,
     SOC_SAND_IN  ARAD_TCAM_LOCATION         *location
  )
{
    uint32 res = SOC_SAND_OK;
    SOC_SAND_HASH_TABLE_PTR
        hash_tbl;
    SOC_SAND_HASH_TABLE_PTR
        hash_mask_tbl;
    uint8
        found;
    uint8
      stream[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES];
    uint8
      stream_mask[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES];
    ARAD_TCAM_ENTRY
        entry;
    ARAD_TCAM_BANK_ENTRY_SIZE
        entry_size;
    
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    SOC_SAND_CHECK_NULL_INPUT(global_location);
    SOC_SAND_CHECK_NULL_INPUT(location);

    
    found = FALSE;
    ARAD_TCAM_ENTRY_clear(&entry);

    if(entry_exists)
    {
        
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt.isem_key_to_entry_id.get(unit, &hash_tbl);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

        
        res = sw_state_access[unit].dpp.soc.arad.pp.vtt_mask.isem_key_to_entry_id.get(unit, &hash_mask_tbl);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        
        
        res = soc_sand_hash_table_get_by_index(unit, hash_tbl, global_location->entry_id, stream, &found);
        SOC_SAND_CHECK_FUNC_RESULT(res, 7, exit);
        if (found)
        {
            res = soc_sand_hash_table_get_by_index(unit, hash_mask_tbl, global_location->entry_id, stream_mask, &found);
            SOC_SAND_CHECK_FUNC_RESULT(res, 7, exit);
        }

        if(found)
        {
            

            entry.valid = TRUE;
            res = soc_sand_U8_to_U32(stream, ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES, entry.value);
            SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

            res = soc_sand_U8_to_U32(stream_mask, ARAD_PP_ISEM_ACCESS_TCAM_KEY_LEN_BYTES, entry.mask);
            SOC_SAND_CHECK_FUNC_RESULT(res, 11, exit);
        }
        else
        {
            
            SOC_SAND_SET_ERROR_CODE(SOC_SAND_GEN_ERR, 20, exit);
        }
    }
    

    res = sw_state_access[unit].dpp.soc.arad.tm.tcam.bank.entry_size.get(unit, location->bank_id, &entry_size);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 30, exit);

    
    res = arad_tcam_entry_rewrite(unit, entry_exists, global_location->tcam_db_id, location, entry_size, &entry);
    SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_ip_tcam_rewrite_entry()", 0, 0);
}

uint32
  arad_pp_isem_access_entry_add_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY                     *isem_key,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_ENTRY                   *isem_entry,
    SOC_SAND_OUT SOC_SAND_SUCCESS_FAILURE                      *success
  )
{
  uint32
    res = SOC_SAND_OK;  
  uint32
    key_buffer[ARAD_PP_ISEM_ACCESS_KEY_SIZE];
  uint32     
    nof_tables,   
    tbl_access_idx,
    tables_access_id,
    tables_access_ids[ARAD_PP_ISEM_ACCESS_NOF_TABLES],
    entry_buffer[SOC_DPP_DEFS_MAX(ISEM_PAYLOAD_NOF_UINT32)];  
  uint8
    is_duplicate_entry;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  SOC_SAND_CHECK_NULL_INPUT(isem_key);
  SOC_SAND_CHECK_NULL_INPUT(isem_entry);
  SOC_SAND_CHECK_NULL_INPUT(success);

  res = arad_pp_isem_access_sem_tables_get(unit, isem_key, &nof_tables, tables_access_ids,&is_duplicate_entry);
  SOC_SAND_CHECK_FUNC_RESULT(res, 19, exit);

  *success = SOC_SAND_FAILURE_OUT_OF_RESOURCES;

  
  for (tbl_access_idx = 0; tbl_access_idx < nof_tables; tbl_access_idx++)
  {
    
    if (!is_duplicate_entry && tbl_access_idx > 0 && *success == SOC_SAND_SUCCESS)
    {
      break;
    }
    tables_access_id = tables_access_ids[tbl_access_idx];
    if (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A ||
        tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_B)
    {
      
      res = arad_pp_isem_access_key_to_buffer(unit, isem_key, tables_access_id, tbl_access_idx, key_buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);

      res = arad_pp_isem_access_entry_to_buffer(unit, isem_entry, entry_buffer);
      SOC_SAND_CHECK_FUNC_RESULT(res, 17, exit);
      
      res = arad_pp_isem_access_isem_entry_add_unsafe(unit,key_buffer,entry_buffer,tables_access_id,success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
    }
    else
    {
      
      res = arad_pp_isem_access_tcam_entry_add_unsafe(unit,isem_key,isem_entry,success);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
    }
  }
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_entry_add_unsafe()", 0, 0);
}

STATIC
uint32
  arad_pp_isem_access_tcam_remove_unsafe(
    SOC_SAND_IN  int                                     unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY                       *isem_key
  )
{
  uint32
    res = SOC_SAND_OK,
    data_indx;
  uint8
    found;
  uint8
	  stream[ARAD_PP_SW_DB_HASH_KEY_LEN_BYTES] = {0};
  SOC_SAND_HASH_TABLE_PTR
    hash_tbl;
  uint32
    tcam_db_id;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  SOC_SAND_CHECK_DRIVER_AND_DEVICE;

  
  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.isem_key_to_entry_id.get(
               unit,
               &hash_tbl
             );
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  res = arad_pp_isem_access_tcam_isem_key_to_stream(
               unit,
	        isem_key,
	        stream
	      );
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  res = soc_sand_hash_table_entry_lookup(
          unit,
          hash_tbl,
          stream,
          &data_indx,
          &found
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

  if (!found)
  {
    
    SOC_SAND_SET_ERROR_CODE(SOC_PPD_ERR_NOT_EXIST, 30, exit);
  }

  res = soc_sand_hash_table_entry_remove_by_index(
          unit,
          hash_tbl,
          data_indx
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);

  
  tcam_db_id = arad_pp_isem_access_tcam_db_id_get(
                 isem_key->key_type
               );

  res = arad_tcam_managed_db_entry_remove_unsafe(
          unit,
          tcam_db_id,
          data_indx
        );
  SOC_SAND_CHECK_FUNC_RESULT(res, 50, exit);

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_tcam_remove_unsafe()", 0, 0);
}



uint32 
    arad_pp_isem_access_isem_entry_remove_unsafe(int unit, uint32 key_buffer[ARAD_PP_ISEM_ACCESS_KEY_SIZE], uint32 tables_access_id)
{
    uint32 temp, res, block_port_id, access_addr;
    uint32 buffer[ARAD_PP_ISEM_ACCESS_ENTRY_REQ_SIZE];
    uint64 failure;
    uint32 is_failed;
    uint32 reason = 0;

    
#if SOC_DPP_IS_EM_HW_ENABLE
    uint32      block_id;
    soc_mem_t   tmp_mem_name;
#endif

    soc_reg_t   tmp_reg_name;
    soc_field_t tmp_fld_name;



    SOC_SAND_INIT_ERROR_DEFINITIONS(0);
    ARAD_PP_CLEAR(buffer, uint32, ARAD_PP_ISEM_ACCESS_ENTRY_REQ_SIZE);

    temp = ARAD_PP_ISEM_ACCESS_ACTION_TYPE_DELETE;
    res = soc_sand_bitstream_set_any_field(
            &temp,
            ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_LSB,
            ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_MSB - ARAD_PP_ISEM_ACCESS_ENTRY_REQ_TYPE_LSB + 1,
            buffer
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 17, exit);

    res = soc_sand_bitstream_set_any_field(
            key_buffer,
            ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_LSB,
            ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_MSB - ARAD_PP_ISEM_ACCESS_ENTRY_REQ_KEY_LSB + 1,
            buffer
          );
    SOC_SAND_CHECK_FUNC_RESULT(res, 22, exit);

#if SOC_DPP_IS_EM_HW_ENABLE
    if(SOC_IS_QAX(unit)) {
        block_port_id = REG_PORT_ANY;
        tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_INTERRUPT_REGISTER_ONEr : PPDB_B_ISEM_INTERRUPT_REGISTER_ONEr;
        tmp_fld_name = ISEM_MANAGEMENT_COMPLETEDf;
    } else {
        if (SOC_IS_JERICHO(unit)) {
            block_port_id = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)?  0 : 1 ;
            tmp_reg_name = IHB_ISEM_INTERRUPT_REGISTER_ONEr;
            tmp_fld_name = ISEM_MANAGEMENT_COMPLETEDf;
        } else {
            block_port_id = REG_PORT_ANY;
            tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? IHP_ISA_INTERRUPT_REGISTER_ONEr:IHP_ISB_INTERRUPT_REGISTER_ONEr;
            tmp_fld_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? ISA_MANAGEMENT_COMPLETEDf:ISB_MANAGEMENT_COMPLETEDf;
        }
    }


    if (! ((SOC_IS_DONE_INIT(unit)) && 
#ifdef CRASH_RECOVERY_SUPPORT
           (BCM_UNIT_DO_HW_READ_WRITE(unit))
#else
           (0)
#endif 
           ))        
    {
      SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_read(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name, &temp));
      if (temp)
      {
        SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_NOT_READY_ERR, 10, exit);
      }
    }

    if(SOC_IS_QAX(unit)) {
        block_id = MEM_BLOCK_ALL;
        tmp_mem_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? PPDB_A_ISEM_MANAGEMENT_REQUESTm : PPDB_B_ISEM_MANAGEMENT_REQUESTm;
    } else {
        if (SOC_IS_JERICHO(unit)) {
            tmp_mem_name = IHB_ISEM_MANAGEMENT_REQUESTm;
            block_id = IHB_BLOCK(unit, block_port_id);
        } else {
            tmp_mem_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? IHP_ISA_MANAGEMENT_REQUESTm: IHP_ISB_MANAGEMENT_REQUESTm;
            block_id = MEM_BLOCK_ALL;
        }
    }
    SOC_SAND_SOC_IF_ERROR_RETURN(res, 1230, exit, soc_mem_write(unit, tmp_mem_name, block_id, 0, buffer));

    res = arad_polling(
            unit,
            ARAD_TIMEOUT,
            ARAD_MIN_POLLS,
            tmp_reg_name,
            block_port_id,
            0,
            tmp_fld_name,
            1
    );
    SOC_SAND_CHECK_FUNC_RESULT(res, 17, exit);
    
      temp = 1;
      SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  19,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, tmp_reg_name, block_port_id, 0, tmp_fld_name,  temp));
#endif
       if (SOC_DPP_IS_EM_SIM_ENABLE(unit)) {
          access_addr = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? \
             ARAD_CHIP_SIM_ISEM_A_BASE:ARAD_CHIP_SIM_ISEM_B_BASE;
          res = chip_sim_exact_match_entry_remove_unsafe(
                  unit,
                  access_addr,
                  key_buffer,
                  ARAD_PP_ISEM_ACCESS_KEY_SIZE * sizeof(uint32)
                );
          SOC_SAND_CHECK_FUNC_RESULT(res, 32, exit);
       }

       if(SOC_IS_QAX(unit)) {
           block_port_id = REG_PORT_ANY;
           tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? PPDB_A_ISEM_MANAGEMENT_UNIT_FAILUREr : PPDB_B_ISEM_MANAGEMENT_UNIT_FAILUREr;
       } else {
           if(SOC_IS_JERICHO(unit)){
               block_port_id = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)?  0 : 1 ;
               tmp_reg_name = IHB_ISEM_MANAGEMENT_UNIT_FAILUREr;
           } else {
               block_port_id = REG_PORT_ANY;
               tmp_reg_name = (tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A) ? IHP_ISA_MANAGEMENT_UNIT_FAILUREr: IHP_ISB_MANAGEMENT_UNIT_FAILUREr;
           }
       }
       SOC_SAND_SOC_IF_ERROR_RETURN(res, 1240, exit, soc_reg_get(unit, tmp_reg_name, block_port_id, 0, &failure));

       tmp_fld_name = SOC_IS_JERICHO(unit)? ISEM_MNGMNT_UNIT_FAILURE_VALIDf:
           ((tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? ISA_MNGMNT_UNIT_FAILURE_VALIDf: ISB_MNGMNT_UNIT_FAILURE_VALIDf);
       is_failed = soc_reg64_field32_get(unit, tmp_reg_name, failure, tmp_fld_name);
       if (is_failed)
       {
           tmp_fld_name = SOC_IS_JERICHO(unit)? ISEM_MNGMNT_UNIT_FAILURE_REASONf:
               ((tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_A)? ISA_MNGMNT_UNIT_FAILURE_REASONf: ISB_MNGMNT_UNIT_FAILURE_REASONf);

         reason = soc_reg64_field32_get(unit, tmp_reg_name, failure, tmp_fld_name);
       }

       if (reason)
       {
#if ARAD_PP_ISEM_ACCESS_DEBUG
           switch(reason)
           {
           case 0x001:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Change non-exist from self  ")));
             break;
           case 0x002:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Change non-exist from other ")));
             break;
           case 0x004:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Change request over static  ")));
             break;
           case 0x008:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Change-fail non exist       ")));
             break;
           case 0x010:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Learn over existing         ")));
             break;
           case 0x020:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Learn request over static   ")));
             break;
           case 0x040:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Inserted existing           ")));
             break;
           case 0x080:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Reached max entry limit     ")));
             break;
           case 0x100:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Delete unknown key          ")));
             break;
           case 0x200:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Table coherence             ")));
             break;
           case 0x400:
             LOG_INFO(BSL_LS_SOC_LIF,
                      (BSL_META_U(unit,
                                  "Notice: Cam table full              ")));
             break;
           }
#endif
       }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_isem_entry_remove_unsafe()", 0, 0);
}


uint32
  arad_pp_isem_access_entry_remove_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  ARAD_PP_ISEM_ACCESS_KEY             *isem_key    
  )
{
  uint8  is_duplicate_entry;

  uint32
    nof_tables,
    tbl_access_idx,
    res = SOC_SAND_OK,    
    tables_access_ids[ARAD_PP_ISEM_ACCESS_NOF_TABLES],
    key_buffer[ARAD_PP_ISEM_ACCESS_KEY_SIZE];

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  SOC_SAND_CHECK_NULL_INPUT(isem_key);

  res = arad_pp_isem_access_sem_tables_get(unit, isem_key, &nof_tables, tables_access_ids,&is_duplicate_entry);
  SOC_SAND_CHECK_FUNC_RESULT(res, 19, exit);
    
  
  for (tbl_access_idx = 0; tbl_access_idx < nof_tables; tbl_access_idx++)
  {
    if (tables_access_ids[tbl_access_idx] != ARAD_PP_ISEM_ACCESS_ID_TCAM) 
    {
        res = arad_pp_isem_access_key_to_buffer(unit, isem_key, tables_access_ids[tbl_access_idx], tbl_access_idx, key_buffer);
        SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);

        res = arad_pp_isem_access_isem_entry_remove_unsafe(unit, key_buffer, tables_access_ids[tbl_access_idx]);
        SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);        
    }
    else
    {
      
      res = arad_pp_isem_access_tcam_remove_unsafe(unit,isem_key);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
    }
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_entry_remove_unsafe()", 0, 0);
}

uint32
  arad_pp_isem_access_prog_sel_in_rif_key_get_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_OUT uint8                               *with_in_rif
  )
{
  uint32
    res = SOC_SAND_OK;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]

  SOC_SAND_CHECK_NULL_INPUT(with_in_rif);
  
  *with_in_rif = prog_soc_prop.mpls_use_in_rif; 

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_entry_remove_unsafe()", 0, 0);
}

STATIC
uint32
    arad_pp_isem_access_ac_map_key_type_to_prog_sel(
     int                            unit,
     SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE       key_mapping,
     uint32                            *llvp_prog_sel_val
   )
{

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  switch(key_mapping)
  {
  case SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN:
	  if(SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23) {
		  *llvp_prog_sel_val = PROG_VT_VDxOUTERVID;
	  }
	  else {
		  *llvp_prog_sel_val = PROG_VT_VDxOUTERVID_L1;
	  }
    break;
  case SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN_VLAN:
    *llvp_prog_sel_val = PROG_VT_VD_OUTER_INNER;
    break;
  case SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_INITIAL_VLAN:
	  if(SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode >= 20 && SOC_DPP_CONFIG(unit)->pp.mpls_termination_database_mode <= 23) {
		  *llvp_prog_sel_val = PROG_VT_VDxINITIALVID;
	  }
	  else {
		  *llvp_prog_sel_val = PROG_VT_VDxINITIALVID_L1;
	  }
    break;
  case SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN_ETH:
    *llvp_prog_sel_val = PROG_VT_SECTION_OAM_ONE_TAG;
    break;
  case SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN_VLAN_ETH:
    *llvp_prog_sel_val = PROG_VT_SECTION_OAM_TWO_TAGS;
    break;
  default:
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROG_SEL_INVALID_LIF_KEY_RANGE_ERR, 14590, exit);
    break;
  }
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_ac_map_key_type_to_prog_sel()", key_mapping, 0);
}

STATIC
uint32
    arad_pp_isem_access_prog_sel_to_ac_map_key_type(
     int                            unit,
     uint32                            llvp_prog_sel_val,
     SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE       *key_mapping    
   )
{

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  switch(llvp_prog_sel_val)
  {
  case PROG_VT_VDxOUTERVID_L1:
  case PROG_VT_VDxOUTERVID:
    *key_mapping = SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN;
    break;
  case PROG_VT_VD_OUTER_INNER:
    *key_mapping = SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN_VLAN;
    break;
  case PROG_VT_VDxINITIALVID_L1:
  case PROG_VT_VDxINITIALVID:
    *key_mapping = SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_INITIAL_VLAN;
    break;
  case PROG_VT_SECTION_OAM_ONE_TAG :
    *key_mapping = SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN_ETH;
    break;
  case PROG_VT_SECTION_OAM_TWO_TAGS:
    *key_mapping = SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_PORT_VLAN_VLAN_ETH ;
    break;
  default:
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROG_SEL_INVALID_LIF_KEY_RANGE_ERR, 10, exit);
    break;
  }
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_prog_sel_to_ac_map_key_type()", llvp_prog_sel_val, 0);
}

uint32
  arad_pp_isem_access_prog_sel_ac_key_set_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  uint32                                 entry_ndx,
    SOC_SAND_IN  SOC_PPC_L2_LIF_AC_KEY_QUALIFIER           *qual_key,
    SOC_SAND_IN  SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE            *key_mapping
  )
{
  uint32
    res = SOC_SAND_OK;
  ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_1st_cam_tbl;
  uint32
    llvp_prog_sel_val = 0;
  ARAD_PP_MGMT_OPERATION_MODE
    *oper_mode = NULL;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);
  ARAD_ALLOC(oper_mode, ARAD_PP_MGMT_OPERATION_MODE, 1, "arad_pp_isem_access_prog_sel_ac_key_set_unsafe.oper_mode");
  ARAD_PP_MGMT_OPERATION_MODE_clear(oper_mode);

  res = sw_state_access[unit].dpp.soc.arad.pp.oper_mode.get(unit,oper_mode);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 2, exit);  

  SOC_SAND_CHECK_NULL_INPUT(qual_key);
  SOC_SAND_CHECK_NULL_INPUT(key_mapping);

  ARAD_CLEAR(&prog_selection_1st_cam_tbl, ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1);

  if (entry_ndx > DPP_PP_ISEM_PROG_SEL_1ST_CAM_USR_LAST_ENTRY(unit))
  {
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROG_SEL_USR_INDEX_OUT_OF_RANGE_ERR, 10, exit);
  }

  res = arad_pp_isem_access_ac_map_key_type_to_prog_sel(unit,*key_mapping,&llvp_prog_sel_val);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_get_unsafe(unit, entry_ndx, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  

  if (*key_mapping == SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_DEFAULT)
  {
    prog_selection_1st_cam_tbl.valid = 0;
    prog_selection_1st_cam_tbl.packet_format_qualifier_1_mask     = 0x7FF;
    prog_selection_1st_cam_tbl.packet_format_qualifier_2_mask     = 0x7FF;
    prog_selection_1st_cam_tbl.packet_format_code_mask            = ARAD_PARSER_PFC_MATCH_ANY;
    prog_selection_1st_cam_tbl.ptc_vt_profile_mask                = 0x3;
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask         = ARAD_PP_ISEM_ACCESS_VT_PROFILE_MASK;
    prog_selection_1st_cam_tbl.parser_leaf_context_mask           = ARAD_PARSER_PLC_MATCH_ANY;
  }
  else
  {
    prog_selection_1st_cam_tbl.packet_format_qualifier_1      = ((qual_key->pkt_parse_info.outer_tpid << 3) | (qual_key->pkt_parse_info.is_outer_prio << 2) | (qual_key->pkt_parse_info.inner_tpid << 0)); 
    prog_selection_1st_cam_tbl.packet_format_qualifier_1_mask = 0x7e0;
    prog_selection_1st_cam_tbl.packet_format_code             = ARAD_PARSER_PFC_ETH;
    prog_selection_1st_cam_tbl.packet_format_code_mask        = ARAD_PARSER_PFC_MATCH_TYPE;
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile          = qual_key->port_profile;
    prog_selection_1st_cam_tbl.in_pp_port_vt_profile_mask     = 0x0;
    prog_selection_1st_cam_tbl.llvp_prog_sel                  = llvp_prog_sel_val;
    prog_selection_1st_cam_tbl.valid                          = 0x1; 
  }
  
  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_set_unsafe(unit, entry_ndx, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);

exit:
  ARAD_FREE(oper_mode);
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_prog_sel_ac_key_set_unsafe()", entry_ndx, 0);
}

uint32
  arad_pp_isem_access_prog_sel_ac_key_get_unsafe(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  uint32                                 entry_ndx,
    SOC_SAND_IN  SOC_PPC_L2_LIF_AC_KEY_QUALIFIER           *qual_key,
    SOC_SAND_OUT SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE            *key_mapping    
  )
{
  uint32
    res = SOC_SAND_OK;
  ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA
    prog_selection_1st_cam_tbl;
  ARAD_PP_MGMT_OPERATION_MODE
    *oper_mode = NULL;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  ARAD_ALLOC(oper_mode, ARAD_PP_MGMT_OPERATION_MODE, 1, "arad_pp_isem_access_prog_sel_ac_key_get_unsafe.oper_mode");
  ARAD_PP_MGMT_OPERATION_MODE_clear(oper_mode);

  res = sw_state_access[unit].dpp.soc.arad.pp.oper_mode.get(unit,oper_mode);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 3, exit);

  SOC_SAND_CHECK_NULL_INPUT(qual_key);
  SOC_SAND_CHECK_NULL_INPUT(key_mapping);

  ARAD_CLEAR(&prog_selection_1st_cam_tbl, ARAD_PP_IHP_VTT1ST_KEY_PROGRAM_SELECTION_CAM_TBL_DATA, 1); 

  if (entry_ndx > DPP_PP_ISEM_PROG_SEL_1ST_CAM_USR_LAST_ENTRY(unit))
  {
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_PROG_SEL_USR_INDEX_OUT_OF_RANGE_ERR, 10, exit);
  }

  res = arad_pp_ihp_isem_1st_program_selection_cam_tbl_get_unsafe(unit, entry_ndx, &prog_selection_1st_cam_tbl);
  SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

  if (prog_selection_1st_cam_tbl.valid)
  {
    res = arad_pp_isem_access_prog_sel_to_ac_map_key_type(unit,prog_selection_1st_cam_tbl.llvp_prog_sel,key_mapping);
    SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  }
  else
  {
    
    *key_mapping = SOC_PPC_L2_LIF_AC_MAP_KEY_TYPE_DEFAULT;   
  }
  

exit:
  ARAD_FREE(oper_mode);
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_prog_sel_ac_key_get_unsafe()", entry_ndx, 0);
}


CONST SOC_PROCEDURE_DESC_ELEMENT*
  arad_pp_isem_access_get_procs_ptr(void)
{
  return Arad_pp_procedure_desc_element_isem_access;
}

CONST SOC_ERROR_DESC_ELEMENT*
  arad_pp_isem_access_get_errs_ptr(void)
{
  return Arad_pp_error_desc_element_isem_access;
}

uint32 arad_pp_isem_prefix_from_buffer(SOC_SAND_IN  int       unit,
                                       SOC_SAND_IN  uint32   *buffer,
                                       SOC_SAND_IN  uint32    lookup_num,
                                       SOC_SAND_IN  uint32    tables_access_id,
                                       SOC_SAND_OUT uint32   *prefix )
{
    uint8 valid = 0;
    uint32 tcam_db_id = 0;
    uint32 access_profile_id = 0;
    uint32 access_profile_from_buffer = 0;
    uint32 res = SOC_SAND_OK;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if (tables_access_id != ARAD_PP_ISEM_ACCESS_ID_TCAM)
    {

       res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_LSB_PREFIX, ARAD_PP_ISEM_ACCESS_NOF_BITS_PREFIX, prefix);
       SOC_SAND_CHECK_FUNC_RESULT(res, 12, exit);
    }
    else
    {
       res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_LSB, ARAD_PP_ISEM_ACCESS_TCAM_ACCESS_PROFILE_ID_NOF_BITS, &access_profile_from_buffer);
       SOC_SAND_CHECK_FUNC_RESULT(res, 13, exit);

       for (tcam_db_id = ARAD_PP_ISEM_ACCESS_TCAM_BASE; tcam_db_id <= ARAD_PP_ISEM_ACCESS_TCAM_END; tcam_db_id++)
       {
          res = sw_state_access[unit].dpp.soc.arad.tm.tcam.tcam_db.valid.get(unit, tcam_db_id, &valid);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 13, exit);
          if (valid)
          {
            res = sw_state_access[unit].dpp.soc.arad.tm.tcam.tcam_db.access_profile_id.get(
                    unit,
                    tcam_db_id,
                    0, 
                    &access_profile_id
                  );
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 13, exit);

            if (access_profile_id == access_profile_from_buffer)
            {
               break;
            }
          }
       }

       if (tcam_db_id > ARAD_PP_ISEM_ACCESS_TCAM_END)
       {
          
          SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_KEY_TYPE_TCAM_INVALID_ERR, 300, exit);
       }

       *prefix = tcam_db_id;
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_prefix_from_buffer()", 0, 0);
}
uint32
  arad_pp_isem_access_key_from_buffer(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  uint32                                 *buffer,
    SOC_SAND_IN  uint32                                 lookup_num,
    SOC_SAND_IN  uint32                                 tables_access_id,
    SOC_SAND_OUT ARAD_PP_ISEM_ACCESS_KEY                *isem_key
  )
{
  uint32
    res = SOC_SAND_OK;
  uint32
    tmp = 0,
    prefix=0;
  ARAD_PP_ISEM_ACCESS_KEY_TYPE
    key_type = 0;
  uint32
    mac_U32[SOC_SAND_PP_MAC_ADDRESS_NOF_UINT32S] = {0};
  uint32
    ip6_address[SOC_SAND_PP_IPV6_ADDRESS_NOF_UINT32S] = {0};

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  ARAD_PP_CLEAR(isem_key,ARAD_PP_ISEM_ACCESS_KEY,1);

  if(is_g_prog_soc_prop_initilized[unit] == 0)
  {
      res = arad_pp_isem_access_programs_soc_properties_get(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
#define prog_soc_prop g_prog_soc_prop[unit]
  res = arad_pp_isem_prefix_from_buffer(unit,buffer,lookup_num,tables_access_id, &prefix);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
  
  res = arad_pp_isem_access_prefix_to_key_type(unit, prefix, lookup_num, tables_access_id, buffer, &key_type);
  SOC_SAND_CHECK_FUNC_RESULT(res, 14, exit);

  isem_key->key_type = (ARAD_PP_ISEM_ACCESS_KEY_TYPE)key_type;

  switch(isem_key->key_type)
  {
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_INITIAL_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_DESIGNATED_VID:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, &isem_key->key_info.l2_eth.vlan_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 32, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_OUTER_VID_NOF_BITS, &isem_key->key_info.l2_eth.outer_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 38, exit);

    
    switch (isem_key->key_type)
    {
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_VID_VID:
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_VID_VID_INNER_VID_NOF_BITS, &isem_key->key_info.l2_eth.inner_vid);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
      break;    
    case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID:
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_NOF_BITS, &isem_key->key_info.l2_eth.outer_pcp);
      SOC_SAND_CHECK_FUNC_RESULT(res, 447, exit);
      break;
    default:
      break;
    }        
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VD_PCP_VID_VID:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_VLAN_DOMAIN_NOF_BITS, &isem_key->key_info.l2_eth.vlan_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 5532, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_VID_NOF_BITS, &isem_key->key_info.l2_eth.outer_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 5538, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_OUTER_PCP_NOF_BITS, &isem_key->key_info.l2_eth.outer_pcp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 443, exit);
    
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_VD_PCP_VID_VID_INNER_VID_NOF_BITS, &isem_key->key_info.l2_eth.inner_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 445, exit);
      
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID:
  {
    uint32 gpon_enable = 0;
    uint32 lsb;
    uint32 nof_bits;

    if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "gpon_application_enable", 0)) {
        gpon_enable = 1;
    }

    lsb = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_LSB);
    nof_bits = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_VLAN_DOMAIN_NOF_BITS(unit));
    res = soc_sand_bitstream_get_any_field(buffer, lsb, nof_bits, &isem_key->key_info.l2_pon.port); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 700, exit);

    isem_key->key_info.l2_pon.port_valid = TRUE;

    lsb = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_LSB : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_LSB(unit));
    nof_bits = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_TUNNEL_NOF_BITS(unit));
    res = soc_sand_bitstream_get_any_field(buffer, lsb, nof_bits, &isem_key->key_info.l2_pon.tunnel_id); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 705, exit);
    
    isem_key->key_info.l2_pon.tunnel_id_valid = TRUE;

    if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL &&
        tables_access_id == ARAD_PP_ISEM_ACCESS_ID_ISEM_B) {
        
        isem_key->key_info.l2_pon.flags = ARAD_PP_ISEM_ACCESS_L2_PON_TLS;
    }

    if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID || 
        isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID ) 
    {
      lsb = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_LSB : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_LSB(unit));
      nof_bits = (gpon_enable ? ARAD_PP_ISEM_ACCESS_KEY_GPON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS : ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_OUTER_VID_NOF_BITS(unit));
      res = soc_sand_bitstream_get_any_field(buffer, lsb, nof_bits, &isem_key->key_info.l2_pon.outer_vid); 
      SOC_SAND_CHECK_FUNC_RESULT(res, 710, exit);

      isem_key->key_info.l2_pon.outer_vid_valid = TRUE;
    }

    if (isem_key->key_type == ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_TUNNEL_VID_VID) 
    { 
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_TUNNEL_VID_VID_INNER_VID_NOF_BITS(unit), &isem_key->key_info.l2_pon.inner_vid); 
      SOC_SAND_CHECK_FUNC_RESULT(res, 715, exit);

      isem_key->key_info.l2_pon.inner_vid_valid = TRUE;
    }    

    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID:
    
    isem_key->key_info.l2_pon.port_valid = TRUE; 
    isem_key->key_info.l2_pon.tunnel_id_valid = TRUE;
    isem_key->key_info.l2_pon.ether_type_valid = TRUE;
    isem_key->key_info.l2_pon.outer_dei_valid = TRUE;
    isem_key->key_info.l2_pon.outer_pcp_valid = TRUE;
    isem_key->key_info.l2_pon.outer_vid_valid = TRUE;
    isem_key->key_info.l2_pon.inner_vid_valid = TRUE;
    
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_VLAN_DOMAIN_NOF_BITS(unit), &isem_key->key_info.l2_pon.port); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 700, exit);  

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_TUNNEL_NOF_BITS(unit), &isem_key->key_info.l2_pon.tunnel_id); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 705, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_VID_NOF_BITS(unit), &isem_key->key_info.l2_pon.outer_vid); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 710, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_INNER_VID_NOF_BITS(unit), &isem_key->key_info.l2_pon.inner_vid); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 715, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_ETHERTYPE_NOF_BITS(unit), &isem_key->key_info.l2_pon.ether_type); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 720, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_DEI_NOF_BITS(unit), &isem_key->key_info.l2_pon.outer_dei); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 725, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_PON_VD_ETHERTYPE_TUNNEL_PCP_VID_VID_OUTER_PCP_NOF_BITS(unit), &isem_key->key_info.l2_pon.outer_pcp); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 730, exit);

    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID:
    
    isem_key->key_info.section_oam.port_valid = TRUE;
    isem_key->key_info.section_oam.ether_type_valid = TRUE;
    isem_key->key_info.section_oam.outer_vid_valid = TRUE;
    isem_key->key_info.section_oam.inner_vid_valid = TRUE;

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_NOF_BITS(unit), &isem_key->key_info.section_oam.outer_vid); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 810, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_NOF_BITS(unit), &isem_key->key_info.section_oam.ether_type); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 805, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_NOF_BITS(unit), &isem_key->key_info.section_oam.port); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 800, exit);  
    break;
	
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SECTION_OAM_PORT_ETH_VID_VID:
    
    isem_key->key_info.section_oam.port_valid = TRUE;
    isem_key->key_info.section_oam.ether_type_valid = TRUE;
    isem_key->key_info.section_oam.outer_vid_valid = TRUE;
    isem_key->key_info.section_oam.inner_vid_valid = TRUE;

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_OUTER_VID_NOF_BITS(unit), &isem_key->key_info.section_oam.outer_vid); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 825, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_INNER_VID_NOF_BITS(unit), &isem_key->key_info.section_oam.inner_vid); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 835, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_ETHERTYPE_NOF_BITS(unit), &isem_key->key_info.section_oam.ether_type); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 820, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_SECTION_OAM_PORT_ETH_VID_VLAN_DOMAIN_NOF_BITS(unit), &isem_key->key_info.section_oam.port); 
    SOC_SAND_CHECK_FUNC_RESULT(res, 815, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_PBB:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_DOMAIN_NOF_BITS, &isem_key->key_info.pbb.isid_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit);
    
    if (SOC_DPP_CONFIG(unit)->pp.test1 == 0 ){
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_NOF_BITS, &isem_key->key_info.pbb.isid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 42, exit);
    } else {
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PBB_ISID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TEST1_ISID_NOF_BITS, &isem_key->key_info.pbb.isid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 42, exit);
    }
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_DIP:       
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_NOF_BITS, &isem_key->key_info.ip_tunnel.dip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 58, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP:       
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_SIP_OVERLAY_SIP_NOF_BITS, &isem_key->key_info.ip_tunnel.sip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 59, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_SIP_NOF_BITS, &isem_key->key_info.ip_tunnel.sip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 800, exit); 
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_MY_VTEP_INDEX_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.my_vtep_index);
    SOC_SAND_CHECK_FUNC_RESULT(res, 801, exit); 
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_MY_VTEP_INDEX_SIP_VRF_VRF_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf);
    SOC_SAND_CHECK_FUNC_RESULT(res, 802, exit); 
    break; 

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP:       
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_NOF_BITS, &isem_key->key_info.ip_tunnel.dip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_NOF_BITS, &isem_key->key_info.ip_tunnel.sip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 362, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_DIP_MASK_NOF_BITS, &isem_key->key_info.ip_tunnel.dip_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 61, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_SIP_MASK_NOF_BITS, &isem_key->key_info.ip_tunnel.sip_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 62, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_NOF_BITS, &isem_key->key_info.ip_tunnel.ipv4_next_protocol);
    SOC_SAND_CHECK_FUNC_RESULT(res, 364, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_PORT_PROPERTY_NOF_BITS, &isem_key->key_info.ip_tunnel.port_property);
    SOC_SAND_CHECK_FUNC_RESULT(res, 366, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_TCAM_NEXT_PROTOCOL_MASK_NOF_BITS, &isem_key->key_info.ip_tunnel.ipv4_next_protocol_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 366, exit);

    isem_key->key_info.ip_tunnel.port_property_en = (isem_key->key_info.ip_tunnel.port_property) ? 1:0;     
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IP_TUNNEL_SIP_DIP_VRF:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_NOF_BITS, &isem_key->key_info.ip_tunnel.dip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_NOF_BITS, &isem_key->key_info.ip_tunnel.sip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 61, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_LSB, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf);
    SOC_SAND_CHECK_FUNC_RESULT(res, 62, exit);

    res = soc_sand_bitstream_set_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_PORT_PROPERTY_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.port_property);
    SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_DIP_MASK_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.dip_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 63, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_SIP_MASK_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.sip_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 64, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IP_TUNNEL_DIP_SIP_VRF_TCAM_VRF_MASK_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 64, exit);

    isem_key->key_info.ip_tunnel.port_property_en = (isem_key->key_info.ip_tunnel.port_property) ? 1:0;

    break; 
 
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP:    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_DIP_AFTER_RECYCLE: 
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_NOF_BITS(unit), isem_key->key_info.ip_tunnel.dip6.ipv6_address.address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);
    if (prog_soc_prop.ipv6_term_dip_sip_enable) {
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf);
        SOC_SAND_CHECK_FUNC_RESULT(res, 61, exit);
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_GRE_PARSED_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.ip_gre_tunnel);
        SOC_SAND_CHECK_FUNC_RESULT(res, 62, exit);
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_QUAL_PROTOCOL_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.qualifier_next_protocol);
        SOC_SAND_CHECK_FUNC_RESULT(res, 63, exit);
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.port_property);
        SOC_SAND_CHECK_FUNC_RESULT(res, 64, exit);

        isem_key->key_info.ip_tunnel.port_property_en = (isem_key->key_info.ip_tunnel.port_property) ? 1:0;
    }   
    
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_DIP_MASK_NOF_BITS(unit), &tmp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);
    isem_key->key_info.ip_tunnel.dip6.prefix_len = tmp;
    if (prog_soc_prop.ipv6_term_dip_sip_enable) {
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_VRF_MASK_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf_prefix_len);
        SOC_SAND_CHECK_FUNC_RESULT(res, 66, exit);
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_DIP_TCAM_PORT_PROPERTY_MASK_NOF_BITS(unit), &tmp);
        SOC_SAND_CHECK_FUNC_RESULT(res, 67, exit);    
        isem_key->key_info.ip_tunnel.port_property_en = tmp;
    }
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_DIP_AFTER_RECYCLE:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_DIP_NOF_BITS(unit), isem_key->key_info.ip_tunnel.dip6.ipv6_address.address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_IP_PROTOCOL_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.ipv4_next_protocol);
    SOC_SAND_CHECK_FUNC_RESULT(res, 71, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_DIP_TCAM_QUAL_PROTOCOL_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.gre_ethertype);
    SOC_SAND_CHECK_FUNC_RESULT(res, 72, exit);
    break;
    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_IPV6_TUNNEL_CASCADE_SIP:  
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_NOF_BITS(unit), isem_key->key_info.ip_tunnel.sip6.ipv6_address.address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf);
    SOC_SAND_CHECK_FUNC_RESULT(res, 81, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_COMP_DEST_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.my_vtep_index);
    SOC_SAND_CHECK_FUNC_RESULT(res, 82, exit);    
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.port_property);
    SOC_SAND_CHECK_FUNC_RESULT(res, 83, exit);

    
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_SIP_MASK_NOF_BITS(unit), &tmp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
    isem_key->key_info.ip_tunnel.sip6.prefix_len = tmp;
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_VRF_MASK_NOF_BITS(unit), &isem_key->key_info.ip_tunnel.vrf_prefix_len);
    SOC_SAND_CHECK_FUNC_RESULT(res, 86, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_LSB(unit), ARAD_PP_ISEM_ACCESS_KEY_IPV6_TUNNEL_CASCADE_SIP_TCAM_PORT_PROPERTY_MASK_NOF_BITS(unit), &tmp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 87, exit);   
    isem_key->key_info.ip_tunnel.port_property_en = tmp;    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NICK:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_NICK_NAME_NOF_BITS, &isem_key->key_info.trill.nick_name);
    SOC_SAND_CHECK_FUNC_RESULT(res, 64, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_VSI_NOF_BITS, &isem_key->key_info.trill.vsi);
    SOC_SAND_CHECK_FUNC_RESULT(res, 74, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_APPOINTED_FORWARDER_PORT_NOF_BITS, &isem_key->key_info.trill.port);
    SOC_SAND_CHECK_FUNC_RESULT(res, 76, exit);
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_NATIVE_INNER_TPID_NOF_BITS, &isem_key->key_info.trill.native_inner_tpid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 78, exit);
    break;


  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_GRE:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_KEY_VPN_NOF_BITS, &isem_key->key_info.l2_gre.gre_key);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    if (SOC_IS_L2GRE_VDC_ENABLE(unit)) {
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_GRE_VD_NOF_BITS, &isem_key->key_info.l2_vni.match_port_class);
      SOC_SAND_CHECK_FUNC_RESULT(res, 81, exit);
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VNI:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VPN_NOF_BITS, &isem_key->key_info.l2_vni.vni_key);
    SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
    if (SOC_IS_VXLAN_VDC_ENABLE(unit)) {
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_L2_VNI_KEY_VD_NOF_BITS, &isem_key->key_info.l2_vni.match_port_class);
      SOC_SAND_CHECK_FUNC_RESULT(res, 86, exit);
    }
    break;

  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_D_ID_NOF_BITS, &tmp);
    SOC_SAND_CHECK_FUNC_RESULT(res, 93, exit);    
    ARAD_PP_FRWRD_FCF_SET_DOMAIN(isem_key->key_info.fcoe.d_id,tmp);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_FCOE_VSAN_NOF_BITS, &isem_key->key_info.fcoe.vsan);
    SOC_SAND_CHECK_FUNC_RESULT(res, 93, exit);
    break;


  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L3:    
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_ELI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L2_ELI:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_ELI:  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_PWE_L2_GAL:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_LSB(prog_soc_prop.is_bos_in_key_enable), ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_NOF_BITS(prog_soc_prop.is_bos_in_key_enable), &isem_key->key_info.mpls.label);
    SOC_SAND_CHECK_FUNC_RESULT(res, 34, exit);    

    if (prog_soc_prop.is_bos_in_key_enable) 
    {
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_NOF_BITS, &isem_key->key_info.mpls.is_bos);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);    
    }    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_TT:
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_LSB, ARAD_PP_ISEM_ACCESS_KEY_CFM_ETHER_TYPE_NOF_BITS, &isem_key->key_info.oam_stat.cfm_eth_type);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_VT:
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_LSB, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_NOF_BITS, &isem_key->key_info.oam_stat.opaque);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_LSB, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_NOF_BITS, &isem_key->key_info.oam_stat.pph_type);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_OAM_STAT_VT:
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_LSB, ARAD_PP_ISEM_ACCESS_KEY_OPAQUE_NOF_BITS, &isem_key->key_info.oam_stat.opaque);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_LSB, ARAD_PP_ISEM_ACCESS_KEY_PPH_TYPE_NOF_BITS, &isem_key->key_info.oam_stat.pph_type);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISA:
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_LSB, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_NOF_BITS, &isem_key->key_info.oam_stat.bfd_format);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
  break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_BFD_STAT_TT_ISB:
	  res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_LSB, ARAD_PP_ISEM_ACCESS_KEY_BFD_FORMAT_NOF_BITS, &isem_key->key_info.oam_stat.bfd_format);
      SOC_SAND_CHECK_FUNC_RESULT(res, 36, exit);
  break;

  
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_L1_IN_RIF_ELI:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_LSB(prog_soc_prop.is_bos_in_key_enable), ARAD_PP_ISEM_ACCESS_KEY_MPLS_RIF_NOF_BITS(prog_soc_prop.is_bos_in_key_enable), &isem_key->key_info.mpls.in_rif);
    SOC_SAND_CHECK_FUNC_RESULT(res, 37, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_LSB(prog_soc_prop.is_bos_in_key_enable), ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_NOF_BITS(prog_soc_prop.is_bos_in_key_enable), &isem_key->key_info.mpls.label);
    SOC_SAND_CHECK_FUNC_RESULT(res, 38, exit);    
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_MPLS_LABEL_BOS_NOF_BITS, &isem_key->key_info.mpls.is_bos);
    SOC_SAND_CHECK_FUNC_RESULT(res, 39, exit);    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_FRR:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_NOF_BITS, &isem_key->key_info.mpls.label);
    SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);    

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_NOF_BITS, &isem_key->key_info.mpls.label2);
    SOC_SAND_CHECK_FUNC_RESULT(res, 142, exit);    

    if (prog_soc_prop.is_bos_in_key_enable) 
    {
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL2_BOS_NOF_BITS, &isem_key->key_info.mpls.is_bos);
      SOC_SAND_CHECK_FUNC_RESULT(res, 143, exit);    
    }
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV4:   

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SA_8MSB_NOF_BITS, mac_U32);
    SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);    

    
       
    res = soc_sand_pp_mac_address_long_to_struct(
          mac_U32,
          &isem_key->key_info.spoof_v4.smac
        );
    SOC_SAND_CHECK_FUNC_RESULT(res, 146, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V4_SIP_NOF_BITS, &isem_key->key_info.spoof_v4.sip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 147, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_IPV6:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SA_7MSB_NOF_BITS, mac_U32);
    SOC_SAND_CHECK_FUNC_RESULT(res, 245, exit);    

    res = soc_sand_pp_mac_address_long_to_struct(
          mac_U32,
          &isem_key->key_info.spoof_v6.smac
        );
    SOC_SAND_CHECK_FUNC_RESULT(res, 246, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_V6_SIP_NOF_BITS, isem_key->key_info.spoof_v6.sip6.ipv6_address.address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 153, exit);

    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TRILL_VSI:
    isem_key->key_info.trill.flags = 0x0;
    tmp = 0;

    if (tables_access_id != ARAD_PP_ISEM_ACCESS_ID_TCAM) {
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_2BITS_INDICATION_NOF_BITS, &tmp);
      SOC_SAND_CHECK_FUNC_RESULT(res, 500, exit);
  
      if (tmp == ARAD_PP_ISEM_ACCESS_KEY_2BITS_OUTER_VID) {
          isem_key->key_info.trill.flags |= ARAD_PP_ISEM_ACCESS_TRILL_VSI_VL; 
      } else {
          isem_key->key_info.trill.flags |= ARAD_PP_ISEM_ACCESS_TRILL_VSI_FGL; 
      }
      
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_OUTER_VID_NOF_BITS, &isem_key->key_info.trill.high_vid);
      SOC_SAND_CHECK_FUNC_RESULT(res, 510, exit);
      
      if (isem_key->key_info.trill.flags & ARAD_PP_ISEM_ACCESS_TRILL_VSI_FGL) 
      {
        res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_NATIVE_INNER_VID_NOF_BITS, &isem_key->key_info.trill.low_vid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 520, exit);
      }
    } else {
      isem_key->key_info.trill.flags |= ARAD_PP_ISEM_ACCESS_TRILL_VSI_TTS; 
      
      res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TRILL_VSI_TTS_NATIVE_OUTER_VID_NOF_BITS, &isem_key->key_info.trill.high_vid);
      SOC_SAND_CHECK_FUNC_RESULT(res, 510, exit);
    }    
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_RPA:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_LSB, ARAD_PP_ISEM_ACCESS_KEY_RPA_DIP_NOF_BITS, &isem_key->key_info.rpa.dip);
    SOC_SAND_CHECK_FUNC_RESULT(res, 610, exit);    

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_LSB, ARAD_PP_ISEM_ACCESS_KEY_RPA_VRF_NOF_BITS, &isem_key->key_info.rpa.vrf);
    SOC_SAND_CHECK_FUNC_RESULT(res, 620, exit); 
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_SINGLE_TAG:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, &isem_key->key_info.l2_eth.vlan_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 710, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_NOF_BITS, &isem_key->key_info.l2_eth.outer_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 720, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_FLEXIBLE_Q_IN_Q_DOUBLE_TAG:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, &isem_key->key_info.l2_eth.vlan_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 730, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_OUTER_VID_NOF_BITS, &isem_key->key_info.l2_eth.outer_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 740, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_FLEXIBLE_Q_IN_Q_VD_VID_VID_INNER_VID_NOF_BITS, &isem_key->key_info.l2_eth.inner_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 750, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_INITIAL_TAG:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_COMPRESSED_TAG:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_UNTAG:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, &isem_key->key_info.l2_eth.vlan_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 710, exit);

    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_NOF_BITS, &isem_key->key_info.l2_eth.outer_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 720, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST_DOUBLE_TAG:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_VLAN_DOMAIN_NOF_BITS, &isem_key->key_info.l2_eth.vlan_domain);
    SOC_SAND_CHECK_FUNC_RESULT(res, 730, exit);                            
                                                                           
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_NOF_BITS, &isem_key->key_info.l2_eth.outer_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 740, exit);                            
                                                                           
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_LSB, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_INNER_VID_NOF_BITS, &isem_key->key_info.l2_eth.inner_vid);
    SOC_SAND_CHECK_FUNC_RESULT(res, 750, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_MPLS_EXPLICIT_NULL:
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_LSB, ARAD_PP_ISEM_ACCESS_KEY_TCAM_MPLS_LABEL1_NOF_BITS, &isem_key->key_info.mpls.label);
    SOC_SAND_CHECK_FUNC_RESULT(res, 760, exit);        
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_DIP6_TCAM_COMPRESSION:   
    res = soc_sand_bitstream_get_any_field(buffer, 0, 72, ip6_address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 770, exit);
    res = soc_sand_bitstream_set_any_field(ip6_address, 56, 72, isem_key->key_info.ip6_compression.ip6.ipv6_address.address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 771, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SPOOF_SIP6_TCAM_COMPRESSION:
    res = soc_sand_bitstream_get_any_field(buffer, 0, 64, ip6_address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);
    res = soc_sand_bitstream_set_any_field(ip6_address, 64, 64, isem_key->key_info.spoof_v6.sip6.ipv6_address.address);
    SOC_SAND_CHECK_FUNC_RESULT(res, 781, exit);

    res = soc_sand_bitstream_get_any_field(buffer, 64, 8, &isem_key->key_info.spoof_v6.vsi);
    SOC_SAND_CHECK_FUNC_RESULT(res, 783, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_TST2_TCAM:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_AC_TST2:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_SRC_PORT_DA_DB_TCAM:
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VSI_DA_DB_VRRP_TCAM:
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_VLAN_DOMAIN_MPLS:
    res = soc_sand_bitstream_get_any_field(buffer, 0, 8, &(isem_key->key_info.mpls.vlan_domain));  
    SOC_SAND_CHECK_FUNC_RESULT(res, 784, exit);
    res = soc_sand_bitstream_get_any_field(buffer, ARAD_PP_ISEM_ACCESS_KEY_TST_VD_VID_VID_OUTER_VID_LSB, 20, &(isem_key->key_info.mpls.label));  
    SOC_SAND_CHECK_FUNC_RESULT(res, 785, exit);
    break;
  case ARAD_PP_ISEM_ACCESS_KEY_TYPE_CUSTOM_PP_LSP_ECMP:
    res = soc_sand_bitstream_get_any_field(buffer, 0, 32, &(isem_key->key_info.l2_pon.outer_pcp));  
    SOC_SAND_CHECK_FUNC_RESULT(res, 784, exit);
    res = soc_sand_bitstream_get_any_field(buffer, 32, 20, &(isem_key->key_info.l2_pon.tunnel_id));  
    SOC_SAND_CHECK_FUNC_RESULT(res, 784, exit);
    res = soc_sand_bitstream_get_any_field(buffer, 52, 9, &(isem_key->key_info.l2_pon.port));  
    SOC_SAND_CHECK_FUNC_RESULT(res, 785, exit);
    break;

  default:
    SOC_SAND_SET_ERROR_CODE(ARAD_PP_ISEM_ACCESS_UNKNOWN_KEY_TYPE_ERR, 100, exit); 
    break;
  }

exit:
#undef prog_soc_prop
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_key_from_buffer()", 0, 0);
}

uint32
  arad_pp_isem_access_print_vt_program_look_info(int unit, int prog_id)
{

  int program_id;
  ARAD_PP_IHP_VTT1ST_KEY_CONSTRUCTION_TBL_DATA ihp_vtt1st_key_construction_tbl_data;
  uint32 res;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, prog_id, &program_id);
  SOC_SAND_CHECK_FUNC_RESULT(res, prog_id, exit);
  if (program_id == -1) {
    goto exit;
  }

  soc_sand_os_memset(&ihp_vtt1st_key_construction_tbl_data, 0x0, sizeof(ARAD_PP_IHP_VTT1ST_KEY_CONSTRUCTION_TBL_DATA));

  ihp_vtt1st_key_construction_tbl_data.dbal = 1;
  res = arad_pp_ihp_vtt1st_key_construction_tbl_get_unsafe(unit, program_id, &ihp_vtt1st_key_construction_tbl_data );  
  SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);

  LOG_CLI((BSL_META("  LOOKUPS:")));

  if(ihp_vtt1st_key_construction_tbl_data.isa_lookup_enable == 1) {
      LOG_CLI((BSL_META("\tSEM A enabled ")));
  }else{
      LOG_CLI((BSL_META("\tSEM A disabled")));
  }

  if(ihp_vtt1st_key_construction_tbl_data.isb_lookup_enable == 1) {
      LOG_CLI((BSL_META("\tSEM B enabled ")));
  }else{
      LOG_CLI((BSL_META("\tSEM B disabled")));
  }
  if(ihp_vtt1st_key_construction_tbl_data.tcam_db_profile != 0x3F) {
      LOG_CLI((BSL_META("\tTCAM enabled %d"), ihp_vtt1st_key_construction_tbl_data.tcam_db_profile));
  }else{
      LOG_CLI((BSL_META("\tTCAM disabled")));
  }

  LOG_CLI((BSL_META("\n\n")));

exit:

  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_print_vt_program_look_info()", prog_id, 0);
}


uint32
  arad_pp_isem_access_print_tt_program_look_info(int unit, int prog_id)
{

  int program_id;
  ARAD_PP_IHP_VTT2ND_KEY_CONSTRUCTION_TBL_DATA  ihp_vtt2nd_key_construction_tbl_data;
  uint32 res;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, prog_id, &program_id);
  SOC_SAND_CHECK_FUNC_RESULT(res, prog_id, exit);
  if (program_id == -1) {
    goto exit;
  }


  soc_sand_os_memset(&ihp_vtt2nd_key_construction_tbl_data, 0x0, sizeof(ARAD_PP_IHP_VTT2ND_KEY_CONSTRUCTION_TBL_DATA));

  ihp_vtt2nd_key_construction_tbl_data.dbal = 1;
  res = arad_pp_ihp_vtt2nd_key_construction_tbl_get_unsafe(unit, program_id, &ihp_vtt2nd_key_construction_tbl_data);  
  SOC_SAND_CHECK_FUNC_RESULT(res, 780, exit);

  LOG_CLI((BSL_META("  LOOKUPS:")));

  if(ihp_vtt2nd_key_construction_tbl_data.isa_lookup_enable == 1) {
      LOG_CLI((BSL_META("\tSEM A enabled ")));
  }else{
      LOG_CLI((BSL_META("\tSEM A disabled")));
  }

  if(ihp_vtt2nd_key_construction_tbl_data.isb_lookup_enable == 1) {
      LOG_CLI((BSL_META("\tSEM B enabled ")));
  }else{
      LOG_CLI((BSL_META("\tSEM B disabled")));
  }
  if(ihp_vtt2nd_key_construction_tbl_data.tcam_db_profile != 0x3F) {
      LOG_CLI((BSL_META("\tTCAM enabled %d"), ihp_vtt2nd_key_construction_tbl_data.tcam_db_profile));
  }else{
      LOG_CLI((BSL_META("\tTCAM disabled")));
  }

  LOG_CLI((BSL_META("\n\n")));

exit:

  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_print_tt_program_look_info()", prog_id, 0);
}


char*
  arad_pp_isem_access_print_vt_program_data(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  uint32                                 program_id,
    SOC_SAND_IN  uint32                                 to_print
  )
{
    char* prog_name;

    switch(program_id)
    {
    case PROG_VT_TM_PROG:
        prog_name = "PROG_VT_TM_PROG";
        break;
    case PROG_VT_VDxINITIALVID:
        prog_name = "PROG_VT_VDxINITIALVID";
        break;
    case PROG_VT_VDxINITIALVID_L1:
        prog_name = "PROG_VT_VDxINITIALVID_L1";
        break;
    case PROG_VT_VDxOUTERVID:
        prog_name = "PROG_VT_VDxOUTERVID";
        break;
    case PROG_VT_VDxOUTERVID_L1:
        prog_name = "PROG_VT_VDxOUTERVID_L1";
        break;
    case PROG_VT_VD_OUTER_INNER:
        prog_name = "PROG_VT_VD_OUTER_INNER";
        break;
    case PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER:
        prog_name = "PROG_VT_HIGH_VD_OUTER_INNER_OR_LOW_VD_OUTER";
        break;
    case PROG_VT_VDxINITIALVID_L1_L2ELI:
        prog_name = "PROG_VT_VDxINITIALVID_L1_L2ELI";
        break;
    case PROG_VT_VDxOUTERVID_L1_L2ELI:
        prog_name = "PROG_VT_VDxOUTERVID_L1_L2ELI";
        break;
    case PROG_VT_VD_INITIALVID_TRILL:
        prog_name = "PROG_VT_VD_INITIALVID_TRILL";
        break;
    case PROG_VT_VD_DESIGNATED_VID_TRILL:
        prog_name = "PROG_VT_VD_DESIGNATED_VID_TRILL";
        break;
    case PROG_VT_VD_OUTER_TRILL:
        prog_name = "PROG_VT_VD_OUTER_TRILL";
        break;
    case PROG_VT_VD_OUTER_INNER_TRILL:
        prog_name = "PROG_VT_VD_OUTER_INNER_TRILL";
        break;
    case PROG_VT_VD_INITIALVID_L1FRR:
        prog_name = "PROG_VT_VD_INITIALVID_L1FRR";
        break;
    case PROG_VT_VD_OUTERVID_L1FRR:
        prog_name = "PROG_VT_VD_OUTERVID_L1FRR";
        break;
    case PROG_VT_VD_OUTER_OR_VD_OUTER_PCP:
        prog_name = "PROG_VT_VD_OUTER_OR_VD_OUTER_PCP";
        break;
    case PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP:
        prog_name = "PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER_OUTERPCP";
        break;
    case PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER:
        prog_name = "PROG_VT_HIGH_VD_OUTER_INNER_OUTERPCP_OR_VD_OUTER_INNER_OR_VD_OUTER";
        break;
    case PROG_VT_VD_INITIALVID_OR_VD_INITIALVID:
        prog_name = "PROG_VT_VD_INITIALVID_OR_VD_INITIALVID";
        break;
    case PROG_VT_VD_OUTER_OR_VD_OUTER:
        prog_name = "PROG_VT_VD_OUTER_OR_VD_OUTER";
        break;
    case PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER:
        prog_name = "PROG_VT_VD_OUTER_INNER_OR_VD_OUTER_INNER";
        break;
    case PROG_VT_INDX_VD_INITIALVID_L1:
        prog_name = "PROG_VT_INDX_VD_INITIALVID_L1";
        break;
    case PROG_VT_INDX_VD_OUTERVID_L1:
        prog_name = "PROG_VT_INDX_VD_OUTERVID_L1";
        break;
    case PROG_VT_INDX_MPLS_PORT_L1:
        prog_name = "PROG_VT_INDX_MPLS_PORT_L1";
        break;            
    case PROG_VT_INDX_VD_INITIALVID_FRR_L1:
        prog_name = "PROG_VT_INDX_VD_INITIALVID_FRR_L1";
        break;
    case PROG_VT_INDX_VD_OUTERVID_FRR_L1:
        prog_name = "PROG_VT_INDX_VD_OUTERVID_FRR_L1";
        break;                
    case PROG_VT_INDX_VD_INITIALVID_L3:
        prog_name = "PROG_VT_INDX_VD_INITIALVID_L3";
        break;        
    case PROG_VT_INDX_VD_OUTERVID_L3:
        prog_name = "PROG_VT_INDX_VD_OUTERVID_L3";
        break;                
    case PROG_VT_PON_UNTAGGED:
        prog_name = "PROG_VT_PON_UNTAGGED";
        break;        
    case PROG_VT_PON_ONE_TAG:
        prog_name = "PROG_VT_PON_ONE_TAG";
        break;        
    case PROG_VT_PON_TWO_TAGS:
        prog_name = "PROG_VT_PON_TWO_TAGS";
        break;        
    case PROG_VT_PON_TWO_TAGS_VS_TUNNEL_ID:
        prog_name = "PROG_VT_PON_TWO_TAGS_VS_TUNNEL_ID";
        break;        
    case PROG_VT_IPV4_INITIAL_VID:
        prog_name = "PROG_VT_IPV4_INITIAL_VID";
        break;        
    case PROG_VT_IPV4_OUTER_VID:
        prog_name = "PROG_VT_IPV4_OUTER_VID";
        break;
     case PROG_VT_IPV4_PORT:
        prog_name = "PROG_VT_IPV4_PORT";
        break;     
    case PROG_VT_EVB_S_TAG:
        prog_name = "PROG_VT_EVB_S_TAG";
        break;     
    case PROG_VT_EVB_UN_C_TAG:
        prog_name = "PROG_VT_EVB_UN_C_TAG";
        break;
    case PROG_VT_EXTENDER_PE:
        prog_name = "PROG_VT_EXTENDER_PE";
        break;
    case PROG_VT_EXTENDER_PE_UT:
        prog_name = "PROG_VT_EXTENDER_PE_UT";
        break;
    case PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID:
        prog_name = "PROG_VT_DOUBLE_TAG_PRIORITY_INITIAL_VID";
        break;        
    case PROG_VT_DOUBLE_TAG_INITIAL_VID:
        prog_name = "PROG_VT_DOUBLE_TAG_INITIAL_VID";
        break;        
    case PROG_VT_DOUBLE_TAG_5_IP_TUPLE_Q_IN_Q:
        prog_name = "PROG_VT_DOUBLE_TAG_5_IP_TUPLE_Q_IN_Q";
        break;
    case PROG_VT_SINGLE_TAG_5_IP_TUPLE_Q_IN_Q:
        prog_name = "PROG_VT_SINGLE_TAG_5_IP_TUPLE_Q_IN_Q";
        break;
    case PROG_VT_IPV4_INITIAL_VID_AFTER_RECYCLE:
        prog_name = "PROG_VT_IPV4_INITIAL_VID_AFTER_RECYCLE";
        break;
    case PROG_VT_IPV4_OUTER_VID_AFTER_RECYCLE:
        prog_name = "PROG_VT_IPV4_OUTER_VID_AFTER_RECYCLE";
        break;
    case PROG_VT_VD_INITIALVID:
        prog_name = "PROG_VT_VD_INITIALVID";
        break;
    case PROG_VT_VD_INITIALVID_VRRP:
        prog_name = "PROG_VT_VD_INITIALVID_VRRP";
        break;
    case PROG_VT_VD_DOUBLE_TAG:
        prog_name = "PROG_VT_VD_DOUBLE_TAG";
        break;
    case PROG_VT_VD_DOUBLE_TAG_VRRP:
        prog_name = "PROG_VT_VD_DOUBLE_TAG_VRRP";
        break;       
    case PROG_VT_VD_SINGLE_TAG:
        prog_name = "PROG_VT_VD_SINGLE_TAG";
        break;
    case PROG_VT_VD_SINGLE_TAG_VRRP:
        prog_name = "PROG_VT_VD_SINGLE_TAG_VRRP";
        break;  
    case PROG_VT_VD_INITIALVID_EXPLICIT_NULL:
        prog_name = "PROG_VT_VD_INITIALVID_EXPLICIT_NULL";
        break;
    case PROG_VT_VD_DOUBLE_TAG_EXPLICIT_NULL:
        prog_name = "PROG_VT_VD_DOUBLE_TAG_EXPLICIT_NULL";
        break;       
    case PROG_VT_VD_SINGLE_TAG_EXPLICIT_NULL:
        prog_name = "PROG_VT_VD_SINGLE_TAG_EXPLICIT_NULL";
        break;
    case PROG_VT_OUTER_INNER_PCP_1_TST2:
        prog_name = "PROG_VT_OUTER_INNER_PCP_1_TST2";
        break;
    case PROG_VT_OUTER_INNER_PCP_2_TST2:
        prog_name = "PROG_VT_OUTER_INNER_PCP_2_TST2";
        break;
    case PROG_VT_OUTER_PCP_1_TST2:
        prog_name = "PROG_VT_OUTER_PCP_1_TST2";
        break;
    case PROG_VT_OUTER_PCP_2_TST2:
        prog_name = "PROG_VT_OUTER_PCP_2_TST2";
        break;
    case PROG_VT_OUTER_INNER_1_TST2:
        prog_name = "PROG_VT_OUTER_INNER_1_TST2";
        break;
    case PROG_VT_OUTER_INNER_2_TST2:
        prog_name = "PROG_VT_OUTER_INNER_2_TST2";
        break;
    case PROG_VT_OUTER_1_TST2:
        prog_name = "PROG_VT_OUTER_1_TST2";
        break;
    case PROG_VT_OUTER_2_TST2:
        prog_name = "PROG_VT_OUTER_2_TST2";
        break;
    case PROG_VT_UNTAGGED_TST2:
        prog_name = "PROG_VT_UNTAGGED_TST2";
        break;
    case PROG_VT_TEST2:
        prog_name = "PROG_VT_TEST2";
        break;
    case PROG_VT_CUSTOM_PP_PORT_TUNNEL:
        prog_name = "PROG_VT_CUSTOM_PP_PORT_TUNNEL";
        break;
    case PROG_VT_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1:
        prog_name = "PROG_VT_VD_INITIALVID_VLAN_DOMAIN_MPLS_L1";
        break;
    case PROG_VT_SECTION_OAM_ONE_TAG:
        prog_name = "PROG_VT_SECTION_OAM_ONE_TAG";
        break;
    case PROG_VT_SECTION_OAM_TWO_TAGS:
        prog_name = "PROG_VT_SECTION_OAM_TWO_TAGS";
        break;
    case PROG_VT_INDX_VD_MPLS4_INITIALVID_L1L2:
        prog_name = "PROG_VT_INDX_VD_MPLS4_INITIALVID_L1L2";
        break;
    case PROG_VT_INDX_VD_MPLS4_OUTERVID_L1L2:
        prog_name = "PROG_VT_INDX_VD_MPLS4_OUTERVID_L1L2";
        break;
    case PROG_VT_IPV6_INITIAL_VID:
        prog_name = "PROG_VT_IPV6_INITIAL_VID";
        break;        
    case PROG_VT_IPV6_OUTER_VID:
        prog_name = "PROG_VT_IPV6_OUTER_VID";
        break;
    case PROG_VT_IPV6_INITIAL_VID_AFTER_RECYCLE:
        prog_name = "PROG_VT_IPV6_INITIAL_VID_AFTER_RECYCLE";
        break;        
    case PROG_VT_IPV6_OUTER_VID_AFTER_RECYCLE:
        prog_name = "PROG_VT_IPV6_OUTER_VID_AFTER_RECYCLE";
        break;
    case PROG_VT_3MTSE_PLUS_FRR_INITIALVID_L2_L1:
         prog_name = "PROG_VT_3MTSE_PLUS_FRR_INITIALVID_L2_L1";
         break;
    case PROG_VT_3MTSE_PLUS_FRR_OUTERVID_L2_L1:
         prog_name = "PROG_VT_3MTSE_PLUS_FRR_OUTERVID_L2_L1";
         break;
    case PROG_VT_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL:
         prog_name = "PROG_VT_3MTSE_PLUS_FRR_VDxINITIALVID_L2_L4B_L5GAL";
         break;
    case PROG_VT_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL:
         prog_name = "PROG_VT_3MTSE_PLUS_FRR_VDxOUTERVID_L2_L4B_L5GAL";
         break;
    case PROG_VT_2MTSE_PLUS_FRR_VDxINITIALVID_FRR:
         prog_name = "PROG_VT_2MTSE_PLUS_FRR_VDxINITIALVID_FRR";
         break;
    case PROG_VT_2MTSE_PLUS_FRR_VDxOUTERVID_FRR:
         prog_name = "PROG_VT_2MTSE_PLUS_FRR_VDxOUTERVID_FRR";
         break;
    case PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR:
         prog_name = "PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_VID_FRR";
         break;
    case PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR:
         prog_name = "PROG_VT_2MTSE_PLUS_FRR_VDxOUTER_INNER_PCP_VID_FRR";
         break;
    case PROG_VT_GENERALIZED_RCH0:
        prog_name = "PROG_VT_GENERALIZED_RCH0";
        break;
    case PROG_VT_GENERALIZED_RCH1:
        prog_name = "PROG_VT_GENERALIZED_RCH1";
        break;

    default:
        prog_name = "Unknown program";
    }

    if (to_print)
    {
        int prog_used = -1;
        if (sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, program_id, &prog_used))
        {
            return prog_name;
        }
        if (prog_used != -1) {
            LOG_CLI((BSL_META_U(unit,
                                "Program %s ID: %d\n"), prog_name,prog_used));
        }
    }

    return prog_name;
}

char*
  arad_pp_isem_access_print_tt_program_data(
    SOC_SAND_IN  int                                 unit,
    SOC_SAND_IN  uint32                                 program_id,
    SOC_SAND_IN  uint32                                 to_print

  )
{
    char* prog_name;

    switch(program_id)
    {
    case PROG_TT_TM_PROG:
        prog_name = "PROG_TT_TM_PROG";
        break;
	case PROG_TT_OAM_STAT_PROG:
        prog_name = "PROG_TT_OAM_STAT_PROG";
        break;
	case PROG_TT_BFD_STAT_PROG:
        prog_name = "PROG_TT_BFD_STAT_PROG";
        break;
    case PROG_TT_L2:
        prog_name = "PROG_TT_L2";
        break;
    case PROG_TT_L3:
        prog_name = "PROG_TT_L3";
        break;
    case PROG_TT_L2_L3ELI:
        prog_name = "PROG_TT_L2_L3ELI";
        break;
    case PROG_TT_ARP_2ND_PROG:
        prog_name = "PROG_TT_ARP_2ND_PROG";
        break;
    case PROG_TT_BRIDGE_STAR_2ND_PROG:
        prog_name = "PROG_TT_BRIDGE_STAR_2ND_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_PWE_GRE_DIP_FOUND_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_PORT_VXLAN_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_PORT_VXLAN_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_PORT_L2_GRE_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_PORT_L2_GRE_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_MC_DIP_NOT_FOUND_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_MC_DIP_NOT_FOUND_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_UC_DIP_NOT_FOUND_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_UC_DIP_NOT_FOUND_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG_IPMC_RCY:
        prog_name = "PROG_TT_IPV4_ROUTER_DIP_FOUND_PROG_IPMC_RCY";
        break;
    case PROG_TT_IP_ROUTER_2ND_PROG:
        prog_name = "PROG_TT_IP_ROUTER_2ND_PROG";
        break;
    case PROG_TT_IPV6_ROUTER_2ND_PROG:
        prog_name = "PROG_TT_IPV6_ROUTER_2ND_PROG";
        break;
    case PROG_TT_IP_ROUTER_CompatibleMc_2ND_PROG:
        prog_name = "PROG_TT_IP_ROUTER_CompatibleMc_2ND_PROG";
        break;
    case PROG_TT_UNKNOWN_L3_PROG:
        prog_name = "PROG_TT_UNKNOWN_L3_PROG";
        break;
    case PROG_TT_MAC_IN_MAC_WITH_BTAG_PROG:
        prog_name = "PROG_TT_MAC_IN_MAC_WITH_BTAG_PROG";
        break;
    case PROG_TT_MAC_IN_MAC_MC_PROG:
        prog_name = "PROG_TT_MAC_IN_MAC_MC_PROG";
        break;
    case PROG_TT_FC_WITH_VFT_PROG:
        prog_name = "PROG_TT_FC_WITH_VFT_PROG";
        break;
    case PROG_TT_FC_PROG:
        prog_name = "PROG_TT_FC_PROG";
        break;
    case PROG_TT_INDX_L1_L2_INRIF:
        prog_name = "PROG_TT_INDX_L1_L2_INRIF";
        break;
    case PROG_TT_INDX_L1_L2_L3ELI_INRIF:
        prog_name = "PROG_TT_INDX_L1_L2_L3ELI_INRIF";
        break;
    case PROG_TT_INDX_L1_L2ELI_INRIF:
        prog_name = "PROG_TT_INDX_L1_L2ELI_INRIF";
        break;
    case PROG_TT_INDX_L3_L2:
        prog_name = "PROG_TT_INDX_L3_L2";
        break;
    case PROG_TT_INDX_MPLS_PORT_L3_L2:
        prog_name = "PROG_TT_INDX_MPLS_PORT_L3_L2";
        break;
    case PROG_TT_INDX_L3_L4:
        prog_name = "PROG_TT_INDX_L3_L4";
        break;
    case PROG_TT_INDX_L2_L3ELI:
        prog_name = "PROG_TT_INDX_L2_L3ELI";
        break;
    case PROG_TT_TRILL_2ND_PROG:
        prog_name = "PROG_TT_TRILL_2ND_PROG";
        break;
    case PROG_TT_TRILL_2ND_PROG_TWO_VLANS_AT_NATIVE_ETH:
        prog_name = "PROG_TT_TRILL_2ND_PROG_TWO_VLANS_AT_NATIVE_ETH";
        break;
    case PROG_TT_TRILL_2ND_PROG_TRILL_TRAP_PROG:
        prog_name = "PROG_TT_TRILL_2ND_PROG_TRILL_TRAP_PROG";
        break;   
    case PROG_TT_INDX_L1_L1:
        prog_name = "PROG_TT_INDX_L1_L1";
        break;
    case PROG_TT_INDX_L1_L2:
        prog_name = "PROG_TT_INDX_L1_L2";
        break;
    case PROG_TT_INDX_L1_L1_GAL:
        prog_name = "PROG_TT_INDX_L1_L1_GAL";
        break;
    case PROG_TT_INDX_L1_L2_GAL:
        prog_name = "PROG_TT_INDX_L1_L2_GAL";
        break;
    case PROG_TT_INDX_L2_L2:
        prog_name = "PROG_TT_INDX_L2_L2";
        break;
    case PROG_TT_INDX_L2_L3_GAL:
        prog_name = "PROG_TT_INDX_L2_L3_GAL";
        break;
    case PROG_TT_MLDP_AFTER_RECYCLE:
        prog_name = "PROG_TT_MLDP_AFTER_RECYCLE";
        break;
    case PROG_TT_DIP6_COMPRESSION_PROG:
      prog_name = "PROG_TT_DIP6_COMPRESSION_PROG";
      break;
    case PROG_TT_EXTENDER_UNTAG_CHECK_IP_MC:
        prog_name = "PROG_TT_EXTENDER_UNTAG_CHECK_IP_MC";
        break;
    case PROG_TT_EXTENDER_UNTAG_CHECK_IP_UC:
        prog_name = "PROG_TT_EXTENDER_UNTAG_CHECK_IP_UC";
        break;
    case PROG_TT_EXTENDER_UNTAG_CHECK:
        prog_name = "PROG_TT_EXTENDER_UNTAG_CHECK";
        break;
    case PROG_TT_IPV4_ROUTER_L3_GRE_PORT_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_L3_GRE_PORT_PROG";
        break;
    case PROG_TT_IPV4_ROUTER_DIP_SIP_VRF_PROG:
        prog_name = "PROG_TT_IPV4_ROUTER_DIP_SIP_VRF_PROG";
        break; 
    case PROG_TT_IPV4_FOR_EXPLICIT_NULL_PROG:
        prog_name = "PROG_TT_IPV4_FOR_EXPLICIT_NULL_PROG";
        break;
    case PROG_TT_TUNNEL_FOR_TWO_EXPLICIT_NULL_PROG:
        prog_name = "PROG_TT_TUNNEL_FOR_TWO_EXPLICIT_NULL_PROG";
        break;
    case PROG_TT_IP_DISABLE_FOR_EXPLICIT_NULL_PROG:
        prog_name = "PROG_TT_IP_DISABLE_FOR_EXPLICIT_NULL_PROG";
        break;
    case PROG_TT_IPV4_DISABLE_FOR_EXPLICIT_NULL_PROG:
        prog_name = "PROG_TT_IPV4_DISABLE_FOR_EXPLICIT_NULL_PROG";
        break;
    case PROG_TT_IPV6_DISABLE_FOR_EXPLICIT_NULL_PROG:
        prog_name = "PROG_TT_IPV6_DISABLE_FOR_EXPLICIT_NULL_PROG";
        break;
    case PROG_TT_EXTENDER_IP_MC_PROG:
        prog_name = "PROG_TT_EXTENDER_IP_MC_PROG";
        break;
    case PROG_TT_EXTENDER_IP_UC_PROG:
        prog_name = "PROG_TT_EXTENDER_IP_UC_PROG";
        break;
    case PROG_TT_EXTENDER_PROG:
        prog_name = "PROG_TT_EXTENDER_PROG";
        break;
    case PROG_TT_INDX_L1_GAL_ONLY:
        prog_name = "PROG_TT_INDX_L1_GAL_ONLY";
        break;
    case PROG_TT_INDX_L2_GAL_ONLY:
        prog_name = "PROG_TT_INDX_L2_GAL_ONLY";
        break;
    case PROG_TT_VLAN_DOMAIN_MPLS_L2:
        prog_name = "PROG_TT_VLAN_DOMAIN_MPLS_L2";
        break;
    case PROG_TT_INDX_AS_ORDER_L2_L3:
        prog_name = "PROG_TT_INDX_AS_ORDER_L2_L3";
        break;
    case PROG_TT_INDX_AS_ORDER_L2_L2:
        prog_name = "PROG_TT_INDX_AS_ORDER_L2_L2";
        break;
    case PROG_TT_INDX_AS_ORDER_L1_L2:
        prog_name = "PROG_TT_INDX_AS_ORDER_L1_L2";
        break;
    case PROG_TT_INDX_AS_ORDER_L1_L1:
        prog_name = "PROG_TT_INDX_AS_ORDER_L1_L1";
        break;
    case PROG_TT_INDX_AS_ORDER_NOP:
        prog_name = "PROG_TT_INDX_AS_ORDER_NOP";
        break;
    case PROG_TT_INDX_MPLS4_L3_L4:
        prog_name = "PROG_TT_INDX_MPLS4_L3_L4";
        break;
    case PROG_TT_INDX_MPLS4_NOP:
        prog_name = "PROG_TT_INDX_MPLS4_NOP";
        break;
    case PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND:
        prog_name = "PROG_TT_IPV6_ROUTER_COMP_DEST_FOUND";
        break;
    case PROG_TT_IPV6_ROUTER_2ND_PROG_AFTER_RECYCLE:
        prog_name = "PROG_TT_IPV6_ROUTER_2ND_PROG_AFTER_RECYCLE";
        break;
    case PROG_TT_PPPOE_PROG:
        prog_name = "PROG_TT_PPPOE_PROG";
        break;
	case PROG_TT_L2TP:
		prog_name = "PROG_TT_L2TP";
		break;
    case PROG_TT_3MTSE_PLUS_FRR_L1_L1:
        prog_name = "PROG_TT_3MTSE_PLUS_FRR_L1_L1";
        break;
    case PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3:
        prog_name = "PROG_TT_3MTSE_PLUS_FRR_TFL_L3_L3";
        break;
    case PROG_TT_3MTSE_PLUS_FRR_L3_L1:
        prog_name = "PROG_TT_3MTSE_PLUS_FRR_L3_L1";
        break;
    case PROG_TT_3MTSE_PLUS_FRR_TFL_L4_L3:
        prog_name = "PROG_TT_3MTSE_PLUS_FRR_TFL_L4_L3";
        break;
    case PROG_TT_3MTSE_PLUS_FRR_L1:
        prog_name = "PROG_TT_3MTSE_PLUS_FRR_L1";
        break;
    case PROG_TT_3MTSE_PLUS_FRR_L2_L1:
         prog_name = "PROG_TT_3MTSE_PLUS_FRR_L2_L1";
         break;
    case PROG_TT_2MTSE_PLUS_FRR_L1_L1:
         prog_name = "PROG_TT_2MTSE_PLUS_FRR_L1_L1";
         break;
    case PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2:
         prog_name = "PROG_TT_2MTSE_PLUS_FRR_TFL_L2_L2";
         break;
    case PROG_TT_2MTSE_PLUS_FRR_L2_L1:
         prog_name = "PROG_TT_2MTSE_PLUS_FRR_L2_L1";
         break;
    case PROG_TT_2MTSE_PLUS_FRR_TFL_L3_L2:
         prog_name = "PROG_TT_2MTSE_PLUS_FRR_TFL_L3_L2";
         break;
    case PROG_TT_GENERALIZED_RCH_MPLS_PROG:
        prog_name = "PROG_TT_GENERALIZED_RCH_MPLS_PROG";
        break;
    case PROG_TT_MYMAC_IP_DISABLED_TRAP_PROG:
        prog_name = "PROG_TT_MYMAC_IP_DISABLED_TRAP_PROG";
        break;
    default:
        prog_name = "Unknown program";
    }
    
    if (to_print)
    {
        int prog_used = -1;
        if (sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, program_id, &prog_used))
        {
            return prog_name;
        }
        if (prog_used != -1) {
            LOG_CLI((BSL_META_U(unit,
                                "Program %s ID: %d\n"), prog_name,prog_used));
        }
    }

    return prog_name;
}


void
  arad_pp_isem_access_print_all_programs_data(
    SOC_SAND_IN  int                                 unit
  )
{
    int program_id;

    LOG_CLI((BSL_META_U(unit,"\nVT programs:\n")));
    LOG_CLI((BSL_META_U(unit,"------------\n\n")));
    for (program_id = 0; program_id < PROG_VT_NOF_PROGS; program_id++) {
        arad_pp_isem_access_print_vt_program_data(unit, program_id, 1);
        arad_pp_isem_access_print_vt_program_look_info(unit, program_id);
    }
    LOG_CLI((BSL_META_U(unit,"\nTT programs:\n")));
    LOG_CLI((BSL_META_U(unit,"------------\n\n")));
    for (program_id = 0; program_id < PROG_TT_NOF_PROGS; program_id++) {
        arad_pp_isem_access_print_tt_program_data(unit, program_id, 1);
        arad_pp_isem_access_print_tt_program_look_info(unit, program_id);
    }
}



void
  arad_pp_isem_access_program_sel_line_to_program_id(
    SOC_SAND_IN   int                 unit,
    SOC_SAND_IN   int                 line,    
    SOC_SAND_IN   int                 is_vt,
    SOC_SAND_OUT  uint8               *prog_id
  ) 
{

    uint8 found = FALSE;
    int program_id;
    int prog_used = -1;
    
    if (is_vt)
    {
        for (program_id = 0; program_id < PROG_VT_NOF_PROGS; program_id++){
            if (sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, program_id, &prog_used))
            {
                break;
            }
            if (prog_used == line)
            {
                *prog_id = program_id;
                found = TRUE;
                break;
            }
        }
    } else {

        for (program_id = 0; program_id < PROG_TT_NOF_PROGS; program_id++){
            if (sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, program_id, &prog_used))
            {
                break;
            }
            if (prog_used == line)
            {
                found = TRUE;
                *prog_id = program_id;
                break;
            }
        }
    }

    if (!found){
        *prog_id = -1;
    }
}

uint32
  arad_pp_isem_access_print_last_vtt_program_data(
    SOC_SAND_IN   int                 unit,
    SOC_SAND_IN   int                 core_id,
    SOC_SAND_IN   int                 to_print,
    SOC_SAND_OUT  int                 *prog_id_vt,
    SOC_SAND_OUT  int                 *prog_id_tt,
    SOC_SAND_OUT  int                 *num_of_progs_vt,
    SOC_SAND_OUT  int                 *num_of_progs_tt
  )
{
    uint8 found = FALSE;
    uint32 fld_val, 
        vt_progs_bmp,
        tt_progs_bmp,
        pgm_ndx,
        program_id,
        res = SOC_SAND_OK;
    int prog_used;
    uint64 reg_val64;
    

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    

    *prog_id_vt = -1;
    *prog_id_tt = -1;
	(*num_of_progs_vt) = 0;
	(*num_of_progs_tt) = 0;

    SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, READ_IHP_VTT_PROGRAM_ENCOUNTEREDr(unit, core_id ,&reg_val64));
    fld_val = soc_reg64_field32_get(unit, IHP_VTT_PROGRAM_ENCOUNTEREDr, reg_val64, SOC_IS_JERICHO(unit) ? VLAN_TRANSLATION_PROGRAM_ENCOUNTEREDf : VTT_PROGRAM_FIRST_LOOKUPf);
    vt_progs_bmp = fld_val;
    fld_val = soc_reg64_field32_get(unit, IHP_VTT_PROGRAM_ENCOUNTEREDr, reg_val64, SOC_IS_JERICHO(unit) ? TUNNEL_TERMINATION_PROGRAM_ENCOUNTEREDf : VTT_PROGRAM_SECOND_LOOKUPf);
    tt_progs_bmp = fld_val;

    if (to_print){
        LOG_CLI((BSL_META_U(unit,"Last invoked VT program:\n")));
    }
    for (pgm_ndx = 0; pgm_ndx < SOC_DPP_DEFS_GET(unit, nof_vtt_programs); pgm_ndx++)
    {
        if (SOC_SAND_GET_BIT(vt_progs_bmp, pgm_ndx))
        {
            
            found = TRUE;            
            for (program_id = 0; program_id < PROG_VT_NOF_PROGS; program_id++)
            {
                res = sw_state_access[unit].dpp.soc.arad.pp.vtt.vt_programs.get(unit, program_id, &prog_used);
                SOC_SAND_CHECK_FUNC_RESULT(res, program_id, exit);
                if (prog_used == pgm_ndx)
                {
                    *prog_id_vt = pgm_ndx;
                    (*num_of_progs_vt)++;
                    arad_pp_isem_access_print_vt_program_data(unit, program_id, to_print);
                    break;
                }
            }
        }
    }

    if (!found)
    {
        if(to_print){
            LOG_CLI((BSL_META_U(unit,"No program invoked\n")));
        }
    }

    found = FALSE;
    if (to_print){
        LOG_CLI((BSL_META_U(unit,"Last invoked TT program:\n")));
    }

    for (pgm_ndx = 0; pgm_ndx < SOC_DPP_DEFS_GET(unit, nof_vtt_program_selection_lines); pgm_ndx++)
    {
        if (SOC_SAND_GET_BIT(tt_progs_bmp, pgm_ndx))
        {
            
            found = TRUE;
            for (program_id = 0; program_id < PROG_TT_NOF_PROGS; program_id++)
            {
                res = sw_state_access[unit].dpp.soc.arad.pp.vtt.tt_programs.get(unit, program_id, &prog_used);
                SOC_SAND_CHECK_FUNC_RESULT(res, program_id, exit);
                if (prog_used == pgm_ndx)
                {
                    *prog_id_tt = pgm_ndx;
                    (*num_of_progs_tt)++;
                    arad_pp_isem_access_print_tt_program_data(unit, program_id, to_print);
                    break;
                }
            }
        }
    }


    if (!found)
    {
        if (to_print){
            LOG_CLI((BSL_META_U(unit,"No program invoked\n")));
        }
    }

    
    COMPILER_64_ALLONES(reg_val64);
    SOC_SAND_SOC_IF_ERROR_RETURN(res, 20, exit, WRITE_IHP_VTT_PROGRAM_ENCOUNTEREDr(unit,core_id, reg_val64));


exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_pp_isem_access_print_last_vtt_program_data()", 0, 0);
}


#include <soc/dpp/SAND/Utils/sand_footer.h>


#endif 

