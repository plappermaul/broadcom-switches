/* $Id: arad_egr_prog_editor.c,v 1.142.2.17 Broadcom SDK $
 * $Copyright: (c) 2016 Broadcom.
 * Broadcom Proprietary and Confidential. All rights reserved.$
 * $
*/


#include <soc/mcm/memregs.h>
#if defined(BCM_88650_A0)

#ifdef _ERR_MSG_MODULE_NAME
  #error "_ERR_MSG_MODULE_NAME redefined"
#endif

#define _ERR_MSG_MODULE_NAME BSL_SOC_EGRESS


/*************
 * INCLUDES  *
 *************/
/* { */
#include <shared/bsl.h>
#include <shared/swstate/access/sw_state_access.h>
#include <sal/appl/sal.h>

#include <soc/dcmn/error.h>
#include <soc/dcmn/dcmn_dev_feature_manager.h>
#include <soc/dpp/drv.h>

#include <soc/dpp/SAND/Utils/sand_header.h>
#include <soc/dpp/SAND/Utils/sand_os_interface.h>

#include <soc/dpp/SAND/Management/sand_general_macros.h>
#include <soc/dpp/SAND/Management/sand_error_code.h>

#include <soc/dpp/TMC/tmc_api_stack.h>

#include <soc/dpp/ARAD/arad_api_framework.h>
#include <soc/dpp/ARAD/arad_api_mgmt.h>
#include <soc/dpp/ARAD/arad_tbl_access.h>
#include <soc/dpp/ARAD/arad_ports.h>
#include <soc/dpp/ARAD/arad_sw_db.h>
#include <soc/dpp/ARAD/arad_reg_access.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_oam.h>

#include <soc/dpp/ARAD/arad_egr_prog_editor.h>

#include <soc/dpp/ARAD/arad_egr_prge_mgmt.h>
#include <soc/dpp/ARAD/arad_egr_prge_interface.h>

#include <soc/dpp/PPD/ppd_api_eg_encap.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_general.h>



/* } */
/*************
 * DEFINES   *
 *************/
/* { */



#define IPV4_UC    (1)
#define IPV4_MC    (2)
#define IPV6_UC    (3)
#define IPV6_MC    (4)
#define CPU_TRAP    (15)



#define ARAD_PP_EG_PROG_NO_COMPARE (0x7)

#define ARAD_PP_EG_PROG_NULL_LFEM(_unit)    (ARAD_PP_EG_PROG_NOF_FEM(_unit))

typedef enum {
    ifc_10G = 0, 
    ifc_40G = 1,
    ifc_100G = 2,
    Ilaken = 3
} Ifc_mode ;

typedef enum {
    ofp_1p = 0, 
    ofp_2p = 1,
    ofp_8p = 2
}  Ofp_mode ;

/* -----------------------------------------------------------------------------k----------------------- */
/*                          PRGE - Programable Editor */
/* ---------------------------------------------------------------------------------------------------- */

#define ARAD_PP_PRGE_ENG_SIZE_REG_R0        (0)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R1        (1)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R2        (2)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R3        (3)
#define ARAD_PP_PRGE_ENG_SIZE_REG_SZ        (4)
#define ARAD_PP_PRGE_ENG_SIZE_CONST         (5)
#define ARAD_PP_PRGE_ENG_SIZE_CONSTANT      ARAD_PP_PRGE_ENG_SIZE_CONST

#define ARAD_PP_PRGE_ENG_OFFSET_REG_R0         (0)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R1         (1)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R2         (2)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R3         (3)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_SZ         (4)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_0        (5)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_64       (6)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_96       (7)

#define ARAD_PP_PRGE_ENG_OP1_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_OP1_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_OP1_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_OP1_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_OP1_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_OP1_SIZE         (5)
#define ARAD_PP_PRGE_ENG_OP1_FEM_FIELD    (6)
#define ARAD_PP_PRGE_ENG_OP1_OP_VALUE     (7)

#define ARAD_PP_PRGE_ENG_OP2_SIZE         ARAD_PP_PRGE_ENG_OP1_SIZE
#define ARAD_PP_PRGE_ENG_OP2_FEM_FIELD    ARAD_PP_PRGE_ENG_OP1_FEM_FIELD
#define ARAD_PP_PRGE_ENG_OP2_REG_SZ       ARAD_PP_PRGE_ENG_OP1_REG_SZ
#define ARAD_PP_PRGE_ENG_OP2_REG_R0       ARAD_PP_PRGE_ENG_OP1_REG_R0
#define ARAD_PP_PRGE_ENG_OP2_REG_R1       ARAD_PP_PRGE_ENG_OP1_REG_R1
#define ARAD_PP_PRGE_ENG_OP2_REG_R2       ARAD_PP_PRGE_ENG_OP1_REG_R2
#define ARAD_PP_PRGE_ENG_OP2_REG_R3       ARAD_PP_PRGE_ENG_OP1_REG_R3
#define ARAD_PP_PRGE_ENG_OP2_OP_VALUE     ARAD_PP_PRGE_ENG_OP1_OP_VALUE

#define ARAD_PP_PRGE_ENG_OP3_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_OP3_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_OP3_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_OP3_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_OP3_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_OP3_SIZE         (5)
#define ARAD_PP_PRGE_ENG_OP3_OP_VALUE     (7)
#define ARAD_PP_PRGE_ENG_OP3_ALU          (8)

#define ARAD_PP_PRGE_ENG_DST_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_DST_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_DST_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_DST_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_DST_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_DST_INST_ADDR    (5)
#define ARAD_PP_PRGE_ENG_DST_DATA_ADDR    (6)

#define ARAD_PP_PRGE_SRC_ORIGINAL (0)
#define ARAD_PP_PRGE_SRC_GENERATED (1)
#define ARAD_PP_PRGE_SRC_RESOLVED (2)

#define ARAD_PP_PRGE_ACE_VARIABLE (59)
#define ARAD_PP_PRGE_EES_DATA1 (31)
#define ARAD_PP_PRGE_EES_DATA2 (17)
#define ARAD_PP_PRGE_SYS_HEADERS_SIZE (33)

#define ARAD_PP_PRGE_CMP_PASS_ALL (7)
/* offset source is 0B const   this value is pointing the LSB  (sic) */
#define ARAD_PP_PRGE_DST_SYSTEM_PORT 39  
#define ARAD_PP_PRGE_OUT_LIF 57
#define ARAD_PP_PRGE_OUT_PP_PORT             113 

#define ARAD_PP_PRGE_PROGRAM_VAR    3 /*   offset source is 64B const ** this value is pointing the LSB  */

#define ARAD_PP_PRGE_TOD_NTP 81 /*offset source is 0B const. This value is pointing the LSB */
#define ARAD_PP_PRGE_TOD_1588 97 /*offset source is 0B const. This value is pointing the LSB */

#define ARAD_PP_PRGE_NWK_HEADERS_SIZE        35  /*   offset source is 64B const. this value is pointing the LSB  */

#define ARAD_PP_PRGE_PP_PORT_VARIABLE        45  /*   offset source is 0B const . This value is pointing the LSB  */

/* FTHM & PPH sizes*/

/* --------------------------- */
/* type values */
/* --------------------------- */

/* forwarding code types */
#define PP_FWD_CODE_ETHERNET                   (0x0)
#define PP_FWD_CODE_IPV4_UC                    (0x1)
#define PP_FWD_CODE_IPV4_MC                    (0x2)
#define PP_FWD_CODE_IPV6_UC                    (0x3)
#define PP_FWD_CODE_IPV6_MC                    (0x4)
#define PP_FWD_CODE_MPLS                       (0x5)
#define PP_FWD_CODE_TRILL                      (0x6)
#define PP_FWD_CODE_ETHERNET_AFTER_TERMINATION (0x8)
#define PP_FWD_CODE_CUSTOM1                    (0x9)
#define PP_FWD_CODE_FCF                         PP_FWD_CODE_CUSTOM1
#define PP_FWD_CODE_CUSTOM2                    (0xa)
#define PP_FWD_CODE_SNOOP                      (0xb)
#define PP_FWD_CODE_TM                         (0xe)

#define ETH_TYPE_IPV6     (0x86dd)

#define ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE 24

/* Fields Value */

/* max program number */
#define SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)     (SOC_DPP_DEFS_GET(unit, nof_prge_programs)-1)

/* Number of instruction entries INCLUDING JUMP ONLY entries
   A JER_A0 bug in this regard was fixed in JER_B0
   but there's no column for JER_B0 in soc_dpp_defines so doing the ugly */
#define SOC_DPP_EGR_PROG_EDITOR_NOF_ENTRY_POINTERS(unit) (SOC_IS_JERICHO_B0(unit)?42:SOC_DPP_DEFS_GET(unit, nof_prge_instr_entries))

/* max program selection entry */
#define ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(_unit)  (SOC_DPP_DEFS_GET((_unit), egr_prge_nof_prog_sel_tcam_entries)-1)

/* General defines*/

#define ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE 9 /* 9 bytes */
#define ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_BASE_SIZE 6 /* 6 bytes */
#define ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE 7 /* 7 bytes */

#define ARAD_EGR_PROG_EDITOR_FTMH_STACKING_EXTENSION_SIZE 2 /* 16 bits */

#define ARAD_EGR_PROG_EDITOR_FTMH_LB_EXTENSION_SIZE 1 /* 8 bits */
#define ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_LB_EXTENSION_SIZE 2 /* 16 bits */

#define ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE 2 /*16 bits*/

#define ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE 6 /* 6 bytes */

#define ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE 31

#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_NO_FHEI  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE)
#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_3_BYTE  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3)
#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_5_BYTE  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 5)

#define _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_BITS_NOF(_unit) SOC_DPP_DEFS_GET(_unit,sys_hdrs_format_code_bits)
#define _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_VALUE_1_OFFSET_BITS_NOF(_unit) SOC_DPP_DEFS_GET(_unit,value_1_offset_bits)
/**
 * calculate the total FTMH size.
 */
#define ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE  ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + \
         SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_stacking_ext_mode * ARAD_EGR_PROG_EDITOR_FTMH_STACKING_EXTENSION_SIZE +\
         (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode ? ARAD_EGR_PROG_EDITOR_FTMH_LB_EXTENSION_SIZE : 0 )

#define ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_TOTAL_SIZE ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_BASE_SIZE + \
         (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode ? ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_LB_EXTENSION_SIZE : 0 ) + 2

/* Following values reperesnt the first byte of the OAM-TS. OAM-TS.TYPE==0, OAM-TS.OAM-SUBTYPE==2/3 , OAM-TS.MEP-TYPE==0 (down)*/
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_NTP_DOWN  0x18
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_1588_DOWN  0x10

/* Observe only the first 6 bits.*/
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_MASK  3


/* PMF (Ace) Values */
#define ARAD_EGR_PROG_EDITOR_ACE_BFD_CLEAR_FLAGS                1
#define ARAD_EGR_PROG_EDITOR_ACE_REFLECTOR_1PASS                2
#define ARAD_EGR_PROG_EDITOR_ACE_END_TLV                        3


#define ARAD_EGR_PROG_EDITOR_FRR_LABEL_DEFAULT_TTL 255

/* MIM SPB constant to signify replacing the BSA */
#define ARAD_EGR_PRGE_MIM_BSA_REPLACE_LSB           0

/* MPLS and IP default ports for UDP tunnels */
#define ARAD_EGR_PRGE_UDP_TUNNEL_IPV4_DEFAULT_PORT ARAD_PP_UDP_IPV4_DST_PORT
#define ARAD_EGR_PRGE_UDP_TUNNEL_IPV6_DEFAULT_PORT ARAD_PP_UDP_IPV6_DST_PORT
#define ARAD_EGR_PRGE_UDP_TUNNEL_MPLS_DEFAULT_PORT ARAD_PP_UDP_MPLS_DST_PORT

/* } */
/*************
 * MACROS    *
 *************/
/* { */


/* } */
/*************
 * TYPE DEFS *
 *************/
/* { */

typedef struct
{
  uint32 val1;
  uint32 val2;
} lfem_map;

 


/* } */
/*************
 * GLOBALS   *
 *************/
/* { */


STATIC uint8
    lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS][34] = {

        /* 
         * THESE HAVE TO BE IN THE SAME ORDER AS THE "ARAD_EGR_PROG_EDITOR_LFEMS" enum! 
         * The enumeration value at the start of the line is used to validate this. 
         */

        /* LSB masks */
        {ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS, 1,0, 1,0, 1,0, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS, 1,0, 1,0, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS_SWAPPED, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0, 0,1},

        /* MSB masks */
        {ARAD_EGR_PROG_EDITOR_LFEM_8_MSBS, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8,   1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_12_MSBS, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4,   1,0, 1,0, 1,0, 1,0},

        /* Bit extraction */
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_2, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3},


        /* General masking */
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1,  0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10, 0,15, 0,14, 0,13, 0,12, 0,11, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10,  0,15, 0,14, 0,13, 0,12, 0,11, 1,1, 1,1, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_MASK_HEX_81, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT1, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT3, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT12_TO_BIT13, 0,15, 0,14, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,1, 1,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_CENTRAL_BITS, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_PERIPHERAL_BITS, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT1_CLR_BIT0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 1,0},

        /* 2 bit vals, multiplied by 2*/
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_3_M, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_0_M, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BITS_0_M, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0, 1,0},

        /* Shifts */
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_2, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_12, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_2,  1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},
		{ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_1_FIRST_BIT_ONLY, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1},
		
        /* spicific for MPLS headers */         /* label,highest nibble */    /* TC/EXP */      /* bos */            /* TTL */
        {ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP     ,  1,0,  1,0,  1,0,  1,0,     0,11, 0,10, 0,9,     1,0,    0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP_COMP,  0,15, 0,14, 0,13, 0,12,    1,0,  1,0,  1,0,     0,8,    1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        /* Petra-B */
        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB, 1,1, 1,1, 1,1,  1,1, 1,1, 1,1, 0,6, 0,5, 0,3, 0,2 ,0,11, 0,10, 0,9 ,0,8 ,0,7, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB, 1,0 ,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,9, 0,8, 0,11, 0,10, 0,4, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB, 0,15, 0,14, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4},

        {ARAD_EGR_PROG_EDITOR_LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,1, 0,2, 1,1, 0,0},


        /* Arad */
        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,10, 0,9, 0,3, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,23, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,29, 0,28, 0,27, 0,2, 0,1, 1,1, 1,1, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC_JER, 1,0, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,0, 0,29, 0,28, 0,27, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 1,0, 1,1, 1,0, 1,1, 1,1, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 1,1, 1,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 1,1, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8,  0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,1, 1,0, 1,1, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,6},

        {ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,21, 0,20, 0,19, 0,18, 0,17, 0,16},

        {ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A, 0,15, 0,14, 0,13, 0,12, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE, 1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES,  1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES,   0,15, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 1,0, 1,0, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC, 1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,1, 1,1, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,18, 0,17, 0,16},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH, 1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD,       1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,1, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,1, 1,1, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS,  0,16, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXCLUDE_TOD,       0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC, 1,0, 0,5, 0,4, 0,3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0, 1,0, 1,0, 1,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,1, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS,    1,0 ,1,0 ,1,0 ,1,0 ,0,11 ,0,10 ,0,9 ,1,0 ,0,7 ,0,6 ,0,5 ,0,4 ,0,3 ,0,2 ,0,1 ,0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS,    0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        
		{ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1},
		
		{ARAD_EGR_PROG_EDITOR_LFEM_SET_BITS_7_8, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 1,0, 1,1, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SVID, 1,0, 1,0, 1,0, 1,0, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_EID, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,6},

        {ARAD_EGR_PROG_EDITOR_LFEM_FAP_ID, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SA_FAP, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SA_LAG, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IS_LAG, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,15},

        {ARAD_EGR_PROG_EDITOR_LFEM_4_MSB_AND_LSB, 0,15, 0,14, 0,13, 0,12, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TOS, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_MASK_BIT_2_3, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC_AS_MSB, 0,5, 0,4, 0,3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        /* customer application that connect to NP */
        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_OUT, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_PPH_VSI, 1,0, 1,0, 1,0, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_TAG_NUM, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_OUTFP_MSB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,24},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_DEL_LEN, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_VLAN_STATUS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_IN, 0,17, 0,16, 0,15, 0,14, 0,13, 0,12, 0,11, 0,18, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_COS_COLOR, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,21, 0,29, 0,28, 0,27, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 1,0, 1,0, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_LAG, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE, 1,0, 1,0, 1,0,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP, 1,1, 1,1, 1,0, 1,1, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,29, 0,2, 0,1, 1,0, 1,0, 1,0},
        
        {ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP_MC, 1,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,29, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE_MC, 1,0, 1,0, 1,0,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,0, 1,0, 0,3, 0,2, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_MC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,4, 0,3, 0,2, 1,0, 1,0, 1,0, 1,0},
            
        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_FROM_CUD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,11, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_NPH_H_S, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 1,0, 1,0, 0,6, 1,0, 1,0, 1,0},
           
        /* Jericho */
        {ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S_TTL, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 1,0, 1,1, 1,1, 1,1, 1,1, 1,1, 1,1, 1,1, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_ESI_LSB, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_TTL, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_BOS_TTL, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,19, 0,18, 0,17, 0,16, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 3, 1, 0 },

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_PPH_TYPE_2, 1, 0, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0 },

    }; /* lfem_actions[][] */


/* 
 * Shadow of the FEM actions loaded to the HW.
 * ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS means this slot is empty, other values represent the FEM action.
 */
lfem_maps_shadow_t lfem_maps_shadow[SOC_MAX_NUM_DEVICES];

/* 
 * used to show which programs needs to be set:
 */
ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INFO programs_usage[SOC_MAX_NUM_DEVICES];

/* 
 * last program ID used for allocation: 
 * if -1: no programs has been allocated yet 
 * max is 15 
 */
int last_program_id[SOC_MAX_NUM_DEVICES];

/* 
 * last tm profile used for allocation: 
 * if -1: no tm profile has been allocated yet 
 * max is 16 
 */
int last_tm_profile[SOC_MAX_NUM_DEVICES];

/* 
 * last instruction entry used for allocation: 
 * if -1: no instruction entry has been allocated yet 
 * max is 41
 */
int last_program_pointer[SOC_MAX_NUM_DEVICES];

/* 
 * Number of tm profiles that can be used 
 * max is 16
 */
int tm_profiles_available[SOC_MAX_NUM_DEVICES];

/* 
 * Index of the STACKING_8 LFEM if it was allocated and loaded.
 * -1 if not.
 */
int lfem_stacking_8_index[SOC_MAX_NUM_DEVICES];

/* 
 * LFEM map table of the STACKING_8 LFEM if it was allocated and loaded.
 */
int lfem_stacking_8_map[SOC_MAX_NUM_DEVICES];

/* 
 * Index of the STACKING_8 LFEM if it was allocated and loaded.
 * -1 if not.
 */
int lfem_stacking_10_index[SOC_MAX_NUM_DEVICES];

/* 
 * LFEM map table of the STACKING_10 LFEM if it was allocated and loaded.
 */
int lfem_stacking_10_map[SOC_MAX_NUM_DEVICES];

/*
 * Last branch entry allocated.
 */
int last_branch_entry[SOC_MAX_NUM_DEVICES];

/*
 * Entries allocated to each branch.
 * -1 means the branch wasn't allocated.
 */
int branch_entries[SOC_MAX_NUM_DEVICES][ARAD_EGR_PROG_EDITOR_BRANCH_IDS_NOF];

/* } */
/*************
 * FUNCTIONS *
 *************/
/* { */

/* Convert lfem_map array to 96 bit table data */
void
  lfem_map_arr_to_lfem_field_select_map(
    SOC_SAND_IN  lfem_map lfem_arr[],
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  );

/* Loads lfem action from the actions static array to 96 bit table data */
void
  lfem_map_action_to_lfem_field_select_map(
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_LFEM lfem_action,
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  );

uint32 
  arad_egr_prog_editor_basic_epni_tm_config(
    SOC_SAND_IN  int unit
  ); 

void 
  header_editing_size_to_reg_val(
    SOC_SAND_IN  soc_reg_above_64_val_t val, 
    SOC_SAND_OUT soc_reg_above_64_val_t dest
  );


#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_LEARN_EXT_EXISTS_BIT 0x1
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_EEI_EXT_EXISTS_BIT 0x2
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS 0xc
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_EXISTS_BIT 0x10
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT 0x20
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT 0x40

#define COE_TYPE_2_TPID 0x8100

/**
 * Set the VALUE_1_OFFSET register and related registers. 
 * the VALUE_1_OFFSET register is accesed by one of 8 profiles, 
 * a profile is attained from the SYSTEM_HEADERS_FORMAT_CODE 
 * register. SYSTEM_HEADERS_FORMAT_CODE is accessed with the 
 * mapping 
 * {ftmh_dsp_ext_exists,ftmh_oam_ts_ext_exists,sys_hdr_record[`EPP_SYS_RCRD_PPH_VALID],fhei_size 
 * (0--> not present, 1--> 3 Byte, 2-->5 Byte),
 * pph_eei_ext_exists,pph_learn_ext_exists} 
 *  
 * Note that program selection cam should be configured 
 * accordingly to account for system header stack. 
 *  
 * All programs using the value_1_offset in the program 
 * selection cam should  
 *  
 * The  VALUE_1_OFFSET[profile] is a 5 bit field.
 *  
 * @author sinai (03/04/2014)
 * 
 * @param unit 
 * 
 * @return STATIC uint32 
 */
STATIC uint32 arad_egr_prg_editor_set_value_1_offset(int unit) {
	uint8 sys_header_format_code_key;
	soc_reg_above_64_val_t reg_above64_val; 
	uint32 value_1_key;
	uint32 value_1_offset[8] = {0};
	int i;
	uint32 res;
	int profile_used=0;
    uint8 value_1_offset_first_profile;
    uint8 num_value_1_offset_profiles;
    uint32 format_code_bits_nof = _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_BITS_NOF(unit);
    uint32 value_1_offset_bits_nof = _ARAD_EGR_PROG_EDITOR_SYSTEM_HEADERS_VALUE_1_OFFSET_BITS_NOF(unit);
    uint8 dscp_preserve_set_value_1;
    uint8 is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);


	SOC_REG_ABOVE_64_CLEAR(reg_above64_val);

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , READ_EPNI_SYSTEM_HEADERS_FORMAT_CODEr(unit, REG_PORT_ANY, reg_above64_val));

	/* First, determine the profiles*/
	if (programs_usage[unit].oam_dm_down) {
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);
		profile_used += num_value_1_offset_profiles;
	}

    if (programs_usage[unit].vmac_enable) {
        /* VMAC uses 3 profiles, depending on the FHEI size*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 30, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 40, exit);
		profile_used += num_value_1_offset_profiles;
    }

    if (programs_usage[unit].delay_based_ecn2) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 50, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 60, exit);
		profile_used += num_value_1_offset_profiles;
    }

    dscp_preserve_set_value_1 = (SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_INLIF_CTRL_EN;
    if (dscp_preserve_set_value_1) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 50, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 60, exit);
		profile_used += num_value_1_offset_profiles;
    }

    if (programs_usage[unit].oam_1711) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            set(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, profile_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 50, exit);
		res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &num_value_1_offset_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 60, exit);
		profile_used += num_value_1_offset_profiles;
    }

	/* Next, set the profiles according to the system headers configurations..*/
	for (sys_header_format_code_key = 0; sys_header_format_code_key < 0x80 /* all combinations of 7 bits. */; ++sys_header_format_code_key) {
        value_1_key=0;
		if (programs_usage[unit].oam_dm_down
            && (sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT)) {

            /* first profile: OAM-TS without DSP,  second profile: OAM-TS withou DSP*/
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 70, exit);
            value_1_key = value_1_offset_first_profile +
                 ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT) > 0);

        } else if (programs_usage[unit].delay_based_ecn2
                   && (sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT)) {

            /* first profile: ECN bit in FTMH */
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 80, exit);
            value_1_key = value_1_offset_first_profile;

		} else if (programs_usage[unit].vmac_enable) {

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 90, exit);
            if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) ==0) {
                /* NO FHEI., use first profile*/
                value_1_key = value_1_offset_first_profile;
            } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0x4 ) {
                /* 3 byte FHEI, use second profile*/
                value_1_key = value_1_offset_first_profile + 1;
            } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0x8 ) {
                /* 5 byte FHEI, use third profile*/
                value_1_key = value_1_offset_first_profile + 2;
            }

		} else if (dscp_preserve_set_value_1) {

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                get(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &value_1_offset_first_profile);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 91, exit);
            if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT) == 0) {
                /* OAM_TS_PRESENT == 0, profile 0/1 */
                if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 0x4) {
                    /* 3B FHEI., use first profile*/
                    value_1_key = value_1_offset_first_profile;
                } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0xC ) {
                    /* 8B FHEI, use second profile*/
                    value_1_key = value_1_offset_first_profile + 1;
                }
            }
            else {
                /* OAM_TS_PRESENT == 1, profile 3/4 */
                if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 0x4) {
                    /* 3B FHEI., use first profile*/
                    value_1_key = value_1_offset_first_profile + 2;
                } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0xC ) {
                    /* 8B FHEI, use second profile*/
                    value_1_key = value_1_offset_first_profile + 3;
                }
            }
        } else if (programs_usage[unit].oam_1711 && (sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT)) {
            if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) == 4) {
                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
                    get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &value_1_offset_first_profile);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 80, exit);
                value_1_key = value_1_offset_first_profile;
            }
        }
        SHR_BITCOPY_RANGE(reg_above64_val, (format_code_bits_nof * sys_header_format_code_key), &value_1_key, 0, format_code_bits_nof);
	}

    /* In petab with oam_dm_down value1_key is set to 0 */
    if (is_petrab_in_system && programs_usage[unit].oam_dm_down) {
        SOC_REG_ABOVE_64_CLEAR(reg_above64_val);
    }
    
	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit ,  WRITE_EPNI_SYSTEM_HEADERS_FORMAT_CODEr(unit, REG_PORT_ANY, reg_above64_val));


	/* Now set the actual offsets given the profiles.*/
	if (programs_usage[unit].oam_dm_down) {
		/* point to the start of the OAM-TS.*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 100, exit);
		value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
		value_1_offset[value_1_offset_first_profile + 1] = 
            ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE; 
	}

    if (programs_usage[unit].vmac_enable) {
        /* 3 profiles used: with FHEI, 3 byte FHEI, 5 byte FHEI*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 110, exit);
        value_1_offset[value_1_offset_first_profile] = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_NO_FHEI; 

        value_1_offset[value_1_offset_first_profile + 1] = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_3_BYTE;

        value_1_offset[value_1_offset_first_profile + 2] = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_5_BYTE;
    }

    if (programs_usage[unit].delay_based_ecn2) {

        /* Last byte of the FTMH base header */
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 120, exit);
        value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE - 1;
    }


    if (dscp_preserve_set_value_1) {
        /* 4 profiles used: with/without OAM-TS, 3 byte FHEI, 8 byte FHEI*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 130, exit);

        value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE; 
        value_1_offset[value_1_offset_first_profile + 1] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 5;
        value_1_offset[value_1_offset_first_profile + 2] = value_1_offset[value_1_offset_first_profile] + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE; 
        value_1_offset[value_1_offset_first_profile + 3] = value_1_offset[value_1_offset_first_profile + 1] + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
    }

    if (programs_usage[unit].oam_1711) {
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.value_1_offset_first_profile.
            get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &value_1_offset_first_profile);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 140, exit);
        value_1_offset[value_1_offset_first_profile] = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3 - 1;
    }

	SOC_REG_ABOVE_64_CLEAR(reg_above64_val);
	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , READ_EPNI_SYSTEM_HEADERS_VALUE_1_OFFSETr(unit, SOC_CORE_ALL, reg_above64_val));

    if (is_petrab_in_system && programs_usage[unit].oam_dm_down) {
        value_1_offset[0] = ARAD_EGR_PROG_EDITOR_PETRAB_FTMH_TOTAL_SIZE;
    }

	/* Now write the offsets into the register, per profile.*/
	for (i=0 ; i <8 /* 8 profiles */ ; ++i) {
		if (value_1_offset[i]) {
			SHR_BITCOPY_RANGE(reg_above64_val, (value_1_offset_bits_nof * i), &value_1_offset[i], 0, value_1_offset_bits_nof);
		}
	}

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , WRITE_EPNI_SYSTEM_HEADERS_VALUE_1_OFFSETr(unit, SOC_CORE_ALL,  reg_above64_val));

exit: 
    SOC_SAND_EXIT_AND_SEND_ERROR_SOCDNX((_BSL_SOCDNX_SAND_MSG("Something went wrong")));
}

/* regular task, usage - both ALU and FEM parts */
STATIC void arad_egr_prog_editor_next_mem_and_entry_find(SOC_SAND_INOUT int * prge_entry, SOC_SAND_INOUT int * prge_mem)
{
    if(*prge_entry % 2 != 0) {
        /* odd */
        *prge_mem = *prge_mem+1;
        *prge_entry = *prge_entry-1;
    }
    else {
        *prge_entry = *prge_entry+1;
    }
}


/* 
 * arad_egr_prog_editor_supply_lfem_idx
 * Used for LFEM management during instruction loading to the HW.
 * If the needed LFEM is already allocated an entry in the LFEM map table
 * used from the instruction's memory table, the index is returned and no new
 * allocation is made.
 * If the LFEM is not available in the LFEM map table available from the
 * instruction's memory table, the function tries to allocate an entry for
 * the LFEM. 
 * PARAMS: 
 *   SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog - the program in which
 *                                      the LFEM is used (for diagnostics only)
 *   SOC_SAND_IN    int                             mem  - Instruction's memory table
 *   SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem - the needed LFEM action
 *   SOC_SAND_OUT   uint32                         *index- returned index.
 *  
 * if unable to allocate the entry needed, Prints hints for
 * instructions reordering in the form of duplicate LFEM loads.
 */
uint32
  arad_egr_prog_editor_supply_lfem_idx(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem,
     SOC_SAND_IN    int                             mem,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog,
     SOC_SAND_OUT   uint32                         *index
  ) {

    int i;
    int lfem_arr_idx = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    uint32 res;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);
    
    if (NULL == index) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("NULL supplied for out parameter\n\r")));
    }

    if (lfem == ARAD_EGR_PROG_EDITOR_LFEM_NULL) {
        /* NULL LFEM is a constant LFEM which doesn't need allocation */
        *index = ARAD_PP_EG_PROG_NULL_LFEM(unit);
        /* We don't log the usage of NULL LFEM */
    }
    else
    {
        *index = -1; 

        for (i = 0; i < ARAD_PP_EG_PROG_NOF_FEM(unit); i++) {
            if (lfem_maps_shadow[unit][lfem_arr_idx][i] == ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                /* end of allocated LFEMs in this array. Allocate one for this action and return the index */
                lfem_maps_shadow[unit][lfem_arr_idx][i] = lfem;
                *index = i;
                break;
            }
            else if (lfem_maps_shadow[unit][lfem_arr_idx][i] == lfem) {
                /* lfem is already allocated. return the index. */
                *index = i;
                break;
            }
        }

        if (*index == -1) 
        {
            /* Could not allocate LFEM slot for the required action. Print duplicates and fail */
            arad_egr_prog_editor_print_lfem_duplicates(unit);
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error - Not enough LFEMs to load all programs needed.\n\r")));
        }
        else
        {
            /* Update programs for diagnostics purposes */
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.lfem_bk.set(
                unit, prog, lfem_arr_idx, *index, lfem);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        }
    }

exit: 
    SOC_SAND_EXIT_AND_SEND_ERROR_SOCDNX((_BSL_SOCDNX_SAND_MSG("Error while loading LFEMs")));
}

STATIC uint32
    arad_egr_prog_editor_validate_lfem_action_array(
       SOC_SAND_IN  int     unit
    )
{
    int i;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        if (i != lfem_actions[i][0]) {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Static error - LFEM actions array is out of order. First occurance in entry %d\n\r"),i));
        }
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_validate_lfem_action_array()",0,0);   
}


/*
 * Allocates instruction entries for a program's branch.
 */
uint32
  arad_egr_prog_editor_branch_pointer_allocate(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_BRANCH     branch_id,
     SOC_SAND_OUT   uint32                         *entry
  ) {


    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    /* Input vlidity checks */
    SOC_SAND_CHECK_NULL_INPUT(entry);
    if (branch_id >= ARAD_EGR_PROG_EDITOR_BRANCH_IDS_NOF) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error: Unknown branch ID: %d\n\r"),branch_id));
    }
    /* End validity checks */

    if (branch_entries[unit][branch_id] == -1 ) {
        /* Branch wasn't allocated yet */
        if (last_branch_entry[unit] > last_program_pointer[unit] + 1) {
            /* A branch is available */
            branch_entries[unit][branch_id] = (--last_branch_entry[unit]);
        }
        else {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error: Not enough instruction entries to load branch with ID: %d"),branch_id));
        }
    }

    *entry = branch_entries[unit][branch_id];

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_branch_pointer_allocate()",0,0);
}


/* 
 * init all programs info:
 */
STATIC int
  arad_egr_prog_editor_programs_init(
     SOC_SAND_IN  int                                 soc_petrab_cfg,
     SOC_SAND_IN  int                              unit
  )
{
    int i, j;
    soc_error_t rv;

    SOCDNX_INIT_FUNC_DEFS;

    last_program_id[unit] = 0;
    last_tm_profile[unit] = 0;
    last_program_pointer[unit] = 0; /* pointer 0 is for NULL program */

    lfem_stacking_8_index[unit] = -1;
    lfem_stacking_10_index[unit] = -1;

    /* Init branch data */
    last_branch_entry[unit] = SOC_DPP_EGR_PROG_EDITOR_NOF_ENTRY_POINTERS(unit);
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_BRANCH_IDS_NOF; i++) {
        branch_entries[unit][i] = -1;
    }

    for (i = 0; i < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; i++) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.set(
            unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.set(
            unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
            unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
    }
    for (i = 0; i < ARAD_EGR_PRGE_MAX_NOF_LFEM_TABLES; i++) {
        /* The macro SOC_DPP_DEFS_MAX can cause same_on_both_sides defects in case that there is a same value 
         * in both of the chips. Ignore such defects */
        /* coverity[same_on_both_sides] */
        for (j = 0; j < ARAD_EGR_PRGE_MAX_NOF_LFEMS; j++) {
            lfem_maps_shadow[unit][i][j] = ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS;
        }
    }
    for (i = 0; i < ARAD_PRGE_TM_SELECT_NOF_PROFILES; i++) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, i, -1);
        SOCDNX_IF_ERR_EXIT(rv);
    }
            
    /* 
     * Init special cases of programs data
     */
     
    /* ETH_WITH_LLID_TAG (EPON) */
    if (!SOC_IS_ARAD_B1_AND_BELOW(unit)) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
            unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG);
        SOCDNX_IF_ERR_EXIT(rv);
    }

    /* 10.	OAM DM Down Trap (arad+)*/
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP, 2); /*one profile with the DSP and another without. */
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP, 2); /*one profile with the DSP and another without. */
    SOCDNX_IF_ERR_EXIT(rv);

    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, 1);
    SOCDNX_IF_ERR_EXIT(rv);

    /* OTMH */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, ARAD_PRGE_TM_SELECT_OTMH_BASE);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, ARAD_PRGE_TM_SELECT_OTMH_BASE);
    SOCDNX_IF_ERR_EXIT(rv);

    /* OTMH program with 24bit CUD extention */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT);
    SOCDNX_IF_ERR_EXIT(rv);

    /* Removing system headers */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);

    /* Remove TDM FTMH */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH);
    SOCDNX_IF_ERR_EXIT(rv);

    /* TDM PMM */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);

    /* TDM_STAMP_CUD */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD_OVER_OUTER_FTMH);
    SOCDNX_IF_ERR_EXIT(rv);

    /* STACKING */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, ARAD_PRGE_TM_SELECT_STACKING);
    SOCDNX_IF_ERR_EXIT(rv);

    /* STACKING UC */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, ARAD_PRGE_TM_SELECT_STACKING);
    SOCDNX_IF_ERR_EXIT(rv);

        
    /* ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, ARAD_PRGE_TM_SELECT_PP_RCY_PORT);
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU);
    SOCDNX_IF_ERR_EXIT(rv);

	/* ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU);
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, 3); /*Three profiles: each depend on the FHEI size*/
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, 3); /*Three profiles: each depend on the FHEI size*/
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER);
    SOCDNX_IF_ERR_EXIT(rv);

    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, ARAD_PRGE_TM_SELECT_FCOE_N_PORT);
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, ARAD_PRGE_TM_SELECT_REFLECTOR_IP_AND_ETH); /* TM profile allocated dynamically.*/ 
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, ARAD_PRGE_TM_SELECT_REFLECTOR_ETH); /* TM profile allocated dynamically.*/ 
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, ARAD_PRGE_TM_SELECT_TM_MODE_HW_PROCESSING); /* TM profile allocated dynamically.*/ 
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, ARAD_PRGE_TM_SELECT_PP_MODE_HW_PROCESSING); /* TM profile allocated dynamically.*/ 
    SOCDNX_IF_ERR_EXIT(rv);
    /* ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, ARAD_PRGE_TM_SELECT_RAW_MPLS);
    SOCDNX_IF_ERR_EXIT(rv);
    
    /* customer application that connect to NP */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP);
    SOCDNX_IF_ERR_EXIT(rv);



    /* ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2 */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, 1);
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER/ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, 4); /*Four profiles: each depend on OAM_TS and FHEI size*/
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.num_value_1_offset_profiles.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, 4); /*Four profiles: each depend on OAM_TS and FHEI size*/
    SOCDNX_IF_ERR_EXIT(rv);

    /* ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP */
    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.set(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, ARAD_PRGE_TM_SELECT_TIMESTAMP_AND_SSP); /* TM profile allocated dynamically.*/ 
    SOCDNX_IF_ERR_EXIT(rv);

exit:
    SOCDNX_FUNC_RETURN; 
}

/* 
 * init all programs usage info:
 */
STATIC uint32
  arad_egr_prog_editor_programs_usage_init(
      SOC_SAND_IN  int                                 unit
  )
{
  uint8 is_petrab_in_system;
  uint32 port_idx, res;
  soc_pbmp_t pbmp;
  SOC_TMC_PORTS_FTMH_EXT_OUTLIF outlif_ext_en;
  char *propval;
  uint8 soc_value;
  bcm_port_t port_i;
  

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INIT);

  sal_memset(&programs_usage[unit], 0, sizeof(ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INFO));

  if (SOC_DPP_CONFIG(unit)->tm.otmh_header_used) {
      programs_usage[unit].otmh_base = 1;
  }

  if (SOC_DPP_CONFIG(unit)->tm.l2_encap_external_cpu_used) {
   programs_usage[unit].l2_encap_external_cpu = 1;
  }

  /* XGS is always set, but its type depends on whether the device is in TM or PP mode */
  if (SOC_DPP_CONFIG(unit)->arad->init.pp_enable == TRUE) { /* PP mode */

      if (SOC_DPP_CONFIG(unit)->pp.xgs_port_exists) {
          programs_usage[unit].xgs_pp = 1;
      }
      programs_usage[unit].ipv6_tunnel = SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_enable;

      if (SOC_DPP_CONFIG(unit)->pp.oam_enable) {
          programs_usage[unit].oam_ts_ccm = 1;
		  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", SOC_IS_JERICHO_PLUS_AND_BELOW(unit))) {
			  programs_usage[unit].oam_dm_down =1;
		  }
          if (soc_property_get(unit, spn_OAM_DM_NTP_ENABLE, 1)) {
              programs_usage[unit].oam_dm_ntp = 1;
          }
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_upmep_rx_enable", 1) == 1) {
              programs_usage[unit].oam_dm_up_rx = 1;
          }
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_lm_upmep_enable", 1) == 1) {
              programs_usage[unit].oam_lm_upmep = 1;
          }
          if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_upmep_enable", 1) == 1) {
              programs_usage[unit].oam_upmep = 1;
          }
          if (SOC_IS_QAX(unit) && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_1711_enable", 0) == 1)) {
              programs_usage[unit].oam_1711 = 1;
          }
      }
      /* For now - channel override is enabled always for QAX when BFD is enabled.
         If ever there is a problem with PRGE resources, this can be disabled. */
      programs_usage[unit].bfd_chan_override = SOC_IS_QAX(unit) && (SOC_DPP_CONFIG(unit)->pp.bfd_enable);

      programs_usage[unit].erspan = soc_property_get(unit, spn_BCM886XX_ERSPAN_TUNNEL_ENABLE, 0) ? 1 : 0;
      programs_usage[unit].rspan = soc_property_get(unit, spn_BCM886XX_RSPAN_TUNNEL_ENABLE, 1) ? 1 : 0;
      
      programs_usage[unit].vxlan = (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_VXLAN) ? 1 : 0; /* for B0 */
      if ((programs_usage[unit].vxlan) && (SOC_IS_ARAD_A0(unit))) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  VXLAN supported only on ARAD_B0 device and above. \n\r")));
      }
        
      programs_usage[unit].epon = SOC_DPP_CONFIG(unit)->pp.pon_application_enable;
  }
  else { /* TM mode */
      programs_usage[unit].xgs_tm = 1; 
  }

  /* Avoid loading PROG_OAM_LOOPBACK program if Rcy Port is not defined */
  if (soc_property_get(unit, spn_OAM_RCY_PORT, -1)!= -1) {
      programs_usage[unit].oam_loopback = 1; 
  }

  SOC_SAND_SOC_IF_ERROR_RETURN(res, 9, exit,dcmn_property_get_str(unit,spn_FAP_TDM_BYPASS,&propval));
  if (propval != NULL) {
      if (sal_strcmp(propval, "0") != 0) {
          programs_usage[unit].tdm = 1;
      }
  }

  /* check if there's Petra-B in system */
  is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);
  if (is_petrab_in_system) {
     programs_usage[unit].tdm_pmm = 1;
  }

  programs_usage[unit].tdm_stamp_cud = SOC_DPP_CONFIG(unit)->tdm.is_bypass ? 1 : 0;

  programs_usage[unit].stacking = SOC_DPP_CONFIG(unit)->arad->init.ports.is_stacking_system ? 1 : 0; 

  programs_usage[unit].two_hop_scheduling = 0;

  SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, soc_port_sw_db_valid_ports_get(unit, 0, &pbmp));

  SOC_PBMP_ITER(pbmp,port_idx) {
      res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.outlif_ext_en.get(unit, port_idx, &outlif_ext_en);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 15, exit);
      if (outlif_ext_en == SOC_TMC_PORTS_FTMH_EXT_OUTLIF_DOUBLE_TAG) {
          programs_usage[unit].two_hop_scheduling = 1;
          break;
      }
  }

  if ((SOC_DPP_CONFIG(unit)->arad->init.pp_enable == TRUE)&&
	  (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "88650L23C", 0))) /* PP mode and feature enabled*/
  {
      /* Remote CPU program and XGS programs share the same instructions - if remote CPU enabled, need to disable all XGS programs */
      programs_usage[unit].xgs_tm = 0;
      programs_usage[unit].xgs_pp=0;
      programs_usage[unit].l2_remote_cpu=1;
  }
  else
  {
      programs_usage[unit].l2_remote_cpu=0;
  }

  if ((SOC_DPP_CONFIG(unit)->arad->init.pp_enable == FALSE) && (SOC_DPP_CONFIG(unit)->tm.ftmh_outlif_enlarge == TRUE))
  {
      programs_usage[unit].otmh_cud = 1;
  }
  else
  {
      programs_usage[unit].otmh_cud = 0;
  }

  programs_usage[unit].trill = SOC_DPP_CONFIG(unit)->trill.mode; 

  programs_usage[unit].vmac_enable = soc_property_get(unit, spn_VMAC_ENABLE, 0) ? 1 : 0;

  programs_usage[unit].bfd_echo = soc_property_get(unit, spn_BFD_ECHO_ENABLED, 0) ? 1 : 0;

  programs_usage[unit].olp_petra = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "olp_petra", 0) ? 1 : 0;
  

  /* In systems with user defined header we need to remove the header before the packet is sent to the network.
  * With Ethernet packets we do not need a special program because we have the PPH witch points to the end of user defined header, so this is considered part of the system headers. In TM packets there is no PPH so UDH has to be removed with a special program.
  * The solution:
  *     - New program to remove the UDH 
  *     - Program selection is TM PROFILE (we would like to use PP profile, but do not have enough profiles)
  *     - Because different ports can have different TM profiles, we use the MSB of the profile in the program selection.
  *     - To make management easier we reduced by 2 the amount of available TM profiles (in case of lack of profiles we can think of a batter solution), this is done if soc property custom_feature_user_header_always_remove is enabled. 
  */ 
  programs_usage[unit].user_header_always_remove = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "user_header_always_remove", 0) ? 1 : 0;

  programs_usage[unit].size_header = 0;
  for (port_idx = 0; port_idx < ARAD_NOF_FAP_PORTS; port_idx++) 
  {
      if(soc_property_port_suffix_num_get(unit, port_idx, -1, spn_CUSTOM_FEATURE, "add_size_header", 0)) {
          programs_usage[unit].size_header = 1;
          break;
      }
  }

  programs_usage[unit].mpls_raw = soc_property_get(unit, spn_PORT_RAW_MPLS_ENABLE, 0); 


  /* Set FCOE NPV no myMAC usage */
  programs_usage[unit].npv_without_my_mac = soc_property_get(unit, spn_FCOE_NPV_BRIDGE_MODE, 0);

  programs_usage[unit].delay_based_ecn2 = soc_property_get(unit, spn_ECN_DM_ENABLE, 0);

  if (SOC_IS_JERICHO(unit)) {
      /* Jericho only programs */
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          programs_usage[unit].mpls_eli  = soc_property_get(unit, spn_MPLS_EGRESS_LABEL_ENTROPY_INDICATOR_ENABLE, 0);
      }
      programs_usage[unit].mpls_extended  = soc_property_get(unit, spn_MPLS_EGRESS_LABEL_EXTENDED_ENCAPSULATION_MODE, 0);
  }

  if (SOC_IS_JERICHO(unit)) {
      programs_usage[unit].evpn = soc_property_get(unit, spn_EVPN_ENABLE, 0);
      /* This program is used for jericho and above. */
      /* Evpn frr is used for:
         1) In jericho with roo_extension_label_encapsulation. This soc property is enabled only in jericho.
         2) In jericho plus with mpls_egress_label_extended_encapsulation_mode which signifies the addition of a
         label via LL's wide data */
      programs_usage[unit].evpn_frr = (soc_property_get(unit, spn_ROO_EXTENSION_LABEL_ENCAPSULATION, 0) && !SOC_IS_JERICHO_PLUS(unit))
                           || (programs_usage[unit].evpn && programs_usage[unit].mpls_extended && SOC_IS_JERICHO_PLUS(unit));
  }

  if (SOC_IS_JERICHO(unit)) {
      programs_usage[unit].mim_spb   = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_spb_enable", 0);
  }

  /* customer application that connect to NP */
  if (SOC_IS_JERICHO(unit)) {
      /* Jericho only programs */
      programs_usage[unit].customer_conn_to_np_enable = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "conn_to_np_enable", 0);
  }
  if(SOC_IS_QAX(unit))
  {
      /* QAX only programs */
      programs_usage[unit].ipsec = SOC_DPP_CONFIG(unit)->qax->ipsec;
  }
  if (SOC_IS_JERICHO(unit)) {
      SOC_PBMP_ITER(PBMP_RCY_ALL(unit), port_i) {
        soc_value = soc_property_port_suffix_num_get(unit, port_i, -1,spn_CUSTOM_FEATURE,"recycle_with_ptch2", 0);
        if (soc_value != 0) {
            programs_usage[unit].recycle_with_ptch2 = soc_value;
            break;
        } else {
            programs_usage[unit].recycle_with_ptch2 = 0;
        }
      }
  }
  
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_programs_usage_init()",0,0);
}

void
  arad_egr_prog_editor_prog_name_get_by_id(uint32 program_id, char** prog_name)
{
    switch(program_id) {
        case ARAD_EGR_PROG_EDITOR_PROG_VXLAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VXLAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_RSPAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RSPAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_STACKING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_STACKING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION";    
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST1:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST2:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST2";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA:
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_END_TLV:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_END_TLV";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC";
        break;        
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_LI:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_LI";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP";
        break;
        default:
            *prog_name = "Unknown program";
    }
}

void
  arad_egr_prog_editor_branch_name_get_by_id(uint32 branch_id, char** branch_name)
{
    switch (branch_id) {
    case ARAD_EGR_PROG_EDITOR_BRANCH_DROP_PACKET:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_DROP_PACKET";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_AND_SOURCE_PORT:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_AND_SOURCE_PORT";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_MC:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_BFD_ECHO:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_BFD_ECHO";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_PP_COPY_HEADER:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_PP_COPY_HEADER";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_2_HOP_SCHEDULING:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_2_HOP_SCHEDULING";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_STACKING:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_STACKING";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_DELAY_BASE_ECN2:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_DELAY_BASE_ECN2";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_OAM_STRING_MAID:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_OAM_STRING_MAID";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_OAM_LB_UP:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_OAM_LB_UP";
        break;
    case ARAD_EGR_PROG_EDITOR_BRANCH_IP_OVER_UDP:
        *branch_name = "ARAD_EGR_PROG_EDITOR_BRANCH_IP_OVER_UDP";
        break;
    default:
        *branch_name = "Unknown branch";
        break;
    }
}

void
  arad_egr_prog_editor_lfem_name_get_by_id(uint32 lfem_id, char** lfem_name)
{
    switch(lfem_id)                                                
    {                                                                 
    case ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_8_MSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_MSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_12_MSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_12_MSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS_SWAPPED:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS_SWAPPED";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_0";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_3:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_3";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_1_FIRST_BIT_ONLY:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_1_FIRST_BIT_ONLY";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC_JER:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC_JER";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_PPH_TYPE_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_PPH_TYPE_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXCLUDE_TOD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXCLUDE_TOD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_8_CENTRAL_BITS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_CENTRAL_BITS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_8_PERIPHERAL_BITS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_PERIPHERAL_BITS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_BIT1_CLR_BIT0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT1_CLR_BIT0";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_MASK_HEX_81:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MASK_HEX_81";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT1";
        break;
       case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT3:
       *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT3";
       break;
	case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT12_TO_BIT13:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT12_TO_BIT13";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_4";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ESI_LSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ESI_LSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S_TTL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FRR_EXP_S_TTL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_TTL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_TTL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_BOS_TTL:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MPLS_EXP_BOS_TTL";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SET_BITS_7_8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SET_BITS_7_8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SVID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SVID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FAP_ID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FAP_ID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SA_FAP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SA_FAP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SA_LAG:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SA_LAG";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IS_LAG:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IS_LAG";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_3_M:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_2_3_M";
        break;   
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_0_M:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_0_M";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BITS_0_M:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_0_M";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_12:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_12";
        break;   
    case ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP";
        break; 
    case ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP_COMP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TTL_EXP_COMP";
        break; 
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC_AS_MSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC_AS_MSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_RSHIFT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_OUT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_OUT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_PPH_VSI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_PPH_VSI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_TAG_NUM:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_TAG_NUM";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_OUTFP_MSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_OUTFP_MSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_DEL_LEN:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_DEL_LEN";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_VLAN_STATUS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_VLAN_STATUS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_IN:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_SLOT_IN";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_COS_COLOR:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_COS_COLOR";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_LAG:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_LAG";
    break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XTMH_DP_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_DS_MODE_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_MAIN_TYPE_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_FROM_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_PS_FROM_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_NPH_H_S:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_NPH_H_S";
        break;

    default:
        *lfem_name = "Unknown LFEM";
        break;
    }
}


void
  arad_egr_prog_editor_print_lfem_duplicates(
     int unit
  ) {

    uint8
        lfems[ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS][2];
    int
        i,j,k;
    char
        *lfem_name,
        array_num_buf[8];

    /* Init lfems array */
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        lfems[i][0] = 0; /* Appearances in lfem shadow arrays counter */
        lfems[i][1] = 0; /* In which arrays they appear bitmap */
    }

    /* Count loads of LFEMs and mark where are they loaded to */
    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; j < ARAD_PP_EG_PROG_NOF_FEM(unit); j++) {
            if (lfem_maps_shadow[unit][i][j] == ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                /* no more entries in this shadow array */
                break;
            }
            else {
                lfems[lfem_maps_shadow[unit][i][j]][0]++;
                lfems[lfem_maps_shadow[unit][i][j]][1] |= (0x01 << i);
            }
        }
    }

    LOG_CLI((BSL_META_U(unit,
                        "\n\r\n\r")));

    /* Print duplicates */
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        if (lfems[i][0] > 1) {
            /* LFEM is loaded to more than 1 array */

            /* Get LFEM name */
            arad_egr_prog_editor_lfem_name_get_by_id(i, &lfem_name);

            /* Get LFEM used arrays string */
            k = 0;
            for (j = 0; j < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); j++) {
                if (lfems[i][1] & (0x01 << j)) {
                    array_num_buf[k++] = ' ';
                    array_num_buf[k++] = '0' + j;
                }
            }
            array_num_buf[k] = '\0';

            LOG_CLI((BSL_META_U(unit,
                                "FIX HINT: Duplicate load of %s to:%s\n\r"), lfem_name, array_num_buf));
        }
    }

    LOG_CLI((BSL_META_U(unit,
                        "\n\r\n\r")));

}


STATIC uint32
  arad_egr_prog_editor_allocate_program(
    SOC_SAND_IN int unit ,
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_PROGRAMS                                 prog
  )
{
  int i,j;
  int tm_profile_already_allocated = 0;
  int tm_profiles;
  uint32 tm_profile;
  soc_error_t rv;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_ALLOCATE_PROGRAM_AND_ITS_LFEMS);

  /* Init program's bookkeeping */
  for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
      for (j = 0; j < ARAD_PP_EG_PROG_NOF_FEM(unit); j++) {
          rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.lfem_bk.set(
              unit, prog, i, j, ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
      }
  }

  /* alloc program number */
  rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.set(
    unit, prog, ++last_program_id[unit]);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
  if (last_program_id[unit] > SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)) {
     SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_PROGRAMS_ERR, 10, exit);
  }

  if (prog == ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH) {
      goto exit; /* OTMH lfems and instructions were already allocated */
  }

  if (prog == ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER) {
      goto exit; /* COPY Headers for COE type 2 with ITMH lfems and instructions were already allocated */
  }

  if ((prog == ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1) ||
        (prog == ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1)) {
      goto exit;
  }

  /* alloc instruction entries */
  rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.set(
    unit, prog, ++last_program_pointer[unit]);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
  if (last_program_pointer[unit] > SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)) {
      SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_INSTRUCTION_ENTRIES_ERR, 40, exit);
  }

  /* alloc tm profile */
  if(programs_usage[unit].user_header_always_remove) {
      /* Add here any other programs in which non-Ethernet packet can be sent to an Ethernet port and require using remove-system-headers program */
      rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(
        unit, prog, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
      if (tm_profile == ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG) {
          tm_profile_already_allocated = 1;
      }
  }

  rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(
    unit, prog, &tm_profile);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
  if ((tm_profile != -1) && (!tm_profile_already_allocated)) {
      rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 40, exit);
      if (tm_profiles == -1) {
          /* this tm_profile has not been allocated yet - alloc */
          rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, tm_profile, ++last_tm_profile[unit]);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 50, exit);

          if (last_tm_profile[unit] > tm_profiles_available[unit]) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_TM_PROFILES_ERR, 60, exit);
          }
      }
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_allocate_program()",0,0);
}

/* 
 * init all programs[unit] usage info:
 */
STATIC uint32
  arad_egr_prog_editor_programs_alloc(
     SOC_SAND_IN  int                                 soc_petrab_cfg,
     SOC_SAND_IN  int                                 unit,
     uint32                                           user_header_size
  )
{
  uint32 res;
  int arad_prog_editor_otmh_keep_pph_port_present;
  int pp_port, tm_rm_hdrs;
  int pp_port_program_loaded=0, tm_port_program_loaded=0;
  uint32 port_idx,timestamp_ssp = 0,is_valid;



  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_ALLOCATE_PROGRAMS_AND_LFEMS_ALLOC);

  /* number of tm_profiles to be used in case user_header_always_remove is enabled */
  tm_rm_hdrs = (1 << (soc_mem_field_length(unit, EPNI_PRGE_PROGRAM_SELECTION_CAMm, PRGE_TM_PROFILEf)-1));

  if(programs_usage[unit].user_header_always_remove) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS, tm_rm_hdrs);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      /* Add here any other programs in which non-Ethernet packet can be sent to an Ethernet port and require using remove-system-headers program */
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.set(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, tm_rm_hdrs - 1);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

      tm_profiles_available[unit] = tm_rm_hdrs - 1;

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);


  }
  else {
      tm_profiles_available[unit] = 2 * tm_rm_hdrs - 1;
  }

  if (programs_usage[unit].otmh_base) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  arad_prog_editor_otmh_keep_pph_port_present=0;
  for (pp_port = 0; pp_port < ARAD_PORT_NOF_PP_PORTS; pp_port++) {
      if (soc_property_suffix_num_get(unit, pp_port, spn_CUSTOM_FEATURE, "otmh_keep_pph_", 0) == 1) {
          arad_prog_editor_otmh_keep_pph_port_present = 1;
      }
      if (soc_property_port_suffix_num_get(unit, pp_port, -1, spn_CUSTOM_FEATURE, "vendor_custom_tm_port", FALSE) == 1) {
          if (!tm_port_program_loaded) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING); 
              SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
              tm_port_program_loaded = 1;
          }
      }
      if (soc_property_port_suffix_num_get(unit, pp_port, -1, spn_CUSTOM_FEATURE, "vendor_custom_pp_port", FALSE) == 1) {
          if (!programs_usage[unit].customer_conn_to_np_enable) {
              if (!pp_port_program_loaded) {
                  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
                  pp_port_program_loaded = 1;
              }
          }
      }

  }

  if (arad_prog_editor_otmh_keep_pph_port_present) {
      if (!soc_petrab_cfg) { 
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
  }

  if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) { /* Need to support Port Extender Mode 2 */
      /* Allocate */
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 16, exit);
  }

  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
      /* Alloc Program that handle the L3 Traffic Copy Header with Full MyMac */
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
  }

  /* Allocating 4_LABEL_PUSH program based on soc property*/ 
  if((soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ext_ipv4_mpls_extended_fwd_table_size", 0)) ||
	 (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ext_ipv6_extended_fwd_table_size", 0))){
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  /* allocating ptagged mode programms based on soc-property */
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
  }

  /* allocate  a porgram that modifies MIM header  */
  if (SOC_DPP_CONFIG(unit)->pp.custom_ip_route) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
  }
  
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "lsr_manipulation", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION);
      SOC_SAND_CHECK_FUNC_RESULT(res, 27, exit);
  }  

    /* allocating a program to copy TOS from native ip to encapsulation ip */
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ip_tunnel_preserve_dscp", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
  }

    /* allocating programs to override TOS on bridged IPV4/IPV6 packets, AND FIX checksum */
  if (SOC_DPP_CONFIG(unit)->pp.pon_dscp_remarking) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6);
      SOC_SAND_CHECK_FUNC_RESULT(res, 27, exit);
  }

  /* allocating a program to copy 48 bytes from system headers */
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "dedicated_recycle_port", 0)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 26, exit);
  }


  if(SOC_DPP_CONFIG(unit)->pp.test1){ 
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TEST1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }  
  
  if(SOC_DPP_CONFIG(unit)->pp.test2){
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TEST2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

  }  

  /* Allocating UDH header copy program based on system port header type configuration */
  if ((SOC_DPP_CONFIG(unit)->pp.udh_port_exists))
  {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  if ((!SOC_IS_ARADPLUS(unit) && (SOC_DPP_CONFIG(unit)->pp.next_hop_mac_extension_enable))
      || (SOC_IS_ARADPLUS(unit) && (SOC_IS_NEXT_HOP_MAC_EXT_ARAD_COMPATIBLE(unit))))
    {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

      if (programs_usage[unit].xgs_pp) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 21, exit);
    }
  }
  
  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER);
  SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);



  /* vxlan support use program for version under arad+. Arad+ support vcxlan by design. */
  if (SOC_IS_ARAD_B1_AND_BELOW(unit) && programs_usage[unit].vxlan) {
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VXLAN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);
  }

  if (programs_usage[unit].rspan) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);

      if (programs_usage[unit].xgs_pp) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }
  }

  if (programs_usage[unit].erspan) {
      if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }
      else {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }

      if (programs_usage[unit].xgs_pp) {
          if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
              res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
          }
          else {
              res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
          }
      }
  }

  if (programs_usage[unit].xgs_tm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
  }

  if (programs_usage[unit].xgs_pp) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 95, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 98, exit);
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 100, exit);
  }

  if (programs_usage[unit].epon) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 105, exit);
  }
  
  if (programs_usage[unit].ipv6_tunnel) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
      SOC_SAND_CHECK_FUNC_RESULT(res, 115, exit);
  }

  if (programs_usage[unit].oam_loopback) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit); 
  }

  if (programs_usage[unit].oam_ts_ccm) {

      if (SOC_IS_JERICHO_PLUS(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
      if (user_header_size && SOC_IS_JERICHO(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
      
      if (programs_usage[unit].oam_dm_ntp &&
          soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_up_rx_ntp_enable", 1)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
      }

      /* Allocating BFD echo program based on soc property and if the device is ARAD+*/
      if ((programs_usage[unit].bfd_echo) && SOC_IS_ARADPLUS(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
      if (programs_usage[unit].oam_dm_up_rx) {
          if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
              /* 1588 stamping not supported in Arad A0.*/
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
          }
      }
      if (programs_usage[unit].oam_lm_upmep) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }
      if (programs_usage[unit].oam_upmep) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
          SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
          if (SOC_IS_JERICHO(unit)) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT);
              SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
          }
      }
      if (programs_usage[unit].oam_dm_down) {
          if (programs_usage[unit].oam_dm_ntp) {
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
          }
          if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
              /* 1588 stamping not supported in Arad A0.*/
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
          }
      }
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "egress_snooping_advanced", 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }

      if (programs_usage[unit].bfd_chan_override || (SOC_DPP_CONFIG(unit)->pp.bfd_masked_flags_bitfield != 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }

      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "eg_pwe_counting", 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }

      if (SOC_DPP_CONFIG(unit)->pp.oam_use_double_outlif_injection) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }
  }

  if (programs_usage[unit].oam_1711) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }

  if (programs_usage[unit].tdm_pmm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 165, exit);
  }

  if (programs_usage[unit].tdm_stamp_cud) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 175, exit);
      if (SOC_IS_JERICHO(unit) && (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "tdm_eg_editing_is_cud_stamping", 0) == 1)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 175, exit);
      }
  }

  if (programs_usage[unit].tdm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 185, exit);
  }

  if (programs_usage[unit].stacking) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_STACKING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 205, exit);
  }

  if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == ARAD_MGMT_FTMH_LB_EXT_MODE_FULL_HASH) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 205, exit);
  }

  if (programs_usage[unit].two_hop_scheduling) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 215, exit);
  }

  if (programs_usage[unit].l2_remote_cpu) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU);
      SOC_SAND_CHECK_FUNC_RESULT(res, 225, exit);
  }

   if (programs_usage[unit].l2_encap_external_cpu) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
  }
  if (programs_usage[unit].otmh_cud) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }

  if (programs_usage[unit].size_header) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }

  if (programs_usage[unit].npv_without_my_mac) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (SOC_IS_ROO_ENABLE(unit)) {
      if (SOC_IS_ARADPLUS_A0(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN);
          SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
      }
      else if (SOC_IS_JERICHO_AND_BELOW(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY);
          SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
      }
  }

  /* Preserving DSCP - separate implementation for ARAD+ and JER */
  if ((SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp) {
      if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
          /* Preserving DSCP on a per out-port bases  - 2 programs one when OAMTS exist and one when doesnt */
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);

          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
      }
      else {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 297, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 297, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 298, exit);
      }
  }

  /*
   * PTCH for Overlay application. Currently enabled for Trill and MIM.
   * PTCH2 will also be used when needed to direct to routing recycle destination.
   */
  if (programs_usage[unit].trill || (SOC_DPP_CONFIG(unit)->arad->pp_op_mode.mim_enable) ||
      (SOC_DPP_CONFIG(unit)->pp.ipv6_with_rpf_2pass_exists) || programs_usage[unit].recycle_with_ptch2) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 245, exit);
  }

  if (programs_usage[unit].vmac_enable) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (programs_usage[unit].olp_petra) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 275, exit);
  }

  if (programs_usage[unit].oam_ts_ccm && SOC_IS_ARADPLUS(unit)) {
      if (soc_property_get(unit, spn_OAM_MAID_11_BYTES_ENABLE,0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
      else {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (soc_property_get(unit, spn_RFC2544_REFLECTOR_MAC_AND_IP_SWAP_PORT, 0)) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }
  if (soc_property_get(unit, spn_RFC2544_REFLECTOR_MAC_SWAP_PORT, 0)) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }
  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "rfc2544_reflector_mac_swap_1pass", 0)) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (programs_usage[unit].mpls_raw) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }

  if (programs_usage[unit].delay_based_ecn2) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }

  if (programs_usage[unit].evpn) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      if (programs_usage[unit].evpn_frr) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }
  if (programs_usage[unit].evpn_frr) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }
  if (programs_usage[unit].mpls_eli) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      if (programs_usage[unit].mpls_extended) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "four_independent_mpls_encapsulation_enable", 0) == 1) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }

  if (programs_usage[unit].mpls_extended) {
      if(SOC_IS_JERICHO_PLUS(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      } else {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (programs_usage[unit].mim_spb) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      if (SOC_IS_JERICHO_B0_AND_ABOVE(unit)) {
          /* Due to bug in MIM ROO in JER-A0, there's no point in loading the programs for A0*/
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      }
  }

  if (SOC_DPP_CONFIG(unit)->pp.udp_tunnel_enable && SOC_IS_JERICHO_B0_AND_ABOVE(unit)) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
  }
  
  /* customer application that connect to NP */
  if (SOC_IS_JERICHO(unit) && programs_usage[unit].customer_conn_to_np_enable) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 295, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY);
      SOC_SAND_CHECK_FUNC_RESULT(res, 296, exit);
  }

  if(SOC_IS_JERICHO_PLUS(unit))
  {
      if (programs_usage[unit].ipsec)
      {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC);
          SOC_SAND_CHECK_FUNC_RESULT(res, 285, exit);
          LOG_ERROR(BSL_LS_BCM_FP,
                    (BSL_META_U(unit,
                                "____________IPSEC - program allocated  \n")));
      }
  }
  if ((SOC_IS_JERICHO(unit))) { 
    for (port_idx = 0; port_idx < SOC_MAX_NUM_PORTS; ++port_idx) {

        res = soc_port_sw_db_is_valid_port_get(unit, port_idx, &is_valid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 286, exit);
        if (!is_valid) {
          continue;
        }
        res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.timestamp_and_ssp.get(unit, port_idx, &timestamp_ssp);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 287, exit);
        if (timestamp_ssp) {
            res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP);
            SOC_SAND_CHECK_FUNC_RESULT(res, 288, exit);
            break;
        }
    }
  }
 
  if (SOC_DPP_CONFIG(unit)->pp.lawful_interception_enable) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_LI);
      SOC_SAND_CHECK_FUNC_RESULT(res, 300, exit);
  }
 

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_programs_alloc()",0,0);
}


uint32
  arad_egr_prog_editor_unsafe(
    SOC_SAND_IN  int                                 unit
  )
{
    uint32
      res = SOC_SAND_OK;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_UNSAFE);

  SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_LINK_FILTER_ENABLEr, SOC_CORE_ALL, 0, TM_OR_CPU_EEDB_FILTER_ENABLEf,  0x0));

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_unsafe()", 0, 0);
}

/* 
 * set Program selection valid bit by program id: 
 * Parameters                                   :
 * in   unit                                           :
 * in   prog - program id                                                       :
 * in   prog_selection_valid - set program selection valid or invalidate                                                                             :
 *           is set (>0) set the program selection valid
 *           else (==0) invalidate the program selection
 */ 
/*  SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_PROGRAMS      prog ,   */
uint32
  arad_egr_prog_editor_invalidate_program_by_id(
    SOC_SAND_IN  uint32                          unit ,
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_PROGRAMS   prog ,
    SOC_SAND_IN  int                             prog_selection_valid
  )
{
    uint32 res;
    uint32 program_pointer_id = 0;
    int program_sel;
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA prog_sel_tbl_data;
    int set_valid, found_flg=0;
    char* prog_name;
    int prog_used;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    arad_egr_prog_editor_prog_name_get_by_id(prog, &prog_name);
        LOG_CLI((BSL_META_U(unit,
                            "program %d: %s\n"), prog, prog_name));

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, prog, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        program_pointer_id = prog_used;
        LOG_CLI((BSL_META_U(unit,
                            "arad_egr_prog_editor_invalidate_program_by_id, map program_id to %d\n"), program_pointer_id));
    } /* Program pointer found */
    else {
        soc_sand_os_printf("ERROR, arad_egr_prog_editor_invalidate_program_by_id, failed to map program_id \n");
        res = SOC_E_NOT_FOUND;
        SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);
    }

    set_valid = (prog_selection_valid == 0)? 0:1;

    for (program_sel = 0; program_sel < ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); program_sel++) {

        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, program_sel, &prog_sel_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 255+2, exit);
        if (prog_sel_tbl_data.program == program_pointer_id) {
            prog_sel_tbl_data.valid = set_valid;
            found_flg++;

            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, program_sel, &prog_sel_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 255+3, exit); 
        }
    }
    /* Set the result to point in case no program found */
    res = (found_flg==0)? SOC_E_NOT_FOUND: SOC_E_NONE;
    SOC_SAND_CHECK_FUNC_RESULT(res, 255+4, exit); 

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_invalidate_program_by_id()",0,0);
}

/*
 * arad_egr_prog_editor_null_prog_init
 * Initializing the deafult NULL program 
 * In teh context of port_extender destination need to add port extender. 
 * Concatenates nop instructions to the end of a program with less
 * than the needed instructions.
 * PARAMS:
 *   SOC_SAND_IN int entry_even - even entries for this program
 *   SOC_SAND_IN int entry_odd  - odd entries for this program
 */
uint32
  arad_egr_prog_editor_null_prog_init(
    SOC_SAND_IN int unit,
    SOC_SAND_IN int entry_even,
    SOC_SAND_IN int entry_odd
  )
{
    uint32 
        res;
    int
        mem = EPNI_PRGE_INSTRUCTION_0m,   /* The first instructions table to write */
        entry = entry_even;
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) { /* Need to support Port Extender Mode 1 */

        /* Instraction #0 - Extract Resolved.Data.tm-port-var (1B)*/
        prge_instruction_tbl_data.src_select  = 2;    
        prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, /* Even Fem (0/2 = 0%2 = 0 */
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        /* Instraction #1 - NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = 0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value    = 0;
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action  = 0;
        prge_instruction_tbl_data.dst_select  = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

        /* Instraction #2 
         * ALU operation with LFEM op_value added dest to R_Size
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = 0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 0x7; /* always */
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; /* R_Size */
        /* prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2; */
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        /* Instraction #3 - NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = 0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* instruction #4
         * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - Resolved Data: out-PP-port */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
        prge_instruction_tbl_data.size_base   = 0; 
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value    = 0;
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
        prge_instruction_tbl_data.dst_select  = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  For this program set all other instructions to NULL (NOP) starting the instruction #5 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    } /* NULL program with port extender mode 1*/
    else { /* Standard NULL Program */
        /*  Program 0 instructions (entries 0, 1 in each table) */
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, EPNI_PRGE_INSTRUCTION_0m, 0, 0, 1) );
    }
exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_null_prog_init()", mem, entry);

}


/* 
 * arad_egr_prog_editor_cat_nops
 * Concatenates nop instructions to the end of a program with less
 * than the needed instructions.
 * PARAMS:
 *   SOC_SAND_IN int mem        - first instructions table to write to
 *   SOC_SAND_IN int entry      - first entry in instruction table to write to
 *   SOC_SAND_IN int entry_even - even entries for this program
 *   SOC_SAND_IN int entry_odd  - odd entries for this program
 */
uint32
  arad_egr_prog_editor_cat_nops(
    SOC_SAND_IN int unit,
    SOC_SAND_IN int first_mem,
    SOC_SAND_IN int first_entry,
    SOC_SAND_IN int entry_even,
    SOC_SAND_IN int entry_odd
  )
{

    uint32 
        res;
    int
        mem = first_mem,
        entry = first_entry;
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    /* Init NOP command */
    prge_instruction_tbl_data.src_select  = 0;
    prge_instruction_tbl_data.offset_base = 0;
    prge_instruction_tbl_data.offset_src  = 0;
    prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.size_base   = 0;
    prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value    = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action  = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action  = 0;
    prge_instruction_tbl_data.dst_select  = 0;

    while (mem < EPNI_PRGE_INSTRUCTION_0m + ARAD_PP_EG_PROG_NOF_INSTR_MEMS(unit)) {
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data); 
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_cat_nops()", mem, entry);
}

/* 
 * arad_egr_prog_editor_load_required_lfems
 * Loads the required lfems to the HW according to the shadow lfem maps
 */
uint32
  arad_egr_prog_editor_load_required_lfems(
    SOC_SAND_IN int unit
  )
{
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  
        lfem_field_select_map_tbl_data;
    int
        i = 0, 
        j = 0, 
        res = 0;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; (j < ARAD_PP_EG_PROG_NOF_FEM(unit)) ; j++ )
        {
            if (lfem_maps_shadow[unit][i][j] < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                /* Load LFEM to HW */
                lfem_map_action_to_lfem_field_select_map(lfem_maps_shadow[unit][i][j], &lfem_field_select_map_tbl_data);
                res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, i, j, &lfem_field_select_map_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
            }
            else {
                /* No more allocations in this map */
                break;
            }
        }
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_load_required_lfems()", i, j);
}

uint32
  lfem_map_to_uint32(
    SOC_SAND_IN  lfem_map lfem
  )
{
    return ((lfem.val1 << 5) | lfem.val2);
}

void
  lfem_map_arr_to_lfem_field_select_map(
    SOC_SAND_IN  lfem_map lfem_arr[],
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  )
{
    tbl_data->lfem_field_select_map[0] = lfem_map_to_uint32(lfem_arr[15]) | 
                                         (lfem_map_to_uint32(lfem_arr[14]) << 6) | 
                                         (lfem_map_to_uint32(lfem_arr[13]) << 12) | 
                                         (lfem_map_to_uint32(lfem_arr[12]) << 18) | 
                                         (lfem_map_to_uint32(lfem_arr[11]) << 24) | 
                                         ((lfem_map_to_uint32(lfem_arr[10]) & 0x3) << 30);
    tbl_data->lfem_field_select_map[1] = ((lfem_map_to_uint32(lfem_arr[10]) & 0x3c) >> 2) | 
                                         (lfem_map_to_uint32(lfem_arr[9]) << 4) | 
                                         (lfem_map_to_uint32(lfem_arr[8]) << 10) | 
                                         (lfem_map_to_uint32(lfem_arr[7]) << 16) | 
                                         (lfem_map_to_uint32(lfem_arr[6]) << 22) | 
                                         ((lfem_map_to_uint32(lfem_arr[5]) & 0xf) << 28);
    tbl_data->lfem_field_select_map[2] = ((lfem_map_to_uint32(lfem_arr[5]) & 0x30) >> 4) | 
                                         (lfem_map_to_uint32(lfem_arr[4]) << 2) | 
                                         (lfem_map_to_uint32(lfem_arr[3]) << 8) | 
                                         (lfem_map_to_uint32(lfem_arr[2]) << 14) | 
                                         (lfem_map_to_uint32(lfem_arr[1]) << 20) | 
                                         (lfem_map_to_uint32(lfem_arr[0]) << 26);
}

/* 
 * Returns a 6 bit representation of the action,val pair in an lfem action representation.
 * action (idx_or_val_bit) is a 1 bit description of weather the value is a const or a pointer
 * to a bit in the 32 bit key of the lfem map.
 * the value is 5 bit.
 */
uint32
  lfem_couple_to_uint32(
    SOC_SAND_IN  uint8  value,
    SOC_SAND_IN  uint8  idx_or_val_bit
  )
{
    return ((idx_or_val_bit << 5) | value);
}

/*
 * Transform the action, value (x16) array to a 96 bit table data to load to the HW.
 */
void
  lfem_map_action_to_lfem_field_select_map(
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_LFEM lfem_action,
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  )
{
    uint8* lfem_arr = &lfem_actions[lfem_action][1];
    tbl_data->lfem_field_select_map[0] = lfem_couple_to_uint32(lfem_arr[31], lfem_arr[30]) | 
                                         (lfem_couple_to_uint32(lfem_arr[29], lfem_arr[28]) << 6) | 
                                         (lfem_couple_to_uint32(lfem_arr[27], lfem_arr[26]) << 12) | 
                                         (lfem_couple_to_uint32(lfem_arr[25], lfem_arr[24]) << 18) | 
                                         (lfem_couple_to_uint32(lfem_arr[23], lfem_arr[22]) << 24) | 
                                         ((lfem_couple_to_uint32(lfem_arr[21], lfem_arr[20]) & 0x3) << 30);
    tbl_data->lfem_field_select_map[1] = ((lfem_couple_to_uint32(lfem_arr[21], lfem_arr[20]) & 0x3c) >> 2) | 
                                         (lfem_couple_to_uint32(lfem_arr[19], lfem_arr[18]) << 4) | 
                                         (lfem_couple_to_uint32(lfem_arr[17], lfem_arr[16]) << 10) | 
                                         (lfem_couple_to_uint32(lfem_arr[15], lfem_arr[14]) << 16) | 
                                         (lfem_couple_to_uint32(lfem_arr[13], lfem_arr[12]) << 22) | 
                                         ((lfem_couple_to_uint32(lfem_arr[11], lfem_arr[10]) & 0xf) << 28);
    tbl_data->lfem_field_select_map[2] = ((lfem_couple_to_uint32(lfem_arr[11], lfem_arr[10]) & 0x30) >> 4) | 
                                         (lfem_couple_to_uint32(lfem_arr[9], lfem_arr[8]) << 2) | 
                                         (lfem_couple_to_uint32(lfem_arr[7], lfem_arr[6]) << 8) | 
                                         (lfem_couple_to_uint32(lfem_arr[5], lfem_arr[4]) << 14) | 
                                         (lfem_couple_to_uint32(lfem_arr[3], lfem_arr[2]) << 20) | 
                                         (lfem_couple_to_uint32(lfem_arr[1], lfem_arr[0]) << 26);
}

void 
  header_editing_size_to_reg_val(
    SOC_SAND_IN  soc_reg_above_64_val_t val, 
    SOC_SAND_OUT soc_reg_above_64_val_t dest
  )
{
    SOC_REG_ABOVE_64_CLEAR(dest);

    dest[0] = val[0] | (val[1] << 7) | (val[2] << 14) | (val[3] << 21) | ((val[4] & 0xf) << 28);
    dest[1] = ((val[4] & 0x70) >> 4) | (val[5] << 3) | (val[6] << 10) | (val[7] << 17) | (val[8] << 24) | ((val[9] & 0x1) << 31);
    dest[2] = ((val[9] & 0x7E) >> 1) | (val[10] << 6) | (val[11] << 13) | (val[12] << 20) | ((val[13] & 0x1f) << 27);
    dest[3] = ((val[13] & 0x60) >> 5) | (val[14] << 2) | (val[15] << 9);  
}


/******************************************************************************/
/*                     basic_epni_tm_config */
/******************************************************************************/


uint32
    arad_egr_prog_editor_add_custom_sa(int unit,
                                       int *entry_ ,
                                       int entry_odd ,
                                       int entry_even,
                                       int *mem_) 
{
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;
    int res,entry,mem;
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    entry = *entry_;
    mem = *mem_;

    /* extract last nibble from tmPortVar + first nibble from ppPortVar let call this the fourthByte */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
    prge_instruction_tbl_data.offset_base     = 46; /* PrgeDataFieldTmPortVar -7 */
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FIRST_FIFTH_NIBBLES, 
                                               mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0; 
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    /* copy 3 bytes from tmPortVar */

    mem   = (entry == entry_odd) ? (mem + 1) : mem;                                                  
    entry = (entry == entry_even) ? entry_odd : entry_even;                                          
                                                                                                     
    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;                           
    prge_instruction_tbl_data.offset_base     = 52; /* PrgeDataFieldTmPortVar -1 */                                                 
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;                     
    prge_instruction_tbl_data.size_base       = 3; /* copy 3 bytes */                                                   
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;                         
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);                       
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;                    
    prge_instruction_tbl_data.op_value        = 0;                                                   
    prge_instruction_tbl_data.op_2_field_select = 0;                                                 
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;                             
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;                          
    prge_instruction_tbl_data.cmp_action      = 0x0;                                                 
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;                         
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);  

    /* the fourthByte will be stored in register R0*/
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    /* just a NOP */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    /* now the fourthByte is in register R0, lets concatenate this register */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
    prge_instruction_tbl_data.offset_base     = 59;  /*PrgeDataFieldR0*/
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 1; /* copy only 1 byte */
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 


    /* copy highest 2 bytes of ppPortVar*/
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;

    prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
    prge_instruction_tbl_data.offset_base     = 41; /* PrgeDataFieldPpPortVar - 4*/
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 2; /* copy 2 bytes */
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = 0x0;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 

    *entry_ = entry;
    *mem_ = mem;

    exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_add_custom_sa()",0,0);
}



uint32 
  arad_egr_prog_editor_basic_epni_tm_config(
    SOC_SAND_IN  int unit
  ) 
{
  int soc_petrab_cfg = 0; /* If this set PRGE will work in soc_petrab mode (Arad otherwise) */
  int tcam_line;
  int program_line;
  int mem;
  int entry=0,entry_odd, entry_even;
  int tdm_arad_opt, tdm_arad_std;
  ARAD_MGMT_TDM_MODE tdm_mode;
  uint8 is_petrab_in_system;
  int i, j;
  uint32 res;
  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA 
      prge_program_selection_cam_tbl_data;
  ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA 
      prge_program_tbl_data;
  ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
      prge_instruction_tbl_data;
  soc_reg_above_64_val_t 
      header_editing_size, 
      header_editing_size_val;
  uint64 ethernet_header_editing_size_val;
  int is_1588 ; /* 1 -> 1588, 0 ->ntp*/
  int ftmh_size = 0;
  int reflector_with_ip;
  int canonical_tpid = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "canonical_tpid", 0);
  uint32 prgeVarLow;
  uint32 prgeVarHigh;
  /* used for vxlan egress program config for version before arad+ */
  uint32 fld_val;
  
  /* Branching entry pointer */
  uint32 branch_pointer;

  uint32 nof_dynamic_members;

  uint32 user_header_size, user_header_0_size, user_header_1_size;
  uint32 user_header_egress_pmf_offset_0_dummy, user_header_egress_pmf_offset_1_dummy;
  int tm_profiles;
  uint32 program_pointer;
  int prog_used;
  uint32 tm_profile;
  uint8 routing_preserve_dscp;

  /* customer application that connect to NP */
  uint32 customer_conn_to_np_debug;
  uint32 customer_ftmh_dsp_extension_add;
  uint32 customer_ftmh_lb_extension_add;
  uint32 customer_disable_xtmh;
  uint32 outrif_range_lower_limit = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "outrif_range_lower_limit", 0x1000);
  char *propval;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  customer_conn_to_np_debug = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "conn_to_np_debug", 0);
  customer_ftmh_dsp_extension_add = soc_property_get(unit, "ftmh_dsp_extension_add", 0);
  if ((propval = soc_property_get_str(unit, "system_ftmh_load_balancing_ext_mode")) != NULL) {
    if (sal_strcmp(propval,"ENABLED") == 0) {
        customer_ftmh_lb_extension_add = 1;    
    } else {
        customer_ftmh_lb_extension_add = 0;
    }
  } else {
    customer_ftmh_lb_extension_add = 0;
  }
  customer_disable_xtmh = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "disable_xtmh", 0);

  res = arad_egr_prog_editor_validate_lfem_action_array(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  prgeVarHigh = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_3", 0);
  prgeVarHigh = prgeVarHigh << 16;
  prgeVarHigh |= soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_2", 0);

  prgeVarLow = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_1", 0);
  prgeVarLow = prgeVarLow << 16;
  prgeVarLow |= soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_tpid_num_0", 0);

  res = arad_pmf_db_fes_user_header_sizes_get(
             unit,
             &user_header_0_size,
             &user_header_1_size,
             &user_header_egress_pmf_offset_0_dummy,
             &user_header_egress_pmf_offset_1_dummy
           );
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  user_header_size = (user_header_0_size + user_header_1_size) / 8;

  ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE ;
   
  if (SOC_IS_ARADPLUS(unit)) {
    if (soc_property_get(unit, spn_SCHEDULER_COMPENSATION_ENABLE, 0)) { 
      /*
       * Normally, user header is not included in the system header size. This way, the 
       * egress editor uses the user header size to know how many bytes to remove after the 
       * system header. 
       * When scheduling compensation feature is enabled, the user header is included in the 
       * system header size. In this case the header size used by the egress editor should be 0 
       * because the user header is removed as a part of the system header and not separately 
       * after the system header as done without scheduling compensation. 
       */
      user_header_size = 0;
    }
  }

  tdm_mode = SOC_DPP_CONFIG(unit)->arad->init.tdm_mode;
  is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);

  if (is_petrab_in_system) 
  {
    soc_petrab_cfg = 1;
  }

  tdm_arad_opt = (tdm_mode == ARAD_MGMT_TDM_MODE_TDM_OPT);
  tdm_arad_std = (tdm_mode != ARAD_MGMT_TDM_MODE_TDM_OPT);

  /* QAX - Init default outlif mapping */
  if (SOC_IS_JERICHO_PLUS(unit)) {
      /*
       * In QAX a mapping exist from actual outlif profile to the
       * outlif profile used for program selection and the outlif
       * profile available in the resolved data buffer.
       * Initialize the default mapping of these maps (1:1 mapping).
       */
      uint32 databuf[1] = {0}, progbuf[1] = {0};
      uint32 outlif_profiles_nof = 1 << soc_mem_field_length(unit,
                                                             EPNI_PRGE_PROGRAM_SELECTION_CAMm,
                                                             FIRST_OUT_LIF_PROFILE_MASKf);
      for (fld_val = 0; fld_val < outlif_profiles_nof; fld_val++) {
          soc_EPNI_OUTLIF_PROFILE_TO_PRGE_DATAm_field32_set(unit, databuf, OUTLIF_PROFILE_TO_PRGE_DATAf, fld_val);
          SOC_SAND_CHECK_FUNC_RESULT(soc_mem_write(unit, EPNI_OUTLIF_PROFILE_TO_PRGE_DATAm, MEM_BLOCK_ALL, fld_val, databuf), 10, exit);
          soc_EPNI_OUTLIF_PROFILE_TO_PRGE_PROGRAMm_field32_set(unit, progbuf, OUTLIF_PROFILE_TO_PRGE_PROGRAMf, fld_val);
          SOC_SAND_CHECK_FUNC_RESULT(soc_mem_write(unit, EPNI_OUTLIF_PROFILE_TO_PRGE_PROGRAMm, MEM_BLOCK_ALL, fld_val, progbuf), 10, exit);
      }
  }

  /*  Program selection cam - 24 lines */
  for (i = 0; i<=ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); i++) /* set all non valid lines to 0 */
  {
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, i, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 
        prge_program_selection_cam_tbl_data.valid = 0;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, i, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 
  }

  /* init the programs info */
  res = arad_egr_prog_editor_programs_init(soc_petrab_cfg, unit);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  /* fill programs usgae info */
  arad_egr_prog_editor_programs_usage_init(unit);

  /* go over all porgrams that should be used and allocate program number and lfems:
   * if not enough programs or not enough lfems - return err
   */
  res = arad_egr_prog_editor_programs_alloc(soc_petrab_cfg, unit, user_header_size);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 

  /* Set value 1 offset in accordance with existing programs*/
  res = arad_egr_prg_editor_set_value_1_offset(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 

  /* This register enables LFEM entry 10 usage */
  SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  11,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_PMC_PARITY_ENr, SOC_CORE_ALL, 0, PMC_PARITY_ENf,  0));

  /* Initiate program management system */
  res = arad_egr_prge_mgmt_init(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  tcam_line = -1;

    
  /* Config Program selection 0 : TM packet tm profile high bit 1 -> is remove-system-headers program */
  if(programs_usage[unit].user_header_always_remove) {

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          /* First handle packets with UDH without PPH or OAM-TS since in this case,
             The UDH size isn't added to the FWD-header offset in PPH or OAM-TS */
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x7;

          prge_program_selection_cam_tbl_data.pph_type                  = 0x0;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x0;

          prge_program_selection_cam_tbl_data.program                   = prog_used;
          prge_program_selection_cam_tbl_data.valid                     = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          /* Now, if there's PPH and/or OAM-TS but the FWD-code is TM, then another
             special handling is necessary */
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x7;

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_TM;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;

          prge_program_selection_cam_tbl_data.program                   = prog_used;
          prge_program_selection_cam_tbl_data.valid                     = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
      }

  }

  /* Config Program selection 0 : VMAC_DOWNSTREAM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1              = ARAD_PRGE_PP_SELECT_VALUE_1_VMAC_DOWN_ADD;
    prge_program_selection_cam_tbl_data.value_1_mask              =0;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection 0 : VMAC_UPSTREAM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ; 
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1              =ARAD_PRGE_PP_SELECT_VALUE_1_VMAC_UP_ADD;
    prge_program_selection_cam_tbl_data.value_1_mask              =0;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection 0 : MIM_PTCH2 */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_RCY_OVERLAY;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
  
  /* Config Program selection 1 : XGS_PE_FROM_FRC_LITE */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FRC_LITE;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 7; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 1 : L2_ENCAP_EXTERNAL_CPU*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  if (tm_profiles == -1) {
		  SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_ENCAP_EXTERNAL_CPU is not allocated. \n\r")));
	  }
	  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles; /*program is selected accroding to TM profile only*/
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
	  prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
	  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x3;
	  prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
	  prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
	  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
	  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
	  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
	  /* prge_program_selection_cam_tbl_data.program                 = 55s; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

      /*Program Selection - ERSPAN_XGS_PE_FROM_FTMH */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;    
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH_ERSPAN;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    /*Program Selection - ERSPAN_XGS_PE_FROM_FTMH no WA */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;    
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x1 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs            =ARAD_PRGE_DATA_ENTRY_LSBS_ERSPAN;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      =0;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code                 = PP_FWD_CODE_SNOOP;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x1 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x0;
        prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 1;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    /*Program Selection - XGS_MAC_EXT_AND_SPAN */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code  = PP_FWD_CODE_SNOOP;/* mirror should be the same code as snoop*/
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH_SPAN; /*span+xgs new define in egq_env-def*/
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    /*Config Program selection 2 : XGS_PE_FROM_FTMH_ARP*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code = 1 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x01;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid                 = 0x1;
        prge_program_selection_cam_tbl_data.eei_valid_mask            = 0;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  /* Config Program selection 2 : XGS_PE_FROM_FTMH */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x01;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 8; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

  if (prog_used != -1) {  
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x01;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 8; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);

  }

  /* put the following program before ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
      }
      
      prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0;

      /* learn_ext_exist=1,valid_eei=0 */
      prge_program_selection_cam_tbl_data.eei_valid                  = 0x0;
      prge_program_selection_cam_tbl_data.eei_valid_mask             = 0x0;

      prge_program_selection_cam_tbl_data.learn_ext_exist            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x0;

      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_ETHERNET; /* bridging */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;

      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_PON_DSCP_RE;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
      }
      
      prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0;

      /* learn_ext_exist=0,valid_eei=1 */
      prge_program_selection_cam_tbl_data.eei_valid                  = 0x1;
      prge_program_selection_cam_tbl_data.eei_valid_mask             = 0x0;

      prge_program_selection_cam_tbl_data.learn_ext_exist            = 0x0;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x0;

      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_ETHERNET; /* bridging */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;

      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_PON_DSCP_RE;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_LI, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_LI;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;

      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; /* second encapsulation is IPV4 */
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit); 
  }

  /* Config Program selection 3 : ETH_WITH_LLID_TAG */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.data_entry_lsbs            = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          /* prge_program_selection_cam_tbl_data.program                 = 11; */
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }
      else {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x7;
          prge_program_selection_cam_tbl_data.fwd_code                  = 0x0;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          /* prge_program_selection_cam_tbl_data.program                 = 11; */
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit); 
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                        unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 1; /* FWD-Code == 1 or 3*/
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 2;

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_IPSEC_ENC_DEC;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.program                   = prog_used;
      prge_program_selection_cam_tbl_data.valid                     = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }


  /* Config Program selection 4 : IPV6_TUNNEL_PROGRAM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;

      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;

      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_IPV6_TUNNEL;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0; /* ROO over IPv6 isn't supported */
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
  }

  /* Config Program selection : ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code      = 0x5; /* MPLS */
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;

      /* Uses outlif-profile which is added later (in this stage the required
         occupation management isn't initialized) */

      prge_program_selection_cam_tbl_data.program       = prog_used;
      prge_program_selection_cam_tbl_data.valid         = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection 5 : ETH_OAM_LOOPBACK */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_ETH_OAM_LOOPBACK;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;

      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }


   if ( SOC_DPP_CONFIG(unit)->pp.upmep_lbm_is_configured ){

      /* Config additional Program selection : ETH_OAM_LOOPBACK for upmep LBM*/
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_ETH_LOOPBACK;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;

          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }


      /* Config another Program selection 5 : ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER for second path in upmep LBM*/
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_ETH_OAM_LOOPBACK_UP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;

          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }
  


    	/*Config Program selection 6 :  oam_sub_type == 3*/
    for (is_1588 = 0; is_1588 <= 1; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP; 
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            prge_program_selection_cam_tbl_data.oam_sub_type              = (is_1588 == 1)? _ARAD_PP_OAM_SUBTYPE_DM_1588 : _ARAD_PP_OAM_SUBTYPE_DM_NTP;
            prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0;

            prge_program_selection_cam_tbl_data.mirror_enable = 1 ;/* QAX */
            prge_program_selection_cam_tbl_data.mirror_enable_mask = 0 ;

            prge_program_selection_cam_tbl_data.valid = 1;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
        }

    }

	/* Always below the equicalent up programs. (Up packets may incorrectly catch the down program but the other way around is not possible).*/
	for (is_1588 = 0; is_1588 <= 1; ++is_1588) {
		/*Config Program selection 6 : OAM Program according to PP port */
		int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP :
										  ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		if (prog_used != -1) {
			tcam_line++;
			if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
				SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
			}
			ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
			prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1; /* Ignore the First bit. 
                                                                                                                Select only packets destined to the OAMP (PP profile 1) or CPU (PP profile 0)*/
			prge_program_selection_cam_tbl_data.pph_type = 0x2; /* PPH type: oam-TS present*/
			prge_program_selection_cam_tbl_data.pph_type_mask = 0x1; /* PPH type: Look at the OAM-TS bit*/

			prge_program_selection_cam_tbl_data.value_1_mask              = ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_MASK;
			prge_program_selection_cam_tbl_data.value_1              = (is_1588) ? ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_1588_DOWN :
																				   ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_NTP_DOWN;

            prge_program_selection_cam_tbl_data.valid = 1;
			prge_program_selection_cam_tbl_data.program                 = prog_used;
			res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
		}
	}

	/*Config Program selection 6 :  oam_sub_type == 1*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
       unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
       /* In Jericho injected LM packets will also have sub-type 1 (LM).
          The program selection must be more exclusive: use the FHEI size as well.
          Two entries are required - one for value 1 (3B) and one for value 2 (5b).
          Injected packets should have FHEI size 0.*/
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

       prge_program_selection_cam_tbl_data.fhei_size =  1;
       prge_program_selection_cam_tbl_data.fhei_size_mask =  SOC_IS_JERICHO(unit) ? 0 : 3;

       prge_program_selection_cam_tbl_data.oam_sub_type = _ARAD_PP_OAM_SUBTYPE_LM;
       prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0;

       prge_program_selection_cam_tbl_data.mirror_enable = 1; /* QAX */
       prge_program_selection_cam_tbl_data.mirror_enable_mask = 0;

       prge_program_selection_cam_tbl_data.valid = 1;
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

       if (SOC_IS_JERICHO(unit)) {
          /* Add a second entry with a different FHEI size.*/
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
             SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          prge_program_selection_cam_tbl_data.fhei_size =  2;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
       }
       if (SOC_IS_JERICHO_PLUS(unit)) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
             SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
          prge_program_selection_cam_tbl_data.oam_sub_type =  _ARAD_PP_OAM_SUBTYPE_SLM; /* SLM */
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
       }
    }
	
    /* Config Program selection 7 : OAM Program oam_sub_type == 4 (CCM) */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
    unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.oam_sub_type            = _ARAD_PP_OAM_SUBTYPE_CCM;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask       = 0x0;

        prge_program_selection_cam_tbl_data.mirror_enable=1;
        prge_program_selection_cam_tbl_data.mirror_enable_mask=0;

        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
    }

    /* Config Program selection : OAM LBR SAT Program oam_sub_type == 5 (LBM) */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
       unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_UPMEP_LOOPBACK_SAT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.oam_sub_type            = _ARAD_PP_OAM_SUBTYPE_ETH_LOOPBACK;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask       = 0x0;

        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {
		tcam_line++;
		if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
		{
			SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		}
		ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
		
		prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
		prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
		prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0xf;
		prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
		prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
		prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
		prge_program_selection_cam_tbl_data.oam_sub_type              = ARAD_PP_OAM_SUBTYPE_EGRESS_SNOOP;
		prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
		prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
		prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
		prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
		prge_program_selection_cam_tbl_data.valid = 1 ;
		prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
		prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
		prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
		prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
		prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
		prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		prge_program_selection_cam_tbl_data.program                 = prog_used;
		res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	}

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
        prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_END_TLV;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_BFD_CLEAR_FLAGS;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
        prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_END_TLV;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }


    /* [ARAD+]Config Program selection :PRESERVING_DSCP -  Preserving DSCP on a per out-port bases  - pph type = OAMTS*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
      for (i=0; i<2; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.fwd_code                   = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
          prge_program_selection_cam_tbl_data.fwd_code_mask              = 0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP; 
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
          prge_program_selection_cam_tbl_data.pph_type                  = 0x3;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }
   

    /* [ARAD+]Config Program selection :PRESERVING_DSCP -  Preserving DSCP on a per out-port bases */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }

            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
            prge_program_selection_cam_tbl_data.fwd_code                   = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask              = 0;
            prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP; 
            prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;     
            prge_program_selection_cam_tbl_data.data_entry_cnt             = 0;
            prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
        }
    }

    /* [ARAD+]Config Program selection :PRESERVING_DSCP -  Preserving DSCP on a per out-port bases - IPV6*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }

            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
            prge_program_selection_cam_tbl_data.fwd_code                   = (i==0)?PP_FWD_CODE_IPV6_UC:PP_FWD_CODE_IPV6_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask              = 0;
            prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP; 
            prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
            prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
            prge_program_selection_cam_tbl_data.pph_type                  = 0x1;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
        }
    }
    
    routing_preserve_dscp = (SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp;
    
    /* [JER]Config Program selection :PRESERVING_DSCP, IPv4 with OAM-TS header */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            /*
                    * program selection can be done based on either(depends on SOC property):
                    *     Out port PP profile
                    *     Out port PP profile + InLIF profile
                    *     OutLIF profile + InLIF profile
                    */
            if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
            }

            prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
            prge_program_selection_cam_tbl_data.pph_type_mask             = 0;
            prge_program_selection_cam_tbl_data.pph_type                  = 0x3;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
        }
    }

    /* [JER]Config Program selection :PRESERVING_DSCP, IPv4 without OAM-TS header */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 131, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 132, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            /*
                    * program selection can be done based on either(depends on SOC property):
                    *     Out port PP profile
                    *     Out port PP profile + InLIF profile
                    *     OutLIF profile + InLIF profile
                    */
            if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
            }

            prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV4_UC:PP_FWD_CODE_IPV4_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 133, exit);
        }
    }
    
    /* [JER]Config Program selection :PRESERVING_DSCP, IPv6 */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 134, exit);
    if (prog_used != -1) {
        for (i=0; i<2; i++) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 135, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

            /*
                    * program selection can be done based on either(depends on SOC property):
                    *     Out port PP profile
                    *     Out port PP profile + InLIF profile
                    *     OutLIF profile + InLIF profile
                    */
            if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
                prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
                prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
            }

            prge_program_selection_cam_tbl_data.fwd_code                  = (i==0)?PP_FWD_CODE_IPV6_UC:PP_FWD_CODE_IPV6_MC;
            prge_program_selection_cam_tbl_data.fwd_code_mask             = 0;
            prge_program_selection_cam_tbl_data.program                 = prog_used;
            prge_program_selection_cam_tbl_data.valid                   = 0x1;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 136, exit);
        }
    }
    
    /* Config Program selection : BFD ECHO */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_OAM_PORT; /* ARAD_PRGE_PP_SELECT_PP_COPY_HEADER; */
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
        prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
        prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
        prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
        prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
        prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
        prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        prge_program_selection_cam_tbl_data.valid                   = 0x1;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
       prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x0;

       prge_program_selection_cam_tbl_data.oam_sub_type = _ARAD_PP_OAM_SUBTYPE_SLM;
       prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0x0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_PP_OAM_PORT;
       prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.fwd_code = 7;    /*cpu trap*/
       prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
       
       prge_program_selection_cam_tbl_data.value_1 = 0;    /*default, it's trap id and should be set by user*/
       prge_program_selection_cam_tbl_data.value_1_mask = 0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, &prog_used);
   SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
   if (prog_used != -1) {
       tcam_line++;
       if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
       }
       ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
       prge_program_selection_cam_tbl_data.fwd_code = 7;    /*cpu trap*/
       prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
       
       prge_program_selection_cam_tbl_data.value_1 = 0;    /*default, it's trap id and should be set by user*/
       prge_program_selection_cam_tbl_data.value_1_mask = 0;
  
       prge_program_selection_cam_tbl_data.program                 = prog_used;
       prge_program_selection_cam_tbl_data.valid                   = 0x1;
       res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
       SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
   }



  /* Config Program selection 9 : epni_prge_config_erspan */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ERSPAN;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x0;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
      /* no copy paste error */
      /* coverity[copy_paste_error] */
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
      /* prge_program_selection_cam_tbl_data.program                = 15; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 10 : epni_prge_config_rspan */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask              = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask             = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask          = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask             = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask               = 0xff;
      prge_program_selection_cam_tbl_data.first_enc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask            = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt             = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
      /* prge_program_selection_cam_tbl_data.program                 = 12; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 9 : epni_prge_config_erspan */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_ERSPAN;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      /* prge_program_selection_cam_tbl_data.program                = 15; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }



  /* Config Program selection 11 : epni_prge_config_span */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_SPAN;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask              = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask             = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask          = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask             = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask               = 0xff;
      prge_program_selection_cam_tbl_data.first_enc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask            = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 2; remove system_header (must) */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 11 : epni_prge_config_span */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
        prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_OLP_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x0;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x7;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      /* EVPN outlif profile is also used here */
      if (SOC_IS_JERICHO_PLUS(unit)) {
            prge_program_selection_cam_tbl_data.fifth_out_lif_profile = 1; /* Assuming FRR (Extension Label) always use outlif profile bit-0*/
            prge_program_selection_cam_tbl_data.fifth_out_lif_profile_mask &= ~1;
      } else {
            prge_program_selection_cam_tbl_data.first_out_lif_profile = 1; /* Assuming FRR (Extension Label) always use outlif profile bit-0*/
            prge_program_selection_cam_tbl_data.first_out_lif_profile_mask &= ~1;
      }
      prge_program_selection_cam_tbl_data.routing_over_overlay = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.first_enc               = 1; /* MPLS 1st Enc*/
      prge_program_selection_cam_tbl_data.first_enc_mask          = 0;
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      /*
       * OutLIF-Profile1.ELI == 1 (will be added during mpls_init)
       */

      for (i = 1; i <= 4; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          /*
           * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init)
           */

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      /*
	   * OutLIF-Profile1.ELI == 1 (will be added during mpls_init)
	   */

      prge_program_selection_cam_tbl_data.first_enc = 1; /* MPLS 1st Enc*/
      prge_program_selection_cam_tbl_data.first_enc_mask = 0;

      /* Uses outlif-profile which is added later (in this stage the required
         occupation management isn't initialized) */
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      /* Uses outlif-profile which is added later (in this stage the required
         occupation management isn't initialized) */

      if (SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.fifth_out_lif_profile = 0;
          prge_program_selection_cam_tbl_data.fifth_out_lif_profile_mask &= 0x3E;
      } else {
          prge_program_selection_cam_tbl_data.first_out_lif_profile = 0;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask &= 0x3E;
      }
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      /* Uses outlif-profile which is added later (in this stage the required
         occupation management isn't initialized) */

      if (SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.fifth_out_lif_profile = 1;
          prge_program_selection_cam_tbl_data.fifth_out_lif_profile_mask &= 0x3E;
      } else {
          prge_program_selection_cam_tbl_data.first_out_lif_profile = 1;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask &= 0x3E;
      }
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc                        = 0 ;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      prge_program_selection_cam_tbl_data.fwd_code     =   2 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask  = 1 ; /*ipv4/6 UC*/
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      prge_program_selection_cam_tbl_data.fwd_code     =   0 ;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0 ; /*bridge*/
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc                        = 0 ;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      prge_program_selection_cam_tbl_data.fwd_code     =   PP_FWD_CODE_MPLS ;
      prge_program_selection_cam_tbl_data.fwd_code_mask  = 0 ; /*ipv4/6 UC*/
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.first_enc             = 1 ;
      prge_program_selection_cam_tbl_data.first_enc_mask    = 0 ;
      prge_program_selection_cam_tbl_data.second_enc                        = 3 ;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 0 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      /*
       * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init)
       */

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      if (!SOC_IS_JERICHO_PLUS(unit)) {
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      }
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      prge_program_selection_cam_tbl_data.data_entry_cnt                   = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.data_entry_lsbs                        = 1 ;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask                   = 0 ;

      prge_program_selection_cam_tbl_data.fwd_code     =    PP_FWD_CODE_MPLS;
      prge_program_selection_cam_tbl_data.fwd_code_mask                          = 0 ;

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      /*
       * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init)
       */

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;

      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      for (i = 1; i <= 4; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          /*
           * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init)
           */

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      for (i = 1; i <= 4; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          /*
           * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init) to outlif profiles 3 or 4, and to outlif profiles 5 or 6.
           */

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      for (i = 1; i <= 2; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          /*
           * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init) to outlif profiles 3 or 4, and OutLIF-Profile_i.SR-bit == 0 will be set to both outlif profile 5 and 6.
           */

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* Add 4 entries - one for each outlif-profile   */

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.valid                   = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;

      for (i = 1; i <= 2; i++) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
          }
          /*
           * OutLIF-Profile_i.SR-bit == 1 (will be added during mpls_init) to outlif profiles 5 or 6, and OutLIF-Profile_i.SR-bit == 0 will be set to both outlif profile 3 and 4
           */

          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
      }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code      = PP_FWD_CODE_IPV4_UC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0;

      prge_program_selection_cam_tbl_data.prge_pp_profile = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_ETHERNET;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.system_mc                 = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0;

      prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_MIM_SPB;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;

      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;

      prge_program_selection_cam_tbl_data.system_mc                 = 1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0;

      prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_MPLS;
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.first_enc = 0x1; /* first encapsulation is MPLS*/
        prge_program_selection_cam_tbl_data.first_enc_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV4_MC;
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }
  
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

        prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV4_UC;
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
        prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
        prge_program_selection_cam_tbl_data.second_enc_mask = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
        prge_program_selection_cam_tbl_data.valid = 1;
        prge_program_selection_cam_tbl_data.program = prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
      prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV6_MC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
      prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
      prge_program_selection_cam_tbl_data.second_enc_mask = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  
      prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV6_UC;
      prge_program_selection_cam_tbl_data.fwd_code_mask = 0x0;
      prge_program_selection_cam_tbl_data.second_enc = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP;
      prge_program_selection_cam_tbl_data.second_enc_mask = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* UC ROO */
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
	  prge_program_selection_cam_tbl_data.fwd_code                  = 1; /* UC IPv4/6*/
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x2; /* IPv6 is FWD_CODE=3 */
        prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      /* IPV4 MC ROO */
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
	  prge_program_selection_cam_tbl_data.fwd_code                  = 2; /* MC IPv4*/
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

      /* IPV6 MC ROO */
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 14, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 4; /* MC IPv6*/
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay      = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);


  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1)  {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  /*Config Program selection 9 : DC-Overlays - VxLAN Plus-F5*/
	  prge_program_selection_cam_tbl_data.fwd_code                 = 1; /* UC IPv4*/
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
	  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
	  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
	  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
	  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
	  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ROO_VXLAN; /* LL-Eth*/
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
	  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

	  /*Config Program selection 10 : DC-Overlays - VxLAN  Plus-F5*/
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  prge_program_selection_cam_tbl_data.fwd_code                 = 2; /* MC IPv4*/
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
	  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
	  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
	  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
	  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
	  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ROO_VXLAN; /* LL-Eth*/
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
	  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }


  /* Config Program selection : VXLAN
     for version under arad+. Arad+ support VxLAN by design. */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                   = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; /* second encapsulation is IPV4 */
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_IPV4_UC;
	prge_program_selection_cam_tbl_data.fwd_code_mask = 0;
	prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
	prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0xf;
	prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
	prge_program_selection_cam_tbl_data.pph_type = 2 ; /* OAM ts exists */
	prge_program_selection_cam_tbl_data.pph_type_mask = 1 ;
	prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
	prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x7;
	prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
	prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
	prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
	prge_program_selection_cam_tbl_data.valid = 1 ;
	prge_program_selection_cam_tbl_data.value_1                  =0x03;/* {cni = 0, ecn = 1, excl_src = 1}*/
	prge_program_selection_cam_tbl_data.value_1_mask              =0xf8;
	prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
	prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
	prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
	prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
	prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
	prge_program_selection_cam_tbl_data.program                 = prog_used;
	res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.first_out_lif_profile = 1; /* Assuming FRR (Extension Label) always use outlif profile bit-0*/
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask &= ~1;
      prge_program_selection_cam_tbl_data.valid = 1 ;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection 12 : copy etpp new header (default with arp ext) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code              = 0x1;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid                 = 0x1;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* Config Program selection: copy User Defined Header */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_WITH_USER_HEADERS;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  for (reflector_with_ip=0 ; reflector_with_ip<=1 ; ++reflector_with_ip) {
	  ARAD_EGR_PROG_EDITOR_PROGRAMS used_program = reflector_with_ip? ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH :
		  ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, used_program, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  if (prog_used != -1) {
		  tcam_line++;
		  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
			  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		  }
		  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

		  prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, used_program, &tm_profile);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
		  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
		  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
		  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
		  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
		  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
		  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
		  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
		  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
		  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
		  prge_program_selection_cam_tbl_data.valid = 1;
		  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
		  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
		  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
		  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
		  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
		  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		  prge_program_selection_cam_tbl_data.program                 = prog_used;
		  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	  }
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.ace_variable = ARAD_EGR_PROG_EDITOR_ACE_REFLECTOR_1PASS;
      prge_program_selection_cam_tbl_data.ace_variable_mask = 0;

      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.program = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_selection_cam_tbl_data.prge_tm_profile = tm_profiles; /*TmProfile = 10, could be changed */
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask = 1;
      prge_program_selection_cam_tbl_data.pph_type_mask = 3;
      prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
      prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.tm_profile.get(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &tm_profile);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_selection_cam_tbl_data.prge_tm_profile = tm_profiles; /*TmProfile = 10, could be changed */
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask = 1;
      prge_program_selection_cam_tbl_data.pph_type_mask = 3;
      prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
      prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

    /* Config Program selection : Add NULL Programs
     * for snopped packet in case of 4_label_push flow
     * Use the same 4_Label_Push selection + prge_pp_profile */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = 0x0;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  /* check whether learn extenssion (eei2) exists*/
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* Config Program selection : 4_label_push */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    /* Ignore snopped or trapped packets */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  /* check whether learn extenssion (eei2) exists*/
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_ETHERNET; /* bridging */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid                = 0x1; /* eei exists, we expect it to be signaled by pmf in this case */
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x0;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x0; /* first encapsulation is None*/
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; /* second encapsulation is IP*/
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x0;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  /* check whether learn extenssion (eei2) exists*/
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_INTO_BACKCONE_WITH_TTL_PORT;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 = prog_used;

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* selection for programs:
     ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED,ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED,
     ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED,
     looks the same here, but they are actually different , the function bcm_petra_mpls_init
     modifies the prgoramm selection of these 3 programs to be dependent on outlif profile */
  /* Config Program selection : ptagged programm, user mode ptagged */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    /* Ignore snopped or trapped packets */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; /* first encapsulation mpls */
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  /* check whether learn extenssion (eei2) exists*/
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x0;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;    /* this packet's native ethernet is tagged */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* Config Program selection : ptagged programm, user mode ptagged */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    /* Ignore snopped or trapped packets */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; /* first encapsulation mpls */
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      /* check whether learn extenssion (eei2) exists*/
      prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }





  /* Config Program selection : patg_tbridge untagged case */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                    = 0x7;    /* Ignore snopped or trapped packets */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0; 
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; /* first encapsulation mpls */
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      /* check whether learn extenssion (eei2) exists*/
      prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;  /* this signals untagged native ethernet */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }











  /* Config Program selection : ptagged programm, user mode ptagged */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1; /* first encapsulation mpls */
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      /* check whether learn extenssion (eei2) exists*/
      prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x1;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* Config Program selection : mpls lsr programm, lsr manipulation */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                   = 0x7;    /* Ignore snopped or trapped packets */
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x7;
          
      prge_program_selection_cam_tbl_data.first_enc                 = 0x1;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1; 

      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = SOC_PPD_EG_ENCAP_TEST2_PROG_VAR;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_EoE_PROGRAM;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }







  /* Config Program selection N : PRGE SUPPORT for FCOE N_PORT Program
   * Program Selectoin according to FWDCODE=FCF + ARAD_PRGE_TM_SELECT_FCOE_N_PORT
   */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_FCOE_N_PORT, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_FCOE_N_PORT is not allocated. \n\r")));
      }

      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_FCF;   /* FCF FWD_CODE*/
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;

      prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles;/* N_PORT */
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* Config Program selection N+1 : PRGE SUPPORT for FCOE NP_PORT Program
   * NOTE: Must be in lower priority than the Program selection for ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT
   * Program Selectoin according to FWDCODE=FCF only. (Assuming tm_port_profile is not set for NP_PORT)
   */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_FCF;   /* FCF FWD_CODE*/
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* Mpls Raw */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

	  prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_RAW_MPLS, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  if (tm_profiles == -1) {
		  SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_RAW_MPLS is not allocated. \n\r")));
	  }
	  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
	  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
	  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
	  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
	  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
	  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
	  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
	  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
	  prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
	  prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
	  prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
	  prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
	  prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.program                 = prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Init the program selection for the COPY Headers COE with ITMH FWD (no EGR PP) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.pph_type                  = 0x0;   /* No PPH - For ITMH case */
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x2;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code                  = 7;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* Config Program selection  : timestamp and ssp */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TIMESTAMP_AND_SSP, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TIMESTAMP_AND_SSP is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0; /* so it will not hit other programs - use the default pp profile */
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 2; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }



  if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1){   /* System is configured with FUll MyMAC in PRGE
                                                          Need Copy Headers for L2 and another with Update SA for L3 Traffic */
      /* Config Program selection 12 : copy etpp new header (default) */
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.fwd_code                  = (PP_FWD_CODE_ETHERNET | PP_FWD_CODE_ETHERNET_AFTER_TERMINATION);   /* L2 Traffic */
          prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x8;  /* 4b'1000 - All 3 Lsb == 0 */
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.second_enc               = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_NONE;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x0;

          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  } else { /* Not supporting Full MyMAC in PRGE - Standard Copy Headers Selection Cam */

            /* Config Program selection 12 : copy etpp new header (default) */
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }

  /* Config Program selection 13 : OTMH CUD and extensions */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 1; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  /* Config Program selection : OTMH BASE and extensions, keep PPH */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_OTMH_BASE, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_BASE is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE_KEEP_PPH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 1; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }



  /* Config Program selection 13 : OTMH BASE and extensions */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_OTMH_BASE, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_BASE is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 1; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  /* Config Program selection 14 : removing system headers */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_REMOVE_SYSTEM_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 2; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }

  /* Config Program selection 15 : TDM FTMH */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                 = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_REMOVE_TDM_OPT_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      /* prge_program_selection_cam_tbl_data.program                 = 3; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 160, exit);
  }

  /* Config Program selection 16 : TDM PMM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_TDM_PMM_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      /* prge_program_selection_cam_tbl_data.program                 = 5; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 170, exit);
  }

  /* Config Program selection 18 : TDM_STAMP_CUD */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 10; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }


  /* Config Program selection 18 : TDM_STAMP_CUD_OVER_OUTER_FTMH */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD_OVER_OUTER_FTMH, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD_OVER_OUTER_FTMH is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;

      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }

  /* Config Program selection 19 : 2_HOP_SCHEDULING */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_PP_RCY_PORT, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_PP_RCY_PORT is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }

  /* Config Program selection 20 : STACKING */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_STACKING, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_STACKING is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_TDM_STAMP_CUD;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 7; */
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);
  }

  	/*--------------------------------------------*/
	/* Stacking program with UC selection*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1)
	{
		tcam_line++;
		if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit))
		{
			SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		}
		ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
		/*Config Program selection 16 : STACKING*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_STACKING, &tm_profiles);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (tm_profiles == -1) {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_STACKING is not allocated. \n\r")));
        }
        prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
		prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0x0;
		prge_program_selection_cam_tbl_data.prge_pp_profile           =0x0;
		prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x0;
		prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
		prge_program_selection_cam_tbl_data.system_mc = 0 ;
		prge_program_selection_cam_tbl_data.system_mc_mask = 0 ;
		prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
		prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
		prge_program_selection_cam_tbl_data.oam_sub_type              =_ARAD_PP_OAM_SUBTYPE_DEFAULT;
		prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
		prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
		prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
		prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
		prge_program_selection_cam_tbl_data.valid = 1 ;
		prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
		prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
		prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
		prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
		prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
		prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		prge_program_selection_cam_tbl_data.program                 = prog_used;
		res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	}


  /* Config Program selection 23 : L2_REMOTE_CPU */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);
  }

  /* Config Program selection 24 : ADD PACKET SIZE HEADER */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (tm_profiles == -1) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER is not allocated. \n\r")));
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
	  prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* customer application that connect to NP */
  if(SOC_IS_JERICHO(unit) && programs_usage[unit].customer_conn_to_np_enable) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;   /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;  /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;   /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;  /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 2;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }

          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }

          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;   /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;  /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 00;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 3;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 01;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }


      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_ETHERNET;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_MPLS;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }
	  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_UC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_UC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

	  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_UC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 0;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 2;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }


      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_IPV4_MC;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 0;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_MPLS;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;    /*bit 3:0*/
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;    /*bit 7:4*/
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;    /*bit 11:8*/
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 2;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
          /*
          prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_MPLS;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
          */
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP - 1;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
          
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;    /*bit 12*/
          prge_program_selection_cam_tbl_data.pph_type                  = 1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x1;    /*bit 14:13*/
          prge_program_selection_cam_tbl_data.data_entry_lsbs           = 1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;   /*bit 33:32*/

          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }


      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);          
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profiles);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          if (tm_profiles == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP is not allocated. \n\r")));
          }
      
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
          prge_program_selection_cam_tbl_data.system_mc                 = 1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
          
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);        
      }  
  }
  
  /* [ARAD+]Config Program selection :_COPY_HEADER  - 
     *     default program in case of prge pp profile =  ARAD_PRGE_PP_SELECT_PRESERVING_DSCP
     */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
  
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
  
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.program                 = prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }
  
  /* [JER]Config Program selection :_COPY_HEADER  - 
     *     default program in case of prge pp profile=  ARAD_PRGE_PP_SELECT_PRESERVING_DSCP
     */
  if (routing_preserve_dscp & SOC_DPP_DSCP_PRESERVE_PORT_CTRL_EN) {
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          tcam_line++;
          if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
          }
  
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  
  
          ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PRESERVING_DSCP;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
          prge_program_selection_cam_tbl_data.program                 = prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
          res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
      }
  }


  /* Config Program selection 22 : NULL program */
  tcam_line++;
  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit)) {
      SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
  }
  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &prge_program_selection_cam_tbl_data);
  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
  prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0xf;
  prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
  prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
  prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
  prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
  prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
  prge_program_selection_cam_tbl_data.oam_sub_type              = _ARAD_PP_OAM_SUBTYPE_DEFAULT;
  prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
  prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
  prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
  prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x1;
  prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.valid                   = 0x1;
  prge_program_selection_cam_tbl_data.program                 = 0x0;
  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 200, exit);





  /*  Program table - 16 lines */

  /*  Program 0 - default program (does nothing) */
  program_line = 0; /* NULL program - aleays exists and always prog=0 */
  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
  prge_program_tbl_data.program_pointer       = 0;
  COMPILER_64_ZERO(prge_program_tbl_data.program_var);
  prge_program_tbl_data.register_src          = 1;
  prge_program_tbl_data.remove_system_header  = 0;
  prge_program_tbl_data.remove_network_header = 0;
  prge_program_tbl_data.bytes_to_remove       = 0;
  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, program_line, &prge_program_tbl_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);

  /*  Program 1 - ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    COMPILER_64_ZERO(prge_program_tbl_data.program_var);
    prge_program_tbl_data.register_src         = 1;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       = 0;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    COMPILER_64_ZERO(prge_program_tbl_data.program_var);
    prge_program_tbl_data.register_src         = 1;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       = 0;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - tm_profile = 1 (creates OTMH and removes FTMH) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - tm_profile = 1 (creates OTMH and removes FTMH but no PPH) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      /* Same program pointer as OTMH program */
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.set(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size + ftmh_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - tm_profile = 1 (creates OTMH and removes FTMH) CUD */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 2 - tm_profile = 2 (Remove FTMH) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x8100); /* TPID for port extender mode 2 */
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) ? 12 : 0) + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 230, exit);
  }

  /*  Program 3 - tm_profile = 3 (Remove TDM FTMH) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      if (SOC_IS_JERICHO_PLUS(unit) && tdm_arad_std) {
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
              unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prge_program_tbl_data.program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          COMPILER_64_ZERO(prge_program_tbl_data.program_var);
          prge_program_tbl_data.register_src         = 0;
          prge_program_tbl_data.remove_system_header  = 1;
          prge_program_tbl_data.remove_network_header = 0;
          prge_program_tbl_data.bytes_to_remove       = ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE;
      } else {
          prge_program_tbl_data.program_pointer      = 0;
          COMPILER_64_ZERO(prge_program_tbl_data.program_var);
          prge_program_tbl_data.register_src         = 0;
          prge_program_tbl_data.remove_system_header  = 0;
          prge_program_tbl_data.remove_network_header = 0;
          prge_program_tbl_data.bytes_to_remove       = (soc_petrab_cfg && tdm_arad_opt) ? 2:4; /* Optimize Petra-B is 2 Bytes */;
      }
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 240, exit);
  }

  /*  Program 4 -Ethernet copy (for COE ITMH) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x8100); /*HIGH = SIP limi indication | LOW = tpid=8100 in Port Extender Tag */
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = user_header_size + 12;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_TRAP_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x8100); /*HIGH = SIP limi indication | LOW = tpid=8100 in Port Extender Tag */
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = user_header_size + 12;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program 4 -Ethernet copy (default) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, SOC_PPD_EG_ENCAP_BFD_IPV4_PROG_VAR ,0x8100); /*HIGH = SIP limi indication | LOW = tpid=8100 in Port Extender Tag */
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program X - In Case of Full MyMac supported - L3 Traffic Copy Headers */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, SOC_PPD_EG_ENCAP_BFD_IPV4_PROG_VAR ,0x8100); /*HIGH = SIP limi indication | LOW = tpid=8100 in Port Extender Tag */
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }
  /*  Program - 4_label_push */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - copy dscp to encapsulating IP*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - override TOS , fix checksum*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - override TOS , no checksum*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /* copy 48 bytes of system headers, keep original packet */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /* */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      prgeVarLow = 0x00000000;
      prgeVarHigh= 0x08000000; /* lowest 6 bytes are reserved for B-SA don't use */
      COMPILER_64_SET(prge_program_tbl_data.program_var,prgeVarHigh,prgeVarLow);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /*  Program - ptagged program */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      COMPILER_64_SET(prge_program_tbl_data.program_var,prgeVarHigh,prgeVarLow);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - ptagged program */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      COMPILER_64_SET(prge_program_tbl_data.program_var,prgeVarHigh,prgeVarLow);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - ptagged program */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      COMPILER_64_SET(prge_program_tbl_data.program_var,prgeVarHigh,prgeVarLow);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      COMPILER_64_SET(prge_program_tbl_data.program_var,prgeVarHigh,prgeVarLow);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /*PP mode*/
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /*TM mode*/
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - BFD echo */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /*  Program - Preserving DSCP on a per out-port bases */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /*PP*/
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program - Preserving DSCP on a per out-port bases */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /*PP*/
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /*  Program - Preserving DSCP on a per out-port bases - IPV6 */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /*PP*/
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }




  /*  Program - BFD clear flags */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x7);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 2;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /*  Program - copy User Defined Headers  */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /* prepare regs src to generated headers */
      prge_program_tbl_data.remove_system_header  = 1; /* remove the system headers from the packet header */
      prge_program_tbl_data.remove_network_header = 1; /* remove the network headers from the packet header */
      prge_program_tbl_data.bytes_to_remove       = 0; /* The user defined headers in the network header removed as part of network_headers removal */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);
  }

  /*  Program 4 -Ethernet copy (default with arp ext)  */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /*  Program 5 - tm_profile = 4 (TDM PMM) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1; /* Remove FTMH header */
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 260, exit);
  }

  /* Program 7 - tm_profile = 6 (XGS_PE_FROM_FRC_LITE) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 10 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 280, exit);
  }

  /* Program 8 - tm_profile = 7 (XGS_PE_FROM_FTMH) */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x010100);
      /*prge_program_tbl_data.program_var          = 0x010100;*/
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x010100);
      /*prge_program_tbl_data.program_var          = 0x010100;*/
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);

  }

  /*Program 8 - tm_profile = 7 (XGS_PE_FROM_FTMH_ARP)*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x010100);
      /*prge_program_tbl_data.program_var          = 0x010100;*/
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }


    for (is_1588=0; is_1588<=1 ; ++is_1588) {
            /*Program 9 -  (OAM_TS_EXT)*/
        int prog_index = (is_1588==1)? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP:
            ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP;

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1)
        {
            sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, prog_index, &prge_program_tbl_data.program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            /*prge_program_tbl_data.program_var          = {0x0,0xe8,0x0,0xe9}; */
            COMPILER_64_SET( prge_program_tbl_data.program_var,0,0xe000e0);
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = 0;
            prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x0);

        prge_program_tbl_data.register_src         = 0;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
    
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x0);

        prge_program_tbl_data.register_src         = 0;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
    
    }
    
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = 1;
            prge_program_tbl_data.bytes_to_remove       = 31;
            COMPILER_64_SET(prge_program_tbl_data.program_var,0,43); /*default, can be set by user*/
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
        } else {
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 0;
            prge_program_tbl_data.remove_network_header = 0;
            prge_program_tbl_data.bytes_to_remove       = 0;
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);        
        }
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = 1;
            prge_program_tbl_data.bytes_to_remove       = 31;
            COMPILER_64_SET(prge_program_tbl_data.program_var,0,43); /*default, can be set by user*/
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
        } else {
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 0;
            prge_program_tbl_data.remove_network_header = 0;
            prge_program_tbl_data.bytes_to_remove       = 0;
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);        
        }
    }



	/*Program 9 - oam_sub_type = 3 (OAM_TS_EXT)*/
    for (is_1588=0; is_1588<=1 ; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP;

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1)
        {
            sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, prog_index, &prge_program_tbl_data.program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            /*prge_program_tbl_data.program_var          = {0x0,0xe8,0x0,0xe9}; */
            COMPILER_64_SET( prge_program_tbl_data.program_var,0,0xe000e0);
            prge_program_tbl_data.register_src         = soc_petrab_cfg ? 0 : 1; /* Petra-B in system ? TM : PP */
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = soc_petrab_cfg ? 0 : 1; /* Petra-B in system ? Keep : Remove */
            prge_program_tbl_data.bytes_to_remove       = 0 ;
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
        }
    }


        /*Program 9 - oam_sub_type = 1 (OAM_TS_EXT)*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		if (prog_used != -1)
		{
			sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &prge_program_tbl_data.program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
			/*prge_program_tbl_data.program_var          = {0x0,0xe8,0x0,0x08}; (sic)*/
            COMPILER_64_SET( prge_program_tbl_data.program_var,0,0xe0000c);
            prge_program_tbl_data.register_src         = soc_petrab_cfg ? 0 : 1; /* Petra-B in system ? TM : PP */
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = soc_petrab_cfg ? 0 : 1; /* Petra-B in system ? Keep : Remove */
			prge_program_tbl_data.bytes_to_remove       = 0 ;
			res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
		}




  /* Program 10 - TDM_STAMP_CUD */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = tdm_arad_opt ? 4 : (tdm_arad_std  ? 9 : 0);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 310, exit);
  }

  /* Program 10.5 - TDM_STAMP_CUD_OVER_OUTER_FTMH */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 2; /* Use this program for stamping CUD over the 2 MSBytes of the FTMH */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 310, exit);
  }

  /* Program 11 - ETH_WITH_LLID_TAG */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 320, exit);
  }

  /* Program 12 - IPV6_TUNNEL_PROGRAM */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      /*prge_program_tbl_data.program_var          = {16'h0, ETH_TYPE_IPV6 (Eth-Type = 0x86dd), 4'h6 (version), 28'h0};*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0x86dd, 0x60000000);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 330, exit);
  }

  /* Program 13 - oam_sub_type = 4  */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0xe0);
      prge_program_tbl_data.register_src         = soc_petrab_cfg ? 0 : 1; /* Petra-B in system ? TM : PP */
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = soc_petrab_cfg ? 0 : 1; /* Petra-B in system ? Keep : Remove */
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 340, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  /* Program 14 - pp_profile = ETH_OAM_LOOPBACK */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if(prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      /*prge_program_tbl_data.program_var          = {56'h0, 8'h2};*/
      /*prge_program_tbl_data.program_var          = 0x2;*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x2);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 24 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 350, exit);
  }

  /* ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if(prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (SOC_IS_JERICHO(unit) && ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2)) {
        COMPILER_64_SET(prge_program_tbl_data.program_var, SOC_PPD_EG_ENCAP_BFD_IPV4_PROG_VAR ,0x8100);
      } else {
        COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0); /* Not used */
      }

      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 350, exit);
  }



  /* Program - STACKING */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);
  }

  /*Program 7 - STACKING PROGRAM*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  /* Program - erspan */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      /* prog var includes version 1, Vlan = 0 */
      COMPILER_64_SET(prge_program_tbl_data.program_var,0,0x100088be);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  }


  /* Program - erspan */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      /* prog var includes version 1, Vlan = 0 */
      COMPILER_64_SET(prge_program_tbl_data.program_var,0,0x1000);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  }

  /* Program - rspan */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src         = 0;/* TM */
      prge_program_tbl_data.bytes_to_remove       = 12 + user_header_size;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      /* prog var includes version 1, Vlan = 0
      COMPILER_64_SET(prge_program_tbl_data.program_var,0,0x1000);*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }
  /* Program - VXLAN
     for version under arad+. Arad+ support VxLAN by design. */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0x55550800, 0x00001100);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);
  }

  /* Program - 2_HOP_SCHEDULING */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 0;
      prge_program_tbl_data.bytes_to_remove       = 4 + user_header_size; /* Remove second ITMH (The program builds new one) */
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);
  }

  /* Program - Remote CPU */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      /*prge_program_tbl_data.program_var          = ARAD_PRGE_DATA_MEMORY_ENTRY_L2_REMOTE_CPU; */ /*0x3c*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, ARAD_PRGE_DATA_MEMORY_ENTRY_L2_REMOTE_CPU);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 0;/*Dont remove system header*/
      prge_program_tbl_data.remove_network_header = 0;/*Dont remove network header*/
      prge_program_tbl_data.bytes_to_remove       = 0;/*Dont remove any number of bytes*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 440, exit);
  }

  /* Program ERSPAN_XGS_PE_FROM_FTMH  */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1)
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0x5550100, 18); /*here - the size of link layer - 14 or 18 and PPD 6LSB*/
    prge_program_tbl_data.register_src         = 1; /*to use the nwk headers, not system*/
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* Program 10 RSPAN_XGS */
  /* Program ERSPAN_XGS_PE_FROM_FTMH no WA */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1)
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x101000); /* first 2LSBytes used in ERSPAN, all 8bytes in ppd */
    prge_program_tbl_data.register_src         = 1; /*to use the nwk headers, not system*/
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1)
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x10100);
    prge_program_tbl_data.register_src         = 0;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 12 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* Program -  XGS_MAC_EXT_AND_SPAN */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x10100);
        prge_program_tbl_data.register_src         = 1;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
  }

  /* Program 4 -Ethernet copy*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    COMPILER_64_ZERO(prge_program_tbl_data.program_var);
    prge_program_tbl_data.register_src         = 1;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


    /*Program 11  */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &prge_program_tbl_data.program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        COMPILER_64_ZERO(prge_program_tbl_data.program_var);
        prge_program_tbl_data.register_src         = 0;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 6 ;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
    }

  /* Program - Add Packet Size Header */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1;/* remove system header */
      prge_program_tbl_data.remove_network_header = 1;/* remove network header - will be compied using default PP program */
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;/*Dont remove any number of bytes*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 660, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;  /* prepare regs src to generated headers */
      prge_program_tbl_data.remove_system_header  = 1; /* remove the system headers from the packet header */
      prge_program_tbl_data.remove_network_header = 1; /* remove the network headers from the packet header */
      prge_program_tbl_data.bytes_to_remove       = 0; /* The user defined headers in the network header removed as part of network_headers removal */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;  /* prepare regs src to generated headers */
      prge_program_tbl_data.remove_system_header  = 1; /* remove the system headers from the packet header */
      prge_program_tbl_data.remove_network_header = 1; /* remove the network headers from the packet header */
      prge_program_tbl_data.bytes_to_remove       = 0; /* The user defined headers in the network header removed as part of network_headers removal */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  prge_program_tbl_data.register_src         = 1;
	  prge_program_tbl_data.remove_system_header  = 1;
	  prge_program_tbl_data.remove_network_header = 1;
	  prge_program_tbl_data.bytes_to_remove       = 0;
	  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
	  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  prge_program_tbl_data.register_src         = 1;
	  prge_program_tbl_data.remove_system_header  = 1;
	  prge_program_tbl_data.remove_network_header = 1;
	  prge_program_tbl_data.bytes_to_remove       = 0;
	  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  for (reflector_with_ip = 0; reflector_with_ip <= 1; ++reflector_with_ip) {
	  ARAD_EGR_PROG_EDITOR_PROGRAMS used_program = reflector_with_ip ? ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH :
																	   ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH;

      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, used_program, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	  if (prog_used != -1) {
		  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
              unit, used_program, &prge_program_tbl_data.program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
		  prge_program_tbl_data.register_src         = 1;
		  COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x80);
		  prge_program_tbl_data.remove_system_header  = 1;
		  prge_program_tbl_data.remove_network_header = 1;
		  prge_program_tbl_data.bytes_to_remove       = (6 * reflector_with_ip) ; /* 0 for Eth only, 6 for IP+Eth -
                                                                                        This assumes that network headers size is 36
                                                                                        36 == Cfg-Headr-Editing-Code[BRIDGE] + 12B for TOS/ECN remark */
		  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
	  }
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src         = 0; /* TM */
      prge_program_tbl_data.remove_system_header  = 1; /* Remove System headers*/
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 12 + user_header_size; /* Strip DA+SA and user header */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x8000);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 2 + user_header_size; /* strip 2 MSBytes from iNPHeader*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x4000);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0; /* UDH is removed with network header */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 26; /* strip 26Bytes (OAM)*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x01200d00);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 26; /* strip 26Bytes (OAM)*/
      if (SOC_IS_JERICHO(unit)) {
      prge_program_tbl_data.bytes_to_remove ++;
    }
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

    if (SOC_DPP_CONFIG(unit)->pp.udp_tunnel_enable && SOC_IS_JERICHO_B0_AND_ABOVE(unit)) {
        int prog_index[] = {ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP ,ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP ,ARAD_EGR_PROG_EDITOR_PROG_IPV6_OVER_UDP};
        int dest_port[] = {ARAD_EGR_PRGE_UDP_TUNNEL_MPLS_DEFAULT_PORT ,ARAD_EGR_PRGE_UDP_TUNNEL_IPV4_DEFAULT_PORT ,ARAD_EGR_PRGE_UDP_TUNNEL_IPV6_DEFAULT_PORT};
        for (i = 0 ; i < 3 ; i++) {
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, prog_index[i], &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
                res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prge_program_tbl_data.program_pointer);
                SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
                COMPILER_64_SET(prge_program_tbl_data.program_var, 0, dest_port[i]);
                prge_program_tbl_data.register_src          = 1;
                prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
                prge_program_tbl_data.remove_network_header = 1;
                prge_program_tbl_data.bytes_to_remove       = 0;
                res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
            }
        }
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1)
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    /* COMPILER_64_SET(prge_program_tbl_data.program_var, 0x21212121,0x00310000 | 0x8100); SA MAC # TPID */
    prge_program_tbl_data.register_src         = 0;
    prge_program_tbl_data.remove_system_header  = 0;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 230, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var); /* Should contain system-ID for B-SA. Will be set by API */
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1; /* removing Network headers*/
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_ZERO(prge_program_tbl_data.program_var); /* Should contain system-ID for B-SA. Will be set by API */
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1; /* removing Network headers*/
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0xFFFFFF);
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1; /* removing Network headers*/
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 11, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;  /* prepare regs src to generated headers */                                                      
      prge_program_tbl_data.remove_system_header  = 1; /* remove the system headers from the packet header */                                          
      prge_program_tbl_data.remove_network_header = 1; /* remove the network headers from the packet header */                                         
      prge_program_tbl_data.bytes_to_remove       = 0; /* The user defined headers in the network header removed as part of network_headers removal */ 
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 221, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1; /* removing Network headers*/
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 222, exit);
  }


  /* customer application that connect to NP */
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_1PLUS1, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_1PLUS1, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
  CONN_TO_NP_PROG_ATTRIBUTE_SET(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1; /* removing  System headers*/
      prge_program_tbl_data.remove_network_header = 1; /* removing Network headers*/
      prge_program_tbl_data.bytes_to_remove       = 0;

      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 222, exit);
  }



  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    prge_program_tbl_data.register_src         = 0;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = user_header_size + SOC_DPP_ARAD_INJECTED_HEADER_SIZE_BYTES_VENDOR_PP_2;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 230, exit);
  }

  /* MPLS preserve DSCP for forwarding header */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 240, exit);
  if (prog_used != -1) {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 250, exit);
    
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
    prge_program_tbl_data.register_src         = 1; /* PP */
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       =  0;

    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 260, exit);
  }

  /* MPLS preserve DSCP for forwarding header */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 240, exit);
  if (prog_used != -1) {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 250, exit);
    
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
    prge_program_tbl_data.register_src         = 1; /* PP */
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       =  0;

    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 260, exit);
  }

  /* MPLS preserve DSCP for forwarding header */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 270, exit);
  if (prog_used != -1) {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, &prge_program_tbl_data.program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 280, exit);
    
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
    prge_program_tbl_data.register_src         = 1; /* PP */
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       = 0;

    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_LI, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_LI, &prge_program_tbl_data.program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }



  /*  Instruction tables - 12 tables (494 instructions, table 0 - 32 entries, tables 1..11 - 42 entries) */

  /*  Program 0 instructions initialization - (Always entries 0, 1 in each table) */
  SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_null_prog_init(unit, 0, 1) );

  /*  Program 1 instructions (entries 2, 3 in each table) - OTMH */
  mem   = EPNI_PRGE_INSTRUCTION_0m - 1;

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /* OTMH program with 24bit CUD extention */
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;

            /*  Instruction 0 : load rsz=31 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 79;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

            /*  Instruction 1 : extract the outlif value bit[0],r3=1 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 57; /* resolved data outlif */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 1;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);

            /*  Instruction 2 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

            /*  Instruction 3 : rsz = (fem==r3) ? 25 : rsz */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 76;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x2;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);

            /*  Instruction 4 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 5 : copy EEI data to CUD */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 1;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);

            /*  Instruction 6 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);

            /*  Instruction 7 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Base OTMH */
            /*  Instruction 8 : extract TC from FTMH */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; /* orig header */
            prge_instruction_tbl_data.offset_base = 5; /* 20 bits - take TC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 9 : Extract DP, Action Type, MC from FTMH */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; /* orig header */
            prge_instruction_tbl_data.offset_base = 13; /* 52 bits - take DP, Action Type, MC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 10 : r2=fem(tc) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 11 : r3=fem(dp,action_type,mc) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 12 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select   = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 13 : r1=r2+r3 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* take out-pp-port (destination) */
            /*  Instruction 14 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2; /* resolved data */
            prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - out-PP-port */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 15 : copy r1 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2; /* resolved data */
            prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1*/
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  For this program set all other instructions to NULL */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1){ /* basic OTMH */

      /* Allocate the necessary branches */
      uint32 branch_ptr_cud_sp, branch_ptr_cud_mc;
      res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_AND_SOURCE_PORT, &branch_ptr_cud_sp);
      SOC_SAND_IF_ERR_EXIT(res);
      res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_BASE_OTMH_CUD_MC, &branch_ptr_cud_mc);
      SOC_SAND_IF_ERR_EXIT(res);



          /* Arad OTMH */
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
          /* Store all addresses and jump to CUD Extension or NOP and prepare next jumps */
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;

            /*  Instruction 0 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  /* resolved data */
            prge_instruction_tbl_data.offset_base = 53; /* 128+20+32+32 bits - port var [9:0] in resolved data */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

            /*  Instruction 1 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  /* resolved data */
            prge_instruction_tbl_data.offset_base = 50; /* 128+20+32+20 bits - port var [21:12] in resolved data */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 2;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);

            /*  Instruction 2 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 13;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; /* If this instr. is odd, need to add 1 to the jump address */
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_3,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

            /*  Instruction 3 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);

            /*  Instruction 4 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x2;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 5 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);

          /* CUD Extension with no check for MC/UC traffic */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_ptr_cud_sp);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_ptr_cud_sp);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            }
            else if (programs_usage[unit].two_hop_scheduling) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 17; /* FTMH Out-LIF */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            else {
                prge_instruction_tbl_data.offset_base = 57; /* 128+20+32+32+16 bits from resolved data - CUD */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; /* If this instr. is odd, need to add 1 to the jump address */
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);

            /*  Instruction 7 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1 */
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1-4; /* data action 1 [20:16] */
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            else if (programs_usage[unit].two_hop_scheduling) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 13; /* FTMH Out-LIF */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            else if (SOC_IS_JERICHO(unit)) {
                /* Take OutLIF-MSB field  */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_96;
                prge_instruction_tbl_data.offset_base = 19 - (5*SOC_IS_JERICHO_PLUS(unit));
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 8 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            prge_instruction_tbl_data.op_value    = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                            entry==entry_odd);
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 9 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* CUD Extension only if MC traffic */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_ptr_cud_mc);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_ptr_cud_mc);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            }
            else {
                prge_instruction_tbl_data.offset_base = 57; /* 128+20+32+32+16 bits from resolved data - CUD */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0;
            if (is_petrab_in_system && SOC_IS_JERICHO(unit)) {
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
            }
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; /* If this instr. is odd, need to add 1 to the jump address */
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);

            /*  Instruction 7 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1-4; /* data action 1 [20:16] */
            }
            else {
                prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1 */
            }
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0x1f; /* -1 */
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            else {
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            }

            if (is_petrab_in_system && SOC_IS_JERICHO(unit)) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 16;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 2;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            }

            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 8 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            prge_instruction_tbl_data.op_value    = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                            entry==entry_odd);
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 9 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* NOP */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = (entry==entry_odd) ? 1 : 0; /* If this instr. is odd, need to add 1 to the jump address */
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 7 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 8 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            prge_instruction_tbl_data.op_value    = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                            entry==entry_odd);
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 9 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Source Port Extension */
            /*  Instruction 10 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_ptr_cud_sp);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_ptr_cud_sp);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 43; /* 128+556 bits - Source Port from resolved */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            /* Instruction 10/2 = 5%2 = 1 --> odd lfem */
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 11 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* NOP */
            /*  Instruction 10 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_OTMH, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_even;

            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 11 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Base OTMH */
            /*  Instruction 12 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;  /* orig header */
            prge_instruction_tbl_data.offset_base = 5;  /* 20 bits - take TC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 13 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;  /* orig header */
            prge_instruction_tbl_data.offset_base = 13; /* 52 bits - take DP, Action Type, MC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 14 :  extract value for sop; r2=fem */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 45;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 15 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 16 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  =  0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 17 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;  /* ADD */
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 18 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  /* resolved data */
            prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - out-PP-port */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            if ((SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_EGR_17B_CUDS_127_PORTS_MODE) != 0) {/*use_17b_mcid*/
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }

            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 19 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;   /* resolved data */
            prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1 */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 20 :add the sop (rsz is holding the size) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;   /* resolved data */
            prge_instruction_tbl_data.offset_base = 3; /* from Program Var takes 1Byte 0x00 */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  For this program set all other instructions to NOP */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

  if (soc_petrab_cfg)
  {
      /*  Program 2 instructions (entries 4, 5 in each table) - TDM PMM Petrab */
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {

          mem   = EPNI_PRGE_INSTRUCTION_0m-1;

          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
          entry = entry_odd;

          /* Instruction 0 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 8;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Instruction 1 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 13;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Instruction 2 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Instruction 3 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          for (i = mem; i<12+EPNI_PRGE_INSTRUCTION_0m; i++)
          {
            for (j = entry_even; j<=entry_odd; j++)
            {
                if (entry == entry_odd && i == mem)
                {
                    j = entry_odd;
                }

                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = 0;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, i, j, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            }
          }

          /* Instruction 23 */
          mem   = EPNI_PRGE_INSTRUCTION_0m + 11;
          entry = entry_odd;

          prge_instruction_tbl_data.src_select  = 2;
          prge_instruction_tbl_data.offset_base = 59;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 4;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /*  For this program set all other instructions to NULL */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
      }
  }

  /* Define Program instructions for ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

      /* Beside for port extender mode 1 (Port-extender), this program is all NOPs */
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) { /* Need to support Port Extender Mode 1 */

          INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)   , ALU_SET(0, REG_OP(SZ))                              , "Extract TM-Port-Variable 1b lsb; RSZ = 0");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_NOP                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                   , "If TM-Port-Variable==1 RSZ=R1(=2)");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0))  , ALU_NOP                                             , "Copy Out-PP-Port");

      } /* NULL program with port extender mode 1*/

      /* Beside for port extender mode 2 (COE), this program is all NOPs */

      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) { /* Need to support Port Extender Mode 2 */

          INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(1))                               , "Extract TM-Port-Variable ; R1 = 2");
          INSTR( CE_NOP                                             , ALU_SET(0, REG_OP(SZ))                              , "RSZ = 0");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(SZ)) , "If TM-Port-Variable==1 RSZ=R1(=2)");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "NOP");
          INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ,0))  , ALU_NOP                                             , "Copy PP-Port-Variable");
          INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(SZ,0))    , ALU_NOP                                             , "Copy Program-Variable");
          INSTR( CE_COPY(PKT, R_OFST(3,24+(2*user_header_size)), C_SIZE(8)) , ALU_NOP                                     , "Copy SA & DA");
          INSTR( CE_COPY(PKT, R_OFST(3,8+(2*user_header_size)), C_SIZE(4))  , ALU_NOP                                     , "Copy SA & DA");
      }

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
  }

  if (SOC_IS_JERICHO_PLUS(unit)) {

      /* Define Program instructions for ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH */
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
          unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH, &prog_used);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      if (prog_used != -1) {
          int total_bytes_removed = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE+ARAD_EGR_PROG_EDITOR_BYTES_TO_REMOVE_MAX_SIZE;

          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

          INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_BIT_3)              , ALU_SET(0, REG_OP(2))                               , "0: FEM=DSP_EXT_PRESENT, R2=0");
          INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2)              , ALU_SET(0, REG_OP(3))                               , "1: FEM=OAM_TS_PRESENT, R3=0");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(2), CNST(2), REG_OP(2)) , "2: if DSP_EXT_PRESENT, R2=2");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(3), CNST(6), REG_OP(3)) , "3: if OAM_TS_PRESENT, R3=6");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(1), REG_OP(2), REG_OP(1))            , "4: R1 += R2 (R1=(FTMH+LB_EXT+STACKING_EXT)+DSP_EXT)");
          INSTR( CE_NOP                                             , ALU_SET(0, REG_OP(SZ))                              , "5: Rsz = 0");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(1), REG_OP(3), REG_OP(1))            , "6: R1 += R3 (R1 now points to PPH)");
          INSTR( CE_NOP                                             , ALU_SET(0, REG_OP(0))                               , "7: R0 = 0");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_3)            , ALU_SET(0, REG_OP(2))                               , "8: FEM = EEI_EXT_PRESENT, R2=0");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_2)            , ALU_SET(0, REG_OP(3))                               , "9: FEM = LEARN_EXT_PRESENT, R3=0");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_1)            , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(3), REG_OP(0)), "10: FEM = FHEI.5B, if EEI_EXT_PRESENT, R0=3");
          INSTR( CE_LREAD(PKT, R_OFST(1, 1), LFEM_BIT_0)            , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(5), REG_OP(2)), "11: FEM = FHEI.3B, if LEARN_EXT_PRESENT, R2=5");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(5), REG_OP(3)), "12: if FHEI.5B, R3=5");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(3), REG_OP(SZ)), "13: if FHEI.3B, Rsz=3");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(0), REG_OP(2), REG_OP(0))            , "14: R0 += R2");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(3), REG_OP(SZ), REG_OP(3))           , "15: R3 += Rsz");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(0), REG_OP(1), REG_OP(0))            , "16: R0 += R1");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "17: NOP");
          INSTR( CE_NOP                                             , ALU_ADD(REG_OP(0), REG_OP(3), REG_OP(0))            , "18: R0 += R3 (R0=total_ftmh_size+total_pph_ext_size)");
          INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_1)              , ALU_SUB(CNST(total_bytes_removed), REG_OP(1), REG_OP(1)),
                                                                                                                            "19: R1 = 40 - R1 (R1=total_bytes_removed - total_ftmh_size)");
          INSTR( CE_NOP, ALU_SUB(CNST(total_bytes_removed-ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE-user_header_size), REG_OP(0), REG_OP(SZ)),
                                                                                                                            "20: Rsz = total_bytes_removed - (pph_size+udh_size+total_ftmh_size+total_pph_ext_size)");
          INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), REG_OP(1), REG_OP(SZ)) , "21: if !PPH_EXT_PRESENT, Rsz=R1");
          INSTR( CE_NOP                                             , ALU_NOP                                             , "22: NOP");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))    , "23: Copy from original packet");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2-16), R_SIZE(SZ, -8)), ALU_NOP                                  , "24: Copy from original packet");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2-32), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "25: Copy from original packet");
          INSTR( CE_COPY(PKT, C_OFST(total_bytes_removed*2-48), R_SIZE(SZ, -8)), ALU_NOP                                  , "26: Copy from original packet");

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
      }
  }


  /* Define Program instructions for FCOE NPV N_PORT */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_N_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

/* 0*/ INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ))                 , "0; ALU: RSZ=R3-12, calc Generated Header size - (Native Eth DA:SA size)");
/* 1*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "1: NOP");
/* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,0))               , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
/* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/*10*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/*11*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/*12*/ INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)     , ALU_NOP                                                   , "12: Read System header size (offset 161NB = 33+64B) using LFEM_8_LSBS; NOP ALU");
/*13*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "13: NOP");
/*14*/ INSTR( CE_NOP                                                 , ALU_ADD(FEM, CNST(12), REG_OP(2))                         , "14: NOP CE; ALU: R2=FEM(System Header Size) + 12 (Eth DA;SA size)");
/*15*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "15: NOP");
/*16*/ INSTR( CE_COPY(PKT, R_OFST(2,0), C_SIZE(6))                   , ALU_NOP                                                   , "16: Copy SA from Original Packet, ALU: NOP");
/*17*/ INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                    , ALU_NOP                                                   , "17: Copy DA from generated Header, OFFSET_CONST_0 Point to head of packet, ALU: NOP");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
  }

  /* Define Program instructions for FCOE NPV NP_PORT */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_FCOE_NP_PORT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

/* 0*/ INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3),  CNST(6), REG_OP(SZ))                  , "0; ALU: RSZ=R3-6, calc Generated Header size - (Native Eth DA size)");
/* 1*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "1: NOP");
/* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,0))               , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
/* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/*10*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
/*11*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
/*12*/ INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)     , ALU_NOP                                                   , "12: Read System header size (offset 161NB = 33+64B) using LFEM_8_LSBS; NOP ALU");
/*13*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "13: NOP");
/*14*/ INSTR( CE_NOP                                                 , ALU_ADD(FEM, CNST(6), REG_OP(2))                          , "14: NOP CE; ALU: R2=FEM(System Header Size) + 6 (Eth DA size)");
/*15*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "15: NOP");
/*16*/ INSTR( CE_COPY(PKT, R_OFST(2,0), C_SIZE(6))                   , ALU_NOP                                                   , "16: Copy DA from Original Packet, ALU: NOP");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);
  }

  /* Define Program instructions for Copy Generated Headers + build new mpls label from the learn extenssion (4_LABEL_PUSH)*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                  , "R0 = R3 - R2 ");
     INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(3), REG_OP(1), REG_OP(SZ))                 , "SZ = R3 - R1 ");
     INSTR( CE_NOP                                                 , ALU_SET_IF(REG_OP(0), EQ, CNST(4), CNST(4), REG_OP(SZ))  , "If R0=4 (mpls is the fowarding) then SZ=4");

     INSTR( CE_NOP                                                 , ALU_SET_IF(REG_OP(0), EQ, CNST(4), REG_OP(2), REG_OP(1)) , "If R0=4 then R1<-R2 (R1 will point to the end of the BOS label)");
     INSTR( CE_NOP                                                 , ALU_SET_IF(REG_OP(0), EQ, CNST(4), REG_OP(3), REG_OP(2)) , "If R0=4 then R2<-R3 (R2 will point to the start of the BOS label)");
     INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                    , "copy from generated header, fowarding header + mpls bos label ; Copy generated header RSZ = RSZ - 16");
     INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                  , "copy from generated header, fowarding header + mpls bos label ; Copy generated header R3 = R3 - 16");
     INSTR( CE_FREAD(PrgeDataFieldSysHdrSize, 0)                   , ALU_NOP                                                    , "Extract System header Size");
     INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                    , "copy from generated header, fowarding header + mpls bos label ; Copy generated header R3 = R3 - 16");
     INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(FEM, CNST(0), REG_OP(2))                          , "Copy generated header SZ = SZ - 16 & SZ = Network Header Size");
     INSTR( CE_LREAD(GEN, R_OFST(1,8), LFEM_LSB_MPLS)              , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))                                                   , "Build 12 lsb of the new mpls header");
     INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-16))              , ALU_NOP                                                    , "NOP");
     INSTR( CE_LREAD(PKT, R_OFST(2,0), LFEM_MSB_MPLS)             , ALU_SUB(FEM, CNST(0), REG_OP(0))                           , "Extract 4 bit LSB of the label Save Fem in R0");
     INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                                         , ALU_NOP                                                    , "NOP");
     INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))             , ALU_ADD(FEM, REG_OP(0), REG_OP(0))                         , "R0=R0+FEM");
     INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)       , ALU_NOP                                                    , "For port Ex. Extract Resolved.Data.tm-port-var");
     INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                , ALU_NOP                                                    , "write R0 to header");
     INSTR( CE_COPY(PKT, R_OFST(2, -1), C_SIZE(2)) , ALU_SUB(FEM, CNST(0), REG_OP(2))                          , "write to header 16 msb of the mpls label - For port ex. Copy fem to SZ"); 
     for(i=0; i<2; i++)
     { /* copy from generated header, fowarding header + mpls bos label */
         INSTR( CE_COPY(GEN, R_OFST(1,0), R_SIZE(1,0))                 , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))                    , "Copy generated header R1 = R1 - 16");
         INSTR( CE_COPY(GEN, R_OFST(1,-16), R_SIZE(1,-8))              , ALU_NOP                                                    , "Copy generated header");
     }
     INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, R_SIZE(2,0))      , ALU_NOP                                                    , "Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

     res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IP_TUNNEL_PRESERVE_DSCP);
     SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
     SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
         /* locate TOS relative to R2 it depends on how many tags the fwd(assumed ethenet has) */
        INSTR( CE_READ(GEN, R_OFST(2,44)) , ALU_SET(0x0800, REG_OP(1))                           , "extract ethertype for double tagged packet R2+22bytes,");
        INSTR( CE_READ(GEN, R_OFST(2,36)) , ALU_ADD(REG_OP(0), CNST(6), REG_OP(0))               , "extract ethertype for single tagged packet R2+18bytes, R0+=6 will point 6 bytes in outer IP header");
        INSTR( CE_READ(GEN, R_OFST(2,28)) , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(24), REG_OP(SZ)) , "extract ethertype for non    tagged packet R2+14bytes,");
        INSTR( CE_NOP                     , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(20), REG_OP(SZ)) , "");
        INSTR( CE_NOP                     , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(16), REG_OP(SZ)) , "last 3 instructions hopefully calculated the offset rom R2 to inner IP TOS");

        /* from this poin on all we have to do to locate the TOS of native ethernet is calculate RSZ + R2  */



        /* after the follwoing part R2 will hold native TOS,R1 will hold (0-R2) */
        /*==== marks commands preparing for the copying later */
        /*$$$$ marks commands calculating R2 and R1 TOS and inverse TOS */
        /*====*/ INSTR( CE_LREAD(GEN, R_OFST(0,-8), LFEM_8_MSBS), ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ)) , "extract version/IHL fields from outer IP, RSZ = R3-R0 for copying");
        /*$$$$*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  C_SIZE(8))   , ALU_ADD(REG_OP(SZ), REG_OP(2), REG_OP(2)) , "extract outer ip TOS higher 2 bytes 8 msbs,R2=R2+RSZ,poiting to the TOS of the native IP");
        /*====*/ INSTR( CE_COPY(GEN, R_OFST(3,-16),  C_SIZE(8)) , ALU_ADD(FEM,CNST(0), REG_OP(1))           , "RSZ = RSZ-6 for copying");
        /*$$$$*/ INSTR( CE_LREAD(GEN, R_OFST(2,0), LFEM_8_LSBS) , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))   , "");
        /*====*/ INSTR( CE_NOP                                  , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "R1 = higher byte of new OUTER IP");
        /*$$$$*/ INSTR( CE_NOP                                  , ALU_ADD(FEM,CNST(0), REG_OP(2))           , "R2 = native TOS");


        /* the following part also contains copying the bytes between R3 and R0+6 */
        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,0))               , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
        /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16))             , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                  , "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");


        /* R1 holds higher byte of new IP header, R2 holds the copied TOS, R2 = R2 + R1(2 first bytes of new IP header), R1 = -TOS */
        /* please notice that the concatenation part of the following 2 instructions is part of the copying that is taking place also in the previous instructions */
        /*$$$$*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8)) , ALU_SUB(CNST(0xffff), REG_OP(2), REG_OP(1))    , "R1 = Inverse(native TOS)");
        /*$$$$*/INSTR( CE_COPY(GEN, R_OFST(3,0),  R_SIZE(SZ,-16)) , ALU_ADD(REG_OP(2), REG_OP(1), REG_OP(2))       , "R2 = 2 first bytes of new outer IP");


        /* inverse TOS to identification field, this will make sure the checksum doesn't change */
        INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)), ALU_NOP, "copy inverse TOS to identification field of outer IP");


        /* copy next  two bytes right from the generated header, ALU restore R0 to the beginning of IP header */
        /*  */ INSTR( CE_COPY(GEN, R_OFST(0,-4), C_SIZE(2))        , ALU_SUB(REG_OP(0), CNST(6), REG_OP(0))  , "take the Total Length field from the Gen header, R0 is 6 bytes into the IP header");


        /* take the TOS from native IP, notice the higher byte is from generated header(not copied), only the lowest byte is the copied TOS */
        /*  */ INSTR(  CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))    , ALU_NOP    , "copy the TOS from native IP"   );


        /* copy the mac header, assuming its up to 24 bytes */
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))     , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0)) , "");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))  , ALU_NOP                                 , "");

        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))     , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0)) , "");
    }else {
        /*
        New implementation for Jericho and above:
            1. Identify the offset of tos in native IP header;
            2. Copy IP tunnels (8 copy insts, up to 64 bytes);
            3. Re-calculate checksum;
            4. Copy tos from native IP header;
            5. Copy link layer header;
        */
        INSTR( CE_READ(GEN, R_OFST(2,44))                   , ALU_SET(0x0800, REG_OP(SZ))                                 , "0: FEM=Ethertype of double tagged packet, Rsz=IP Ethertype");
        INSTR( CE_READ(GEN, R_OFST(2,36))                   , ALU_SET(16, REG_OP(1))                                      , "1: FEM=Ethertype of single tagged packet");
        INSTR( CE_LREAD(GEN, R_OFST(0,4), LFEM_8_LSBS)      , ALU_SET_IF(FEM, EQ, REG_OP(SZ), CNST(24), REG_OP(1))        , "2: FEM=ENCAP.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))         , ALU_SET_IF(FEM, EQ, REG_OP(SZ), CNST(20), REG_OP(1))        , "3: Copy 0, R1=offset of PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(8))       , ALU_SUB(FEM, CNST(0), REG_OP(SZ))                           , "4: Copy 1, Rsz=ENCAP.tos");
        INSTR( CE_READ(GEN, R_OFST(0,24))                   , ALU_ADD(REG_OP(2), REG_OP(1), REG_OP(1))                    , "5: FEM=ENCAP.check_sum, R1=R2+R1(points to PAYLOAD.tos)");
        INSTR( CE_COPY(GEN, R_OFST(3,-32), C_SIZE(8))       , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(SZ))                   , "6: Coyp 2, Rsz=R3-R0(IP tunnel size)");
        INSTR( CE_COPY(GEN, R_OFST(3,-48), C_SIZE(8))       , ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))                         , "7: Copy 3, R2=ENCAP.check_sum+ENCAP.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-64), C_SIZE(8))       , ALU_SUB(REG_OP(SZ), CNST(52), REG_OP(SZ))                   , "8: Copy 4, Rsz-=52(5*8+12)");
        INSTR( CE_LREAD(GEN, R_OFST(1,0), LFEM_8_LSBS)      , ALU_NOP                                                     , "9: FEM=PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ, 0))   , ALU_NOP                                                     , "10:Copy 5");
        INSTR( CE_LREAD(GEN, R_OFST(0,24), LFEM_IS_LAG)     , ALU_SUB(REG_OP(2), FEM, REG_OP(1))                          , "11:FEM=MSB(ENCAP.check_sum), MSB(1); R1=R2-PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(3,-96), R_SIZE(SZ, -8))  , ALU_SUB(REG_OP(1), CNST(0), REG_OP(SZ))                     , "12:Copy 6, Rsz=R1(Rsz points to PAYLOAD.tos)");
        INSTR( CE_COPY(GEN, R_OFST(3,-112), R_SIZE(SZ, -16)), ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "13:R1+=MSB(1)");
        INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)   , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "14:FEM=MSB(R1), MSB(3); R2=R1");
        INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)   , ALU_NOP                                                     , "15:FEM=MSB(R2), MSB(2);");
        INSTR( CE_NOP                                       , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "16:R1-=MSB(3)");
        INSTR( CE_NOP                                       , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "17:(MSB(2)==1)? R1=R2");
        INSTR( CE_NOP                                       , ALU_NOP                                                     , "18:NOP");
        INSTR( CE_NOP                                       , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "19:(R1 == 0xFFFF)? R1=0 (ALU)");
        INSTR( CE_NOP                                       , ALU_NOP                                                     , "20:NOP");
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))      , ALU_NOP                                                     , "21:Copy R1(new check_sum)");
        INSTR( CE_COPY(GEN, R_OFST(0, 20), C_SIZE(8))       , ALU_NOP                                                     , "22:Copy ENCAP IP header, byte2-byte9");
        INSTR( CE_COPY(GEN, R_OFST(SZ, 0), C_SIZE(2))       , ALU_NOP                                                     , "23:Copy PAYLOAD.tos");
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))       , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                     , "24:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))    , ALU_NOP                                                     , "25:Copy GEN");
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))       , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                     , "26:Cooy GEN");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))    , ALU_NOP                                                     , "27:Copy GEN");
    }

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

    res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV4);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

#if (ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE != 24)
#error "ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE is not 24"
#endif

    /* 
    first 6 instructions are here to calculate the location of IPV4 checksum field, R0 will hold the result
    the logic behind it is the following:
    assume its double tagged packet, checksum is at offset        12(DA,SA) +8(double tags) + 2(ether-type) +12(checksum within IP) = 34 bytes offset.
    if the packet proves to be single tagged then the offset is : 12(DA,SA) +4(only 1 tag ) + 2(ether-type) +12(checksum within IP) = 30 bytes offset.
    if the packet proves to be single tagged then the offset is : 12(DA,SA) +0(no     tags) + 2(ether-type) +12(checksum within IP) = 26 bytes offset.
    */

    INSTR( CE_READ(GEN, C_OFST(36))                         , ALU_SET(0x0800, REG_OP(1))                          , "extract ether-type for single tagged packet offset 36 nibbles");
    INSTR( CE_READ(GEN, C_OFST(28))                         , ALU_SET(34    , REG_OP(0))                          , "extract ether-type for non    tagged packet offset 28 nibbles");
    INSTR( CE_NOP                                           , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(30), REG_OP(0)) , "if single tagged packet checksum is at offset 30 bytes");
    INSTR( CE_FLREAD( PrgeDataFieldEesData1,-1,LFEM_8_LSBS) , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(26), REG_OP(0)) , "if non    tagged packet checksum is at offset 26 bytes");
    INSTR( CE_NOP                                           , ALU_NOP                                             , "");

    /* at this point R0 should point to the IPV4 header checksum */
    /* R0,R1,R2  are used for the sake of calculating the new checksum */
    /* R0,R3,RSZ are used for the sake of copying everything between R3 and R0 */

    /* CHECKSUM */ INSTR( CE_READ(GEN, R_OFST(0,0))                       , ALU_SUB(FEM ,CNST(0),REG_OP(1))                        , "extract checksum ,R1 = TOS1(extracted two instructions up) ");
    /* COPYING  */ INSTR( CE_NOP                                          , ALU_SUB(REG_OP(3),REG_OP(0),REG_OP(SZ) )               , "                                                           ");
    /* CHECKSUM */ INSTR( CE_LREAD(GEN, R_OFST(0,-20), LFEM_8_LSBS)       , ALU_SUB(FEM,REG_OP(1), REG_OP(2))                      , "extract TOS2     ,R2 = checksum - TOS1(R1)                 ");
    /* COPYING  */ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_NOP                                                , "                                                           ");
    /* CHECKSUM */ INSTR( CE_LREAD(GEN, R_OFST(0,0), LFEM_IS_LAG)         , ALU_ADD(REG_OP(2) ,FEM,REG_OP(1))                      , "extract MSB(1)   ,R1 = R2 + TO2                            ");
    /* COPYING  */ INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,-8))    , ALU_NOP                                                , "                                                           ");
    /* CHECKSUM */ INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)      , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                      , "extract MSB(3)   ,R1 = R1 + MSB(1)                         ");
    /* CHECKSUM */ INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)      , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                 , "extract MSB(2)   ,R2 = R1                                  ");
    /* CHECKSUM */ INSTR( CE_NOP                                          , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                       , "                 ,R1 = R1 - MSB(3)                         ");
    /* CHECKSUM */ INSTR( CE_FLREAD( PrgeDataFieldEesData2,0,LFEM_4_LSBS) , ALU_SET_IF(FEM, EQ, CNST(0x0), REG_OP(2), REG_OP(1))   , "                 ,(MSB(2)==1)? R1 = R2                     ");
                   INSTR( CE_NOP                                          , ALU_NOP                                                , "                                                           ");
    /* CHECKSUM */ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))         , ALU_SUB(FEM ,CNST(0),REG_OP(2))                        , "copy R1(new checksum)                                      ");

    /* at his point checksum is already copied!, lets copy the rest of the packet, make sure to use the new TOS! */
    /* and also make sure to add LLID tag, it will be added according to the size in register R2*/
    /* R0 still points at checksum, we will go on using this pointer */
    /* R2 is the result extracted from the lowest 4 bits of EES_DATA2*/

    /* COPYING */ INSTR(CE_COPY(GEN, R_OFST(0,-4), C_SIZE(8))             , ALU_NOP                               , "copy everything between IPv4 checksum and TOS fields, total of 8 bytes");
    /* NEW TOS */ INSTR(CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(1))    , ALU_SUB(REG_OP(0),CNST(26),REG_OP(SZ)), "copy new TOS from EES_DATA1, total of 1 bytes");
    /* COPYING */ INSTR(CE_COPY(GEN, R_OFST(0,-22), C_SIZE(3))            , ALU_NOP                               , "copy IPv4 first byte and Ether-type of ETHERNET header, total of 3 bytes");
    /* COPYING */ INSTR(CE_COPY(GEN, R_OFST(0,-28), R_SIZE(SZ,0))         , ALU_NOP                               , "copy ETHERNET tags, it can RSZ can be anything from 0-8 bytes");
    /* LLID    */ INSTR(CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(2,0))  , ALU_NOP, "copy LLID label from EES_DATA2");
    /* COPYING */ INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6))               , ALU_NOP, "copy SA from generated header");
    /* COPYING */ INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))               , ALU_NOP, "copy DA from generated header");

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

     res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PON_DSCP_REMARKING_IPV6);
     SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
     SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        /*
        first 6 instructions are here to calculate the location of "2 bytes into IPV6 header", R0 will hold the result
        the logic behind it is the following:
        assume its double tagged packet, location is at offset        12(DA,SA) +8(double tags) + 2(ether-type) + 2(checksum within IP) = 24 bytes offset.
        if the packet proves to be single tagged then the offset is : 12(DA,SA) +4(only 1 tag ) + 2(ether-type) + 2(checksum within IP) = 20 bytes offset.
        if the packet proves to be single tagged then the offset is : 12(DA,SA) +0(no     tags) + 2(ether-type) + 2(checksum within IP) = 16 bytes offset.
        */

        INSTR( CE_READ(GEN, C_OFST(36))                                , ALU_SET(0x86dd, REG_OP(1))                          , "extract ether-type for single tagged packet offset 36 nibbles");
        INSTR( CE_READ(GEN, C_OFST(28))                                , ALU_SET(24    , REG_OP(0))                          , "extract ether-type for non    tagged packet offset 28 nibbles");
        INSTR( CE_NOP                                                  , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(20), REG_OP(0)) , "if single tagged packet checksum is at offset 30 bytes");
        INSTR( CE_FLREAD( PrgeDataFieldEesData1,0,LFEM_8_CENTRAL_BITS) , ALU_SET_IF(FEM, EQ, REG_OP(1), CNST(16), REG_OP(0)) , "if non    tagged packet checksum is at offset 26 bytes");
        INSTR( CE_NOP                                                  , ALU_NOP                                             , "");
        /* at this point R0 should point 2 bytes into the IPV6 header */


        /* prepare R3,RSZ for copying in between  R3 and R0, R1 will hold new first 2 bytes of IPV6 header*/
        INSTR( CE_LREAD(GEN, R_OFST(0,0), LFEM_8_PERIPHERAL_BITS)  , ALU_SUB(FEM ,CNST(0),REG_OP(1))                        , "R1 = NEW_TOS(extracted two instructions up)                ");
        INSTR( CE_NOP                                              , ALU_SUB(REG_OP(3) ,REG_OP(0),REG_OP(SZ))               , "RSZ=R3-R0 this is for copying everything from R3 to R0     ");
        INSTR( CE_NOP                                              , ALU_ADD(FEM ,REG_OP(1),REG_OP(1))                      , "R1 = first 2 bytes of IPV6 header(with updated TOS)        ");

        /* copying in between  R3 and R0 */
        /*at the end of this part will update also R0, and RSZ because later they will be used to copy the tags */
        INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
        INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
        INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)),  ALU_SUB(REG_OP(0), CNST(2), REG_OP(0)), "4: Copy 8B from offset R3");
        INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)),  ALU_SUB(REG_OP(0), CNST(14), REG_OP(SZ)), "5: Copy 8B from offset R3-8B(16NB)");

        /* copy updated first 2 bytes of IPV6 header*/
        INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))             , ALU_NOP                                 , "copy R1 which holds updated first 2 bytes of IPV6 header");

        /* LLID extraction of 4 LSBS of EES-DATA2 */
        INSTR( CE_FLREAD( PrgeDataFieldEesData2,0,LFEM_4_LSBS)     , ALU_NOP                                 , "                                                        ");
        INSTR( CE_NOP                                              , ALU_NOP                                 , "                                                        ");

        /* copy ether-type and up to two tags */
        INSTR( CE_COPY(GEN, R_OFST(0, 0),  R_SIZE(SZ, 0))          , ALU_SUB(FEM ,CNST(0),REG_OP(2))         , "                                                        ");
        INSTR( CE_COPY(GEN, R_OFST(0, -16), R_SIZE(SZ, -8))        , ALU_NOP                                 , "                                                        ");



        /* LLID    */ INSTR(CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(2,0))  , ALU_NOP, "copy LLID label from EES_DATA2");
        /* COPYING */ INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6))               , ALU_NOP, "copy SA from generated header");
        /* COPYING */ INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))               , ALU_NOP, "copy DA from generated header");

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }





  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

     res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_48_BYTES_SYS_HDRS);
     SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

     res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
     SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

     /* COPY 48 bytes of system headers */
    INSTR( CE_COPY(PKT, C_OFST(96), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(80), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(64), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(48), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(32), C_SIZE(8))  , ALU_NOP  , "");
    INSTR( CE_COPY(PKT, C_OFST(16), C_SIZE(8))  , ALU_NOP  , "");

    res = arad_egr_prge_mgmt_build_program_end(unit);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_TO_IPOETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

      /*copy everything , but not the MIM header , assumed to be 22 byte long */
      INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(22), REG_OP(SZ)), "");
      INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(8), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -8)), ALU_SET(3, REG_OP(1)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, 0)), ALU_NOP, "");

      /* assume PRGE program var has the value 0x0800 on it, concatenate it to the output packet */
      INSTR(CE_FCOPY(PrgeDataFieldProgVar, -12, C_SIZE(2)), ALU_NOP, "");


      /* copy  bvlan*/
      INSTR(CE_COPY(GEN, C_OFST(32), C_SIZE(4)), ALU_NOP, "");
      /* copy B-sa for prog-var*/
      INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(6)), ALU_NOP, "");
      /* copy da from generated header */
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");

      res = arad_egr_prge_mgmt_build_program_end(unit); 
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 2) {
    /* 0*/ INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
    /* 1*/ INSTR( CE_READ(GEN, R_OFST(2,28))    , ALU_SET(0, REG_OP(1))                             , "");

    /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SET(2, REG_OP(0))                                           , "");
    /* 3*/ INSTR( CE_NOP                    , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(0)) , "");

    /* 4*/ INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "" );
    /* 5*/ INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M)  , ALU_NOP          , "" );

    /* 6*/ INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET_IF(REG_OP(0), NEQ, CNST(2), CNST(2), REG_OP(1))  , ""   );

    /* $ */ INSTR(CE_LREAD(GEN, R_OFST(2,29),  LFEM_LSHIFT_12)   , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
    /* $$*/ INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , "" );

    /* 7*/ INSTR(  CE_LREAD(GEN, R_OFST(2,-11), LFEM_12_LSBS)     , ALU_SUB(FEM,CNST(0) ,REG_OP(3))                         , "priority in R3"   );

    /* 8*/ INSTR(  CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_1_0_M)  , ALU_NOP                            , ""   );
    /* 9*/ INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );

    /*10*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ))    , ""   );
    /*11*/ INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(1))                , ""   );

    /*12*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))              , ALU_SET(0, REG_OP(3))   , ""   );
    /*13*/ INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SUB(REG_OP(2),CNST(20), REG_OP(SZ))   , ""   );/* RSZ = R2 -8(OFFSET) - 12(|DA|+|SA|)*/

    /* just copy the rest of the packet, bypass data-Label*/
    INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8)), ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))            , "copy DA + SA + PWE");          /* R2 = R2 -8(OFFSET) */
    INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8)), ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "copy DA + SA + PWE");


      /* copy everything after PWE TAG except data-label*/
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8)) , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))  , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      /* coe support */
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }


      /* copy DA from generated header */
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

} else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 1){
   /* 0*/ INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
   /* 1*/ INSTR( CE_NOP                        , ALU_SET(0, REG_OP(0))                            , "");

   /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "");
   /* 3*/ INSTR( CE_READ(GEN, R_OFST(2,28))                      , ALU_NOP , "");

   /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET(2, REG_OP(0))  , "" );
   /* 5*/ INSTR( CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(0), REG_OP(0))  , "" );

   /* 6*/ INSTR(  CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , ""   );

   /* 7*/ INSTR(CE_LREAD(GEN, R_OFST(2,29),  LFEM_LSHIFT_12)   , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
   /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16))   , ALU_NOP  , "" );

   /* 9*/ INSTR(  CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)     , ALU_SUB(FEM,CNST(0) ,REG_OP(3))                         , "priority in R3"   );

   /* 10*/ INSTR(  CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)  , ALU_SUB(CNST(2), REG_OP(0), REG_OP(3)), ""   );                        
   /* 11*/ INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

   /*12*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ)), "");                                                
   /*13*/ INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(3))            , "");

   /*14*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ)),"");                                                     
   /*15*/ INSTR( CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))             ,ALU_SET(0, REG_OP(3))                   ,"");
    

    /* RSZ must be R2-R1  */
    /*16*/INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8)), ALU_SET_IF(FEM,EQ, CNST(1), REG_OP(3), REG_OP(3)), "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
    /*17*/INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0)) , ALU_SUB(REG_OP(1),CNST(12), REG_OP(SZ))          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
    /*18*/INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8)), ALU_NOP                                          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");


      /* copy everything after PWE TAG except data-label*/
      /*19*/INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))   , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1)), "");
      /*20*/INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))  , ALU_NOP, "");
      /*21*/INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16)) , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      /* coe support */ 
      /*22*/INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      /*23*/INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          /*24*/INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          /*25*/INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          /*26*/INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
      /* copy DA from generated header */           
      /*27*/INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");
}

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 2) {
    /* 0*/ INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
    /* 1*/ INSTR( CE_READ(GEN, R_OFST(2,28))    , ALU_SET(0, REG_OP(1))                             , "");

    /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SET(2, REG_OP(0))                                           , "");
    /* 3*/ INSTR( CE_NOP                                          , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(0)) , "");

    /* 4*/ INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "" );
    /* 5*/ INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M)                                         , ALU_NOP          , "" );

    /* 6*/ INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET_IF(REG_OP(0), NEQ, CNST(2), CNST(2), REG_OP(1))  , ""   );

    /* $ */ INSTR( CE_NOP                                          , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
    /* $$*/ INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))    , ALU_NOP  , "" );

    /* 7*/ INSTR(  CE_LREAD(GEN, R_OFST(2,-11), LFEM_12_LSBS)    , ALU_SET(0 ,REG_OP(3))                                   , "priority in R3"   );

    /* 8*/ INSTR(  CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_1_0_M)  , ALU_NOP                            , ""   );                        
    /* 9*/ INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

    /*10*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ))    , ""   );                                                
    /*11*/ INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(1))                , ""   ); 

    /*12*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))              , ALU_SET(0, REG_OP(3))   , ""   );                                                     
    /*13*/ INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SUB(REG_OP(2),CNST(20), REG_OP(SZ))   , ""   );/* RSZ = R2 -8(OFFSET) - 12(|DA|+|SA|)*/
    
    /* just copy the rest of the packet, bypass data-Label*/
    INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8)), ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))            , "copy DA + SA + PWE");          /* R2 = R2 -8(OFFSET) */
    INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8)), ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "copy DA + SA + PWE");
      

      /* copy everything after PWE TAG except data-label*/
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8)) , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))  , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      /* coe support */ 
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
      /* copy DA from generated header */           
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

} else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 1){

   /* 0*/ INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
   /* 1*/ INSTR( CE_NOP                        , ALU_SET(0, REG_OP(0))                            , "");

   /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "");
   /* 3*/ INSTR( CE_READ(GEN, R_OFST(2,28))                      , ALU_NOP , "");

   /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET(2, REG_OP(0))  , "" );
   /* 5*/ INSTR( CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(0), REG_OP(0))  , "" );

   /* 6*/ INSTR(  CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , ""   );

   /* 7*/ INSTR( CE_NOP                      , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
   /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16))   , ALU_NOP  , "" );

   /* 9*/ INSTR(  CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)     , ALU_SET(0 ,REG_OP(3))            , "priority in R3"   );

   /* 10*/ INSTR(  CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)  , ALU_SUB(CNST(2), REG_OP(0), REG_OP(3)), ""   );                        
   /* 11*/ INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

   /*12*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ)), "");                                                
   /*13*/ INSTR(  CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))      , ALU_SET(2, REG_OP(3))            , "");

   /*14*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ)),"");                                                     
   /*15*/ INSTR( CE_COPY(RES, R_OFST(SZ,3), C_SIZE(2))             ,ALU_SET(0, REG_OP(3))                   ,"");
    

    /* RSZ must be R2-R1  */
    /*16*/INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8)), ALU_SET_IF(FEM,EQ, CNST(1), REG_OP(3), REG_OP(3)), "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
    /*17*/INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0)) , ALU_SUB(REG_OP(1),CNST(12), REG_OP(SZ))          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
    /*18*/INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8)), ALU_NOP                                          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");


      /* copy everything after PWE TAG except data-label*/
      /*19*/INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))   , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1)), "");
      /*20*/INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))  , ALU_NOP, "");
      /*21*/INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16)) , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      /* coe support */ 
      /*22*/INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      /*23*/INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          /*24*/INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          /*25*/INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          /*26*/INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
      /* copy DA from generated header */           
      /*27*/INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");
}
      
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_USER_MODE_NOT_PTAGGED);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 2) {
    /* 0*/ INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
    /* 1*/ INSTR( CE_READ(GEN, R_OFST(2,28))    , ALU_SET(0, REG_OP(1))                             , "");

    /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))   , ALU_SET(2, REG_OP(0))                                           , "");
    /* 3*/ INSTR( CE_NOP                                        , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(1), REG_OP(0)) , "");

    /* 4*/ INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))  , "" );
    /* 5*/ INSTR( CE_LREAD(GEN, R_OFST(2,-14), LFEM_BITS_2_3_M)                                         , ALU_NOP          , "" );

    /* 6*/ INSTR(  CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET_IF(REG_OP(0), NEQ, CNST(2), CNST(2), REG_OP(1))  , ""   );

    /* $ */ INSTR( CE_NOP                                       , ALU_SUB(CNST(64),FEM,REG_OP(SZ)) , "" );
    /* $$*/ INSTR( CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8)) , ALU_NOP                          , "" );

    /* 7*/ INSTR(  CE_NOP    , ALU_SET(0 ,REG_OP(3))                                   , "priority in R3"   );

    /* 8*/ INSTR(  CE_NOP  , ALU_NOP                            , ""   );                        
    /* 9*/ INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

    /*10*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(1,0))            , ALU_SUB(CNST(64),FEM, REG_OP(SZ))    , ""   );                                                
    /*11*/ INSTR(  CE_NOP                                             , ALU_SET(2, REG_OP(1))                , ""   ); 

    /*12*/ INSTR(  CE_NOP                                             , ALU_SET(0, REG_OP(3))   , ""   );                                                     
    /*13*/ INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SUB(REG_OP(2),CNST(20), REG_OP(SZ))   , ""   );/* RSZ = R2 -8(OFFSET) - 12(|DA|+|SA|)*/
    
    /* just copy the rest of the packet, bypass data-Label*/
    INSTR(CE_COPY(GEN, R_OFST(2, 24), C_SIZE(8)), ALU_SUB(REG_OP(2), CNST(8), REG_OP(2))            , "copy DA + SA + PWE");          /* R2 = R2 -8(OFFSET) */
    INSTR(CE_COPY(GEN, R_OFST(2, 8), C_SIZE(8)), ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(3)), "copy DA + SA + PWE");
      

      /* copy everything after PWE TAG except data-label*/
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, 0))    , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(2, -16), R_SIZE(SZ, -8)) , ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(2, 0), R_SIZE(SZ, -16))  , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      /* coe support */ 
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
      /* copy DA from generated header */           
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

} else if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0) == 1){

   /* 0*/ INSTR( CE_NOP                        , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) )  , "");
   /* 1*/ INSTR( CE_NOP                        , ALU_SET(0, REG_OP(0))                            , "");

   /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-14))     , ALU_SUB(REG_OP(SZ),CNST(22), REG_OP(SZ))      , "");
   /* 3*/ INSTR( CE_READ(GEN, R_OFST(2,28))                      , ALU_NOP , "");

   /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16)  , R_SIZE(SZ,0))   , ALU_SET(2, REG_OP(0))  , "" );
   /* 5*/ INSTR( CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_2_3_M)   , ALU_SET_IF(FEM, EQ, CNST(canonical_tpid), REG_OP(0), REG_OP(0))  , "" );

   /* 6*/ INSTR(  CE_COPY(GEN, R_OFST(3,-32)  , R_SIZE(SZ,-8))   , ALU_NOP  , ""   );

   /* 7*/ INSTR( CE_NOP                                          , ALU_SUB(CNST(64),FEM,REG_OP(SZ))          , "" );
   /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-48)  , R_SIZE(SZ,-16))   , ALU_NOP  , "" );

   /* 9*/ INSTR(  CE_LREAD(GEN, R_OFST(1,5), LFEM_12_LSBS)     , ALU_SET(0 ,REG_OP(3))                         , "priority in R3"   );

   /* 10*/ INSTR(  CE_LREAD(GEN, R_OFST(1,2), LFEM_BITS_1_0_M)  , ALU_SUB(CNST(2), REG_OP(0), REG_OP(3)), ""   );                        
   /* 11*/ INSTR(  CE_COPY(GEN, R_OFST(2,28)  , R_SIZE(0,0))      , ALU_ADD(REG_OP(3),FEM, REG_OP(3))  , ""   );   

   /*12*/ INSTR(  CE_COPY(RES, R_OFST(SZ,3), R_SIZE(3,0))      , ALU_SUB(CNST(64),FEM, REG_OP(SZ)), "");                                                
   /*13*/ INSTR(  CE_NOP                                       , ALU_SET(2, REG_OP(3))            , "");

   /*14*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SUB(REG_OP(2),REG_OP(1), REG_OP(SZ)),"");                                                     
   /*15*/ INSTR( CE_NOP                                            ,ALU_SET(0, REG_OP(3))                   ,"");
    

    /* RSZ must be R2-R1  */
    /*16*/INSTR(CE_COPY(GEN, R_OFST(2, 24), R_SIZE(SZ,8)), ALU_SET_IF(FEM,EQ, CNST(1), REG_OP(3), REG_OP(3)), "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");                  
    /*17*/INSTR(CE_COPY(GEN, R_OFST(2, 8), R_SIZE(SZ,0)) , ALU_SUB(REG_OP(1),CNST(12), REG_OP(SZ))          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");   
    /*18*/INSTR(CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,-8)), ALU_NOP                                          , "copy DA + SA + PWE + CW(if exists) + ENTROPY(if exists)");


      /* copy everything after PWE TAG except data-label*/
      /*19*/INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, 0))   , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1)), "");
      /*20*/INSTR(CE_COPY(GEN, R_OFST(1,-16), R_SIZE(SZ, -8))  , ALU_NOP, "");
      /*21*/INSTR(CE_COPY(GEN, R_OFST(1, 0) , R_SIZE(SZ, -16)) , ALU_SET(COE_TYPE_2_TPID, REG_OP(0)) , "");


      /* coe support */ 
      /*22*/INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(3, 0),LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      /*23*/INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(3, 0)),                        ALU_NOP, "Copy Program-Variable");


      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          /*24*/INSTR(  CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3))                           , ALU_NOP , "");
          /*25*/INSTR(  CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1),LFEM_FIRST_FIFTH_NIBBLES) , ALU_NOP , "");
          /*26*/INSTR(  CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2))                           , ALU_NOP , "");
      }else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }
      
      
      /* copy DA from generated header */           
      /*27*/INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)) , ALU_NOP, "");

}

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }
  

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_LSR_MANIPULATION);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

      INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3),  REG_OP(1), REG_OP(SZ))             , "Read System header size , RSZ = R3-R1");
      INSTR(CE_NOP                                            , ALU_NOP                                                , "Read System header size , RSZ=RSZ -4 -8");
      INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(FEM,  CNST(0), REG_OP(2))                      , "");
      INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, -4))        , ALU_SUB(REG_OP(SZ),  CNST(20), REG_OP(SZ))             , "R2 = System header size");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -12))     , ALU_ADD(FEM, CNST(30), REG_OP(0))                      , "");
      INSTR(CE_READ(PKT, R_OFST(2, 36)), ALU_ADD(REG_OP(2)    , CNST(26), REG_OP(2))                                   , "");
      INSTR(CE_READ(PKT, R_OFST(2, 28)), ALU_ADD(REG_OP(2)    , CNST(22), REG_OP(2))                                   , "");
      INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(SZ, 0))       , ALU_SET_IF(FEM, EQ, CNST(0x8847), REG_OP(2), REG_OP(0)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -48), R_SIZE(SZ, -8))      , ALU_SET_IF(FEM, EQ, CNST(0x8847), REG_OP(2), REG_OP(0)), "");
      INSTR(CE_COPY(GEN, R_OFST(3, -64), R_SIZE(SZ, -16))     , ALU_SET(2, REG_OP(SZ))                                 , "");

      /* R0   is pointing to the labels at the original header    */
      /* R1+10 is pointing to the labels at the generated header  */
      /* R2 is boolean of if to do COE type 2                     */

      INSTR(CE_LREAD(PKT, R_OFST(0, 0),    LFEM_TTL_EXP)                 , ALU_SET(0, REG_OP(2))                           , "");
      INSTR(CE_LREAD(PKT, R_OFST(0, -8),  LFEM_TTL_EXP)                  , ALU_NOP                                         , "");
      INSTR(CE_LREAD(GEN, R_OFST(1, 8),   LFEM_TTL_EXP_COMP)             , ALU_SUB(FEM  ,CNST(1), REG_OP(SZ))              , "");
      INSTR(CE_LREAD(GEN, R_OFST(1, 0),    LFEM_TTL_EXP_COMP)            , ALU_SUB(FEM  ,CNST(1), REG_OP(3))               , "");
      INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS_SWAPPED)    , ALU_ADD(FEM, REG_OP(SZ), REG_OP(0))             , "");
      INSTR(CE_NOP                                                       , ALU_ADD(FEM, REG_OP(3), REG_OP(3))              , "");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                      , ALU_SET_IF(FEM, EQ, CNST(2), CNST(2), REG_OP(2)), "");
      INSTR(CE_COPY(GEN, R_OFST(1, 4),    C_SIZE(2))                     , ALU_SUB(REG_OP(1),  CNST(16), REG_OP(0))        , "");
      INSTR(CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                      , ALU_SUB(REG_OP(1),  CNST(4), REG_OP(1))         , "");
      INSTR(CE_COPY(GEN, R_OFST(1, -4),   C_SIZE(2))                     , ALU_NOP                                         , "");

      /* Ethernet tags copying */
      INSTR(CE_COPY(GEN, R_OFST(1, 0), R_SIZE(0, 0)), ALU_NOP, "");
      INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(0, -8)), ALU_SET(COE_TYPE_2_TPID, REG_OP(0)), "");

      /* COE support */
      INSTR(CE_FLCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0), LFEM_12_LSBS),   ALU_NOP, "Copy PP-Port-Variable");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, R_SIZE(2, 0)),                        ALU_NOP, "Copy Program-Variable");

      /*copy SA from ppPortVar and tmPortVar */
      if (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) {
          INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
          INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");
      } else { /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
      }

      /* copy DA from generated header */
      INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST1);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_LREAD(PKT, R_OFST(2,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)                , ALU_SET(0x4   , REG_OP(0))                  , "Extract FWD_HEADER_OFFSET; R0=4");
      INSTR( CE_READ(PKT, R_OFST(3,36 + (user_header_size*2)))                          , ALU_SET(24   , REG_OP(SZ))                , "Extract EtherType; set SZ=24 (offset to copy from gen)");
      INSTR( CE_NOP                , ALU_SET_IF(FEM, NEQ, CNST(0), REG_OP(0), REG_OP(1))  , " If FWD_HEADER_OFFSET!=0 then R1=4");
      INSTR( CE_NOP                                                                     , ALU_SET_IF(FEM, NEQ, CNST(0x88e7), REG_OP(0), REG_OP(1))  , "If EtherType!= ITPID then R1=4");
      INSTR(  CE_NOP                                   ,  ALU_NOP                                                   , " NOP");
      INSTR(  CE_LREAD(GEN, C_OFST(40 + (user_header_size*2)), LFEM_SET_BITS_7_8)            , ALU_SET_IF(REG_OP(1), EQ, REG_OP(0), CNST(26), REG_OP(0)) , "Extract and Set res2; If R1=4 then R0=26 (bytes to copy from gen)");
      INSTR( CE_NOP            , ALU_SET_IF(REG_OP(1), EQ, REG_OP(0), CNST(46), REG_OP(SZ)) , " If R1=4 then SZ=46 (offset to copy from gen)");
      
      INSTR( CE_NOP                                    , ALU_SUB(FEM, CNST(0), REG_OP(2))                    , " R2=RES2 set");

      INSTR( CE_COPY(GEN, R_OFST(SZ,(user_header_size*2)), R_SIZE(0,0))               , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))  , "Copy generated header until ttl; SZ-16");
      INSTR( CE_COPY(GEN, R_OFST(SZ,-16+(user_header_size*2)), R_SIZE(0,-8))               , ALU_SUB(REG_OP(0), CNST(24), REG_OP(0)) , "Copy generated header until ttl; R0-8");
      INSTR( CE_COPY(GEN, R_OFST(SZ,(user_header_size*2)), R_SIZE(0,-16))               , ALU_SET(0x4   , REG_OP(0)) , "Copy generated header until ttl; r0=4");
      INSTR( CE_COPY(GEN, R_OFST(SZ,-16+(user_header_size*2)), R_SIZE(0,0))               , ALU_NOP  , "Copy generated header until ttl");

      INSTR( CE_READ(GEN, C_OFST(40 + (user_header_size*2)))            , ALU_SET_IF(REG_OP(1), EQ, REG_OP(0), CNST(0), REG_OP(SZ)) , "Extract res2 and ttl from generated; If R1=4 then Sz=0");
      INSTR(  CE_LREAD(PKT, R_OFST(3,38 + (user_header_size*2)), LFEM_BIT_0)     , ALU_SET_IF(REG_OP(1), NEQ, REG_OP(0), CNST(1), REG_OP(SZ))  , " extract res2 from original packet;  If R1!=4 then Sz=1");
      INSTR( CE_NOP  , ALU_SUB(FEM, CNST(0), REG_OP(3)) , " R3=Res2 from generated");
      
      INSTR( CE_NOP       , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(0), REG_OP(SZ))                  , "If fem (res2) != SZ(1)Sz=0");
      INSTR( CE_NOP                                     , ALU_SET_IF(REG_OP(1), EQ, REG_OP(0), REG_OP(2), REG_OP(3))                          , "If R1=4 then R3=R2");

      INSTR(  CE_NOP                                   ,  ALU_NOP                                                   , " NOP");
      INSTR( CE_NOP       , ALU_SUB(REG_OP(3), REG_OP(SZ), REG_OP(3))                                                  , " R3= TTL - SZ(0/1)");
      INSTR(  CE_NOP                                   ,  ALU_NOP                                                   , " NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))                                    , ALU_NOP                                                    , "Append res 2 and ttl to the packet");
 
 
      INSTR( CE_COPY(GEN, C_OFST(36+(user_header_size*2)), C_SIZE(8))               , ALU_NOP  , "Copy generated header ");
      INSTR( CE_COPY(GEN, C_OFST(20+(user_header_size*2)), C_SIZE(8))               , ALU_NOP  , "Copy generated header ");

      INSTR( CE_COPY(GEN, C_OFST(4+(user_header_size*2)), C_SIZE(2))               , ALU_NOP  , "Copy generated header "); 
     
      
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


  }





  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      int ftmh_size = 0;
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      INSTR(CE_COPY(GEN, R_OFST(3, 0), C_SIZE(8)), ALU_SUB(REG_OP(3), CNST(34), REG_OP(SZ)), "copy from gen ; SZ= R3-18 number of bytes to copy");
      INSTR(CE_COPY(GEN, R_OFST(3, -16), C_SIZE(8)), ALU_NOP, "NOP");
      INSTR(CE_LREAD(GEN, C_OFST(29 + (user_header_size * 2)), LFEM_MSB_MPLS), ALU_SET(0xff, REG_OP(1)), "Extract dei & pri ; R1=255 TTL");


      if (SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable) {
          INSTR(CE_LREAD(PKT, C_OFST(10 + ((ftmh_size + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE) * 2)), LFEM_SVID), ALU_NOP, "Extract S-VID from vsi in PPH ; --- ");
      } else {
          INSTR(CE_LREAD(PKT, C_OFST(10 + (ftmh_size * 2)), LFEM_SVID), ALU_NOP, "Extract S-VID from vsi in PPH ; --- ");
      }

      INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_IS_LAG), ALU_SUB(FEM, CNST(0), REG_OP(2)), "Extract src system port ; R2=dei & pri");
      INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(SZ, 0)), ALU_SUB(FEM, CNST(0), REG_OP(0)), "copy from gen ; R0=S-VID");
      INSTR(CE_COPY(GEN, R_OFST(3, -48), R_SIZE(SZ, -8)), ALU_SUB(FEM, CNST(0), REG_OP(3)), "copy from gen ; r3=src system port is lag?");
      INSTR(CE_COPY(GEN, R_OFST(3, -64), R_SIZE(SZ, -16)), ALU_NOP, "NOP");

      INSTR(CE_LREAD(GEN, C_OFST(24 + (user_header_size * 2)), LFEM_SA_LAG), ALU_ADD(REG_OP(0), REG_OP(2), REG_OP(0)), "extract fap id; R0=dei&pri&svid");


      if (SOC_DPP_CONFIG(unit)->arad->init.ports.add_dsp_extension_enable) {
          INSTR(CE_LCOPY(PKT, C_OFST(8 + ((ftmh_size + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE) * 2)), C_SIZE(1), LFEM_EID), ALU_SET(0xe0e0, REG_OP(1)), "Extract EID from VSI from pph; R1=0xe0e0");
      } else {
          INSTR(CE_LCOPY(PKT, C_OFST(8 + (ftmh_size * 2)), C_SIZE(1), LFEM_EID), ALU_SET(0xe0e0, REG_OP(1)), "Extract EID from VSI from pph; R1=0xe0e0");
      }

      INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)), ALU_SUB(FEM, CNST(0), REG_OP(2)), "append r1 (ttl) to the packet ; r2=msb sa");
      INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2)), ALU_SUB(FEM, CNST(0), REG_OP(1)), "append r1 (etpid) to the packet ; r1=eid");
      INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)), ALU_NOP, "append r0 (s-vid) to the packet ; ---");

      INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_FAP_ID), ALU_NOP, "extract fap id ; ");
      INSTR(CE_FLREAD(PrgeDataFieldSrcSysPort, 0, LFEM_7_LSBS), ALU_NOP, "extract lag id ; ");

      INSTR(CE_NOP, ALU_SUB(FEM, CNST(0), REG_OP(0)), " ----; r0= fap id");
      INSTR(CE_NOP, ALU_SUB(FEM, CNST(0), REG_OP(1)), " -----; R1=LAG id");

      INSTR(CE_NOP, ALU_ADD(FEM, REG_OP(2), REG_OP(2)), " r2=sa not lag");
      INSTR(CE_NOP, ALU_SET_IF(REG_OP(3), EQ, CNST(0x1), REG_OP(1), REG_OP(0)), "If is lag R0=SA lag");

      INSTR(CE_COPY(GEN, C_OFST(28 + (user_header_size * 2)), C_SIZE(2)),  ALU_NOP, " copy 2B STPID");
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "sa_addressing_mode", 0)) {
          INSTR(CE_COPY(GEN, C_OFST(24 + (user_header_size * 2)), C_SIZE(2)),  ALU_NOP, " copy ");
      } else {
          INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)), ALU_NOP, "Append SA to the packet");
      }
      INSTR(CE_COPY(GEN, C_OFST(20 + (user_header_size * 2)), C_SIZE(8)),  ALU_NOP, " copy ");
      INSTR(CE_COPY(GEN, C_OFST(4 + (user_header_size * 2)), C_SIZE(2)),  ALU_NOP, " copy ");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }


  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TEST2_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR(  CE_NOP                                            ,  ALU_SUB(REG_OP(3) , CNST(19) , REG_OP(SZ))   , " ---; SZ=R3-38");
    

      INSTR(CE_NOP                                              , ALU_SET(0, REG_OP(2))                         , "R2=0");
      INSTR( CE_LREAD(GEN, C_OFST(36 + (user_header_size*2))    , LFEM_MASK_BIT_2_3)    , ALU_SET(0x1, REG_OP(1))   , "extract eth type; R1=1");

   
      INSTR(  CE_NOP                                            ,  ALU_NOP                                      , " NOP");

      INSTR(CE_NOP                                              , ALU_SET_IF(FEM, EQ, CNST(0xe0e0), REG_OP(1), REG_OP(2))              , "if eth type == 0xeoeo reg2=1");
   
      INSTR( CE_COPY(GEN, R_OFST(3 ,(user_header_size*2)), R_SIZE(SZ,0)) , ALU_NOP                               , "copy 5B ; ---"); 
      INSTR( CE_COPY(GEN, R_OFST(3 , -16+(user_header_size*2)), R_SIZE(SZ,-8)) , ALU_NOP                               , "copy 5B ; ---"); 
      INSTR( CE_COPY(GEN, R_OFST(3 ,-32+(user_header_size*2)), R_SIZE(SZ,-16)) , ALU_NOP                               , "copy 5B ; ---"); 

      INSTR( CE_READ(GEN, C_OFST(38 + (user_header_size*2)))    , ALU_NOP                                       , "extract ttl value;---");
      INSTR(  CE_NOP                                            ,  ALU_NOP                                      , " NOP");
      INSTR(  CE_NOP                                            ,  ALU_SUB(FEM       , REG_OP(2) , REG_OP(1))   , " ---; r1= TTL-1");
      INSTR(  CE_NOP                                            ,  ALU_NOP                                      , " NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                    , ALU_NOP                               , "append r1 (ttl) to the packet ; ---");
      INSTR( CE_COPY(GEN, C_OFST(34 + (user_header_size*2)), C_SIZE(8)) , ALU_NOP                               , " copy ");
      INSTR( CE_COPY(GEN, C_OFST(18 + (user_header_size*2)), C_SIZE(8)) , ALU_NOP                               , " copy ");
      INSTR( CE_COPY(GEN, C_OFST(2 + (user_header_size*2)), C_SIZE(1))  , ALU_NOP                               , " copy "); 
     
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
  }
  
  
  /* Define Program instructions for Preserving DSCP on a per out-port bases*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

      /* Start program instructions */
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))                 , ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                     , "0: Copy GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE) 
                                                                                                                                , "1: FEM=sys_hdr_size,  JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: R1=sys_hdr_size");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "4: Copy GEN");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: FEM=fwd_hdr_offset");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_NOP                                                     , "6: Copy GEN, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: R0 = fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_NOP                                                     , "8: NOP");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0x100, REG_OP(2))                                   , "9: FEM=PKT.check_sum, R2=0x100 (TTL--)");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0, REG_OP(SZ))                                      , "10:FEM=PKT.check_sum, Rsz=0");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(2), REG_OP(1))                          , "11:R1=PKT.check_sum+0x100");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET_IF(FEM,LT,REG_OP(SZ),CNST(0x101),REG_OP(2))         , "12:if PKT.check_sum<0, R2=0x101");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "13:NOP");
      INSTR( CE_NOP                                               , ALU_SET_COMP_SUM(FEM, REG_OP(2), GE, ALU, REG_OP(1))        , "14:if PKT.check_sum+0x101 >=0, R1=PKT.check_sum+0x101(alu_result)");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "16:Copy new check_sum(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "17:Copy GEN IP header, byte 2-byte 9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "18:Copy PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "19:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "20:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_NOP                                                     , "23:Copy GEN");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }

  /* Define Program instructions for Preserving DSCP on a per out-port bases*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;

      /* Start program instructions */
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_OAMTS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))                 , ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                     , "0: Copy GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                                                , "1: FEM=sys_hdr_size, JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_NOP                                               , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: R1=sys_hdr_size");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "4: Copy GEN");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: FEM=fwd_hdr_offset");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_NOP                                                     , "6: Copy GEN, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: R0 = fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_NOP                                                     , "8: NOP");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0x100, REG_OP(2))                                   , "9: FEM=PKT.check_sum, R2=0x100 (TTL--)");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET(0, REG_OP(SZ))                                      , "10: FEM=PKT.check_sum, Rsz=0");
      INSTR( CE_NOP                                               , ALU_ADD(FEM, REG_OP(2), REG_OP(1))                          , "11:R1=PKT.check_sum+0x100");
      INSTR( CE_READ(PKT, R_OFST(0,24))                           , ALU_SET_IF(FEM,LT,REG_OP(SZ),CNST(0x101),REG_OP(2))         , "12:if PKT.check_sum<0, R2=0x101");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "13:NOP");
      INSTR( CE_NOP                                               , ALU_SET_COMP_SUM(FEM, REG_OP(2), GE, ALU, REG_OP(1))        , "14:if PKT.check_sum+0x101 >=0, R1=PKT.check_sum+0x101(alu_result)");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "16:Copy new check_sum(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "17:Copy GEN IP header, byte 2-byte 9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "18:Copy PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "19:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "20:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_NOP                                                     , "23:Copy GEN");
  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }



  /* Define Program instructions for Preserving DSCP on a per out-port bases*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;

      /* Start program instructions */
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_COPY(GEN, R_OFST(3,0), C_SIZE(8))              , ALU_NOP                                , "0: copy from generated header");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                        , "1: FEM=sys_hdr_size,  JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_NOP                                            , ALU_NOP                                , "2: NOP");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                               , ALU_SUB(FEM, CNST(0), REG_OP(1))       , "3: Extract FWD_HEADER_OFFSET; R1=System header Size ");
      INSTR( CE_LREAD(GEN,  R_OFST(3,-28), LFEM_4_MSB_AND_LSB) , ALU_NOP                                , "4: copy msb of flow label");
      INSTR( CE_NOP                                            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))     , "5: R0= FWD_HEADER_OFFSET +system header size");
      INSTR( CE_NOP                                            , ALU_ADD(FEM, CNST(0), REG_OP(1))       , "6: R1= flow label");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), C_SIZE(6))            , ALU_NOP                                , "7: copy from generated header");
      INSTR( CE_LREAD(PKT, R_OFST(0,3), LFEM_TOS)              , ALU_NOP                                , "8: extract original tos ; ---");
      INSTR( CE_NOP                                            , ALU_NOP                                , "9: NOP");
      INSTR( CE_NOP                                            , ALU_ADD(FEM, REG_OP(1), REG_OP(1))     , "10:--- ; R1 = flow label+tos");
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)), "11:R3=R3-16");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                , "12:copy R1");
   
      /* copy from generated header*/
      for(i=0; i<4; i++) {
          INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))        , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3)), "copy from generated header");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))     , ALU_NOP                                , "copy from generated header");
      }
         
      INSTR(CE_COPY(GEN, R_OFST(3, -32), R_SIZE(3, -16))       , ALU_NOP                                , "copy from generated header");

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                   , "0: Copy 8B form GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                                                , "1: FEM=sys_hdr_size, JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: FEM=GEM.tos, Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                                  , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "3: FEM=fwd_hdr_offset, R1=sys_hdr_size");
      INSTR( CE_READ(GEN, R_OFST(2,24))                           , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "4: FEM=GEN.check_sum, R1=GEM.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: Copy from GEN (if necessary), R0=fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                          , "6: Copy from GEN (if necessary), R2=GEN.check_sum+GEM.tos");
      INSTR( CE_LREAD(PKT, R_OFST(0,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: FEM=PKT.tos, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))                   , "8: NOP");
      INSTR( CE_LREAD(GEN, R_OFST(3,24), LFEM_IS_LAG)             , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                            , "9: FEM=MSB(GEN.check_sum), MSB(1); R1 = R2-PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))            , ALU_NOP                                                     , "10:rsz=0");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)           , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "11:FEM=MSB(R1), MSB(3); R1 = R1+MSB(1)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)           , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "12:FEM=MSB(R2), MSB(2); R2 = R1");
      INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))           , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "13:R1 = R1-MSB(3)");
      INSTR( CE_COPY(GEN, R_OFST(3,-96), R_SIZE(SZ,-16))          , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "14:(MSB(2)==1)? R1=R2");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
      INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:(R1 == 0xFFFF)? R1=0 (rsz)");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "17:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy R1");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy gen IP header, byte2-byte9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "23:Cooy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "24:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");
  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }
  
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size=ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;  
      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_JER_OAMTS);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                   , "0: Copy 8B form GEN, Rsz=R3-R2");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                                                , "1: FEM=sys_hdr_size, JUMP if R0=0 (fall-back-to-bridging)");
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(SZ), CNST(20), REG_OP(SZ))                   , "2: FEM=GEM.tos, Rsz -= 20");
      INSTR( CE_LREAD(PKT, C_OFST((ftmh_size+2)<<1), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), 
                                                                  ALU_SUB(FEM, CNST(0), REG_OP(1))                              , "3: FEM=fwd_hdr_offset, R1=sys_hdr_size");
      INSTR( CE_READ(GEN, R_OFST(2,24))                           , ALU_SUB(FEM, CNST(0), REG_OP(1))                            , "4: FEM=GEN.check_sum, R1=GEM.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))                          , "5: Copy from GEN (if necessary), R0=fwd_hdr_offset+sys_hdr_size(R1)");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))           , ALU_ADD(FEM, REG_OP(1), REG_OP(2))                          , "6: Copy from GEN (if necessary), R2=GEN.check_sum+GEM.tos");
      INSTR( CE_LREAD(PKT, R_OFST(0,4), LFEM_8_LSBS)              , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))                      , "7: FEM=PKT.tos, R3=R2");
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))          , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))                   , "8: NOP");
      INSTR( CE_LREAD(GEN, R_OFST(3,24), LFEM_IS_LAG)             , ALU_SUB(REG_OP(2),FEM,REG_OP(1))                            , "9: FEM=MSB(GEN.check_sum), MSB(1); R1 = R2-PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))            , ALU_NOP                                                     , "10:rsz=0");
      INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_IS_LAG)           , ALU_ADD(REG_OP(1),FEM, REG_OP(1))                           , "11:FEM=MSB(R1), MSB(3); R1 = R1+MSB(1)");
      INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_IS_LAG)           , ALU_SUB(REG_OP(1),CNST(0x0),REG_OP(2))                      , "12:FEM=MSB(R2), MSB(2); R2 = R1");
      INSTR( CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))           , ALU_SUB(REG_OP(1),FEM,REG_OP(1))                            , "13:R1 = R1-MSB(3)");
      INSTR( CE_COPY(GEN, R_OFST(3,-96), R_SIZE(SZ,-16))          , ALU_SET_IF(FEM, EQ, CNST(0x1), REG_OP(2), REG_OP(1))        , "14:(MSB(2)==1)? R1=R2");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "15:NOP");
      INSTR( CE_NOP                                               , ALU_SET_IF(REG_OP(1),EQ,CNST(0xFFFF),ALU,REG_OP(1))         , "16:(R1 == 0xFFFF)? R1=0 (rsz)");
      INSTR( CE_NOP                                               , ALU_NOP                                                     , "17:NOP");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))              , ALU_NOP                                                     , "18:Copy R1");
      INSTR( CE_COPY(GEN, R_OFST(3, 20), C_SIZE(8))               , ALU_NOP                                                     , "19:Copy gen IP header, byte2-byte9");
      INSTR( CE_COPY(PKT, R_OFST(0, 4), C_SIZE(2))                , ALU_NOP                                                     , "20:Copy PKT.tos");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "21:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "22:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "23:Cooy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "24:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "25:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))            , ALU_NOP                                                     , "26:Copy GEN");
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))               , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                     , "27:Copy GEN");
  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }  

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
  
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PRESERVING_DSCP_IPV6_JER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
  
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SET(ftmh_size+2, REG_OP(0))              , "0: FEM=OAM_TS_PRESENT, R0=&PPH.fwd_header_offset");
      INSTR( CE_LREAD(PKT, C_OFST(12), LFEM_BIT_2)             , ALU_JMP_IF(REG_OP(0), EQ, REG_OP(SZ), BRANCH_PRESERVING_DSCP_BRIDGE, JUMP_POINT_PRESERVING_DSCP_BRIDGE)
                                                                                                              , "1: ---; JUMP if R0=0 (fall-back-to-bridging)" );
      INSTR( CE_NOP                                            , ALU_NOP                                      , "2: NOP");

      ftmh_size += ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE;
      INSTR( CE_NOP                                            , ALU_SET_IF(FEM, NEQ, REG_OP(SZ), CNST(ftmh_size+2), REG_OP(0))
                                                                                                              , "3: ---; if OAM_TS_PRESENT != 0 (Rsz), R0 += 6");
      INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))    , "4: extract sys hdr size; Rsz = R3-R2"                   );
      INSTR( CE_NOP                                            , ALU_NOP                                      , "5: NOP");
      INSTR( CE_LREAD(PKT, R_OFST(0,0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)
                                                               , ALU_SUB(FEM, CNST(0), REG_OP(1))             , "6: copy fwd header offset; store sys header size (fem) in R1 " );
      INSTR( CE_NOP                                            , ALU_SUB(REG_OP(SZ), CNST(10), REG_OP(SZ))    , "7: ---; rsz = rsz - 10"                        );
      INSTR( CE_NOP                                            , ALU_ADD(FEM, REG_OP(1), REG_OP(0))           , "8: copy gen hdr; R0 = fwd header offset(FEM) + system hdr size(R1)" );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))         , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))       , "9: copy gen hdr; R3 = R2"                               );
      INSTR( CE_LREAD(PKT, R_OFST(0, 4), LFEM_8_CENTRAL_BITS)  , ALU_SUB(REG_OP(2), CNST(0), REG_OP(3))       , "10:extract old TOS; ---"                                );
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,-8))        , ALU_NOP                                      , "11:copy gen hdr; ---"                                   );
      INSTR( CE_LREAD(GEN, R_OFST(2,4), LFEM_8_PERIPHERAL_BITS), ALU_SUB(FEM ,CNST(0),REG_OP(1))              , "12:extract new TOS; R1 = old TOS (FEM)"                 );
      INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-16))       , ALU_NOP                                      , "13:copy gen hdr; ---"                                   );
      INSTR( CE_NOP                                            , ALU_ADD(FEM ,REG_OP(1),REG_OP(1))            , "14:copy gen hdr; R1 = { Version, old TOS, Flow Label[19:16]");
      INSTR( CE_NOP                                            , ALU_NOP                                      , "15:copy gen hdr; ---"                                   );
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                      , "16:copy R1 (new TOS); ---"                              );
      INSTR( CE_NOP                                            , ALU_NOP                                      , "17: ---; ---"                              );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))      , "18: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))         , ALU_NOP                                      , "19: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))      , "20: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))         , ALU_NOP                                      , "21: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))      , "22: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))         , ALU_NOP                                      , "23: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))      , "24: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))         , ALU_NOP                                      , "25: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))            , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))      , "26: copy remaining generated header"                     );
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))         , ALU_NOP                                      , "27: copy remaining generated header"                     );
  
      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
  }

  if ((SOC_DPP_CONFIG(unit))->pp.routing_preserve_dscp) {
      /* IPMC fall-back-to-bridge */
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_PRESERVING_DSCP_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      
      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_PRESERVING_DSCP_BRIDGE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* Copied 8B already in the main branch */
      INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8) ) , ALU_SUB(REG_OP(3) , CNST(24)  , REG_OP(3)) , "Copy GEN; R3 -= 24");
      INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(3,-16)) , ALU_NOP                                    , "Copy GEN; ---");

      /* copy from generaterd header*/
      for(i=0; i<7; i++)
      {
          INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(3,0) ) , ALU_SUB(REG_OP(3) , CNST(16)  , REG_OP(3)) , "Copy R3 bytes from R3 offset; R3 -= 16");
          INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8)) , ALU_NOP                                    , "Copy R3-8 bytes from R3-16nibbles offset; ---");
      }
      
      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);      
  }

  /* Define Program instructions for bfd echo. if trap code = bcmRxTrapBfdEchoOverIpv4 swap dip and sip and set src.port=0xffff*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      /*uint32 branch_address;*/
      ARAD_SOC_REG_FIELD	dummy1, dummy2;
	  SOC_PPC_TRAP_CODE_INTERNAL	internal_trap_code=0;					                                                              
      res = arad_pp_trap_mgmt_trap_code_to_internal(unit, SOC_PPC_TRAP_CODE_BFD_ECHO, &internal_trap_code, &dummy1, &dummy2);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 9999, exit); 

      /* Start program instructions */
      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET) , ALU_SET(internal_trap_code, REG_OP(SZ))      , "Extract FWD_HEADER_OFFSET. sz=(trap code)");
      INSTR( CE_LREAD(PKT, R_OFST(3,0), LFEM_8_LSBS)     , ALU_NOP                                                                  , "Extract trap code");
      INSTR( CE_NOP                                      , ALU_SUB(FEM       , CNST(0)   , REG_OP(0))                               , "R0= FWD_HEADER_OFFSET");
      INSTR( CE_NOP                                      , ALU_JMP_IF(FEM, NEQ, REG_OP(SZ), BRANCH_BFD_ECHO, JUMP_POINT_BFD_ECHO)   , "Check if trap code = bcmRxTrapBfdEchoOverIpv4 if not jump");
      INSTR( CE_NOP                                      , ALU_SET(0xFFFF    , REG_OP(1))                                           , "R1=0xffff (src port)");
      INSTR( CE_NOP                                      , ALU_ADD(REG_OP(3) , REG_OP(0) , REG_OP(0))                               , "R0= FWD_HEADER_OFFSET + R3");
      INSTR( CE_NOP                                      , ALU_NOP                                                                  , "NOP");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , C_SIZE(6))     , ALU_SUB(REG_OP(0) , CNST(8)   , REG_OP(0))                               , "(no jump) Copy original header until UDP src port; R0 = R0 ? 8 (points end of dip)");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))     , ALU_NOP                                                                  , "Set src port");
      INSTR( CE_COPY(PKT, R_OFST(0,-8)  , C_SIZE(4))     , ALU_SUB(REG_OP(0) , CNST(8)   , REG_OP(0))                               , "Set Sip. R0=R0-8B (points start of sip)");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , C_SIZE(4))     , ALU_NOP                                                                  , "Set Dip");
      INSTR( CE_NOP                                      , ALU_SUB(REG_OP(0) , REG_OP(3) , REG_OP(SZ))                              , "SZ= R0-R3");
      INSTR( CE_NOP                                      , ALU_NOP                                                                  , "NOP");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , R_SIZE(SZ,0))  , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0))                               , "Copy original header R0 = R0 - 16");
      INSTR( CE_COPY(PKT, R_OFST(0,-16) , R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16)  , REG_OP(SZ))                              , "Copy generated header SZ = SZ - 16");
      INSTR( CE_NOP                                      , ALU_SET(0x00E3    , REG_OP(1))                                           , "R1= trap code = 0xe3");
      INSTR( CE_COPY(PKT, R_OFST(0,0)   , R_SIZE(SZ,0))  , ALU_SUB(REG_OP(0) , REG_OP(SZ), REG_OP(0))                               , "Copy original header R0 = R0 - SZ");
      INSTR( CE_COPY(PKT, R_OFST(0,-16) , R_SIZE(SZ,-8)) , ALU_NOP                                                                  , "Copy generated header SZ = SZ - 16");
      INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))     , ALU_SUB(REG_OP(0) , CNST(1)   , REG_OP(0))                               , "Set trap code = 0xe3 = R1 R0=R0-1");
      INSTR( CE_NOP                                      , ALU_NOP                                                                  , "NOP");
      /* copy from original header*/
	  for(i=0; i<2; i++)
	  {
          INSTR( CE_COPY(PKT, R_OFST(0,0), R_SIZE(0,0))      , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0))                               , "copy from original header");
          INSTR( CE_COPY(PKT, R_OFST(0,-16), R_SIZE(0,-8))   , ALU_NOP                                                                  , "copy from original header");
	  }

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* Jump instructions - program reaches here if trap code != echo */
      res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* copy from original header*/
	  for(i=0; i<7; i++)
	  {
          INSTR( CE_COPY(PKT, R_OFST(0,0)  , R_SIZE(0,0) ) , ALU_SUB(REG_OP(0) , CNST(16)  , REG_OP(0)) , "Copy R0 bytes from R0 offset; r0 -= 16");
          INSTR( CE_COPY(PKT, R_OFST(0,-16), R_SIZE(0,-8)) , ALU_NOP                                    , "Copy R0-8 bytes from R0-16nibbles offset; ---");
	  }

      res = arad_egr_prge_mgmt_build_branch_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      uint32 chan_fix_size = programs_usage[unit].bfd_chan_override * 2;

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_BFD_ACC_WA);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      i = 0;

      /* Calculate what needs to be copied and copy the modified bytes */
      i++; INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)        , ALU_NOP                                           , "FEM=NWK-Size ; ---");
      i++; INSTR( CE_NOP                                                    , ALU_NOP                                           , "NOP");
      i++; INSTR( CE_NOP                                                    , ALU_ADD( FEM, REG_OP(3), REG_OP(1) )              , "--- ; R1 = R3+FEM[==Sys+Nwk-HeadersSize]");
      i++; INSTR( CE_NOP                                                    , ALU_NOP                                           , "NOP");


      switch(SOC_DPP_CONFIG(unit)->pp.bfd_masked_flags_bitfield){
      case 0x2: /* Mask D Flag */
         {
          i++; INSTR( CE_LCOPY(PKT, R_OFST(1,4), C_SIZE(2), LFEM_ZERO_BIT1)     , ALU_SUB(REG_OP(1), CNST(chan_fix_size), REG_OP(1)), "Copy BFD 2MSBytes, with D-Flag cleared ; R1 -= 2 (maybe)");
          break;
         }
      case 0x8: /* Mask C Flag */
         {
          i++; INSTR( CE_LCOPY(PKT, R_OFST(1,4), C_SIZE(2), LFEM_ZERO_BIT3)     , ALU_SUB(REG_OP(1), CNST(chan_fix_size), REG_OP(1)), "Copy BFD 2MSBytes, with C-Flag cleared ; R1 -= 2 (maybe)");
          break;
         }
      default:
         {
          i++; INSTR( CE_COPY(PKT, R_OFST(1,4), C_SIZE(2))                      , ALU_SUB(REG_OP(1), CNST(chan_fix_size), REG_OP(1)), "Copy BFD 2MSBytes; R1 -= 2 (maybe)");
         }
      }

      if (programs_usage[unit].bfd_chan_override) {
          /* Due to HW bug in QAX, need to override the channel with constant value. */
          i++; INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))          , ALU_NOP                                           , "Copy channel from program var ; ---");
      }

      /* Copy the rest from original header*/
	  for(; i < ARAD_PP_EG_PROG_NOF_INSTR(unit)-1; i+=2)
	  {
          INSTR( CE_COPY(PKT, R_OFST(1,0)  , R_SIZE(1,0) ) , ALU_SUB(REG_OP(1) , CNST(16)  , REG_OP(1)) , "Copy R1 bytes from R1 offset; R1 -= 16");
          INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-8)) , ALU_NOP                                    , "Copy R1-8 bytes from R1-16nibbles offset; ---");
	  }


      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "l2_encap_pcp_dei_config_enable", 0) == 1)
        {
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(4))                                , ALU_NOP                              	, "Prepend EEDB[31:0]");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(8))                                 , ALU_NOP                               , "Prepend Program Vars[63:0]");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -8, C_SIZE(3))                               , ALU_NOP                               , "Prepend EEDB[55:32]");
            INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(3))                               , ALU_NOP                               , "Prepend Pp-port-vars [23:0]");
        }
        else
        {

            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))                                , ALU_NOP                              	, "Prepend EEDB[15:0]");
            INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4, LFEM_12_LSBS)							, ALU_NOP                			   	, "Extract EEDB[27:16] to FEM[11:0]");
            INSTR( CE_NOP                                                 						, ALU_NOP                               , "NOP");
            INSTR( CE_NOP                            											, ALU_SUB(FEM, CNST(0), REG_OP(0))   	, "FEM -> r0");
            INSTR( CE_LREAD(PKT, C_OFST(5), LFEM_FTMH_TC_AS_MSB)							 	, ALU_NOP                				, "Extract FTMH TC DP to FEM[14:15] FEM[15]=0");
            INSTR( CE_NOP                                                 						, ALU_NOP                               , "NOP");
            INSTR( CE_NOP                            											, ALU_ADD(FEM, REG_OP(0), REG_OP(0))   	, "FEM + r0 -> r0");
            INSTR( CE_NOP                                                 						, ALU_NOP                               , "NOP");
            INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                						, ALU_NOP                               , "write R0 to header");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(8))                                 , ALU_NOP                               , "Prepend Program Vars[63:0]");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, -8, C_SIZE(3))                               , ALU_NOP                               , "Prepend EEDB[55:32]");
            INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(3))                               , ALU_NOP                               , "Prepend Pp-port-vars [23:0]");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

  /* Define Program instructions for Copy Generated Headers + User Defined Headers*/
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      mem   = EPNI_PRGE_INSTRUCTION_0m-1;
      
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
          ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
      entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
      entry = entry_odd;

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      /* Prepare system headers size into R0 using Resolved fields                        */
      /* Need to reach 161 Nibbles from lsb of Resolved fields                            */
      /*   for that use 64B (=128 Nibbles) + 33                                           */
      /* Copy 0 bytes                                                                     */
      /*   size source 0 from offset + 0 bytes offset                                     */
      /* Use FEM to copy from the 32b (starting System-Headers-Size , EES-Data-1 ...)     */
      /* Need to map from the lsb the first 8 bits as is and the higher 8 maps constant 0 */
      
      /* instruction #0 */
      prge_instruction_tbl_data.src_select  = 2;    
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
      prge_instruction_tbl_data.offset_base = 33;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
      prge_instruction_tbl_data.size_base   = 0; /* size with no offset */
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
              mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
      prge_instruction_tbl_data.op_1_field_select     = 0;
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = 0;
      prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
      prge_instruction_tbl_data.dst_select  = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      /* instruction #1 */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* instruction #2 Set R0 with the System Header size calculated value from FEM result*/
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;    
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /* No FEM */
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD; /* FEM Resuls from 2 instructions before */
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;  /* Always*/
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0; /* R0 value is the system header size WITHOUT the UDH */
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      /* instruction #3 */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* definition of 18 instructions - copy Generated Headesr*/
      for( ++mem ; mem < EPNI_PRGE_INSTRUCTION_0m + 11; mem++)
      {
          /* instructions 4,6,8,10,12,14,16,18,20*/
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; /* R3 point to the start of the generated headers */
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST; /* The size to copy */
          prge_instruction_tbl_data.size_base   = 0; /* size with no offset */
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3; /* ALU Operation - Substract R3 by 16 */
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;  /* Perform ALU Always */
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          entry = (entry == entry_even) ? entry_odd : entry_even;
          
         /* instructions 5,7,9,11,13,15,17,19,21*/
          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.offset_base = 0xF0; /* Offset the base by the number of Nibbles (8Bytes = 16Nibbles) */
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;   
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0; /* No ALU Operation */
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }

      /* Copy the user defined from the Packet Header */
      entry = (entry == entry_even) ? entry_odd : entry_even;

      /* Instruction 22*/
      prge_instruction_tbl_data.src_select  = 0;
      /* Use System Headers size set to R0 from Inst #3 */
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* R0: All System Headers size. (FTMH + PPH) in Nibble and all possible extensions */
      prge_instruction_tbl_data.offset_base = 0x0 + user_header_size*2 ; /* Add additional 2 Bytes (4 Nibbeles) for User Header*/
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 0 + user_header_size;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = 0; /* No ALU Operation */
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = 0;
      prge_instruction_tbl_data.cmp_action  = 0;
      prge_instruction_tbl_data.dst_select  = 0;      
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /*  For this program set all other instructions to NULL */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

  } /* end of program to copy generated headers + user defined headers */

  /* Program Instructions for Full MyMac support in PRGE */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if ((SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) && (prog_used != -1)) {
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) { /* Support Full MyMAC in PRGE and Port Extender Type 2 (COE Support)*/
          sal_printf("Instruction ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER with COE type 2");
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 395, exit);

          INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS), ALU_SET(2, REG_OP(0)), "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
          INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ)), "RSZ=R3-12");

          INSTR(CE_NOP, ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), " R0 will be 2 if we are pushing coe tag, 0 otherwise");
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
          
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");

          for (i = 0; i < 4; i++) { /* each iteration copies up to 16 bytes */
              INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          }

          /* build port extender tag only if R0 == 2*/
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0)), ALU_NOP, "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
          INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0)), ALU_NOP, "Copy Program-Variable(2bytes) only if R0 == 2 ");

          /* build SA from pp/tm port vars */
          INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
          INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");

          /* copy DA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, ""); 

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 393, exit);
      } else { /* Support Full MyMAC in PRGE and NO Port Extender Type 2 (COE Support)*/

          sal_printf("Instruction ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER with MyMac no COE "); 
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_FULL_MYMAC_L3_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 385, exit);

          /* 0*/ INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ)), "0; ALU: RSZ=R3-12, calc Generated Header size - (Native Eth DA:SA size)");
          /* 1*/ INSTR(CE_NOP, ALU_NOP, "1: NOP");
          /* 2*/ INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
          /* 3*/ INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          /* 4*/ INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          /* 5*/ INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          /* 6*/ INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          /* 7*/ INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          /* 8*/ INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "8: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          /* 9*/ INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "9: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          /*10*/ INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "10: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
          /*11*/ INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "11: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");

          /* build SA from pp/tm port vars */
          INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
          INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");

          /* copy DA from generated header */
          /*18*/ INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6))								  , ALU_NOP, "18: Copy DA from Generated Header highst 6 Bytes");

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }
  }

  /*
   * ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER
   * Flavors (By order of instructions appearance in the following 'if' maze):
   *   PortExtender1
   *   SipLimitation + PortExtender1 
   *   PortExtender2
   *   SipLimitation
   *   Normal (Original Ethernet Copy program)
   *   MIM_VSI
   */
  if ((SOC_DPP_CONFIG(unit)->pp.mim_vsi_mode) == 0) {
  
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
          /*  Program 3 instructions (entries 6, 7 in each table) - Ethernet Copy */
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);

          if ((SOC_DPP_CONFIG(unit)->pp.bfd_extended_ipv4_src_ip) == 0) {

              /* Copy Headers with PortExtender1 */
              for(mem = EPNI_PRGE_INSTRUCTION_0m; mem < EPNI_PRGE_INSTRUCTION_0m + 8; mem++)
              {
                  entry = entry_even;
                  
                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
                  prge_instruction_tbl_data.op_value    = 16;
                  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                  prge_instruction_tbl_data.cmp_action  = 0x7;
                  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                  entry = entry_odd;
                  
                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0xF0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = 0;
                  prge_instruction_tbl_data.op_value    = 0;
                  prge_instruction_tbl_data.op_2_field_select     = 0;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = 0;
                  prge_instruction_tbl_data.cmp_action  = 0;
                  prge_instruction_tbl_data.dst_select  = 0;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
              }
              /* Instraction #18 NOP */
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

              /* Instraction #19 - Extract Resolved.Data.tm-port-var (1B)*/
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;

              prge_instruction_tbl_data.src_select  = 2;    
              prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, /* Odd Fem (19/2 = 9%2 = 1 */
                      mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
              SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
              prge_instruction_tbl_data.op_1_field_select = 0;
              prge_instruction_tbl_data.op_value          = 0;
              prge_instruction_tbl_data.op_2_field_select = 0;
              prge_instruction_tbl_data.alu_action        = 0;
              prge_instruction_tbl_data.op_3_field_select = 0;
              prge_instruction_tbl_data.cmp_action        = 0;
              prge_instruction_tbl_data.dst_select        = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

              /* Instraction #20 - NOP */
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

              /* Instraction #21 
               * ALU operation with LFEM op_value added dest to R_Size
               */
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
              prge_instruction_tbl_data.op_value          = 0;
              prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action        = 0x7; /* always */
              prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; /* R_Size */
              /* prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2; */
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

              /* Instraction #22 - NOP */
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 0;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = 0;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select = 0;
              prge_instruction_tbl_data.op_value          = 0;
              prge_instruction_tbl_data.op_2_field_select = 0;
              prge_instruction_tbl_data.alu_action        = 0;
              prge_instruction_tbl_data.op_3_field_select = 0;
              prge_instruction_tbl_data.cmp_action        = 0;
              prge_instruction_tbl_data.dst_select        = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              /* instruction #23
               * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
               */
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
              entry = (entry == entry_even) ? entry_odd : entry_even;
              prge_instruction_tbl_data.src_select  = 2;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
              prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - Resolved Data: out-PP-port */
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
              prge_instruction_tbl_data.size_base   = 0; 
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              /*  For this program set all other instructions to NULL */
              mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
          } else { 
              /* PP_COPY_HEADER with PortExtender1 + SIP limit WA */


              res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              /* 0*/ INSTR( CE_FLREAD( PrgeDataFieldProgVar, -8, LFEM_8_LSBS )           , ALU_SET( 0x0004, REG_OP(2))                                  , "extract prge var[35:32]; r2 = 4");
              /* 1*/ INSTR( CE_NOP                                                       , ALU_SET_IF( REG_OP(3), LT, CNST(4), REG_OP(3), REG_OP(2) )   , "--- ; r2 = (r3 < 4)? r3 : r2");
              /* 2*/ INSTR( CE_NOP                                                       , ALU_SUB( FEM, CNST(0), REG_OP(SZ) )                          , "--- ; rsz = fem");
              /* 3*/ INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_SUB( REG_OP(3), CNST(4), REG_OP(3) )                     , "try copy dip, size r2 ; r3 = r3-4");
              /* 4*/ INSTR( CE_NOP                                                       , ALU_SET( 0x0006, REG_OP(2))                                  , "--- ; r2 = 6");
              /* 5*/ INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET_IF( REG_OP(3), LT, CNST(6), REG_OP(3), REG_OP(2) )   , "extract ees_data1[3:0]; r2 = (r3 < 6)? r3 : r2");
              /* 6*/ INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET( 0x0000, REG_OP(0) )                                 , "extract ees_data1[3:0]; r0 = 0 ");
              /* 7*/ INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), REG_OP(2), REG_OP(0) )      , "--- ; r0 = (fem==rsz) ? r2 : r0");
              /* 8*/ INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), CNST(0), REG_OP(2) )        , "--- ; r2 = (fem==rsz) ? 0 : r2");
              /* 9*/ INSTR( CE_FLREAD( PrgeDataFieldTmPortVar, 0, LFEM_BIT_0)            , ALU_NOP                                                      , "Extract Resolved.Data.tm-port-var (1B)" );
              /* 10*/ INSTR( CE_FCOPY( PrgeDataFieldEesData1, -2, R_SIZE(0,0) )          , ALU_SUB( REG_OP(3), CNST(6), REG_OP(3) )                     , "try copy changed sip/checksum [55:8], size r0; r3 = r3-6");
              /*11*/ INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_SUB( FEM, CNST(0), REG_OP(SZ) )                          , "try copy from generated, size r2; ALU: RSZ = LFEM (tm-port-var value)");
              for (i = 0; i < 5; i++) {
                  /*12,14,16,18,20*/ INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "copy the remaining of enc and link layer");
                  /*13,15,17,19,21*/ INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(3,-8) )            , ALU_NOP                                                  , "copy the remaining of enc and link layer");
              }
       
              /*22*/ INSTR( CE_FCOPY( PrgeDataFieldOutPpPort, 0, R_SIZE(SZ,0) )          , ALU_NOP                                                      , "Copy Additional 1B based on the REG_SZ size");

              res = arad_egr_prge_mgmt_build_program_end(unit);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          }
      } /* system is configured with Port extender1 enhancement
           custom_feature_map_port_extr_enabled_[port]=1 */


      /* Add Port Extender Tag (PE-Tag)*/
	  else if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2) {
          sal_printf("Instruction ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER with COE type 2");
          res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
          SOC_SAND_CHECK_FUNC_RESULT(res, 395, exit);

          INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS), ALU_SET(2, REG_OP(0)), "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
          INSTR(CE_NOP, ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ)), "RSZ=R3-12");

          INSTR(CE_NOP, ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), " R0 will be 2 if we are pushing coe tag, 0 otherwise");
          INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, 0)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "2: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
          
          INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");

          for (i = 0; i < 4; i++) { /* each iteration copies up to 16 bytes */
              INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(SZ, -16)), ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)), "Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
              INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
          }

          /* build port extender tag only if R0 == 2*/
          INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0)), ALU_NOP, "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
          INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0)), ALU_NOP, "Copy Program-Variable(2bytes) only if R0 == 2 ");

          /* copy SA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, ""); 

          /* copy DA from generated header */
          INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, ""); 

          res = arad_egr_prge_mgmt_build_program_end(unit);
          SOC_SAND_CHECK_FUNC_RESULT(res, 393, exit);
      } else {

          /*  Program 3 instructions (entries 6, 7 in each table) - Ethernet Copy */
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);

          if ((SOC_DPP_CONFIG(unit)->pp.bfd_extended_ipv4_src_ip) == 0) {

              for (mem = EPNI_PRGE_INSTRUCTION_0m; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++) {
                  entry = entry_even;

                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
                  prge_instruction_tbl_data.op_value    = 16;
                  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                  prge_instruction_tbl_data.cmp_action  = 0x7;
                  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                  entry = entry_odd;

                  prge_instruction_tbl_data.src_select  = 1;
                  prge_instruction_tbl_data.offset_base = 0xF0;
                  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                  prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
                  prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? 0x18 : 0;
                  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                  prge_instruction_tbl_data.op_1_field_select     = 0;
                  prge_instruction_tbl_data.op_value    = 0;
                  prge_instruction_tbl_data.op_2_field_select     = 0;
                  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                  prge_instruction_tbl_data.op_3_field_select     = 0;
                  prge_instruction_tbl_data.cmp_action  = 0;
                  prge_instruction_tbl_data.dst_select  = 0;
                  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
              }

              /*  For this program set all other instructions to NOP */
              entry = entry_even;
              SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));

          }
          else {
              /* PP_COPY_HEADER with SIP limit WA */


              res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              /* 0*/ INSTR( CE_FLREAD( PrgeDataFieldProgVar, -8, LFEM_8_LSBS )           , ALU_SET( 0x0004, REG_OP(2))                                  , "extract prge var[35:32]; r2 = 4");
              /* 1*/ INSTR( CE_NOP                                                       , ALU_SET_IF( REG_OP(3), LT, CNST(4), REG_OP(3), REG_OP(2) )   , "--- ; r2 = (r3 < 4)? r3 : r2");
              /* 2*/ INSTR( CE_NOP                                                       , ALU_SUB( FEM, CNST(0), REG_OP(SZ) )                          , "--- ; rsz = fem");
              /* 3*/ INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_SUB( REG_OP(3), CNST(4), REG_OP(3) )                     , "try copy dip, size r2 ; r3 = r3-4");
              /* 4*/ INSTR( CE_NOP                                                       , ALU_SET( 0x0006, REG_OP(2))                                  , "--- ; r2 = 6");
              /* 5*/ INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET_IF( REG_OP(3), LT, CNST(6), REG_OP(3), REG_OP(2) )   , "extract ees_data1[3:0]; r2 = (r3 < 6)? r3 : r2");
              /* 6*/ INSTR( CE_FLREAD( PrgeDataFieldEesData1, 0, LFEM_8_LSBS )           , ALU_SET( 0x0000, REG_OP(0) )                                 , "extract ees_data1[3:0]; r0 = 0 ");
              /* 7*/ INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), REG_OP(2), REG_OP(0) )      , "--- ; r0 = (fem==rsz) ? r2 : r0");
              /* 8*/ INSTR( CE_NOP                                                       , ALU_SET_IF( FEM, EQ, REG_OP(SZ), CNST(0), REG_OP(2) )        , "--- ; r2 = (fem==rsz) ? 0 : r2");
              /* 9*/ INSTR( CE_FCOPY( PrgeDataFieldEesData1, -2, R_SIZE(0,0) )           , ALU_SUB( REG_OP(3), CNST(6), REG_OP(3) )                     , "try copy changed sip/checksum [55:8], size r0; r3 = r3-6");
              /*10*/ INSTR( CE_COPY( GEN, R_OFST(3,0), R_SIZE(2,0) )                     , ALU_NOP                                                      , "try copy from generated, size r2; -----");
              for (i = 0; i < 5; i++) {
                  /*11,13,15,17,19*/ INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "copy the remaining of enc and link layer");
                  /*12,14,16,18,20*/ INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(3,-8) )            , ALU_NOP                                                  , "copy the remaining of enc and link layer");
              }
              /*21*/ INSTR(CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))                , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "copy the remaining of enc and link layer");

              res = arad_egr_prge_mgmt_build_program_end(unit);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          }
      }
  }
  else {   /* mim_vsi_mode is enabled */

      /* Allocate branch */
      res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_PP_COPY_HEADER, &branch_pointer);
      SOC_SAND_IF_ERR_EXIT(res);

      /*  Program 3 instructions (entries 6, 7 in each table) - Ethernet Copy with MIM 32K ISID mode enabled*/
      mem = EPNI_PRGE_INSTRUCTION_0m;
      res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
          ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &program_pointer);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
      entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
      entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
      entry = entry_even;
      
      /* prepare system headers size */
      prge_instruction_tbl_data.src_select  = 2;
      prge_instruction_tbl_data.offset_base = 33;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value = 0;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* prepare PP port PRGE var (is port PBP) */
      entry = entry_odd;
      
      prge_instruction_tbl_data.src_select      = 2;
      prge_instruction_tbl_data.offset_base     = 45;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = 1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* SZ = system headers size */
      mem = EPNI_PRGE_INSTRUCTION_0m + 1;
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      entry = entry_odd;
      /* R1 = PP port PRGE var */
      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem = EPNI_PRGE_INSTRUCTION_0m + 2;
      
      /* prepare Vlan-Edit-command from FHEI */
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD,
              mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 35;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x0;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem = EPNI_PRGE_INSTRUCTION_0m + 3;

      /* branch if IVE-CMD-ID is either 62 or 63, to compare the IVE-CMD-ID to 62,and branch if the result is not negative.*/
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(branch_pointer, entry==entry_odd);
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
      
      if(soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mim_two_ive_reserved", 0)) {
         prge_instruction_tbl_data.cmp_action      = 0x6;
      }else{
         prge_instruction_tbl_data.cmp_action      = 0x2;
      }
        
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* R1 = R3 - R2 */
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      mem = EPNI_PRGE_INSTRUCTION_0m + 4;
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* R3 = R3-8 */  
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value        = 8;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* don't build 802.1ah header: copy generated header */
      for(mem = EPNI_PRGE_INSTRUCTION_0m + 5; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++) {
          
          entry = entry_even;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 11) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);      

          entry = entry_odd;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_base = (mem != EPNI_PRGE_INSTRUCTION_0m + 5) ? 0xF0 : 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +11) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = (mem != EPNI_PRGE_INSTRUCTION_0m + 5 && mem < EPNI_PRGE_INSTRUCTION_0m +11) ? 0x18 : 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);       
      }

      /*  For this program set all other instructions to NOP */
      entry = entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

      /* build 802.1ah header */
      /* copy R1 bytes from offset R3 */
      mem = EPNI_PRGE_INSTRUCTION_0m + 4;
      entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
      entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
      entry = entry_odd;

      for (i=0; i<9; ++i) {
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base = i == 0 ? 0 : entry == 35 ? 0 : 0xF0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.size_base   = entry == 35 ? 0x18 : 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = entry == 35 ? ARAD_PP_PRGE_ENG_OP1_REG_R3 : ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value    = 16;
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action  = 0x7;
        prge_instruction_tbl_data.dst_select  = entry == 35 ? ARAD_PP_PRGE_ENG_DST_REG_R3 : ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }

      /* take 2 bytes from FHEI.Edit-VID-1 + PCP-1 + DEI-1 */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 2;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* take 1 byte from FHEI.Edit-VID-2 */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;
      prge_instruction_tbl_data.offset_base = 0xF9;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 1;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* copy remainder of header */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0xFA;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0x1D;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
      prge_instruction_tbl_data.op_value    = 19;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0xEA;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0x15;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /*  For this program set all other instructions to NULL */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, 34, 35) );
  }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COE_ITMH_COPY_HEADER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS) ,ALU_SET(2, REG_OP(0))                          ,"For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
        INSTR(CE_NOP                                            ,ALU_NOP                                        ,"NOP");
        INSTR(CE_NOP                                            ,ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0))," R0 will be 2 if we are pushing coe tag, 0 otherwise");
        INSTR(CE_NOP                                            ,ALU_NOP                                        ,"NOP");

        INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0)) ,ALU_NOP                                        ,"Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0)) ,ALU_NOP                                        ,"Copy Program-Variable(2bytes) only if R0 == 2 ");  

        INSTR(CE_NOP                                            ,ALU_ADD(REG_OP(3), CNST(user_header_size), REG_OP(SZ)) ,"Point to start of MAC address");        
        INSTR(CE_NOP                                            ,ALU_NOP                                        ,"NOP");
        INSTR(CE_COPY(PKT, R_OFST(SZ,24), C_SIZE(8))            ,ALU_NOP                                        ,"Copy DMAC+SMAC[5~4]");
        INSTR(CE_COPY(PKT, R_OFST(SZ,8), C_SIZE(4))             ,ALU_NOP                                        ,"Copy SMAC[3~0]");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
    }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;
      
            /* Instruction 0 : extract sys header size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 33;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 1 : extract DA 2LSB*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                      
            
            /* Instruction 2 : extract DA 2LSB, as [3:0]set to 0x0, r0=fem-5*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 8;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : -, r2=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            /* Instruction 4 : extract eei [19:16], rsz=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 5 : extract eei [23:16], r1=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 6 : --, rsz=fem+rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 10;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7 : --, r0=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 8 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9 : Copy generated header, r2 = (r0 > 15) ? rsz : r2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 0xf0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
            prge_instruction_tbl_data.cmp_action = 4 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 11 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 12 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 13 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 14 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 15 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 16 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17: Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 18: Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 19: copy r2 (DA 2 LSbyte), ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 51;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 20: copy DA 4 MSbytes*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 8;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  For this program set all other instructions to NOP */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {

      res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_TM_TRAFFIC_REMOVE_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      INSTR( CE_NOP , ALU_SUB(REG_OP(3), CNST(user_header_size), REG_OP(0)) , "--- ; Decrease UHD size from generated header size (R0 = R3 - user_header_size)");
      INSTR( CE_NOP , ALU_NOP                                               , "NOP");

      /* PP-Copy */
      INSTR( CE_NOP , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))               , "--- ; R0 -= 16 (Prepare for PP-Copy loop with seperate size register)");
      for (i = 0; i < 10; i++) {
          INSTR( CE_COPY( GEN, R_OFST(3, 0) , R_SIZE(0, 0) )     , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))  , "copy the remaining of enc and link layer");
          INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(0, 8) )     , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))  , "copy the remaining of enc and link layer");
      }

      res = arad_egr_prge_mgmt_build_program_end(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

  }

  /*  Program 4 instructions (entries 8, 9 in each table) - XGS_PE_FROM_FRC_LITE */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
  
    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;

    /*  Instruction 0 : Store PPD 4 line in r0 without FEM, r2 = 91 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 20;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 1 : Store PPD 4 line in r1 with FEM, rsz = 93 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 20;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 93;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 2 : Extract PPD type, r0 = line 4 without fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 3 : Extract DSP , r1 = line 4 with fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 4 : Extract rep_id , r2 = (ppd != 2) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 12;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 2;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 5 : Extract CUD , r2 = (dsp != 255) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 57;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 6 : --- , r0 = rep_id */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 7 : Copy last line of PPD , r1 = CUD */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 8 : Extract DSP , r2 = 91 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 9 : Copy 3 line of PPD, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 16;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 10 : Store 1 line of PPD without FEM, r2 = (dsp != 255) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 8;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 11 : Store 1 line of PPD with FEM, r2 = 91 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 8;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 12 : Copy 2 line of PPD, r0 = 1 line no fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 13 : Extract PPD type, r1 = 1 line with fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 14 : Extract DSP, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 15 : Extract TC, r2 = (ppd != 0) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 5;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 16 : ---, r2 = (dsp != 255) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 17 : Take MC bit, r0 = TC */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 18;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 18 : Copy 1 line of PPD, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 19 : Copy 4 line of FRC, r0 = {MC, 1'b0, TC} */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 20 : Copy 3 line of FRC, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 43;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 21 : Copy 2 line of FRC, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 17;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 22 : Copy 1 line of FRC, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 59;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  For this program set all other instructions to NOP */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

    /*  Program 5 instructions (entries 10, 11 in each table) -  2_HOP_SCHEDULING */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        /* Allocate branch */
        res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_2_HOP_SCHEDULING, &branch_pointer);
        SOC_SAND_IF_ERR_EXIT(res);

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /*  Instruction 0 : check CUD lsb , R3 = 0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolved data */
        prge_instruction_tbl_data.offset_base     = 57; /* CUD */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Jump if CUD is odd */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(branch_pointer, entry==entry_odd);
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 0x4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : take TC from ITMH to FEM result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4; /* +4 */ /* LSB of the ITMH */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* start of ITMH */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : r3=TC */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* instructions if CUD was odd */

        /*  Instruction 6 : take Flow-ID from EEDB to FEM result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolve data */
        prge_instruction_tbl_data.offset_base     = 27; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 7 : r2 = 8'b00001110 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 14;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : r3 = r3 + Flow-ID */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 11 : copy r3 (16b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 12 : copy r2 (8b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 13 : copy outlif 16 lsb from EEDB result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 31; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 14 : take outlif msb from EEDB result to FEM*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 27; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 15 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 16 : {12 MSBs of original ITMH, 4'b1010} to FEM, r3=out-lif msb */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4; /* +4 */ /* LSB of the ITMH */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* start of ITMH */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 17 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
               
        /*  Instruction 18 : r3 = r3 + {12 MSBs of original ITMH, 4'b1010} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 19 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 20 : copy r3 (16b) to packet header (rest of ITMH) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 21 : Source system port for PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; /* Resolved-Data */
        /* 128-data-mem, 556-resolve-data-width, 0-offset to source-system-port lsb, 64*2 - minus offset source (in bytes) */
        prge_instruction_tbl_data.offset_base     = ((128 + 556 - 0)/4) - 64*2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 22 : 8'b0 for MSB of the PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 49; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


        /* Jump instructions - program reaches here if CUD was even */

        mem   = EPNI_PRGE_INSTRUCTION_3m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
        entry = entry_odd;

        /*  Instruction 6 : take Flow-ID from EEDB to FEM result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolve data */
        prge_instruction_tbl_data.offset_base     = 20; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 7 : r2 = 8'b00001110 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 14;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : r3 = r3 + Flow-ID */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 11 : copy r3 (16b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 12 : copy r2 (8b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 13 : copy outlif 16 lsb from EEDB result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 24; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 14 : take outlif msb from EEDB result to FEM*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 20; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*  Instruction 15 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 16 : {12 MSBs of original ITMH, 4'b1010} to FEM, r3=out-lif msb */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4; /* +4 */ /* LSB of the ITMH */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* start of ITMH */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 17 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                                      
        /*  Instruction 18 : r3 = r3 + {12 MSBs of original ITMH, 4'b1010} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 19 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 20 : copy r3 (16b) to packet header (rest of ITMH) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 21 : Source system port for PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; /* Resolved-Data */
        /* 128-data-mem, 556-resolve-data-width, 0-offset to source-system-port lsb, 64*2 - minus offset source (in bytes) */
        prge_instruction_tbl_data.offset_base     = ((128 + 556 - 0)/4) - 64*2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 22 : 8'b0 for MSB of the PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 49; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill the rest of the instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


    } 

    /*  Program 5 instructions (entries 10, 11 in each table) - ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /*  Instruction 0 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : Copy generated header, r0 = 0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 6 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 7 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : add PPD */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 11 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 12 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 13 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 14 : Copy 4 line of FRC (dp from ftmh) , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 15 : Extract TC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 16 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 17 : Take MC bit, r1 = TC */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0xfb00;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 18 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 19 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 20 : Copy 3 line of FRC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 21 : Copy 2 line of FRC (Dest System Port), --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 22 : Copy 1 line of FRC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  For this program set all other instructions to NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /*  Instruction 10 : add PPD */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 11 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 12 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 13 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 14 : Copy 4 line of FRC (dp from ftmh) , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 15 : Extract TC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_TM, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 16 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 17 : Take MC bit, r1 = TC */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0xfb00;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 18 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 19 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 20 : Copy 3 line of FRC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 21 : Copy 2 line of FRC (Dest System Port), --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 22 : Copy 1 line of FRC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  For this program set all other instructions to NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    /* customer application that connect to NP */
    if(programs_usage[unit].customer_conn_to_np_enable) {
        
        if (customer_conn_to_np_debug) {
            /*
             * Debug program:
             * Add R0/R1/R2/R3 in front of packet without removing any header
             */
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
            CONN_TO_NP_DEBUG_PROG(ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL);
        } else {
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
            
                INSTR( CE_COPY(PKT,  C_OFST(17),     C_SIZE(2))                     ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy Outlif from FTMH, R0 = R3 + 4");
                INSTR( CE_LCOPY(PKT, C_OFST(13),     C_SIZE(0), LFEM_3_LSBS)        ,ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: R1 = FEM + R1");                   
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM) ,ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy tag number to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-7]: Set DS mode");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-8]: R0 = FEM + R0");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -6, C_SIZE(1), LFEM_NPH_SLOT_OUT) ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-9]: Get slot_out from data entry, R1 = R3 - 2");
            
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_NOP                        ,"[Inst-10]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");
            
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-11]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1, -12, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-12]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(0, REG_OP(1))        ,"[Inst-13]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]: Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]: copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]: copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]: main type and sub type");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPWS_LAG);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                INSTR( CE_COPY(PKT,  C_OFST(17),     C_SIZE(2))                     ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy Outlif from FTMH, R0 = R3 + 4");
                INSTR( CE_LCOPY(PKT, C_OFST(13),     C_SIZE(0), LFEM_3_LSBS)        ,ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC),ALU_ADD(FEM, CNST(0), REG_OP(0)) ,"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)) ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -6, C_SIZE(1))              ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-8]: Get slot_out from data entry, R1 = R3 - 2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN)   ,ALU_NOP                      ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(0, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-16]: main type and sub type");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]: Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]: copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]: copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-23]: Set Main Type and sub Type.");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2,      0, C_SIZE(2))             ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            /*
             * Program for: VPLS
             */
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)) ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_COPY(RES,  C_OFST(128+55),     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                
                INSTR( CE_LCOPY(RES, C_OFST(128+25), C_SIZE(1), LFEM_NPH_SLOT_OUT)  ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1)) ,"[Inst-8]: Get slot_out from data entry, R1 = R3 - 2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");

                /* Got PPH.VSI for Ulei_Port(13)
                 * PPH.Base offset: ftmh_size + 10
                 */
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_COPY (RES, C_OFST(128+19), C_SIZE(1))                     ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
            
                /* construct XTMH
                 *  Instruction  --- CE to extract flow_id from data-format entry
                 *               --- CE to extract FTMH.TC and FTMH.DP
                 */
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-26]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_LAG);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;

                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -6, C_SIZE(1))             ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-8]: Get slot_out from data entry, R1 = R3 - 2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-16]:main type and sub type");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-23]: Set Main Type and sub Type.");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2,      0, C_SIZE(2))             ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }


            /*
             * Program for: VPLS Multicast
             */
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPLS_MC);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;

                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE_MC),ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_COPY(RES,  C_OFST(128+55),     C_SIZE(2))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-8]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_SET(0 , REG_OP(1))         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, Set R0 = 0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for VPN ID(13)");
                if (customer_ftmh_lb_extension_add) {
                    fld_val = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + 1;
                    INSTR( CE_COPY(PKT, C_OFST((fld_val<<1)), C_SIZE(1))            ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Got LB key as Hash ID(4)");
                } else {
                    INSTR( CE_COPY(RES, C_OFST(128+55), C_SIZE(1))                  ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Hash ID(4) to 0");
                }
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_MC) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0] to form MC_ID");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");

                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11), C_SIZE(2), LFEM_XTMH_DP_MC)    ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_MPLS);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }

                /* extract from PPH.Base[31:24] */
                INSTR( CE_LCOPY(PKT, C_OFST(32),     C_SIZE(0), LFEM_8_LSBS)        ,ALU_SET(0x0004, REG_OP(0))             ,"[Inst-0]: Get PPH.Base[31:24], set ");
                INSTR( CE_COPY(PKT,  R_OFST(3,8),    C_SIZE(0))                     ,ALU_NOP                                ,"[Inst-1]: Get user_header_1 16LSB");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-2]: RSZ = PPH.Base[31:24]");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: R0 = user_header_1 16LSB");

                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_NOP                         ,"[Inst-4]: NOP");
                INSTR( CE_NOP                                                       ,ALU_SET_IF(REG_OP(SZ), EQ, CNST(0xA5), REG_OP(1), REG_OP(0))   , "[Inst-5]: If CPU injected pkt, copy OAM content from user header");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(3))       ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                      ,ALU_NOP                                ,"[Inst-7]: Add NPH 16LSB.");

                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_SET(0, REG_OP(2))                  ,"[Inst-8]: copy FTMH.TC and FTMH.DP");                
                INSTR( CE_LCOPY(RES, C_OFST(128+25), C_SIZE(1), LFEM_NPH_SLOT_OUT)  ,ALU_NOP                                ,"[Inst-9]: Get slot_out from data entry, R1 = R3 - 2");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN)   ,ALU_NOP                      ,"[Inst-10]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");
                /* optional */
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-11]: Got PPH.VSI for Ulei_Port(13)");
                INSTR( CE_COPY (RES, C_OFST(128+19), C_SIZE(1))                     ,ALU_SUB(FEM, CNST(user_header_size), REG_OP(0))       ,"[Inst-12]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(3, REG_OP(1))        ,"[Inst-13]: NOP");

                
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SET_IF(REG_OP(SZ), EQ, CNST(0xA5), REG_OP(2), REG_OP(0)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(1), LFEM_NPH_TAG_NUM) ,ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-15]: Get tag_num from FHEI.IVE-CMD[3:2]");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))                      ,ALU_NOP                                ,"[Inst-18]: test");

                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(3), REG_OP(2))     ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");

                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }
            
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -5, C_SIZE(0), LFEM_2_LSBS) ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Get lsp_ecmp_fp.1MSB to FEM, R0 = R3 + 4");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -10, C_SIZE(0), LFEM_8_LSBS),ALU_NOP                                ,"[Inst-1]: Get lsp_ecmp_en to fem on bit7");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM, R1=lsp_ecmp_fp.1MSB");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R2 = lsp_ecmp_en");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -6, C_SIZE(0), LFEM_NPH_SLOT_OUT),ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy NextHopIndex or lsp_ecmp_fp.16 LSB from data-entry");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1,  -1,   C_SIZE(2))            ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode and lsp_ecmp_fp.1MSB, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-8]: Get slot_out from data entry, R2 = FEM + R2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-10]: Copy slot_out+[emcp_en]");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_ADD(FEM, CNST(0), REG_OP(2)),"[Inst-11]: Got VRF, R2=forwarding_header_offset");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -12, C_SIZE(1))              ,ALU_NOP                                ,"[Inst-12]: Get port_out from data-entrys");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(2, REG_OP(1))        ,"[Inst-13]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                        ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }

                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3VPN_LAG);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -5, C_SIZE(0), LFEM_2_LSBS) ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Get lsp_ecmp_fp.1MSB to FEM, R0 = R3 + 4");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -10, C_SIZE(0), LFEM_8_LSBS),ALU_NOP                                ,"[Inst-1]: Get lsp_ecmp_en to fem on bit7");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM, R1=lsp_ecmp_fp.1MSB");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R2 = lsp_ecmp_en");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -6, C_SIZE(0), LFEM_NPH_SLOT_OUT),ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy NextHopIndex or lsp_ecmp_fp.16 LSB from data-entry");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1,  -1,   C_SIZE(2))            ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode and lsp_ecmp_fp.1MSB, R0 = FEM + R0");
                INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                      ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-8]: Get slot_out from data entry, R2 = FEM + R2");

                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN),ALU_NOP                         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar,  -6, C_SIZE(1))             ,ALU_NOP                                ,"[Inst-10]: Copy slot_out+[emcp_en]");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_ADD(FEM, CNST(0), REG_OP(2)),"[Inst-11]: Got VRF, R2=forwarding_header_offset");
                INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(1))              ,ALU_NOP                                ,"[Inst-12]: Get port_out from data-entrys");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(2, REG_OP(1))        ,"[Inst-13]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                        ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldPpPortVar, 0, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }

                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }


            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_VPN_BRIDGE);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
                if (customer_ftmh_dsp_extension_add) {
                    ftmh_size += 2;
                }
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
            
                INSTR( CE_FCOPY(PrgeDataFieldEesData1,  -1,   C_SIZE(2))            ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy NextHopIndex from data-entry 0, R0 = R3 + 4");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE)   ,ALU_NOP                                ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(8), REG_OP(0)),"[Inst-4]: Put FEM to R0 and set B_F flag");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-5]: R1 = FEM + R1");                   
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM) ,ALU_ADD(FEM, CNST(0), REG_OP(SZ)) ,"[Inst-6]: Copy tag number to FEM");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0,     C_SIZE(1))                 ,ALU_NOP                                ,"[Inst-7]: Set DS mode");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-8]: R0 = FEM + R0");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -6, C_SIZE(1), LFEM_NPH_SLOT_OUT) ,ALU_SUB(REG_OP(3), CNST(2), REG_OP(1))  ,"[Inst-9]: Get slot_out from data entry, R1 = R3 - 2");
            
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_NOP                        ,"[Inst-10]: Get PPH-Base.Forwarding-Header-Offset's to FEM, R0 = R3 - 8");
            
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -6, C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                            ,"[Inst-11]: Got Ulei_Port(13) from data entry");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -12, C_SIZE(1))              ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-12]: Get port_out from data-entry, R2=PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_LAG) ,ALU_SET(0, REG_OP(1))        ,"[Inst-13]: Set R1=NPH.SubType, Get MainType");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size+16), REG_OP(2)), "[Inst-14]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-15]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-16]: Get output_FP[15:0], R2=R2+vlan_status");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB) ,ALU_NOP                       ,"[Inst-17]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-18]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData2, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, REG_OP(SZ), REG_OP(2))    ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
                
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from PP port Var for LAG Dest");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP)   ,ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
            
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }


            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_L3MC);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;

                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE_MC),ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_COPY(RES,  C_OFST(128+55),     C_SIZE(2))                 ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-8]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_SET(0 , REG_OP(1))         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, Set R0 = 0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for VPN ID(13)");
                if (customer_ftmh_lb_extension_add) {
                    fld_val = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + 1;
                    INSTR( CE_COPY(PKT, C_OFST((fld_val<<1)), C_SIZE(1))            ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Got LB key as Hash ID(4)");
                } else {
                    INSTR( CE_COPY(RES, C_OFST(128+55), C_SIZE(1))                  ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Hash ID(4) to 0");
                }
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_MC) ,ALU_SET(1, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_COPY(RES,  C_OFST(128+29), C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0] to form MC_ID");
                INSTR( CE_LCOPY(RES, C_OFST(128+31), C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                              ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_COPY(RES,  C_OFST(128+51), C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");

                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP_MC)   ,ALU_NOP                             ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
            
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE;
                
                INSTR( CE_COPY(PKT,  C_OFST(fld_val<<1),     C_SIZE(2))             ,ALU_ADD(REG_OP(3), CNST(4), REG_OP(0)) ,"[Inst-0]: Copy InLIF[15-0] from PPH.base, R0 = R3 + 4");
                fld_val = fld_val - 2;
                INSTR( CE_LCOPY(PKT, C_OFST(fld_val<<1),     C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-1]: Copy InLIF.[16] to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_H_S)       ,ALU_NOP                                ,"[Inst-2]: Copy H/S and R/L from LIF-extension to FEM");
                INSTR( CE_LCOPY(PKT, R_OFST(0,0),    C_SIZE(0), LFEM_NPH_DS_MODE_MC),ALU_ADD(FEM, CNST(0), REG_OP(1))       ,"[Inst-3]: Copy InLIF.extension[1-0] to FEM, R1 = FEM");
                INSTR( CE_LCOPY(PKT, C_OFST(5),      C_SIZE(0), LFEM_OTMH_BASE_EXTRACT_TC) ,ALU_ADD(FEM, CNST(0), REG_OP(0)),"[Inst-4]: Put FEM to R0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_TAG_NUM),ALU_ADD(FEM, REG_OP(1), REG_OP(1)),"[Inst-5]: Copy tag number to FEM, R1 = FEM + R1");                   
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(SZ))      ,"[Inst-6]: NOP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(2))                     ,ALU_ADD(FEM, REG_OP(0), REG_OP(0))     ,"[Inst-7]: Set DS mode, R0 = FEM + R0");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-8]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+4), C_SIZE(0), LFEM_NPH_DEL_LEN) ,ALU_SET(0 , REG_OP(1))         ,"[Inst-9]: Get PPH-Base.Forwarding-Header-Offset's to FEM, Set R0 = 0");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+10), C_SIZE(2), LFEM_NPH_PPH_VSI),ALU_NOP                        ,"[Inst-10]: Got PPH.VSI for VPN ID(13)");
                if (customer_ftmh_lb_extension_add) {
                    fld_val = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + 1;
                    INSTR( CE_COPY(PKT, C_OFST((fld_val<<1)), C_SIZE(1))            ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Got LB key as Hash ID(4)");
                } else {
                    INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1))                  ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-11]: Hash ID(4) to 0");
                }
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(0), LFEM_NPH_MAIN_TYPE_MC) ,ALU_SET(3, REG_OP(1))        ,"[Inst-12]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST((ftmh_size<<1)+16), C_SIZE(0), LFEM_NPH_VLAN_STATUS),ALU_SUB(REG_OP(2), CNST(user_header_size), REG_OP(2)), "[Inst-13]: Form VLAN status from FHEI.IVE-CMD[1:0], R2=R2-user_header_size");
                INSTR( CE_FCOPY(PrgeDataFieldR0,  0,     C_SIZE(1))                 ,ALU_ADD(FEM, REG_OP(1), REG_OP(1))     ,"[Inst-14]: Set tag number and H/S + R/L flag");
                INSTR( CE_FCOPY(PrgeDataFieldEesData1, -2, C_SIZE(2))               ,ALU_ADD(FEM, REG_OP(2), REG_OP(2))     ,"[Inst-15]: Get output_FP[15:0] to form MC_ID");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, 0, C_SIZE(1), LFEM_NPH_PS_OUTFP_MSB),ALU_NOP                        ,"[Inst-16]: Get PS and Output_FP MSB");
                INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))                      ,ALU_NOP                                ,"[Inst-17]:Form VLAN status from FHEI.IVE-CMD[1:0] and filled Del_len with PPH-Base.Forwarding-Header-Offset");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-18]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(9),      C_SIZE(2), LFEM_NPH_SLOT_IN)   ,ALU_NOP                                ,"[Inst-19]:copy FTMH.SSP-agg to form [Slot_in + trunk flag + LogicPortIn]");
                INSTR( CE_FLCOPY(PrgeDataFieldEesData1, -8, C_SIZE(0), LFEM_STACKING_8) ,ALU_NOP                            ,"[Inst-20]: copy FTMH.TC to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-21]: NOP");
                INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(1), LFEM_NPH_COS_COLOR) ,ALU_ADD(FEM, CNST(0), REG_OP(2))       ,"[Inst-22]:copy FTMH.TC and FTMH.DP");
                INSTR( CE_FCOPY(PrgeDataFieldR1,  0, C_SIZE(1))                     ,ALU_NOP                                ,"[Inst-23]:main type and sub type");
            
                if (!customer_disable_xtmh) {
                    INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                  ,ALU_NOP                                ,"[Inst-24]: Copy flow id from EES-Data-1");
                    INSTR( CE_LCOPY(PKT, C_OFST(11),     C_SIZE(2), LFEM_XTMH_DP_MC),ALU_NOP                                ,"[Inst-25]: Copy FTMH.TC[2] + FTMH.DP[1:0] to form XTMH.DP");
                }
                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }

            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL, &prog_used);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            if (prog_used != -1) {
                res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_CONN_TO_NP_LSP_P2MP_LOCAL);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
                
                ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE;
            
                if (customer_ftmh_lb_extension_add) {
                    ftmh_size += 1;
                }
                fld_val = ftmh_size;

                INSTR( CE_LCOPY(PKT, C_OFST((fld_val<<1)+1), C_SIZE(0), LFEM_2_LSBS),ALU_NOP                                ,"[Inst-0]: Put FHEI size to FEM");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-1]: NOP");
                INSTR( CE_NOP                                                       ,ALU_ADD(FEM, CNST(0), REG_OP(0))       ,"[Inst-2]: R0=FHEI value");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-3]: NOP");
                INSTR( CE_NOP                                                       ,ALU_ADD(REG_OP(0), REG_OP(0), REG_OP(0)),"[Inst-4]: FHEI_size=FHEI_value*2 + 1 for MPLS");
                INSTR( CE_NOP                                                       ,ALU_SET(0x0800, REG_OP(2))             ,"[Inst-5]: NOP");
                fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + user_header_size + 1;
                INSTR( CE_NOP                                                       ,ALU_ADD(REG_OP(0), CNST(fld_val), REG_OP(1)),"[Inst-6]: R1=offet of DMAC");
                INSTR( CE_NOP                                                       ,ALU_NOP                                ,"[Inst-7]: Set Etype to R0");

                INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))                      ,ALU_NOP                                ,"[Inst-8]: Copy Etype");
                /*copy DMAC + SMAC + VLAN-tag(16 Bytes)*/                
                INSTR( CE_COPY(PKT,  R_OFST(1,32), C_SIZE(8))                       ,ALU_SET(0x80, REG_OP(2))               ,"[Inst-9]: copy packet");
                INSTR( CE_COPY(PKT,  R_OFST(1,16), C_SIZE(8))                       ,ALU_NOP                                ,"[Inst-10]: copy packet");

                /*build PTCH to carry SSP*/
                INSTR( CE_LCOPY(PKT, C_OFST(9), C_SIZE(1), LFEM_NPH_SLOT_IN)        ,ALU_NOP                                ,"[Inst-10]: copy packet");
                INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))                      ,ALU_NOP                                ,"[Inst-8]: Copy Etype");                
                res = arad_egr_prge_mgmt_build_program_end(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);
            }
        }

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
        
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_CUSTOMER_NPH_MC_RCY);
            SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
        
            INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS), ALU_NOP                                           , "0: FEM = SysHdrSize                                       ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "1: NOP                                                    ");
            INSTR( CE_LREAD(PKT, C_OFST(13), LFEM_NPH_PS_FROM_CUD)   , ALU_ADD(FEM, CNST(user_header_size+16), REG_OP(3)), "2: FEM = {FTMH[31]:FTMH[22:20]} ({ps[2:0], output_fp[16]}), R3 points to end of NPH");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "3: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_SUB(FEM, CNST(0), REG_OP(0))                  , "4: R0 = FEM                                               ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "5: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "6: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "7: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "8: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "9: NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "10:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "11:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "12:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "13:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "14:NOP                                                    ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "15:NOP                                                    ");
            INSTR( CE_LREAD(PKT, R_OFST(3, -20), LFEM_12_MSBS)       , ALU_NOP                                           , "16:FEM = {NPH[95:84], 4'b0}                               ");
            INSTR( CE_LREAD(PKT, R_OFST(3, -30), LFEM_7_LSBS)        , ALU_NOP                                           , "17:FEM = NPH[126:120]                                     ");
            INSTR( CE_COPY(PKT, R_OFST(3,0), C_SIZE(8))              , ALU_ADD(FEM, REG_OP(0), REG_OP(1))                , "18:Copy NPH[63:0], R1=R0+FEM (NPH[95:80])                 ");
            INSTR( CE_COPY(PKT, C_OFST(17), C_SIZE(2))               , ALU_SUB(FEM, CNST(0), REG_OP(2))                  , "19:Copy FTMH[19:4] (output_fp[15:0]), R2 = FEM            ");
            INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))           , ALU_NOP                                           , "20:Cpoy R1                                                ");
            INSTR( CE_COPY(PKT, R_OFST(3,-24), C_SIZE(3))            , ALU_ADD(REG_OP(2), CNST(8), REG_OP(2))            , "21:Copy NPH[119:86], R2 += 8 (set bit 3)                  ");
            INSTR( CE_NOP                                            , ALU_NOP                                           , "22:NOP                                                    ");
            INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1))           , ALU_NOP                                           , "23:Copy R2                                                ");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
        }
    }


    /*  Program 5 instructions (entries 10, 11 in each table) - ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        
        /* Instruction 0 : extract sys header size*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 33;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 1 : extract DA 2LSB*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 2 : extract DA 2LSB, as [3:0]set to 0x0, r0=fem-5*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 8;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 3 : extract FTMH.DP, r2=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 4 : extract eei [19:16], rsz=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 5 : extract eei [23:16], r1=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 6 : --, rsz=fem+rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 10;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 7 : --, r0=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 16;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        /* Instruction 8 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 9 : Copy generated header, r2 = (r0 > 15) ? rsz : r2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 0xf0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
        prge_instruction_tbl_data.cmp_action = 4 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 10 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 11 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 12 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 13 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 14 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 15 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 16 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 17: copy r2 (DA 2 LSbyte), ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 18: copy DA 4 MSbytes*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 19: copy PPD from program var*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 20: copy DP from r1 FRC line 4*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 21: copy src sys port FRC line 3*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 22: copy dest sys port FRC line 2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 23: copy TC FRC line 1*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  For this program set all other instructions to NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }




    for (is_1588 =0 ; is_1588 <=1 ; ++is_1588  ) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP; 
        uint32 tod_msb_add_enable = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,
                                                                "oam_dm_tod_msb_add_enable",
                                                                SOC_IS_JERICHO_PLUS_AND_BELOW(unit)); /* Unnecessary as a default on QAX*/
        uint32 tod_msb_add_size = tod_msb_add_enable ? 4 : 0 ;
        /* Program 6 instructions (entries 12, 13 in each table) - OAM_TOD_STAMP_OAM_TS_EXT - NTP DM Down Rx*/
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            predefined_data_e tod_field = (is_1588 == 1) ? PrgeDataFieldTod1588 : PrgeDataFieldTodNtp;
            
            res = arad_egr_prge_mgmt_build_program_start(unit, prog_index);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*01*/INSTR( CE_NOP                                             , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                                  , "---                                          ; R0 = R3-R2 -> PPH size" );
            /*02*/INSTR( CE_FCOPY(tod_field, -8, C_SIZE(tod_msb_add_size))   , ALU_NOP                                                                   , "Copy ToD NTP [63:32]                         ; ---" );
            /*03*/INSTR( CE_COPY(PKT, R_OFST(3, 0),R_SIZE(0, -7))           , ALU_NOP                                                                   , "Copy PPH eei and learn                       ; ---" );
            /*04*/INSTR( CE_READ(PKT, R_OFST(2, 4))                         , ALU_NOP                                                                   , "Read PPH fwrd_offset+pkt_ctrl                ; ---" );
            /*05*/INSTR( CE_COPY(PKT, R_OFST(3, -16),R_SIZE(0, -15))        , ALU_NOP                                                                   , "Copy PPH FHEI (if any)                       ; ---" );
            /*06*/INSTR( CE_NOP                                             , ALU_ADD(FEM, CNST((tod_msb_add_size - user_header_size)<< 1), REG_OP(3))  , "---                                          ; Recalculate the pph fwrd offset 0 -> R0 = FEM - ((tod_msb_add_size -  user_header_size) << 1)" );
            /*07*/INSTR( CE_COPY(PKT, R_OFST(2, 14),C_SIZE(5))                , ALU_NOP                                                                   , "Copy PPH base 5 last bytes , nop for pph     ; ---" );
            /*08*/INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))            , ALU_NOP                                                                   , "Copy PPH base fwrd offset + pkt_ctrl         ; ---" );
            /*09*/INSTR( CE_COPY(PKT, R_OFST(2, 2), C_SIZE(1))                , ALU_NOP                                                                   , "Copy PPH base first byte                     ; ---" );
            /*10*/INSTR( CE_COPY(PKT, R_OFST(1, 12), C_SIZE(6))               , ALU_NOP                                                                   , "Copy OAM TS                                  ; ---" );
            /*11*/INSTR( CE_COPY(PKT, R_OFST(1, 0), R_SIZE(1, -6))          , ALU_NOP                                                                   , "Copy LSB of FTMH                             ; ---" );
            /*12*/INSTR( CE_COPY(PKT, C_OFST(12), C_SIZE(6))                , ALU_NOP                                                                   , "Copy MSB of FTMH stamp pph_type = 3          ; ---" );
            
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
    }

	/* Program 6 instructions (entries 12, 13 in each table) - OAM_TOD_STAMP_OAM_TS_EXT - NTP - UP_RX*/
    for (is_1588=0 ; is_1588 <=1 ; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP;
        uint32 tod_msb_add_enable = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE,
                                                                "oam_dm_tod_msb_add_enable",
                                                                SOC_IS_JERICHO_PLUS_AND_BELOW(unit)); /* Unnecessary as a default on QAX*/
        uint32 tod_msb_add_size = tod_msb_add_enable ? 4 : 0 ;
        int tod_field = (is_1588 == 1) ? PrgeDataFieldTod1588 : PrgeDataFieldTodNtp;

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, prog_index, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {

            res = arad_egr_prge_mgmt_build_program_start(unit, prog_index);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Too many LFEMs to manage automatically */
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            if (!soc_petrab_cfg) {

                /* Instr 0-7 : PP-Copy */
                for (i = 0; i < 4; i++) {                                                                                                                   /* for ( i = 0; i < 4; i++ ) { */
                    INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                                        , "PP-Copy with R3; R3 -= 16");
                    INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                                , ALU_NOP                                                                           , "PP-Copy with R3");
                }                                                                                                                                            /* } */
                /*08*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SET( (0x1700|((tod_msb_add_size+14+user_header_size)<<1)) , REG_OP(1))      , "PP-Copy with R3; R1 = PPH 2MSB with FWD-Offset=14+user_header_size");
                /*09*/INSTR( CE_FCOPY(tod_field, -8, C_SIZE(tod_msb_add_size))                  , ALU_NOP                                                                               , "Copy ToD NTP [63:32] and insert it in the begining of the header");
                /*10*/INSTR( CE_READ(GEN, C_OFST(14*2))                                         , ALU_SET( (0x1700|((tod_msb_add_size+18+user_header_size)<<1)) , REG_OP(2))        , "Read offset 14 of candidate ; R2 = PPH 2MSB with FWD-Offset=18+user_header_size");
                /*11*/INSTR( CE_READ(GEN, C_OFST(18*2))                                         , ALU_SET( (0x1700|((tod_msb_add_size+22+user_header_size)<<1)) , REG_OP(0))        , "Read offset 18 of candidate ; R0 = PPH 2MSB with FWD-Offset=22+user_header_size");
                /*12*/INSTR( CE_COPY(GEN, C_OFST(0), C_SIZE(user_header_size))                  , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(1), REG_OP(0))                               , "Copy UDH [=user_header_size'd0] ; if (offset 14 == 0x8902) R0 = R1");
                /*13*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(2), REG_OP(0))                               , "Copy FHEI LSB (Trap-Code) ; if (offset 18 == 0x8902) R0 = R2");
                /*14*/INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                      , ALU_NOP                                                                               , "Copy FHEI MSB (OAM-ID) ; ---");
                /*15*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                                                       , "Copy PPH 5LSB ; R1 = FTMH-Size");
                /*16*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                                               , "Copy PPH 2MSB");

                /* Build OAM-TS and FTMH */
                /*17*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                                         , "Set OAM TS offset = 0 , ---");  /*the offset src?!?!*/
                if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) || !SOC_IS_JERICHO(unit)) {
                    /*18*/INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                                        , ALU_NOP                                                                         , "Copy  OAM ToD LSB , ---");
                    /* 19 - Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte*/
                    if (is_1588 == 1) {
                        if (SOC_IS_ARADPLUS(unit)) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD)               , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                    } else {
                        INSTR(CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP)            , ALU_NOP, "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                    }
                    /*20*/INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                                  , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                    /*21*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH)              , ALU_NOP                                                 , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                } else {
                    if (ftmh_size == 9) {
                        /*18*/INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                        /*19*/INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                        /*20*/INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        /*21*/INSTR( CE_FCOPY(tod_field, 0, C_SIZE(2))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                        /*22*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*23*/INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*24*/INSTR( CE_FCOPY(tod_field, -4, C_SIZE(2))                 , ALU_NOP                                                   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        /*25*/
                        if (is_1588 == 1) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                   , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                        /*26*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(3))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                        /*27*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    } else if (ftmh_size == 10) {
                        /*18*/INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                        /*19*/INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                        /*20*/INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        /*21*/INSTR( CE_FCOPY(tod_field, 0, C_SIZE(3))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                        /*22*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*23*/INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*24*/INSTR( CE_FCOPY(tod_field, -6, C_SIZE(1))                 , ALU_NOP                                                   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        /*25*/
                        if (is_1588 == 1) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                   , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                        /*26*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(4))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                        /*27*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    } else if (ftmh_size == 11) {
                        /*18*/INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                        /*19*/INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                        /*20*/INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                        /*21*/INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                        /*22*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*23*/INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*24*/
                        if (is_1588 == 1) {
                            INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                   , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        } else {
                            INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                        }
                        /*25*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(5))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                        /*26*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    } else if (ftmh_size == 12) {
                         /*18*/INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                         /*19*/INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(0))                                , "Set TPID");
                         /*20*/INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                         /*21*/INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                  , ALU_NOP                                                   , "Copy  OAM ToD LSB , ---");
                         /*21*/
                         if (is_1588 == 1) {
                             INSTR( CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP                  , "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                         } else {
                             INSTR( CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP), ALU_NOP                              , "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                         }
                         /*22*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                         /*23*/INSTR( CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0)) , ALU_NOP                                                   , "Copy TPID(2bytes) only if R0 == 2 ");
                         /*24*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(6))      , ALU_NOP                                                   , "Copy LSB of FTMH , ---");
                         /*25*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH) , ALU_NOP                                           , "Copy MSB of FTMH stamp pph_type = 3 , ---");
                    }
                }
            } else {
                /*
                 * Petra-B FTMH with Arad PPH mode
                 */

                INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(2), CNST(4), REG_OP(2))                  , "Increase R2 to point to the PPH msb");
                INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(1), CNST(2), REG_OP(1))                  , "Increase R1 to point to the Stacking lsb");
                INSTR(CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI), ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))         , "Extract FHEI size , r0 = r3-r2 (pph size)");
                INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)  , ALU_NOP                                         , "Extract FHEI size");
                INSTR( CE_NOP                                                                   , ALU_SUB(REG_OP(0), FEM, REG_OP(0))                      , "--- , r0 -= fem [== (r3-r2)-FheiSize]");
                INSTR( CE_NOP                                                                   , ALU_ADD(FEM, REG_OP(3), REG_OP(SZ))                     , "--- , rsz = r3 + PPH.FwdHeaderOffset");
                /* (to push ToD) if tod_msb_add_enable 4 MSB of TOD between packet and internal headers*/
                INSTR( CE_FCOPY(tod_field, -8, C_SIZE(tod_msb_add_size))                        , ALU_NOP                                                 , "Copy ToD NTP [63:32] and insert it in the begining of the header");
                INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(0,-7))                                  , ALU_SET(0x8902, REG_OP(0))                              , "Copy PPH eei and learn;  r0= 0x8902");
                INSTR( CE_READ(PKT, R_OFST(SZ,28))                                              , ALU_SET((tod_msb_add_enable? 0x34 :0x2c), REG_OP(SZ))   , "Extract Eth type(first attempt 12-13 byte), set rsz=8+14, shifted with 1 bit left - 0x2c;");
                INSTR( CE_READ(PKT, R_OFST(SZ,36))                                              , ALU_NOP                                                 , "Extract Eth type(second attempt 17-18 byte);");
                INSTR( CE_NOP                                                                   , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(tod_msb_add_enable? 0x24 : 0x1c), REG_OP(SZ)), "--- , rsz = (fem == 0x8902) ? 14 : rsz;");
                INSTR( CE_FREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0)                            , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(tod_msb_add_enable? 0x2c : 0x24), REG_OP(SZ)), "Extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;");
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(1))                            , ALU_NOP                                                 , "Create new FHEI, trap code0xe8 , nop for pph");
                INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                            , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))                     , "Create new FHEI - trap qualifier,  recalculate the pph fwrd offset r3=fem+rsz");
                INSTR( CE_COPY(PKT, R_OFST(2,14), C_SIZE(5))                                    , ALU_NOP                                                 , "Copy PPH base 5 last bytes ,");
                /*here - copy for frwd offset+pkt_ctrl, as fwrd is increased +14 +num-tag*4*/
                INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))                                  , ALU_NOP                                                 , "Copy PPH base fwrd offset =pkt_ctrl");
                INSTR( CE_LCOPY(PKT, R_OFST(2,2), C_SIZE(1), LFEM_OAM_TS_CCM_FHEI)              , ALU_NOP                                                 , "Copy PPH base first byte , ---");
                /* System headers mode should be Arad-PPH with Petra FTMH */
                INSTR(CE_COPY(PKT, R_OFST(2,0), C_SIZE(2))                                      , ALU_NOP                                                 , "Copy Petra-B EEP");
                /* Build OAM-TS and FTMH */
                INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                 , "Set OAM TS offset = 0 , ---");  /*the offset src?!?!*/
                INSTR( CE_FCOPY(tod_field, 0, C_SIZE(4))                                        , ALU_NOP                                                 , "Copy  OAM ToD LSB , ---");
                /* Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte*/
                if (is_1588 == 1) {
                    if (SOC_IS_ARADPLUS(unit)) {
                        INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_APLUS)         , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                    } else {
                        INSTR(CE_FLCOPY(PrgeDataFieldTod1588, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD)               , ALU_NOP, "Extract bits [33:32] of 1588_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                    }
                } else {
                    INSTR(CE_FLCOPY(PrgeDataFieldTodNtp, -8, C_SIZE(1), LFEM_OAM_TS_EXTRACT_TOD_NTP)            , ALU_NOP, "Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, copy the fem result as OAM last MSbyte");
                }
                INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                                  , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB), ALU_NOP, "Copy MSB of FTMH stamp pph_type = 3 , ---");

            }

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }
    }
    
    /* Program 6 instructions (entries 12, 13 in each table) - OAM_COUNTER_STAMP_OAM_TS_EXT - LM Up Rx*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (!soc_petrab_cfg) {
            /* Instr 0-7 : PP-Copy */
            for (i = 0; i < 4; i++) {                                                                                                                   /* for ( i = 0; i < 4; i++ ) { */
                INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                , "PP-Copy with R3; R3 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                                , ALU_NOP                                                   , "PP-Copy with R3");
            }                                                                                                                                            /* } */
            /*08*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                             , ALU_SET( (0x1700|((14+user_header_size)<<1)) , REG_OP(1)) , "PP-Copy with R3; R1 = PPH 2MSB with FWD-Offset=14+user_header_size");
            /*09*/INSTR( CE_READ(GEN, C_OFST(14*2))                                         , ALU_SET( (0x1700|((18+user_header_size)<<1)) , REG_OP(2)) , "Read offset 14 of candidate ; R2 = PPH 2MSB with FWD-Offset=18+user_header_size");
            /*10*/INSTR( CE_READ(GEN, C_OFST(18*2))                                         , ALU_SET( (0x1700|((22+user_header_size)<<1)) , REG_OP(0)) , "Read offset 18 of candidate ; R0 = PPH 2MSB with FWD-Offset=22+user_header_size");
            /*11*/INSTR( CE_COPY(GEN, C_OFST(0), C_SIZE(user_header_size))                      , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(1), REG_OP(0))   , "Copy UDH [=user_header_size'd0]; ---");
            /*12*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(1))                      , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(2), REG_OP(0))   , "Copy FHEI LSB (Trap-Code) ; if (offset 14 == 0x8902) R0 = R1");
            /*13*/INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                      , ALU_NOP                                                   , "Copy FHEI MSB (OAM-ID) ; if (offset 18 == 0x8902) R0 = R2");
            /*14*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))                   , ALU_SET(ftmh_size, REG_OP(1))                             , "Copy PPH 5LSB ; R1 = FTMH-Size");
            /*15*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                            , ALU_NOP                                                   , "Copy PPH 2MSB");
            /*16*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                      , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  /*the offset src?!?!*/

            if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) || !SOC_IS_JERICHO(unit)) {
                /*17*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                /*18*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                /*19*/INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                /*20*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH)        , ALU_NOP                                                 , "Copy MSB of FTMH stamp pph_type = 3 , ---");
            } else {
                if (ftmh_size == 9) {
                    /*17*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(2))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    /*18*/INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    /*19*/INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    /*20*/INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    /*21*/INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    /*22*/INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    /*23*/INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    /*24*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, -4, C_SIZE(2))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    /*25*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    /*26*/INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                } else if (ftmh_size == 10) {
                    /*17*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(3))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    /*18*/INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    /*19*/INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    /*20*/INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    /*21*/INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    /*22*/INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    /*23*/INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    /*24*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, -6, C_SIZE(1))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    /*25*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    /*26*/INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                } else if (ftmh_size == 11) {
                    /*17*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    /*18*/INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    /*19*/INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    /*20*/INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    /*21*/INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    /*22*/INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    /*23*/INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    /*24*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    /*25*/INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                } else if (ftmh_size == 12) {
                    /*17*/INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))               , ALU_NOP                                                 , "Copy  OAM counter ,");
                    /*18*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                       , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
                    /*19*/INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)     , ALU_SET(2, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    /*20*/INSTR(CE_NOP                                                , ALU_SET(0x8100, REG_OP(0))                          , "");
                    /*21*/INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    /*22*/INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                    /*23*/INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                    /*24*/INSTR(CE_FCOPY(PrgeDataFieldR0,        0, R_SIZE(SZ, 0))    , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                    /*25*/INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                            , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
                }
                /*17/26/27*/INSTR( CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_OAM_TS_STAMP_PPH)        , ALU_NOP                                                 , "Copy MSB of FTMH stamp pph_type = 3 , ---");
            }

            /* Add XGS MAC extend header */
            if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) && (SOC_DPP_CONFIG(unit)->pp.xgs_port_exists) && SOC_IS_JERICHO(unit)) {
                /*21*/INSTR(CE_FLREAD(PrgeDataFieldPpPortVar, 0, LFEM_2_LSBS)     , ALU_SET(8, REG_OP(SZ))                              , "For port Ex. Extract Resolved.Data.tm-port-var, RSZ=8");
                /*22*/INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                /*23*/INSTR(CE_NOP                                                , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))   , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                /*24*/INSTR(CE_NOP                                                , ALU_NOP                                             , "");
                /*25*/INSTR(CE_COPY(RES, C_OFST(47+128), R_SIZE(SZ, 0))           , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if RSZ == 8 ");
                /*26*/INSTR(CE_COPY(RES, C_OFST(45),     R_SIZE(SZ, 0))           , ALU_NOP                                             , "Copy TPID(2bytes) only if RSZ == 8 ");
            }            
        }
        else {
            /*
             * Petra-B FTMH with Arad PPH mode
             */

            INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(2), CNST(4), REG_OP(2))                  , "Increase R2 to point to the PPH msb");
            INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(1), CNST(2), REG_OP(1))                  , "Increase R1 to point to the Stacking lsb");
            INSTR( CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI), ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))        , "Extract FHEI size , r0 = r3-r2 (pph size)");
            INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)  , ALU_NOP                                         , "extract PPH.FwdHdrOffset , ---");
            INSTR( CE_NOP                                                                   , ALU_SUB(REG_OP(0), FEM, REG_OP(0))                      , "---; r0 -= fem [== r3-r2-FheiSize]");
            INSTR( CE_NOP                                                                   , ALU_ADD(REG_OP(3), FEM, REG_OP(SZ))                     , "---; rsz = r3+fem");
            INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(0,-7))                                  , ALU_SET(0x8902, REG_OP(0))                              , "Copy PPH eei and learn;  r0= 0x8902");
            INSTR( CE_READ(PKT, R_OFST(SZ,28))                                              , ALU_SET(0x2c, REG_OP(SZ))                               , "Extract Eth type(first attempt bytes 12-13), set rsz=8+14, shifted with 1 bit left - 0x2c;");
            INSTR( CE_READ(PKT, R_OFST(SZ,36))                                              , ALU_NOP                                                 , "Extract Eth type(second attempt bytes 16-17);");
            INSTR( CE_NOP                                                                   , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(28), REG_OP(SZ))    , "--- , rsz = (fem == 0x8902) ? 14 : rsz;");
            INSTR( CE_FREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0)                                    , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(36), REG_OP(SZ))    , "Extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -4, C_SIZE(1))                            , ALU_NOP                                                 , "Create FHEI trap code;");
            INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                            , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))                     , "Create new FHEI - trap qualifier,  recalculate the pph fwrd offset r3=fem+rsz");
            INSTR( CE_COPY(PKT, R_OFST(2,14), C_SIZE(5))                                    , ALU_NOP                                                 , "Copy PPH base 5 last bytes ,");
            /*here - copy for frwd offset+pkt_ctrl, as fwrd is increased +14 +num-tag*4*/
            INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))                                  , ALU_NOP                                                 , "Copy PPH base fwrd offset =pkt_ctrl");
            INSTR( CE_LCOPY(PKT, R_OFST(2,2), C_SIZE(1), LFEM_OAM_TS_CCM_FHEI)              , ALU_NOP                                                 , "Copy PPH base first byte , ---");
            /* System headers mode should be Arad-PPH with Petra FTMH */
            INSTR(CE_COPY(PKT, R_OFST(2,0), C_SIZE(2))                                      , ALU_NOP                                                 , "Copy Petra-B EEP");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(1))                            , ALU_NOP                                                 , "Set OAM TS offset = 0 ,");  /*the offset src?!?!*/
            INSTR( CE_FCOPY(PrgeDataFieldOamCounterValue, 0, C_SIZE(4))                     , ALU_NOP                                                 , "Copy  OAM counter ,");
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                             , ALU_NOP                                                 , "Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - take 0x0c from program var LSbyte");
            INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-6))                                  , ALU_NOP                                                 , "Copy LSB of FTMH , ---");
            INSTR(CE_LCOPY(PKT, C_OFST(12), C_SIZE(6), LFEM_STAMP_EXCLUDE_SRC_FOR_OAM_TS_PRESENT_PB), ALU_NOP                                         , "Copy MSB of FTMH stamp pph_type = 3 , ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }
	
    /*  Program ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD_OVER_OUTER_FTMH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_FCOPY(PrgeDataFieldOutLif, 0, C_SIZE(2))  , ALU_NOP   , "Copy CUD (OutLIF)");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }


  /*  Program 7 instructions (entries 14, 15, 36, 37 in each table) - TDM_STAMP_CUD */
  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
    /*if (tdm_petra_std | tdm_petra_opt)*/

    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;

    if (soc_petrab_cfg)
    {
        /*  Instruction 0 : Copy CUD, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : take FTMH [15:14], r0 = CUD */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = /*tdm_petra_std ? 16 : 4*/4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 2/2 = 1%2 = 1 --> odd lfem */
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : ---, r0 = r0 + FEM */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 6 : Copy new FTMH, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 7 : Copy new FTMH, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = /*tdm_petra_std ? 6 : 0*/0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (tdm_arad_opt)
    {
        /*  Instruction 0 : Copy CUD, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : Copy left FTMH, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (tdm_arad_std)
    {
        /*  Instruction 0 : Extract FTMH [3:0], --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 18;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Extract CUD [11:0], r0 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : Extract FTMH [31:20], --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 13;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : ---, r0 = r0 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : Extract CUD [15:12], r1 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 54;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 5/2 = 2%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 6 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 7 :---, r1 = r1 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : Copy {r1, r0} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : Copy left FTMH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 10;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 5;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  }

    /*  Program 8 instructions (entries 16, 17 in each table) - ETH_WITH_LLID_TAG */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m -1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /* extract ees_data2 first nibble (PLUS); r3 = r3 - 12 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:2);
        prge_instruction_tbl_data.offset_base     = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:ARAD_PP_PRGE_EES_DATA2);
        prge_instruction_tbl_data.offset_src      = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:ARAD_PP_PRGE_ENG_OFFSET_CONST_64);
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        }
        else {
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        }
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 12;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_ARADPLUS(unit)) {
            /* r2 = fem */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        for(i=0; i<6; i++)
        {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 24;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 8; /* -16+24; */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        /* Copy LLID */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 29:(ARAD_PP_PRGE_EES_DATA2 - 1));
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? ARAD_PP_PRGE_ENG_SIZE_CONST:ARAD_PP_PRGE_ENG_SIZE_REG_R2);
        prge_instruction_tbl_data.size_base       = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 4:0);
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Copy SA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 24;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Copy DA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
   }
  
    /* Program instructions (entries 8, 9 in each table) - XGS_MAC_EXT_AND_SPAN */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
        
        /* Instruction 0 : nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 1 : extract DA 2LSB*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 2 : nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 3 : extract FTMH.DP,*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 4 :nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 5 : --, r1=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        for (i=6; i<19; i++){
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 0 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 
        }       
        
        /* Instruction 19: copy PPD from program var*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 20: copy DP from r1 FRC line 4*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 21: copy src sys port FRC line 3*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 22: copy dest sys port FRC line 2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 23: copy TC FRC line 1*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /*  Program 9 instructions (entries 18, 19 in each table) - IPV6_TUNNEL_PROGRAM */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
    
        /* Instruction 0 : Extract DIP-PTR, rsz = r3 - r0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 29;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 1 : Extract SIP-MSB-PTR, r2 = r3 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 27;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R3;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 : ---, indirect_addr = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 3 : ---, indirect_addr = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 4 : Copy frwd header, rsz = rsz - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 5 : Copy frwd header, r2 = r2 - 24 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 24;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 6 : Copy frwd header, r3 = r3 - 2 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xE0; /* -32*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 2;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 7 : Copy frwd header, ind_addr = r1 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R1;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 8 : Copy frwd header, r3 = r3 - r0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0x10; /* -16 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 9 : Extract system headers size, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 33;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        /* Instruction 9/2 = 4%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 10 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 11 : Extract FTMH size, r3 = r3 - fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH,
                mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 12 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 16;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 13 : Extract network headers size, r3 = r3 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 35;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        /* Instruction 13/2 = 6%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 14 : Copy SIP-LSB, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 25;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 15 : ---, r3 = r3 - fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 16 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 17 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 20;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 18 : Copy payload length, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 19 : Copy first 4B, r0 = r0 - 2  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 2;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 20 : Copy Eth-Type, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 123;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 21 : Copy Ethernet header, r0 = r0 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 22 : Copy Ethernet header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 23 : Copy Ethernet header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  
    /*  Program 10 instructions (entries 20, 21 in each table) - OAM CCM */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {

            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            if (!soc_petrab_cfg) {
                /* Instr 0-7 : PP-Copy */
                for (i = 0; i < 4; i++) {                                                                                                    /* for ( i = 0; i < 4; i++ ) { */
                    INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                   , ALU_SUB( REG_OP(3) , CNST(16) , REG_OP(3))                , "PP-Copy with R3; R3 -= 16");
                    INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                , ALU_NOP                                                   , "PP-Copy with R3");
                }                                                                                                                            /* } */
                /*08*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))             , ALU_SET( (0x1700|((14+user_header_size)<<1)) , REG_OP(1)) , "PP-Copy with R3; R1 = PPH 2MSB with FWD-Offset=14+user_header_size");
                /*09*/INSTR( CE_READ(GEN, C_OFST(14*2))                         , ALU_SET( (0x1700|((18+user_header_size)<<1)) , REG_OP(2)) , "Read offset 14 of candidate ; R2 = PPH 2MSB with FWD-Offset=18+user_header_size");
                /*10*/INSTR( CE_READ(GEN, C_OFST(18*2))                         , ALU_SET( (0x1700|((22+user_header_size)<<1)) , REG_OP(0)) , "Read offset 18 of candidate ; R0 = PPH 2MSB with FWD-Offset=22+user_header_size");
                /*11*/INSTR( CE_COPY(GEN, C_OFST(0), C_SIZE(user_header_size))  , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(1), REG_OP(0))   , "Copy UDH [=user_header_size'd0]; if (offset 14 == 0x8902) R0 = R1");
                /*12*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))       , ALU_SET_IF(FEM, EQ, CNST(0x8902), REG_OP(2), REG_OP(0))   , "Copy FHEI LSB (Trap-Code) ; if (offset 18 == 0x8902) R0 = R2");
                /*13*/INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))      , ALU_NOP                                                   , "Copy FHEI MSB (OAM-ID) ; ---");
                if (((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) != 2) || !SOC_IS_JERICHO(unit)) {
                    /*14*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))   , ALU_SET(ftmh_size, REG_OP(3))                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                    /*15*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))            , ALU_NOP                                                   , "Copy PPH 2MSB");
                    /*16*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB( REG_OP(3), CNST(16), REG_OP(3))                  , "TM-Copy FTMH");
                    /*17*/INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                   , "TM-Copy FTMH");
                    /*18*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_NOP                                                   , "TM-Copy FTMH");
                } else {
                    /*14*/INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)  , ALU_SET(2, REG_OP(SZ))                                    , "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
                    /*15*/INSTR( CE_NOP                                             , ALU_SET(0x8100, REG_OP(1))                                , "Set TPID");
                    /*16*/INSTR( CE_NOP                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(SZ))         , " R0 will be 2 if we are pushing coe tag, 0 otherwise");
                    if (ftmh_size == 9) {
                        /*17*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(4))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        /*18*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*19*/INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*20*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+3)), C_SIZE(1))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        /*21*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        /*22*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        /*23*/INSTR( CE_COPY(PKT, C_OFST(2), C_SIZE(1))                   , ALU_NOP                                             , "TM-Copy FTMH");
                    } else if (ftmh_size == 10) {
                        /*17*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        /*18*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*19*/INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*20*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        /*21*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        /*22*/INSTR( CE_COPY(PKT, C_OFST(4), C_SIZE(2))                   , ALU_NOP                                             , "TM-Copy FTMH");
                    } else if (ftmh_size == 11) {
                        /*17*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        /*20*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        /*18*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*19*/INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*20*/INSTR( CE_FCOPY(PrgeDataFieldR0, -2, C_SIZE(1))             , ALU_NOP                                             , "Copy PPH 2MSB");
                        /*21*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        /*22*/INSTR( CE_COPY(PKT, C_OFST(6), C_SIZE(3))                   , ALU_NOP                                             , "TM-Copy FTMH");                       
                    } else if (ftmh_size == 12) {
                        /*20*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))              , ALU_NOP                                             , "Copy PPH 2MSB");
                        /*17*/INSTR( CE_COPY(PKT, C_OFST(2*(ftmh_size+7)), C_SIZE(5))     , ALU_NOP                                             , "Copy PPH 5LSB ; R3 = FTMH-Size");
                        /*18*/INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
                        /*19*/INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(SZ, 0))   , ALU_NOP                                             , "Copy TPID(2bytes) only if R0 == 2 ");
                        /*21*/INSTR( CE_COPY(PKT, C_OFST(ftmh_size<<1), C_SIZE(8))        , ALU_NOP                                             , "TM-Copy FTMH");
                        /*22*/INSTR( CE_COPY(PKT, C_OFST(8), C_SIZE(4))                   , ALU_NOP                                             , "TM-Copy FTMH");
                    }
                }
            }
            else {
                /*
                 * Petra-B FTMH with Arad PPH mode
                 */

                /*-2*/INSTR( CE_NOP                                                                             , ALU_ADD(REG_OP(2), CNST(4), REG_OP(2))                  , "Increase R2 to point to the PPH msb");
                /*-1*/INSTR( CE_NOP                                                                             , ALU_NOP                                                 , "NOP");
                /*00*/INSTR(CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI)   , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(0))                , "Extract FHEI size , r0 = r3-r2 (pph size)");
                /*01*/INSTR( CE_FLREAD(PrgePktFieldFheiSize_UseR2TM, 0, LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI)  , ALU_NOP                                                 , "Extract FHEI size");
                /*02*/INSTR( CE_FLREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0, LFEM_OAM_CCM_EXTRACT_PPH_OFFSET)    , ALU_SET_IF(FEM, EQ, CNST(3), CNST(3), REG_OP(SZ))       , "extract PPH.FwdHdrOffset , rsz = (fem == 3) ? 3 : rsz");
                /*03*/INSTR( CE_NOP                                                                             , ALU_SET_IF(FEM, EQ, CNST(5), CNST(5), REG_OP(SZ))       , "---; rsz = (fem == 5) ? 5 : rsz");
                /*04*/INSTR( CE_NOP                                                                             , ALU_ADD(REG_OP(3), FEM, REG_OP(1))                      , "---; r1 = r3+fem");
                /*05*/INSTR( CE_NOP                                                                             , ALU_SUB(REG_OP(0), REG_OP(SZ), REG_OP(0))               , "r0 = r0 - rsz as PPH size holds sizes of base, eei ext, learn ext and fhei ext, removes fhei size");
                /*06*/INSTR( CE_NOP                                                                             , ALU_NOP                                                 , "nop");
                /*07*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(0,-7))                                            , ALU_SET(0x8902, REG_OP(0))                              , "Copy PPH eei and learn;  r0= 0x8902");
                /*08*/INSTR( CE_READ(PKT, R_OFST(1,28))                                                         , ALU_SET(0x2c, REG_OP(SZ))                               , "Extract Eth type(first attempt 12-13 byte), set rsz=8+14, shifted with 1 bit left - 0x2c;");
                /*09*/INSTR( CE_READ(PKT, R_OFST(1,36))                                                         , ALU_NOP                                                 , "Extract Eth type(second attempt 16-17 byte);");
                /*10*/INSTR( CE_NOP                                                                             , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(0x1c), REG_OP(SZ))  , "Compare rsz = (fem == 0x8902) ? 0+14 : rsz;");
                /*11*/INSTR( CE_FREAD(PrgePktFieldFwdHdrOffset_UseR2TM, 0)                                      , ALU_SET_IF(FEM, EQ, REG_OP(0), CNST(0x24), REG_OP(SZ))  , "Extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;");
                /*12*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))                                       , ALU_NOP                                                 , "Create FHEI trap code;");
                /*13*/INSTR( CE_FCOPY(PrgeDataFieldOamExtId, 0, C_SIZE(2))                                      , ALU_ADD(FEM, REG_OP(SZ), REG_OP(3))                     , "Create FHEI trap code qaulifier , r3=fem+rsz");
                /*14*/INSTR( CE_COPY(PKT, R_OFST(2,14), C_SIZE(5))                                              , ALU_NOP                                                 , "Copy 5 LSB bytes from PPH , ---");
                /*15*/INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(1))                                            , ALU_NOP                                                 , "Copy second byte of PPH from R3 , ---");
                /*16*/INSTR( CE_LCOPY(PKT, R_OFST(2,2), C_SIZE(1), LFEM_OAM_TS_CCM_FHEI)                        , ALU_NOP                                                 , "Copy PPH base first byte , ---");
                /*17*/INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))                                             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                 , "Copy FTMH , r2 = r2 - 16");
                /*18*/INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))                                          , ALU_NOP                                                 , "Copy FTMH , ---");
                /*19*/INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))                                             , ALU_NOP                                                 , "Copy FTMH , ---");

            }


            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_SLR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*01*/INSTR( CE_READ(PKT, R_OFST(2,4))                              , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                 , "extract PPH.FwdHdrOffset         ; RSZ = R3 - R2");
        /*02*/INSTR( CE_NOP                                                 , ALU_NOP                                                   , "---                              ; ---");
        /*03*/INSTR( CE_NOP                                                 , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0))     , "---                              ; R0 = PPH.FwdHdrOffset - user_header_size");
        /*04*/INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))                  , "---                              ; RSZ -= 2");

        /* copy PPH header with EEI, learn and FHEI extemtions */
        /*05*/INSTR( CE_LREAD(PKT, R_OFST(1,4), LFEM_ZERO_BIT12_TO_BIT13)   , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                  , "Read FTMH OAM-TS, set subtype=1  ; R3 -= 8");
        /*06*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, 0))               , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "PP-Copy from R3 with size RSZ    ; RSZ -= 16");
        /*07*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ,-8))               , ALU_SUB(FEM, CNST(0) , REG_OP(1))                         , "PP-Copy from R3 with size RSZ    ; R1 = FEM - FTMH OAM-TS subtype=1");
        /*08*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))              , ALU_NOP                                                   , "PP-Copy from R3 with size RSZ    ; ---");

        /*09*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                , ALU_NOP                                                   , "Copy PPH.FwdHdrOffset            ; ---");

        /*10*/INSTR( CE_COPY(PKT, R_OFST(2,0), C_SIZE(4))                   , ALU_SUB( REG_OP(2) , CNST(6) , REG_OP(2))                , "Copy system headers with R2       ; R2 -= 6");
        /*11*/INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                , ALU_NOP                                                   , "Set updated FTMH OAM-TS subtype  ; ---");

        /* Instr 12-21 : Copy rest */
        for (i = 0; i < 5; i++) {                                                                                                    /* for ( i = 0; i < 5; i++ ) { */
            INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))                   , ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2))                , "Copy with R2                     ; R2 -= 16");
            INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))                , ALU_NOP                                                   , "Copy with R2                     ; ---");
        }                                                                                                                           /* } */

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_OAMP_REMOVE_UDH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*01*/INSTR( CE_READ(PKT, R_OFST(2,4))                      , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))                 , "extract PPH.FwdHdrOffset  ; RSZ = R3 - R2");
        /*02*/INSTR( CE_NOP                                         , ALU_NOP                                                   , "---                      ; ---");
        /*03*/INSTR( CE_NOP                                         , ALU_SUB(FEM, CNST(user_header_size << 1) , REG_OP(0))     , "---                      ; R0 = PPH.FwdHdrOffset - user_header_size");
        /*04*/INSTR( CE_NOP                                         , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))                  , "---                      ; RSZ -= 2");

        /* copy PPH header with EEI, learn and FHEI extemtions */
        /*05*/INSTR( CE_NOP                                         , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                  , "---                      ; R3 -= 8");
        /*06*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ, 0))       , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                 , "PP-Copy from R3 with size RSZ ; RSZ -= 16");
        /*07*/INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(SZ,-8))       , ALU_NOP                                                   , "PP-Copy from R3 with size RSZ ; ---");
        /*08*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))      , ALU_NOP                                                   ,"PP-Copy from R3 with size RSZ ; ---");

        /*09*/INSTR( CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))        , ALU_NOP                                                   , "Copy PPH.FwdHdrOffset    ; ---");

        /* Instr 10-19 : PP-Copy */
        for (i = 0; i < 5; i++) {                                                                                                    /* for ( i = 0; i < 5; i++ ) { */
            INSTR( CE_COPY(PKT, R_OFST(2,0), R_SIZE(2,0))           , ALU_SUB( REG_OP(2) , CNST(16) , REG_OP(2))                , "PP-Copy with R2          ; R2 -= 16");
            INSTR( CE_COPY(PKT, R_OFST(2,-16), R_SIZE(2,-8))        , ALU_NOP                                                   , "PP-Copy with R2          ; ---");
        }                                                                                                                           /* } */

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_MPLS_TP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        if (customer_ftmh_dsp_extension_add) {
            ftmh_size += 2;
        }
        
        fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
            INSTR(CE_FLCOPY(PrgeDataFieldProgVar, 0, C_SIZE(0), LFEM_8_LSBS), ALU_ADD(REG_OP(3), CNST(0), REG_OP(0)), "0. Get prg variable, R0=R3+ (2 labels)");
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_8_LSBS), ALU_SET(2, REG_OP(SZ)),            "1. Get trap code, RSZ=2");     
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2; /*offset of FWD-header-offset*/
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_ADD(FEM, CNST(0), REG_OP(2)), "2. Get PPH.forward-header-offset, R2=prg variable");
            INSTR(CE_NOP,                                            ALU_ADD(FEM, CNST(0), REG_OP(1)),          "3. R1= trap code");
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;
            INSTR(CE_NOP,                                            ALU_ADD(FEM, REG_OP(0), REG_OP(0)),        "4. R0= forward-header-offset + 2 labels + R3");
            INSTR(CE_NOP,                                            ALU_SET_IF(REG_OP(1), EQ, REG_OP(2), CNST(0), REG_OP(SZ)), "5. if trap code==42, RSZ=0");
            
            /*since now, R0--PDU offset, RSZ--GAL size*/
            /*----------build 1731 PDU----------*/
            INSTR(CE_COPY(PKT, R_OFST(0, 4), C_SIZE(1)),             ALU_ADD(REG_OP(0), CNST(36), REG_OP(1)),   "6. build End TLV(value = 0), R1=R0+36,");
            INSTR(CE_LCOPY(PKT,R_OFST(0, 2), C_SIZE(0), LFEM_8_LSBS),ALU_ADD(REG_OP(0), CNST(28), REG_OP(1)),   "7: Get function Type, R1=R0+28");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(8)),             ALU_SET(12, REG_OP(2)),                    "8: copy TxFcb and RxFcf, R2=0x000c");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(CNST(54), FEM, REG_OP(2)),         "9: copy TxFcf, R2=56-Function Type");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_ADD(REG_OP(0), CNST(40), REG_OP(1)),   "10: Built flags and TLV offset");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_NOP,                                   "11: copy MEL + Version + OpCode");

            /*----------[GAL] + ACH----------*/
            INSTR(CE_LCOPY(PKT, R_OFST(0, 0), C_SIZE(0), LFEM_STACKING_8), ALU_NOP,                             "12: Get GAL 16LSB to FEM");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(SZ), REG_OP(SZ), REG_OP(2)),"13: R1 = GAL size");
            INSTR(CE_NOP,                                            ALU_SUB(FEM, CNST(0x1000), REG_OP(1)),     "14: Recover label to 13(1731)");
            /*R1 point to */
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_NOP,                                   "15: copy ACH from PDU[40]");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0)),        ALU_ADD(REG_OP(2), CNST(8), REG_OP(2)),    "16: build GAL 16 LSB if exist, R2=GAL size + 8");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), R_SIZE(SZ,0)),          ALU_SUB(REG_OP(0), CNST(4), REG_OP(1)),    "17: copy GAL 16 MSB if exist");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(2), REG_OP(2), REG_OP(2)),  "18: forward header offset << 1 ");
            /*----------LSP label or PWE label----------*/
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2;
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(REG_OP(3), CNST(fld_val+8), REG_OP(1)), "19: copy LSP/PWE, R1= R3-(fld_val + 8)");

            /*since now, R3--system header offset, R2--forward header offset value*/
            /*----------Copy system header----------*/
            INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(8)),             ALU_SUB(REG_OP(3), CNST(fld_val+16), REG_OP(1)),"21: copy first 8Bytes from offset=R3");
            INSTR(CE_COPY(PKT, R_OFST(3, -16), R_SIZE(1, 0)),        ALU_NOP,                                   "22: NOP");
            INSTR(CE_COPY(PKT, R_OFST(3, -32), R_SIZE(1, 0)),        ALU_NOP,                                   "23: copy reset part");
            /* new Forward header offset */
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1)),           ALU_NOP,                                   "24: Built new forward header offset");
            /* copy reset of system header */
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 1;
            INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),       ALU_NOP,                                   "25: copy system header");
            fld_val = fld_val - 8;
            if (fld_val <= 8) {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "26: copy system header");
            } else {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),   ALU_NOP,                                   "26: copy system header");
                fld_val = fld_val - 8;
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "27: copy system header");
            }         
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_1711_PWE);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
        if (customer_ftmh_dsp_extension_add) {
            ftmh_size += 2;
        }
        
        fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "1711_debug_enable", 0) == 0) {
            INSTR(CE_FLCOPY(PrgeDataFieldProgVar, 0, C_SIZE(0), LFEM_8_LSBS), ALU_ADD(REG_OP(3), CNST(0), REG_OP(0)), "0. Get prg variable, R0=R3+ (2 labels)");
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_8_LSBS), ALU_SET(2, REG_OP(SZ)),            "1. Get trap code, RSZ=2");     
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2; /*offset of FWD-header-offset*/
            INSTR(CE_LCOPY(PKT, C_OFST(fld_val<<1), C_SIZE(0), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET), ALU_ADD(FEM, CNST(0), REG_OP(2)), "2. Get PPH.forward-header-offset, R2=prg variable");
            INSTR(CE_NOP,                                            ALU_ADD(FEM, CNST(0), REG_OP(1)),          "3. R1= trap code");
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3;
            INSTR(CE_NOP,                                            ALU_ADD(FEM, REG_OP(0), REG_OP(0)),        "4. R0= forward-header-offset + 2 labels + R3");
            INSTR(CE_NOP,                                            ALU_SET_IF(REG_OP(1), EQ, REG_OP(2), CNST(0), REG_OP(SZ)), "5. if trap code==42, RSZ=0");
            
            /*since now, R0--PDU offset, RSZ--GAL size*/
            /*----------build 1731 PDU----------*/
            INSTR(CE_COPY(PKT, R_OFST(0, 4), C_SIZE(1)),             ALU_ADD(REG_OP(0), CNST(36), REG_OP(1)),   "6. build End TLV(value = 0), R1=R0+36,");
            INSTR(CE_LCOPY(PKT,R_OFST(0, 2), C_SIZE(0), LFEM_8_LSBS),ALU_ADD(REG_OP(0), CNST(28), REG_OP(1)),   "7: Get function Type, R1=R0+28");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(8)),             ALU_SET(12, REG_OP(2)),                    "8: copy TxFcb and RxFcf, R2=0x000c");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(CNST(54), FEM, REG_OP(2)),         "9: copy TxFcf, R2=56-Function Type");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_ADD(REG_OP(0), CNST(40), REG_OP(1)),   "10: Built flags and TLV offset");
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),           ALU_NOP,                                   "11: copy MEL + Version + OpCode");

            /*----------[GAL] + ACH----------*/
            INSTR(CE_LCOPY(PKT, R_OFST(0, 0), C_SIZE(0), LFEM_STACKING_8), ALU_NOP,                             "12: Get GAL 16LSB to FEM");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(SZ), REG_OP(SZ), REG_OP(2)),"13: R1 = GAL size");
            INSTR(CE_NOP,                                            ALU_SUB(FEM, CNST(0x1000), REG_OP(1)),     "14: Recover label to 13(1731)");
            /*R1 point to */
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_NOP,                                   "15: copy ACH from PDU[40]");
            INSTR(CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0)),        ALU_ADD(REG_OP(2), CNST(8), REG_OP(2)),    "16: build GAL 16 LSB if exist, R2=GAL size + 8");
            INSTR(CE_COPY(PKT, R_OFST(1, 0), R_SIZE(SZ,0)),          ALU_SUB(REG_OP(0), CNST(4), REG_OP(1)),    "17: copy GAL 16 MSB if exist");
            INSTR(CE_NOP,                                            ALU_ADD(REG_OP(2), REG_OP(2), REG_OP(2)),  "18: forward header offset << 1 ");
            /*----------LSP label or PWE label----------*/
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 2;
            INSTR(CE_COPY(PKT, R_OFST(1, 0), C_SIZE(4)),             ALU_SUB(REG_OP(3), CNST(fld_val+8), REG_OP(1)), "19: copy LSP/PWE, R1= R3-(fld_val + 8)");

            /*since now, R3--system header offset, R2--forward header offset value*/
            /*----------Copy system header----------*/
            INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(8)),             ALU_SUB(REG_OP(3), CNST(fld_val+16), REG_OP(1)),"21: copy first 8Bytes from offset=R3");
            INSTR(CE_COPY(PKT, R_OFST(3, -16), R_SIZE(1, 0)),        ALU_NOP,                                   "22: NOP");
            INSTR(CE_COPY(PKT, R_OFST(3, -32), R_SIZE(1, 0)),        ALU_NOP,                                   "23: copy reset part");
            /* new Forward header offset */
            INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(1)),           ALU_NOP,                                   "24: Built new forward header offset");
            /* copy reset of system header */
            fld_val = ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + 1;
            INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),       ALU_NOP,                                   "25: copy system header");
            fld_val = fld_val - 8;
            if (fld_val <= 8) {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "26: copy system header");
            } else {
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(8)),   ALU_NOP,                                   "26: copy system header");
                fld_val = fld_val - 8;
                INSTR(CE_COPY(PKT, C_OFST(fld_val<<1), C_SIZE(fld_val)), ALU_NOP,                               "27: copy system header");
            }         
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) 		{

        if ((soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "snooped_UPMIP_InLIF_info", 0)) == 1 ) {

            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

            /*SDK-73144 - generate FTMH + inlif info in empty OAM-TS*/ 
            /*0*/  INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),                                  ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),      "0: Copy 8B from generated offset R3, Size RSZ; ALU: R3 = R3-16 (calc next generated reference)");
            /*1*/  INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),                                ALU_NOP,                                       "1: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            /*2*/  INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),                                  ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),      "2: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
            /*3*/  INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),                                ALU_NOP,                                       "3: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            /*4*/  INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),                                  ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),      "4: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
            /*5*/  INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),                                ALU_NOP,                                       "5: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            /*6*/  INSTR(CE_COPY(GEN, R_OFST(3, 0),  R_SIZE(3, 0)),                                  ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3)),      "6: Copy 8B from offset R3, Size RSZ-16; ALU: R3 = R3-16 (calc next generated reference)");
            /*7*/  INSTR(CE_COPY(GEN, R_OFST(3, -16), R_SIZE(3, -8)),                                ALU_NOP,                                       "7: Copy 8B from offset R3-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            /*8*/  INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT),                 ALU_SET((ftmh_size + 7), REG_OP(0)),           "8: extract DSP_EXT for FTMH size, R0= ftmh size +PPH base size ");
            /*9*/  INSTR(CE_NOP,                                                                     ALU_SET(0, REG_OP(3)),                         "9: NOP. R3=0");
            /*10*/ INSTR(CE_NOP,                                                                     ALU_ADD(FEM, REG_OP(0), REG_OP(0)),            "10: r0 = R0 + FEM ");
            /*11*/ INSTR(CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_2_LSBYTES),                             ALU_NOP,                                       "11: Extract from FTMH 2LSBytes 12'h000,1'b0,FTMH[2:0] ");
            /*12*/ INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, -3, LFEM_4_LSBS),                        ALU_NOP,                                       "12: Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0");
            /*13*/ INSTR(CE_FLREAD(PrgeDataFieldDstSysPort, 0, LFEM_TDM_CUD_STACKING_EXTRACT_CUD),   ALU_ADD(FEM, CNST(0), REG_OP(2)),              "13: extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem");
            /*14*/ INSTR(CE_COPY(PKT, R_OFST(0, 0), C_SIZE(3)),                                      ALU_ADD(FEM, CNST(0), REG_OP(1)),              "14: copy OAM-TS(inlif-info) 3LSB r1=fem");
            /*15*/ INSTR(CE_LREAD(PKT, C_OFST(12), LFEM_FTMH_2_BYTES),                               ALU_ADD(FEM, REG_OP(2), REG_OP(2)),            "15: extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2");
            /*16*/ INSTR(CE_COPY(PKT, R_OFST(3, 0), C_SIZE(3)),                                      ALU_NOP,                                       "16: copy OAM-TS(zeros) 3MSB");
            /*17*/ INSTR(CE_FCOPY(PrgeDataFieldOutLif, 0, C_SIZE(2)),                                ALU_ADD(FEM, CNST(0), REG_OP(0)),              "17: add FTMH.DSP extension;");
            /*18*/ INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_FTMH_2_BYTES_PPH_TYPE_2),         ALU_NOP,                                       "18: {1'b0, out_pp_port[7:0],7'h0 } ");
            /*19*/ INSTR(CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2)),                                    ALU_NOP,                                       "19: copy from r2  2 bytes (FTMH 2LSBytes)");
            /*20*/ INSTR(CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(1)),                                    ALU_ADD(FEM, REG_OP(0), REG_OP(0)),            "20: copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0");
            /*21*/ INSTR(CE_NOP,                                                                     ALU_NOP,                                       "21: NOP");
            /*22*/ INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2)),                                    ALU_NOP,                                       "22: copy from r0 (FTMH 4th and 5th LSB)");
            /*23*/ INSTR(CE_COPY(PKT, C_OFST(8), C_SIZE(4)),                                         ALU_NOP,                                       "23 copy remaining 4 bytes of FTMH ");

            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        } else {


            int     mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                                                                                                     ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;
            if (SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists == 1) {

                /*instruction 0-7  Copy the the generated pp headers (from the pipe)*/
                for (i = 0; i < 4; i++) {
                    mem   = (entry == entry_odd) ? (mem + 1) : mem;
                    entry = (entry == entry_even) ? entry_odd : entry_even;
                    prge_instruction_tbl_data.src_select      = 1;
                    prge_instruction_tbl_data.offset_base     = 0;
                    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
                    prge_instruction_tbl_data.size_base       = 0;
                    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
                    prge_instruction_tbl_data.op_value        = 16;
                    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                    prge_instruction_tbl_data.alu_action      = 0;
                    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                    prge_instruction_tbl_data.cmp_action = 7;
                    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
                    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                    mem   = (entry == entry_odd) ? (mem + 1) : mem;
                    entry = (entry == entry_even) ? entry_odd : entry_even;
                    prge_instruction_tbl_data.src_select        = 1;
                    prge_instruction_tbl_data.offset_base     = 0xF0;
                    prge_instruction_tbl_data.offset_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                    prge_instruction_tbl_data.size_src          = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
                    prge_instruction_tbl_data.size_base     = 0x18;
                    prge_instruction_tbl_data.fem_select        = ARAD_PP_EG_PROG_NOF_FEM(unit);
                    prge_instruction_tbl_data.op_1_field_select   = 0;
                    prge_instruction_tbl_data.op_value          = 0;
                    prge_instruction_tbl_data.op_2_field_select   = 0;
                    prge_instruction_tbl_data.alu_action        = 0;
                    prge_instruction_tbl_data.op_3_field_select   = 0;
                    prge_instruction_tbl_data.cmp_action        = 0;
                    prge_instruction_tbl_data.dst_select        = 0;
                    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                }


                /*Instruction 8  Extract from FTMH 2LSBytes {12'h000,1'b0,FTMH[2:0]}*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 18; /* FTMH 2LSbyte*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 9   Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     =  ARAD_PP_PRGE_DST_SYSTEM_PORT - 3; /*last nibble of DstSysPort*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 10  extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_DST_SYSTEM_PORT;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



                /*Instruction 11 -------- ; r1=fem*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 0;
                prge_instruction_tbl_data.offset_src      = 0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 12 extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 12;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
                prge_instruction_tbl_data.alu_action      = 1;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 13 add FTMH.DSP extension; -------*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_LIF;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 2;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode) {

                    /* add LB-Key extension; r3=fem*/
                    mem   = (entry == entry_odd) ? (mem + 1) : mem;
                    entry = (entry == entry_even) ? entry_odd : entry_even;
                    prge_instruction_tbl_data.src_select      = 0;
                    prge_instruction_tbl_data.offset_base     = 20; /* LB-Key location in system header */
                    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                    prge_instruction_tbl_data.size_base       = 1;
                    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                    prge_instruction_tbl_data.op_value        = 0;
                    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                    prge_instruction_tbl_data.alu_action      = 1;
                    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                    prge_instruction_tbl_data.cmp_action = 7;
                    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
                    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                    /* NOP (for LFEM alignment); -------*/
                    mem   = (entry == entry_odd) ? (mem + 1) : mem;
                    entry = (entry == entry_even) ? entry_odd : entry_even;
                    prge_instruction_tbl_data.src_select      = 0;
                    prge_instruction_tbl_data.offset_base     = 0;
                    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                    prge_instruction_tbl_data.size_base       = 0;
                    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                    prge_instruction_tbl_data.op_1_field_select = 0;
                    prge_instruction_tbl_data.op_value        = 0;
                    prge_instruction_tbl_data.op_2_field_select = 0;
                    prge_instruction_tbl_data.alu_action      = 0;
                    prge_instruction_tbl_data.op_3_field_select = 0;
                    prge_instruction_tbl_data.cmp_action = 0;
                    prge_instruction_tbl_data.dst_select      = 0;
                    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                }


                /* extract   ;   {1'b0, out_pp_port[7:0],7'h0 } */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_PP_PORT;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.op_1_field_select = (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode) ? ARAD_PP_PRGE_ENG_OP1_REG_R3 : ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



                /* copy from r2  2 bytes (FTMH 2LSBytes)*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     =  51; /*r2*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 2;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /* copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = 55;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 1;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
                prge_instruction_tbl_data.alu_action      = 1;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /* Extract Resolved.Data.tm-port-var (1B) */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                /*      prge_instruction_tbl_data.src_select      = 0;                            */
                /*      prge_instruction_tbl_data.offset_base     = 0;                            */
                /*      prge_instruction_tbl_data.offset_src      = 0;                            */
                /*      prge_instruction_tbl_data.size_base       = 0;                            */
                /*      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;  */
                /*      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);*/
                /*      prge_instruction_tbl_data.op_1_field_select = 0;                          */
                prge_instruction_tbl_data.src_select  = 2;
                prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /* copy from r0 (FTMH 4th and 5th LSB)  */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     =  59; /*r2*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 2;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /* copy remaining 4 bytes of FTMH  */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     =  8;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 4;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                /*      prge_instruction_tbl_data.op_1_field_select = 0;*/
                /*      prge_instruction_tbl_data.op_value        = 0;  */
                /*      prge_instruction_tbl_data.op_2_field_select = 0;*/
                /*      prge_instruction_tbl_data.alu_action      = 0;  */
                /*      prge_instruction_tbl_data.op_3_field_select = 0;*/
                /*      prge_instruction_tbl_data.cmp_action      = 0;  */
                /*      prge_instruction_tbl_data.dst_select      = 0;  */
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value          = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action        = 0x7; /* always */
                prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; /* R_Size */
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                /* NOP */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = 0;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value          = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action        = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action        = 0;
                prge_instruction_tbl_data.dst_select        = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                /*
                 * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
                 */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 2;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - Resolved Data: out-PP-port */
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                /* For this program, fill other instructions with NOPs */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));
            } else {
                /*instruction 0-11  Copy the the generated pp headers (from the pipe)*/
                for (i = 0; i < 6; i++) {
                    mem   = (entry == entry_odd) ? (mem + 1) : mem;
                    entry = (entry == entry_even) ? entry_odd : entry_even;
                    prge_instruction_tbl_data.src_select      = 1;
                    prge_instruction_tbl_data.offset_base     = 0;
                    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
                    prge_instruction_tbl_data.size_base       = 0;
                    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
                    prge_instruction_tbl_data.op_value        = 16;
                    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                    prge_instruction_tbl_data.alu_action      = 0;
                    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                    prge_instruction_tbl_data.cmp_action = 7;
                    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
                    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                    mem   = (entry == entry_odd) ? (mem + 1) : mem;
                    entry = (entry == entry_even) ? entry_odd : entry_even;
                    prge_instruction_tbl_data.src_select        = 1;
                    prge_instruction_tbl_data.offset_base     = 0xF0;
                    prge_instruction_tbl_data.offset_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
                    prge_instruction_tbl_data.size_src          = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
                    prge_instruction_tbl_data.size_base     = 0x18;
                    prge_instruction_tbl_data.fem_select        = ARAD_PP_EG_PROG_NOF_FEM(unit);
                    prge_instruction_tbl_data.op_1_field_select   = 0;
                    prge_instruction_tbl_data.op_value          = 0;
                    prge_instruction_tbl_data.op_2_field_select   = 0;
                    prge_instruction_tbl_data.alu_action        = 0;
                    prge_instruction_tbl_data.op_3_field_select   = 0;
                    prge_instruction_tbl_data.cmp_action        = 0;
                    prge_instruction_tbl_data.dst_select        = 0;
                    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                }


                /*Instruction 12  Extract from FTMH 2LSBytes {12'h000,1'b0,FTMH[2:0]}*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 18; /* FTMH 2LSbyte*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 13   Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     =  ARAD_PP_PRGE_DST_SYSTEM_PORT - 3; /*last nibble of DstSysPort*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 14  extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_DST_SYSTEM_PORT;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



                /*Instruction 15 -------- ; r1=fem*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 0;
                prge_instruction_tbl_data.offset_src      = 0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 16 extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 12;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
                prge_instruction_tbl_data.alu_action      = 1;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);




                /*Instruction 17 add FTMH.DSP extension; -------*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_LIF;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 2;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 18 extract   ;   {1'b0, out_pp_port[7:0],7'h0 } */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_PP_PORT;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2,
                                                           mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



                /*Instruction 19 copy from r2  2 bytes (FTMH 2LSBytes)*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     =  51; /*r2*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 2;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 20 copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0*/
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     = 55;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 1;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
                prge_instruction_tbl_data.alu_action      = 1;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 21 NOP  */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 0;
                prge_instruction_tbl_data.offset_src      = 0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 22 copy from r0 (FTMH 4th and 5th LSB)  */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 2;
                prge_instruction_tbl_data.offset_base     =  59; /*r2*/
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
                prge_instruction_tbl_data.size_base       = 2;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


                /*Instruction 23 copy remaining 4 bytes of FTMH  */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     =  8;
                prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
                prge_instruction_tbl_data.size_base       = 4;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

                /* For this program, fill other instructions with NOPs */
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));

            }
        }
    }

    /*  Program 11 instructions (entries 22, 23 in each table) - OAM Loopback */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
        uint8 itmh_programmable = (SOC_IS_JERICHO(unit) && soc_property_get(unit, spn_ITMH_PROGRAMMABLE_MODE_ENABLE, 1));
        bcm_gport_t oam_rcy_port = soc_property_get(unit, spn_OAM_RCY_PORT, -1);

    

        /* Start program instructions */
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* LFEM shift required for LB-extension on egress snoop  */
        if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode &&
            soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "egress_snooping_advanced", 0)) {
            INSTR( CE_NOP                                                     , ALU_NOP                                               , "NOP Instruction added to push an LFEM to the other map");
        }
     
        INSTR( CE_NOP                       , ALU_SET(0x8902,REG_OP(0))                             , "Extract out pp port ; r0 = 0x8902 ");
        INSTR(CE_READ(PKT, R_OFST(3,28 + (user_header_size*2)))           , ALU_SET(24,REG_OP(SZ))                                , "Extract Eth type(first attempt 13-14 byte), set rsz=8+16 ");
        INSTR(CE_READ(PKT, R_OFST(3,36 + (user_header_size*2)))           , ALU_SET(oam_rcy_port,REG_OP(1)) , "Extract Eth type(second attempt 17-18 byte); r1 = oam_rcy_port");
        INSTR(CE_FREAD(PrgeDataFieldOutPpPort, 0)                         , ALU_SET_IF(REG_OP(0), EQ, FEM, CNST(16), REG_OP(SZ))  , "Extract out pp port ; compare rsz = (fem == 0x8902) ? 16 : rsz; ");
        INSTR(CE_LREAD(PKT, R_OFST(2,4), LFEM_OAM_CCM_EXTRACT_PPH_OFFSET) , ALU_SET_IF(REG_OP(0), EQ, FEM, CNST(20), REG_OP(SZ))  , "copy fwd offset, rsz = (fem == 0x8902)? (16+4):rsz");

        if (itmh_programmable) {
            INSTR(CE_LREAD(PKT, C_OFST(11), LFEM_OAM_LOOPBACK_EXTRACT_TC_JER) ,       ALU_JMP_IF(FEM, NEQ, REG_OP(1), BRANCH_OAM_LB_UP, JUMP_POINT_OAM_LB_UP)  , "extract TC and DP ; ");
        } else {
            INSTR(CE_LREAD(PKT, C_OFST(11), LFEM_OAM_LOOPBACK_EXTRACT_TC)     , ALU_JMP_IF(FEM, NEQ, REG_OP(1), BRANCH_OAM_LB_UP, JUMP_POINT_OAM_LB_UP)       , "extract TC and DP ; ");
        }
        INSTR(CE_NOP                                                      , ALU_ADD(FEM       , REG_OP(SZ)   , REG_OP(SZ))        , "recalculate the pph fwrd offset rsz=fem+rsz");
        INSTR(CE_NOP                                                      , ALU_SUB(FEM ,CNST(0), REG_OP(0))                      , "load r0 with fem -> tc, dp and fwd-dest-info[19:16]=(4'b1100)");
        INSTR(CE_NOP                                                      , ALU_SUB(CNST(24 + user_header_size), REG_OP(SZ) , REG_OP(1))   , " r1 = 24 - rsz (24-bytes to remove)");
        INSTR(CE_NOP                        , ALU_ADD(REG_OP(3), CNST(24 + user_header_size), REG_OP(2))    , " (no jump) r2 = 24 + r3");
        INSTR(CE_NOP                                                     , ALU_SUB(REG_OP(SZ), CNST(1)   , REG_OP(SZ))            , "sz = rsz - 1");
     
        INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_SUB(REG_OP(1), CNST(16)   , REG_OP(1))             , "Copy NWK LSB , r1 = r1 - 16");
        INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_ADD(REG_OP(3), REG_OP(SZ)   , REG_OP(2))           , "Copy NWK LSB , r2 = r3 + rsz");
        INSTR(CE_COPY(PKT, R_OFST(2,-48), R_SIZE(1,-8))                , ALU_SUB(REG_OP(SZ), CNST(12 + user_header_size), REG_OP(1)) , "Copy NWK LSB , r1 = rsz - 12");
        INSTR(CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))               , ALU_NOP              , "(no jump )Set 1731.OpCode");
        INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_NOP              , "Copy NWK MSB");
        INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_NOP              , "Copy NWK MSB");
        INSTR(CE_COPY(PKT, R_OFST(3,12 + (user_header_size * 2)), C_SIZE(6)) , ALU_NOP          , "Copy DA");
        INSTR(CE_COPY(PKT, R_OFST(3,24 + (user_header_size * 2)), C_SIZE(6)) , ALU_NOP          , "Copy SA");
        INSTR(CE_COPY(PKT, R_OFST(3, 0 + (user_header_size * 2)), C_SIZE(user_header_size)) , ALU_NOP  , "Copy UDH");
        if (itmh_programmable) {
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))                , ALU_NOP              , "Copy ITMH MSB 1st LSByte");
        }
        INSTR(CE_FCOPY(PrgeDataFieldSrcSysPort, 0, C_SIZE(2))            , ALU_NOP              , "extract lag id ; ");
        if (itmh_programmable) {
            INSTR(CE_FCOPY(PrgeDataFieldR0, -2, C_SIZE(1))                , ALU_NOP              , "Copy ITMH MSB 1st LSByte");
        } else {
            INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))                 , ALU_NOP              , "Copy ITMH MSB 1st LSByte");
        }
  
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Jump instructions - program reaches here if LBM up mep */
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_OAM_LB_UP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_OAM_LB_UP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* build ptch 0xd0_outpp port*/

        
        INSTR(CE_NOP                                                      , ALU_SET (SOC_PPC_OAM_ETHERNET_PDU_OPCODE_LBR, REG_OP(0))    , "r0= LBR opcode");

        /* 10*/INSTR(CE_NOP                                                      , ALU_ADD(REG_OP(3), CNST(24 + user_header_size), REG_OP(2))    , "r2 = 24 + r3");
        /* 11*/INSTR(CE_NOP                                                     , ALU_SUB(REG_OP(SZ), CNST(1)   , REG_OP(SZ))            , "sz = rsz - 1");
        /* 12*/INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_SUB(REG_OP(1), CNST(16)   , REG_OP(1))             , "Copy NWK LSB , r1 = r1 - 16");
        /* 13*/INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_ADD(REG_OP(3), REG_OP(SZ)   , REG_OP(2))           , "Copy NWK LSB , r2 = r3 + rsz");
        /* 14*/INSTR(CE_COPY(PKT, R_OFST(2,-48), R_SIZE(1,-8))                , ALU_SUB(REG_OP(SZ), CNST(12 + user_header_size), REG_OP(1)) , "Copy NWK LSB , r1 = rsz - 12");
        /* 15*/INSTR(CE_FLREAD(PrgeDataFieldOutPpPort, 0, LFEM_8_LSBS)                   , ALU_SET (0xd000, REG_OP(0))    , "r0= MSB ptch");            
        /* 16*/INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(1))               , ALU_NOP              , "Set LBR OpCode");
        /* 17*/INSTR(CE_COPY(PKT, R_OFST(2,0), R_SIZE(1,0))                     , ALU_ADD(FEM       , REG_OP(0)   , REG_OP(0))              , "Copy NWK MSB; R0=out pp port + MSB ptch ");
        /* 18*/INSTR(CE_COPY(PKT, R_OFST(2,-16), R_SIZE(1,-8))                , ALU_NOP              , "Copy NWK MSB");
        /* 19*/INSTR(CE_COPY(PKT, R_OFST(3,12 + (user_header_size * 2)), C_SIZE(6)) , ALU_SET(0xd0, REG_OP(2))          , "Copy DA; R2= msb of PTCH");
        /* 20*/INSTR(CE_COPY(PKT, R_OFST(3,24 + (user_header_size * 2)), C_SIZE(6)) , ALU_NOP          , "Copy SA");
        /* 21*/INSTR(CE_FCOPY(PrgeDataFieldR0, 0, C_SIZE(2))               , ALU_NOP              , "Set PTCH");
      
    
        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DROP_1ST_ENC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_JERICHO(unit) && (SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1)) {
            /* support: CCM + Full MyMAC + [port vlan COE] */
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS), ALU_SET(2, REG_OP(0)), "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_NOP, ALU_SUB(REG_OP(1),  CNST(12), REG_OP(SZ)), "RSZ=R1-12");
            
            INSTR(CE_NOP, ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), " R0 will be 2 if we are pushing coe tag, 0 otherwise");
            
            for (i = 0; i < 6; i++) { /* each iteration copies up to 16 bytes */
                INSTR(CE_COPY(GEN, R_OFST(1, 0),  R_SIZE(SZ, 0)),   ALU_SUB(REG_OP(1),  CNST(16), REG_OP(1)), "Copy 8B from offset R1, Size RSZ; ALU: R1 = R1-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R1-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                INSTR(CE_NOP, ALU_NOP, "NOP");
            }
            
            /* build port extender tag only if R0 == 2*/
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0)), ALU_NOP, "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0)), ALU_NOP, "Copy Program-Variable(2bytes) only if R0 == 2 ");
            
            /* build SA from pp/tm port vars */
            INSTR(CE_FCOPY(PrgeDataFieldTmPortVar, -1, C_SIZE(3)), ALU_NOP, "");
            INSTR(CE_FLCOPY(PrgeDataFieldTmPortVar, -7, C_SIZE(1), LFEM_FIRST_FIFTH_NIBBLES), ALU_NOP, "");
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, -4, C_SIZE(2)), ALU_NOP, "");
            
            /* copy DA from generated header */
            INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");
        } else if (SOC_IS_JERICHO(unit) && !(SOC_DPP_CONFIG(unit)->pp.egress_full_mymac_1) && ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 2)) {
            /* support: CCM + port vlan COE */
            INSTR(CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS), ALU_SET(2, REG_OP(0)), "For port Ex. Extract Resolved.Data.tm-port-var, R0=2");
            INSTR(CE_NOP, ALU_SUB(REG_OP(1),  CNST(12), REG_OP(SZ)), "RSZ=R1-12");
            INSTR(CE_NOP, ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(0)), " R0 will be 2 if we are pushing coe tag, 0 otherwise");
        
            for (i = 0; i < 6; i++) { /* each iteration copies up to 16 bytes */
                INSTR(CE_COPY(GEN, R_OFST(1, 0),  R_SIZE(SZ, 0)),   ALU_SUB(REG_OP(1),  CNST(16), REG_OP(1)), "Copy 8B from offset R1, Size RSZ; ALU: R1 = R1-16 (calc next generated reference)");
                INSTR(CE_COPY(GEN, R_OFST(1, -16), R_SIZE(SZ, -8)), ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)), "Copy 8B from offset R1-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
                INSTR(CE_NOP, ALU_NOP, "NOP");
            } 
        
            /* build port extender tag only if R0 == 2*/
            INSTR(CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(0, 0)), ALU_NOP, "Copy PP-Port-Variable(2bytes) only if R0 == 2 ");
            INSTR(CE_FCOPY(PrgeDataFieldProgVar,   0, R_SIZE(0, 0)), ALU_NOP, "Copy Program-Variable(2bytes) only if R0 == 2 ");
        
            /* copy SA from generated header */
            INSTR(CE_COPY(GEN, C_OFST(24), C_SIZE(6)), ALU_NOP, "");
            /* copy DA from generated header */
            INSTR(CE_COPY(GEN, C_OFST(12), C_SIZE(6)), ALU_NOP, "");
        } else {
            /* 
             * Support CCM + NULL
             * Instr 0-19 : PP-Copy except 1st enc and fwd
             */
            for (i = 0; i < 10; i++) {                                                                              /* for ( i = 0; i < 10; i++ ) { */
                INSTR( CE_COPY(GEN, R_OFST(1,0), R_SIZE(1,0))     , ALU_SUB( REG_OP(1) , CNST(16) , REG_OP(1))         , "PP-Copy with R1; R1 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(1,-16), R_SIZE(1,-8))  , ALU_NOP                                            , "PP-Copy with R1");
            }                                                                                                       /* } */
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    /* vxlan support use program for version under arad+. Arad+ support VxLAN by design. */
    else { 
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
            /* IPv4 size with GRE*/
            fld_val = 0x24;
            SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  90,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_IPV4_SIZE_WITH_GRE_8_KEYr, SOC_CORE_ALL, 0, IPV4_SIZE_WITH_GRE_8_KEYf,  fld_val)); 
            /* gre next protocol is udp */
            fld_val = 0x11;
            SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  100,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_IP_PROTOCOL_GREr, SOC_CORE_ALL, 0, IP_PROTOCOL_GREf,  fld_val)); 

            /* Program 12 instructions (entries 24, 25 in each table) - VXLAN */
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;

            /* Instruction 0 : Copy FWD Header MSBs 0 (always)
                               CALC Forwarding header size and store in REG-SIZE */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0xF0; /* -8*(8/4) = -16 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
            /* Instruction 1 : Copy IPv4.Total-Length */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = (4*8)/4; /* IPv4.Total-Length is 2 Byte offset from start of IPv4 header */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* Start of IPv4 */
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
            /* Instruction 2 : Copy FWD Header MSBs 1
                               Decrement REG-SIZE by 24 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0xE0; /* (-8-8) * (8/4) = -32 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 24;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
            /* Instruction 3 : Copy FWD Header MSBs 2
                               R1 = IPv4.Total-Length - 20 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0xD0; /* (-16-8) * (8/4) = -48 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x10; /* -16 5b' */
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 20;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /* Instruction 4 : Copy FWD Header MSBs 3 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0xC0; /* (-24-8) * (8/4) = -64 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /*  Instruction 5 : Copy FWD Header MSBs 4 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0xB0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /* Instruction 6 : Generate VxLAN-Header Reserved MSBs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
            prge_instruction_tbl_data.offset_base     = 3; /* (16+2.5+4+4+2+1+3+8+8+0.5+2.5+4+1+1+8+(-64))*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /* Instruction 7 : Generate VxLAN-Header VNI */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0xEE; /* -9 * (8/4) = -18 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /* Instruction 8 : Generate VxLAN-Header.FLAGs,VxLAN-Header.Reserved-LSBs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
            prge_instruction_tbl_data.offset_base     = 127; /* (16+2.5+4+4+2+1+3+8+8+0.5+2.5+4+1+1+6)*8/4 = (63.5)*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /* Instruction 9 : Generate UDP CheckSum */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
            prge_instruction_tbl_data.offset_base     = 128; /* (128+(-64))*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 10 : genrate UDP Length */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
            prge_instruction_tbl_data.offset_base     = 55; /* (16+69.5+2+2+2+(-64))*8/4; R1 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 11 : Generate Dest Port */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
            prge_instruction_tbl_data.offset_base     = 119; /* (16+2.5+4+4+2+1+3+8+8+0.5+2.5+4+1+1+2)*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 12 : Generate Src Port 1 (LB-Key) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
            prge_instruction_tbl_data.offset_base     = 128; /* (128+(-64))*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 13 : Generate Src Port 0 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0; /* SrcSelectHeader */
            prge_instruction_tbl_data.offset_base     = 20; /* (10)*8/4; FTMH-EXT.LB */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



            /* Instruction 14 : IP19_12 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 40; /* (20)*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 15 : IP11_4 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 24; /* (12)*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 16 : IP3_0 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 1; /* (4)*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 17 : Generate LL-ETH 0 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0x12; /* (0)*8/4 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 18 : Generate LL-ETH 1 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0x2; /* (-8)*8/4 = -16 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x1; /* -8 5b' */
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 19 : Generate LL-ETH 2 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
            prge_instruction_tbl_data.offset_base     = 0x0; /* (-16)*8/4 = -32 */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x0; /* -16 5b' */
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            /* Instruction 20 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xf0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x18;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            /* Instruction 21 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;

            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xe0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
            prge_instruction_tbl_data.size_base       = 0x10;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 22 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
        }
    }

    /* Program 13 instructions (entries 26, 27 in each table) - erspan */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) { 
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
    
        /* Instruction 0 : Write ERSPAN-Header 6LSBytes {Priority(3),Reserved(1),Direction(1),Truncated(1),SPAN-ID(10)}
              Directly Extracted from EES1[55:8] */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data */
        prge_instruction_tbl_data.offset_base      = 29; /*(78.5+(-64))*8/4;*/
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 6;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value          = (SOC_IS_JERICHO(unit) ? 8 : 0);
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 7;
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 1 : Write ERSPAN-Header 2MSBytes {Version(4) 0x1,VLAN(12) 0x0}
              Directly Extracted from Program-VAR[15:0] */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data */
        prge_instruction_tbl_data.offset_base      = 0xff; /* -1 */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 2;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.cmp_action       = 0; /* never */
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2: Copy 6 bytes from gen-header (GRE 6LSB) ; R2-=8 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 4;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value          = 8;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 7;
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*
         * Instruction 3 : Write GRE-Header 2MSBytes
         *                          1
         *      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
         *     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         *     |C|R|K|S|s|Recur|A| Flags | Ver |
         *     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         *     |0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0|
         *     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         *     Directly Extracted from Program-VAR[15:0]
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data */
        prge_instruction_tbl_data.offset_base      = 3; /* (65.5+(-64))*8/4; */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 4;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.cmp_action       = 0; /* never */
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 2 and after - Write Generated-Header Without FWD-Header */
        for (mem = EPNI_PRGE_INSTRUCTION_0m + 2; mem < EPNI_PRGE_INSTRUCTION_0m + 9; mem++) {
            /* Instruction 2, 4,.. */
            /*mem   = (entry == entry_odd) ? (mem + 1) : mem;*/
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;/* generated header */
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value          = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action        = 7;
            prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 3, 5,.. */
            /*mem   = (entry == entry_odd) ? (mem + 1) : mem;*/
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0xf0;/* -16;*/
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
            prge_instruction_tbl_data.size_base   = 0x18;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value          = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action        = 0;
            prge_instruction_tbl_data.dst_select        = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
        }

        /* Instraction #18 */
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value          = 8;                       /* since we do not concatenating in the folowing instraction */
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 7;
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instraction #19 - Extract Resolved.Data.tm-port-var (1B)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select  = 2;    
        prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        /* Instraction #20 - Concatenate generated Headers */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value          = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 7;
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instraction #21 - Concatenate generated Headers and
         * ALU operation with LFEM op_value added dest ti R_Size
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base = 0xf0;/* -16;*/
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0x18;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 0x7; /* always */
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; /* R_Size */
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        /* Instraction #22 - Concatenate generated Headers */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* instruction #23
         * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - Resolved Data: out-PP-port */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
        prge_instruction_tbl_data.size_base   = 0; 
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */;
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value    = 0;
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
        prge_instruction_tbl_data.dst_select  = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
     
    }  /* End of ARAD_EGR_PROG_EDITOR_PROG_ERSPAN */

    /* Program 13 instructions (entries 26, 27 in each table) - ERSPAN for B1 and bellow */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) { 

            int mc_support = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "erspan_mc_support", 0) ;
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &program_pointer);
            SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
            entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
            entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
            entry = entry_odd;
    
           /* get the erspan mirror entries offset in prge memory */
           res = arad_sw_db_eg_encap_prge_tbl_nof_dynamic_entries_get(unit, &nof_dynamic_members);
           SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);


            /* Instruction 0 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2:0;
            prge_instruction_tbl_data.offset_base     = (mc_support)? 65:17; /*VSI VAR or shift 68 bits for FTMH.Outlif*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 1 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2:0;
            prge_instruction_tbl_data.offset_base     =  (mc_support)? 65:17; /*VSI VAR or shift 68 bits for FTMH.Outlif*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            /* Instruction 1/2 = 0%2 = 0 --> even lfem */
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : data_addr=fem + 0 (first entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members; /* first entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : rsz = fem +0x10 (prepare the second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members + 16; /*second entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 4 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 : data_addr = rsz (second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6 : nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 8 : copy erspan from mem, rsz = program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            /*arad a0/b0/plus*/
            if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
                prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1 ;
                prge_instruction_tbl_data.op_value        = 8;
                prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7 ;
                prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            } else {
                prge_instruction_tbl_data.op_1_field_select = 0 ;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = 0;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action = 0 ;
                prge_instruction_tbl_data.dst_select      = 0;
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9: Extract Eth Hdr size from mem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            /* Instruction 10 : copy IPv4oGRE from generated header 1/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1 ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 11 : copy IPv4oGRE from generated header 2/4 - total size 28 = 3*8+4; rsz =fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            /* Instruction 12 : copy IPv4oGRE from generated header 3/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 13 : copy IPv4oGRE from generated header 4/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 14 : copy EtherType from DataMem (first entry -top)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 15: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16: copy tag(if exist) from mem eth header, size -> rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17: copy from mem eth header SA*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 24;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 18: copy from mem eth header DA, */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  
    /* Program 15 instructions (entries 30, 31 in each table) - STACKING_PROGRAM */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) { 

        /* Allocate needed branch entries */
        res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_STACKING, &branch_pointer);
        SOC_SAND_IF_ERR_EXIT(res);

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
        
        /* Instruction 0 : --- , r2 = r3 - r1; */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 1 : --- , rsz = r0 - 9 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 9;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 : get PRGE TM var */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolved data */
        prge_instruction_tbl_data.offset_base     = 53; /* 128+20+32+32 bits - port var [9:0] in resolved data */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 3 : Copy system header LSB , r2 = r2 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 4 : jump */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = (entry==entry_odd) ? 1 : 0; /* If this instr. is odd, need to add 1 to the jump address */
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 5 : Copy system header LSB , r3 = r3 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 6 : Copy system header LSB , r2 = r2 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xE0; /* -32 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 7 : Copy system header LSB , r3 = r3 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
    /* STACKING FEM 2 */

    /* Instruction 8 : jump back */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0; 
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                        entry==entry_odd);
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /* Instruction 9 : get stacking ext and perform FEM */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    /* Instruction 9/2 = 4%2 = 0 --> even lfem */
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8,
            mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
    /* Save stacking lfem data for later use */
    /* { */
        lfem_stacking_8_index[unit] = prge_instruction_tbl_data.fem_select;
        lfem_stacking_8_map[unit] = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    /* } */
    prge_instruction_tbl_data.op_1_field_select = 0; 
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* Instruction 10 : Copy other extension */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* Instruction 11 : nop */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* STACKING FEM 3 */

    /* Instruction 8 : jump back */
    mem   = EPNI_PRGE_INSTRUCTION_4m-1;
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
    entry = entry_odd;

    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(program_pointer,
                                                                                        entry==entry_odd);
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* Instruction 9 : get stacking ext and perform FEM */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    /* Instruction 9/2 = 4%2 = 0 --> even lfem */
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10,
            mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
    /* Save stacking lfem data for later use */
    /* { */
        lfem_stacking_10_index[unit] = prge_instruction_tbl_data.fem_select;
        lfem_stacking_10_map[unit] = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    /* } */
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /* Instruction 10 : Copy other extension */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /* Instruction 11 : nop */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  
    /* Jumped back */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
        ARAD_EGR_PROG_EDITOR_PROG_STACKING, &program_pointer);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
    entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
    entry = entry_odd;

    /* Instruction 12 : Extract FTMH [3:0], --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 18;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 13 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 14 : Extract CUD [11:0], r0 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 15 : Extract FTMH [31:20], --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 13;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 16 : ---, r0 = r0 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 17 : Extract CUD [15:12], r1 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 54;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 17/2 = 8%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 18 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 19 :---, r1 = r1 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 20 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 21 : Copy {r1, r0} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 22 : Copy left FTMH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 10;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 5;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 23 : if enabled add as MSB 1Byte of user header*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
#ifdef BCM_88660_A0
        if (SOC_IS_ARADPLUS(unit)) {
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == ARAD_MGMT_FTMH_LB_EXT_MODE_FULL_HASH) ? 1 : 0;
        } else 
#endif /* BCM_88660_A0 */
        {
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
        }
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
		
    /* Program 15 instructions (entries 30, 31 in each table) - STACKING_PROGRAM*/
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;


        /* Instruction 0 : if enabled add as MSB 1Byte of user header*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
		

    /* Program 14 instructions (entries 28, 29 in each table) - rspan */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) { 

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_RSPAN, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;
        
        /* Instruction 0 : copy from data entry 32 bits */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = 29; /*(78.5+(-64))*8/4;*/ 
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 4; /* bytes*/ /* 55:24  (32) + lsb (01)*/
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit); /* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 1 : Copy SA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 0; /*SrcSelectHeader;*/  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = 2 * user_header_size + (12)*8/4; /* FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 6;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);/* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 : Copy SDA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 0; /*SrcSelectHeader;*/  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = 2 * user_header_size + (6)*8/4; /* FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 6;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);/* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 3 : do nothing */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 0; /*SrcSelectHeader;*/  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = (6)*8/4; /* FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 0;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);/* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 4 and after - Write Generated-Header Without FWD-Header */
        for(mem = EPNI_PRGE_INSTRUCTION_0m + 2; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++)
        {
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;/* generated header */
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }  

        /* For this program, fill other instructions with NOPs */
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }



    /*  Program 4 instructions (entries 8, 9 in each table) - ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /*  Instruction 0 : Indirect acceess address = programmable variable (step 1)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; /* resolved data */                                       ;
        prge_instruction_tbl_data.offset_base     = 3; /* 223:160 bits - Programm var[63:0] in resolved data */ ;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        /*offset in nibbles = 0+{bitexpansion=0,40} = 40Nibbles = 160Bit is the offset*/
        prge_instruction_tbl_data.size_base       = 0x0;/*0 - no operation on header*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*no operation on egress*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*default FEM - pass as is*/
        prge_instruction_tbl_data.op_1_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;/*not in use*/
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;/*not in use*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*not in use*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; /*not in use*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Indirect acceess address = programmable variable (step 2)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;/*not in use*/
        prge_instruction_tbl_data.offset_base     = 40; /*not in use*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0x0;/*not in use*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*not in use*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;/*take from FEM - the address as is*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;/*take from ALU result - the address as is*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*no compare*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR; /*Send to data memory*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : copy port prge var to header (2 bytes)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;/*resolved data*/
        prge_instruction_tbl_data.offset_base     = 53; /*prge var in resolved data*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0x2;/*write 2 bytes*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*not in use*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4-7 : nop */
        for (i=4; i<8; i++) {
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;

                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 0;
                prge_instruction_tbl_data.offset_src      = 0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }

        /* Instruction 8: copy 8 LSB of data from data memory to packet header */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;/*resolved data*/
        prge_instruction_tbl_data.offset_base     = 32; /* 8 LSB of data memory */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 8;/*write 8 bytes*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*write 2 bytes*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;/*not in use*/
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;/*not in use*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*not in use*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; /*not in use*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : copy 8 MSB of data from data memory to packet header*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;/*resolved data*/
        prge_instruction_tbl_data.offset_base     = 16; /* 8 MSB of data memory */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 8;/*write 8 bytes*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*write 2 bytes*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;/*not in use*/
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;/*not in use*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*not in use*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; /*not in use*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

        
    /* Program 4 instructions (entries 8, 9 in each table) - ERSPAN Inbound Mirror ERSPAN NO WA + XGS PE from FTMH */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_odd;
            
            /* Instruction 0 : Write ERSPAN-Header 6LSBytes {Priority(3),Reserved(1),Direction(1),Truncated(1),SPAN-ID(10)} Extracted from EES1[55:8]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 1 : Write ERSPAN-Header 2MSBytes {Version(4) 0x1,VLAN(12) 0x0} Extracted from Program-VAR[15:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instructions 2-13 - copy generated without forwarding header (link+1st enc+2nd enc)*/
            for(i = 0; i<6 ; i++)
            {
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 1;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2 ;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
                prge_instruction_tbl_data.op_value    = 16;
                prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action  = 0;
                prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7 ;
                prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
                
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 1;
                prge_instruction_tbl_data.offset_base     = 0xF0;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2 ;
                prge_instruction_tbl_data.size_base     = 0x18;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action  = 0;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
            }
            
            /* Instruction 14: copy PPD from program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 15: copy DP  FRC line 4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16: copy src sys port FRC line 3*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 43;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 17: copy dest sys port FRC line 2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 39;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 18: copy FTMH.TC FRC line 1*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }


    /* Program 4 instructions (entries 8, 9 in each table) - ERSPAN Inbound Mirror ERSPAN WA + XGS PE from FTMH */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {
           int mc_support = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "erspan_mc_support", 0) ;
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_odd;
            
           /* get the erspan mirror entries offset in prge memory */
           res = arad_sw_db_eg_encap_prge_tbl_nof_dynamic_entries_get(unit, &nof_dynamic_members);
           SOC_SAND_CHECK_FUNC_RESULT(res, 376, exit);


            /* Instruction 0 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
           prge_instruction_tbl_data.src_select      = (mc_support)? 2: 0;
          prge_instruction_tbl_data.offset_base     = (mc_support)? 65: 17; /*VSI variable*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 1 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2 : 0;
            prge_instruction_tbl_data.offset_base     = (mc_support)?65 : 17; /*VSI variable*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : data_addr=fem + 0 (first entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members; /* first entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : rsz = fem +0x10 (prepare the second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members + 16; /*second entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 4 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 : data_addr = rsz (second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6 : extract program var for Eth header size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 8 : copy erspan from mem, rsz = program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9 : copy IPv4oGRE from generated header 1/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1 ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10 : copy IPv4oGRE from generated header 2/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 11 : copy IPv4oGRE from generated header 3/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 12 : copy IPv4oGRE from generated header 4/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 13 : copy EtherType from DataMem (first entry -top)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 14: extract DP */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 15: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16: copy from mem the eth header, size -> rsz; r1=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x1E;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17: copy from mem eth header, size -> rsz; r0=0*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x16;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 18: copy from program var PPD 6LSB*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 0xFF;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 19: copy from r0 (0) PPD 2LSB*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 59;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 20: copy DP from r1 (FRC line 4)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 55;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 21: copy src sys port ( FRC line 3)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 22: copy dst sys port ( FRC line 2)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 39;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 23: copy TC ( FRC line 1)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /* epni_prge_mim_ptch2 */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_even;

           /* Instruction 0 - Read 8 LSBs of ACE Var , Set R0=0xF000 */
           prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
           prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_ACE_VARIABLE;
           prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base       = 0;
           res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                   mem, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &(prge_instruction_tbl_data.fem_select));
           prge_instruction_tbl_data.op_1_field_select     = 0;
           prge_instruction_tbl_data.op_value    = 0xF000;
           prge_instruction_tbl_data.op_2_field_select     = 0;
           prge_instruction_tbl_data.alu_action      = 0;
           prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
           prge_instruction_tbl_data.cmp_action  = ARAD_PP_EG_PROG_NO_COMPARE;
           prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           /* Instruction 1 - NOP */
           prge_instruction_tbl_data.src_select  = 0;
           prge_instruction_tbl_data.offset_base = 0;
           prge_instruction_tbl_data.offset_src  = 0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base   = 0;
           prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
           prge_instruction_tbl_data.op_1_field_select     = 0;
           prge_instruction_tbl_data.op_value    = 0;
           prge_instruction_tbl_data.op_2_field_select     = 0;
           prge_instruction_tbl_data.alu_action      = 0;
           prge_instruction_tbl_data.op_3_field_select     = 0;
           prge_instruction_tbl_data.cmp_action  = 0;
           prge_instruction_tbl_data.dst_select  = 0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           /* Instruction 2 - Set R0 = R0 + FEM (ACE)*/
           prge_instruction_tbl_data.src_select  = 0;
           prge_instruction_tbl_data.offset_base = 0;
           prge_instruction_tbl_data.offset_src  = 0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base   = 0;
           prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
           prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
           prge_instruction_tbl_data.op_value    = 0;
           prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R0;
           prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
           prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
           prge_instruction_tbl_data.cmp_action  = ARAD_PP_EG_PROG_NO_COMPARE;
           prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
           
           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           /* Instruction 3 - NOP */
           prge_instruction_tbl_data.src_select  = 0;
           prge_instruction_tbl_data.offset_base = 0;
           prge_instruction_tbl_data.offset_src  = 0;
           prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
           prge_instruction_tbl_data.size_base   = 0;
           prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
           prge_instruction_tbl_data.op_1_field_select     = 0;
           prge_instruction_tbl_data.op_value    = 0;
           prge_instruction_tbl_data.op_2_field_select     = 0;
           prge_instruction_tbl_data.alu_action      = 0;
           prge_instruction_tbl_data.op_3_field_select     = 0;
           prge_instruction_tbl_data.cmp_action  = 0;
           prge_instruction_tbl_data.dst_select  = 0;
           res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
           SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

           arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

           /* Instruction 4 build PTCH */
          prge_instruction_tbl_data.src_select  = 2;  /* Resolved */
          prge_instruction_tbl_data.offset_base = 59; /* R0 */
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 2; /* the size field is 2B */
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* For this program, fill other instructions with NOPs */
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_even;

          /* Instruction 0-11 - Ethernet Copy */
          for(i=0; i<6; i++) {
              prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
              prge_instruction_tbl_data.size_base   = 0x1A/*-6*/;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
              prge_instruction_tbl_data.op_value    = 16;
              prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
              prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

              arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

              prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
              prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
              prge_instruction_tbl_data.size_base   = 0x12/*-14*/;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = 0;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

              arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);
          }

          /* Instruction 12-16 build DA */

          /* Instruction 12 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 13 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 14 */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 8;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 15 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 16 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* For this program, fill other instructions with NOPs */
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
          mem   = EPNI_PRGE_INSTRUCTION_0m;
          res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
              ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM, &program_pointer);
          SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
          entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
          entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
          entry = entry_even;


          /* Instruction 0 */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 12;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 1 - NOP */

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 2-13 - Ethernet Copy */

          /* Instruction 2 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 3 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_value    = 24;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 4 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x10/*-16*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 5 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 6 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 7 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 8 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 9 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0;/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 10 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 11 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 12 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 13-18 build DA */

          /* Instruction 13 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 14 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 15 */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 8;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 16 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 17 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 18 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 12;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* For this program, fill other instructions with NOPs */
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /* Program 10 instructions (entries 28, 29 in each table) - RSPAN  Mirror + XGS */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
               ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &program_pointer);
           SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
           entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
           entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
           entry = entry_odd;
            
            
            /* Instruction 0 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29; /*ees_data1*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            

            /* Instruction 1 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 24 + (user_header_size*2); /*SA*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 12 + (user_header_size*2); /* DA*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 3: copy PPD from program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
            
            /* Instruction 4 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6: copy DP  FRC line 4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7: copy src sys port FRC line 3*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 8: copy dest sys port FRC line 2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 53;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10: copy FTMH.TC FRC line 1*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1)     
    {

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /* Instruction 0 : copy first 2 bytes setting 1 bit to 0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 2 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 1 : copy next 6 bytes with no change */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 4 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
         /* Instruction 2 : Add to junk bytes */
         mem   = (entry == entry_odd) ? (mem + 1) : mem;
         entry = (entry == entry_even) ? entry_odd : entry_even;
         prge_instruction_tbl_data.src_select      = 0;
         prge_instruction_tbl_data.offset_base     = 0;
         prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
         prge_instruction_tbl_data.size_base       = 2 ; 
         prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
         prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
         prge_instruction_tbl_data.op_1_field_select = 0;
         prge_instruction_tbl_data.op_value        = 0;
         prge_instruction_tbl_data.op_2_field_select = 0;
         prge_instruction_tbl_data.alu_action      = 0;
         prge_instruction_tbl_data.op_3_field_select = 0;
         prge_instruction_tbl_data.cmp_action = 0 ;
         prge_instruction_tbl_data.dst_select      = 0;
         res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
         SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                    
         /* For this program, fill other instructions with NOPs */
         mem   = (entry == entry_odd) ? (mem + 1) : mem;
         entry = (entry == entry_even) ? entry_odd : entry_even;
         SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

		/* 0: Get FTMH.Packet_Size */
		/*	  Set R0 = R3 + adjust */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; /* original packet */
        prge_instruction_tbl_data.offset_base = 4; /* Need to move 2B */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* FTMH Header */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value				= (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "add_size_header_adjust", 0)); 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_ADD; 
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 1: Get Network Header Size */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2; /* Registers */
		prge_instruction_tbl_data.offset_base = 35; /* Network Header Size */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action			= 0; 
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action			= 0;
        prge_instruction_tbl_data.dst_select			= 0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 2: Get System Header Size	*/
		/*	  Set R0 = R0 + FTMH.Packet_Size */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2; /* Registers */
		prge_instruction_tbl_data.offset_base = 33; /* System Header Size */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		/* 2/2 = 1 % 2 = 1 -> odd */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 3: Set R1 = Network Header Size - 2 (the size of the private header is not included) */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value				= 2; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R1; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 4: Set R0 = R0 - System Header Size (FEM) */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;  
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 5: NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

		/* 6: Set R0 = R0 - R1 (Network Header Size) */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);
		        
		/* 7-18: Copy Generated Header */
		for(i = 0; i < 6; i++)
		{
			mem   = (entry == entry_odd) ? (mem + 1) : mem;
			entry = (entry == entry_even) ? entry_odd : entry_even;
          
			prge_instruction_tbl_data.src_select  = 1;
			prge_instruction_tbl_data.offset_base = 0;
			prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
			prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
			prge_instruction_tbl_data.size_base   = 0;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
			prge_instruction_tbl_data.op_value    = 16;
			prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
			prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
			prge_instruction_tbl_data.cmp_action  = 0x7;
			prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

			mem   = (entry == entry_odd) ? (mem + 1) : mem;
			entry = (entry == entry_even) ? entry_odd : entry_even;
          
			prge_instruction_tbl_data.src_select  = 1;
			prge_instruction_tbl_data.offset_base = 0xF0; /*-16 */
			prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
			prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
			prge_instruction_tbl_data.size_base   = 0x18; /* -8 */
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select     = 0;
			prge_instruction_tbl_data.op_value    = 0;
			prge_instruction_tbl_data.op_2_field_select     = 0;
			prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select     = 0;
			prge_instruction_tbl_data.cmp_action  = 0;
			prge_instruction_tbl_data.dst_select  = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
		}
		
		/* 19: Append the Packet Size (R0) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select  = 2;	/* Resolved */
        prge_instruction_tbl_data.offset_base = 59; /* R0 */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 2; /* the size field is 2B */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action			= 0; 
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action			= 0;
        prge_instruction_tbl_data.dst_select			= 0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
	}


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {

/* Program 6 instructions (entries 12, 13 in each table) -*/
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
		entry = entry_odd;

/* Instruction 0 : Rsz = R3-R2 (calc native IP length)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 1 : R1 = R2-R0 (calc Overlay length)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 2 : R3 = R3-16 (calc next size), Copy 8B from offset R3*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 3 : Copy 8B from offset R3-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 4 : Copy Remainder from offset R3 (updated in instr2)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x10;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 5 : Copy 8B from Native Eth @ offset R0, Calc next size R0=R0-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 6 : Copy 8B from Native Eth @ offset R0-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 7 : Copy Remainder bytes from Native Eth @ offset R0*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 8 : Take 4 index bits from resolved data*/
/* offset = (128+556-48-4)/4 = 158 nibbles --> const_96 + 62*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2; /* resolved data*/
		prge_instruction_tbl_data.offset_base     = 30;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 9 : nop*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 10 : Set indirect address = FEM result*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
        res = arad_sw_db_eg_encap_prge_tbl_overlay_arp_entries_base_index_get(unit, &prge_instruction_tbl_data.op_value);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
/*  	prge_instruction_tbl_data.op_value        = 0;   */
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 1;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU; 
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 11 : Copy 8B from offset R2 (Overlay), Calc R1=R1-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



/* Instruction 12 : Copy 8B from offset R2-16 (Overlay), Calc R2=R2-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 13 : Copy 8B from offset R2-32 (Overlay), Calc R1=R1-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xE0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 14 : Copy 8B from offset R2 (Overlay)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xD0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 15 : Copy 8B from offset R2 (Overlay)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xC0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 16 : Take 4 size bits from mem data*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 32; /* size is stored in [3:0]*/
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0; 
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 17 : Copy first 8 Bytes of Data-Memory {SA,VLAN,EthType}*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 31;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 8;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 18 : Save FEM result in Rsz*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 19 : NOP*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 20 : Copy remaining bytes of LL-Eth from DATA-Memory (if any)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 15;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



/* Instruction 21 : Copy 6 Bytes from resolved-data, offset=128+256-48-8/4=157 nibbles (LL-Eth {DA})*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 29;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 6; /* 6 bytes == 48 bits DA MAC*/
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

	}

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_JER_ROUTING_OVER_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) ), " --- ;Rsz = R3-R2 (calc native IP length)");
        INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(2) , REG_OP(0)  , REG_OP(1)  ), " --- ;R1 = R2-R0 (calc Overlay length)");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16 (calc next size)");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))      , ALU_SUB(   REG_OP(SZ), CNST(24)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-24");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy Remainder from offset R3 (updated in instr2); r3=r3-16");
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_NOP                                         , "Copy 8B from offset R3-16. size rsz; ---");
        INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))      , ALU_NOP                                         , "Copy 8B from offset R3-16. size rsz-8; ---");
        INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))        , ALU_SUB(   REG_OP(0) , CNST(16)   , REG_OP(0)  ), "Copy 8B from Native Eth @ offset R0; Calc next size R0=R0-16");
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))       , ALU_NOP                                         , "Copy 8B from Native Eth @ offset R0-16; ---");
        INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))        , ALU_SET(         101              , REG_OP(3)  ), "Copy Remainder bytes from Native Eth @ offset R0; r3 = 101");
        INSTR( CE_FLREAD(PrgeDataFieldEesData3, 0, LFEM_4_LSBS), ALU_SET(          97              , REG_OP(SZ) ), "extract ees-data3[3:0] -> vlan_tag_size ; rsz = 97");
        INSTR( CE_COPY(GEN, R_OFST(2,0)  , R_SIZE(1,0))        , ALU_SUB(   REG_OP(1) , CNST(16)   , REG_OP(1)  ), "Copy 8B from offset R2 (Overlay), Calc R1=R1-16");
        INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(1,-8))       , ALU_SUB(   FEM       , CNST(0)    , REG_OP(0)  ), "Copy 8B from offset R2-16 (Overlay), Calc r0=fem_field (tag_size)");
        INSTR( CE_COPY(GEN, R_OFST(2,-32), R_SIZE(1,0))        , ALU_SUB(   REG_OP(1) , CNST(16)   , REG_OP(1)  ), "Copy 8B from offset R2-32 (Overlay), Calc R1=R1-16");
        INSTR( CE_COPY(GEN, R_OFST(2,-48), R_SIZE(1,-8))       , ALU_SET_IF(REG_OP(0) , EQ, CNST(8), REG_OP(3), REG_OP(SZ)), "Copy 8B from offset R2 (Overlay); rsz =(r0 ==8)? r3 : rsz");
        INSTR( CE_COPY(GEN, R_OFST(2,-64), R_SIZE(1,0))        , ALU_NOP                                         , "Copy 8B from offset R2 (Overlay); ---");
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))   , ALU_NOP                                         , "copy from ees_data1[15:0] ether-type ; ---");
        INSTR( CE_COPY(RES, R_OFST(SZ,6) , R_SIZE(0,0))        , ALU_NOP                                         , "copy from ees_data3 vlan tag with size r0(vlan_tag size), offset rsz ; ---");
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, -4, C_SIZE(5))  , ALU_NOP                                         , "copy from ees_data1[55:16] SA 5 LSbytes ; ---");
        INSTR( CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(7))   , ALU_NOP                                         , "copy from ees_data2[55:0] DA 6bytes, SA 1MSbyte ; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
		entry = entry_odd;

		/* Instruction 0 : r0 = r3-r2 */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 1 : nop */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 2 : copy fwd hdr up to Eth SA, r0 = r0-28 */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x14;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 12 + 8;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 3 :  r3 = r3 -16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 4 : copy fwd hdr up to Eth SA ; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 5 : copy fwd hdr up to Eth SA */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        =  16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 6 : copy fwd hdr up to Eth SA ; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 7 : copy fwd hdr up to Eth SA */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        =  16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 8 : copy fwd hdr up to Eth SA ; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 9 : copy fwd hdr up to Eth SA */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        =  16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 10 :   copy DA 6bytes; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 12;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 6;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 11 :   copy SIP 6bytes ; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 24;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 6;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 12 :   copy out_pp_port(PTCH) 2byte; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_PP_PORT;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 1;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 13 :   copy program var 0x80 (PTCH) 1byte; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     =  ARAD_PP_PRGE_PROGRAM_VAR;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 1;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
	}
		

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
	if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Calculate size and offset and copy extra data that was stripped as part of the 42B removal */
        INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SET(0x0800, REG_OP(2))                            , "FEM = SysHdrSize                 ; R2 = 0x0800 (IPv4 Eth-Type)");
        INSTR( CE_NOP                                               , ALU_NOP                                               , "NOP (Let FEM update)");
        INSTR( CE_NOP                                               , ALU_ADD(FEM, CNST(42+user_header_size), REG_OP(1))                     , "---                              ; R1 = SysHdrSize+42");
        INSTR( CE_NOP                                               , ALU_SET(0 , REG_OP(SZ))                               , "---                              ; R2 = 0");
        INSTR( CE_READ(PKT, R_OFST(1,-28*2))                        , ALU_NOP                                               , "FEM = Orig[R1-28B]               ; ---");
        INSTR( CE_READ(PKT, R_OFST(1,-24*2))                        , ALU_NOP                                               , "FEM = Orig[R1-24B]               ; ---");
        INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(8), REG_OP(SZ))   , "---                              ; IF (FEM==0x0800) RSZ=8");
        INSTR( CE_NOP                                               , ALU_SET_IF(FEM, EQ, REG_OP(2), CNST(4), REG_OP(SZ))   , "---                              ; IF (FEM==0x0800) RSZ=4");
        INSTR( CE_NOP                                               , ALU_NOP                                               , "NOP (Let RSZ update)");
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(SZ,0))              , ALU_SUB(REG_OP(1), REG_OP(SZ), REG_OP(1))             , "Copy Extra data                  ; R1 -= RSZ");
        INSTR( CE_NOP                                               , ALU_SUB(CNST(8), REG_OP(SZ), REG_OP(SZ))              , "---                              ; RSZ = 8-RSZ");

        /* Swap SIP,DIP */
        INSTR( CE_COPY(PKT, R_OFST(1,-4*2), C_SIZE(4))              , ALU_SUB(REG_OP(1), CNST(8), REG_OP(1))                , "Copy SIP from original packet    ; R1 -= 8" );
        INSTR( CE_COPY(PKT, R_OFST(1,0), C_SIZE(4))                 , ALU_NOP                                               , "Copy DIP from original packet    ; ---" );

        /* Copy the rest of the IP header + Eth-Type (12B + 2B)*/
        INSTR( CE_COPY(PKT, R_OFST(1,0), C_SIZE(8))                 , ALU_NOP                                               , "Copy the rest of the IP header + Eth-Type" );
        INSTR( CE_COPY(PKT, R_OFST(1,-8*2), C_SIZE(6))              , ALU_NOP                                               , "Copy the rest of the IP header + Eth-Type" );

        /* Copy VLANS */
        INSTR( CE_COPY(GEN, R_OFST(SZ,12*2), R_SIZE(SZ,0))          , ALU_NOP                                               , "Copy VLANS from gen header" );

        /* Swap DA and SA */
        INSTR( CE_COPY(GEN, C_OFST(6*2), C_SIZE(6))                 , ALU_NOP                                               , "Copy DA from gen header" );
        INSTR( CE_COPY(GEN, C_OFST(12*2), C_SIZE(6))                , ALU_NOP                                               , "Copy SA from gen header" );

        /* Build PTCH 0x80<SSP> */
        INSTR( CE_FCOPY(PrgeDataFieldOutPpPort, 0, C_SIZE(1))       , ALU_NOP                                               , "PTCH - SSP");
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))         , ALU_NOP                                               , "PTCH - 0x80");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH_PROGRAMMABLE);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Swap DA and SA */
        /*  0 */INSTR( CE_COPY( PKT, R_OFST(3,12+user_header_size*2), C_SIZE(6) ), ALU_NOP , "Copy DA from original packet" );
        /*  1 */INSTR( CE_COPY( PKT, R_OFST(3,24+user_header_size*2), C_SIZE(6) ), ALU_NOP , "Copy SA from original packet" );

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        int    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /* Instruction 0 : r0 = 1  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 1;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 1 : extract  iNP[79]; rsz = 65  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5 + (user_header_size*2);
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 65;
        prge_instruction_tbl_data.op_2_field_select = 0; 
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 2 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 3 : ------; rsz = (r0 == fem) ? op_value : rsz ( compare mc bit with r0, which is 1, if equal - UC, else MC, rsz holds offset in bytes)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 63;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 4 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 5 : copy 2 bytes from PrgeVar (program), based on rsz offset */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 1;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /*Instruction 0-11 copy generated from Pipe Nwk Hdr*/
        for (i = 0; i < 6; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value    = 16;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }

        /*Instr 12 extract sys hdrs size; -----*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instr 13 extract with lfem { Rsvd2[0],3'b000,PrgePpPortVar[5:0],Rsvd3[15:10] }; --------- */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PP_PORT_VARIABLE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instr 14 Copy OutLif as AID[15:0]; r1 = fem*/
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_LIF;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instr 15 Exctract with lfem 0 FTMH.TC[2:0],0x000} ; r0 = fem (store the extracted OutPpPort) */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instr 16 Copy {Rsvd4,AID[19:16]} - all 0 from PrgeVar[32:16]; r0 = fem*/
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 127;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 17 Copy from UsrHdr LSByte (SB) with offset r1(sys hdr size); r0 = fem +r1 (combine the extraction for Tc and PpPort)*/
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4; /* UsrHdr is with size of 2bytes*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 18 Copy from UsrHdr MSByte {Rsvd3[9:0],SP[5:0]} with offset r1(sys hdr size) and LFEM; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2; /* UsrHdr is with size of 2bytes*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 19 Copy from R0 2 bytes ; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59; /* r0*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 20 Copy FTMH.DP (lfem) {UC(1) , Rsvd1(2) , FTMH.Dp , FHL(1), Rsvd2[2:1]} ; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11; /* */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instr 21 Copy the 2 MSBytes {MC(1) , Mode(1) , Rsvd8[13:0]}; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR; /* */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_MPLS_RAW, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /*intr 0 r2 = r3-r0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*intr 1 nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*intr 2 nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value    = 8;
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action  = 0;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*intr 3 nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value    = 16;
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action  = 0;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*intr 4 nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.size_base   =  0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value    = 16;
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action  = 0;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 0-11 copy generated from Pipe Nwk Hdr*/
        for (i = 0; i < 6; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value    = 16;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.size_base   =  0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 16;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /* Instruction 0 : extract nwk hdr size; r3 = r3+26  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_NWK_HEADERS_SIZE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_END_TLV, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 26;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 1 : copy EndTLV (byte of 0x0); ----  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR; /* `PRGE_PROGRAM_VAR */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 2 : ---; r3 = r3+fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 3 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 4-17 : copy OAM/ETH/System hdrs */
        for (i = 0; i < 7; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select        = 0;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src          = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select        = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select   = 0;
            prge_instruction_tbl_data.op_value          = 0;
            prge_instruction_tbl_data.op_2_field_select   = 0;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select   = 0;
            prge_instruction_tbl_data.cmp_action        = 0;
            prge_instruction_tbl_data.dst_select        = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));
    }


    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_END_TLV_MAID_INT);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Extract the network headers size and check if needs to jump to the string translation branch */
        /*  0 */INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS) , ALU_ADD(    REG_OP(3), CNST(26),             REG_OP(3) ) , "extract nwk hdr size; r3 = r3+26");
        /*  1 */INSTR( CE_NOP                                             , ALU_SET(           4 ,                       REG_OP(0) ) , "--- ; r0=4 (MAID String format code)");
        /*  2 */INSTR( CE_NOP                                             , ALU_ADD(    REG_OP(3),   FEM   ,             REG_OP(3) ) , "--- ; r3 = r3+fem");
        /*  3 */INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        /*  4 */INSTR( CE_LREAD(PKT, R_OFST(3,-30), LFEM_8_LSBS)          , ALU_NOP                                                  , "extract MAID format ; ---");
        /*  5 */INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        /*  6 */INSTR( CE_NOP                      , ALU_JMP_IF(FEM, EQ, REG_OP(0), BRANCH_OAM_STRING_MAID, JUMP_POINT_OAM_MAID_INT) , "--- ; if (FEM == r0) jump to String translation branch");
        /*  7 */INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        /*  8 */INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");
        /*  9 */INSTR( CE_NOP                                             , ALU_NOP                                                  , "NOP");

        /* Preperations are done. In this branch, only need to add 0x00 byte and Copy the original header all the way*/

        /* 10 */INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(1))       , ALU_NOP                                                  , "Copy EndTlv byte; ---");

        /* Instruction 11-23 : copy OAM/ETH/System hdrs */
        for (i = 0; i < 6; i++) {
            INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                        , "copy OAM/ETH/System hdrs");
            INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                        , "copy OAM/ETH/System hdrs");
        }
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))              , ALU_NOP                                                        , "copy OAM/ETH/System hdrs");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Jump instructions - program reaches here if MAID.Format == 4 */
        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_OAM_STRING_MAID);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_OAM_MAID_INT);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Translate the string based MAID to ICC */
        /* 10 */INSTR( CE_COPY(PKT, R_OFST(3,0), C_SIZE(8))               , ALU_SUB(    REG_OP(3), CNST(16),             REG_OP(3) ) , "copy MAID 8bytes ; r3 = r3 - 16");
        /* 11 */INSTR( CE_COPY(PKT, R_OFST(3,-18), C_SIZE(6))             , ALU_NOP                                                  , "copy MAID 6bytes ;  ---");
        /* 12 */INSTR( CE_FCOPY(PrgeDataFieldProgVar, -2, C_SIZE(3))      , ALU_NOP                                                  , "Copy MD Format, MA Format and Length; ---");

        /* Instruction 13-23 : copy OAM/ETH/System hdrs */
        for (i = 0; i < 5; i++) {
            INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                        , "copy OAM/ETH/System hdrs");
            INSTR( CE_COPY(PKT, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                        , "copy OAM/ETH/System hdrs");
        }
        INSTR( CE_COPY(PKT, R_OFST(3,0), R_SIZE(3,0))              , ALU_NOP                                                         , "copy OAM/ETH/System hdrs");

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

   res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        /* Allocate needed branch entries */
        res = arad_egr_prog_editor_branch_pointer_allocate(unit, ARAD_EGR_PROG_EDITOR_BRANCH_DELAY_BASE_ECN2, &branch_pointer);
        SOC_SAND_IF_ERR_EXIT(res);

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &program_pointer);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer);
        entry = entry_odd;

        /* Instruction 0 : extract OAM TS (ftmh, no ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2 * (ftmh_size + ARAD_EGR_PROG_EDITOR_OAM_TS_SIZE + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE - 1) - 3; /* Offset to 12 LSB of OAM-TS-Data field of the OAM-TS ext. */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 1 : extract ToD NTP[28:13] */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_TOD_NTP - 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 2 :   ---; r2 = fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 3 :   Extract Delay Threshold; r1 = fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 4 :   copy IPv4 SIP/DIP; rsz = 0-r2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 5 :   ---; r0 = fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 6 :   ---; rsz = r1 +rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 7 :   extract IPv4.Checksum; r3 = r3-10*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.op_value        = 10;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 8 :   Extract ECN ; rsz = ((r1-r2)>0) ? (r1-r2):rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = (uint8)(2 * (-18)); /* ECN */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 9 :   ---; r1 = fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 10 :   ---; rsz = 3 - fem (== 3 - ECN) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 3;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 11 :   ---; entry  = ((rsz-r0)>0) ? new_jump: continue*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ADDR(branch_pointer, entry == entry_odd);
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 12 :   ---; r2 = r1-rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value        = 1;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 13 :   ---; rsz = 0xFFFF*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0xFFFF;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 14 :   ---; rsz = 0xFFFE*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0xFFFE;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* no jump - continue with simple copy!*/

        /* Instruction 15 : Copy Checksum */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     =  2 * 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 16 : Copy the rest ; r3 = r3-16*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 17 : Copy the rest ;*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 18 : Copy the rest ; r3 = r3-16*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 19 : Copy the rest ;*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));


        /*jump - change checksum and TOS[0]*/
        mem   = EPNI_PRGE_INSTRUCTION_7m;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(branch_pointer);
        entry_even = _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(branch_pointer);
        entry = entry_even;

        /* Instruction 15 : r2 = (r2 == rsz [== 0xFFFF])? 0xFFFE : r2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 0xFFFE;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 16 : r2 = (r2 == rsz [== 0xFFFE])? 0xFFFD  : r2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 0xFFFD;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 17 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 18 : copy checksum from r2 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 19 : copy ip4 lenght,flags,ttl,protocol ; r3 = r3-9*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 9;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 20 : copy the tos, set bit[0] to 1*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS_OR_3,
                                                   mem, ARAD_EGR_PROG_EDITOR_PROG_DELAY_BASED_ECN2, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 21 : Copy the rest ; r3 = r3-16*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 22 : Copy the rest ; */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 23 : Copy the rest ; r3 = r3-16*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd));

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Too many LFEMs to manage */
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* copy network header */
        /* 0*/ INSTR(CE_NOP                                                            ,ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                    ,"---                                                              ; RSZ = R3 - R2");
        /* 1*/ INSTR(CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                 ,ALU_NOP                                                    ,"Read System header size                                           ; ---");
        /* 2*/ INSTR(CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                           ,ALU_SUB(REG_OP(SZ),CNST(16),REG_OP(SZ))                    ,"copy network header                                               ; RSZ -= 16");
        /* 3*/ INSTR(CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))                         ,ALU_ADD( FEM, CNST(user_header_size), REG_OP(1))          ,"copy network header                                               ; R1 = System header LSB (UDH LSB)");
        /* 4*/ INSTR(CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))                          ,ALU_SUB(REG_OP(SZ),CNST(16),REG_OP(SZ))                    ,"copy network header                                               ; RSZ -= 16");
        /* 5*/ INSTR(CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-8))                         ,ALU_NOP                                                    ,"copy network header                                               ; ---");
        /* 6*/ INSTR(CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))                          ,ALU_NOP                                                    ,"copy network header                                               ; ---");
        /* 7*/ INSTR(CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))                         ,ALU_NOP                                                    ,"copy network header                                               ; ---");
        /* check and copy ESI */
        /* 8*/ INSTR( CE_FREAD(PrgeDataFieldEesData2, 0)                                , ALU_ADD(REG_OP(1),CNST(0),REG_OP(3))                      , "Read PE-ID[15:0] from EEDB data                                  ; R3 = R1");
        /* 9*/ INSTR( CE_FREAD(PrgeDataFieldEesData2, -1)                               , ALU_SET( 0x0002, REG_OP(SZ) )                              , "Read PE-ID[19:4] from EEDB data                                  ; RSZ = 2");
        /*10*/ INSTR( CE_READ(PKT, R_OFST(3,-5))                                        , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Read PE-ID[15:0] from UDH                                        ; R1 = EEDB.PE-ID[15:0]");
        /*11*/ INSTR( CE_READ(PKT, R_OFST(3,-6))                                        , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Read PE-ID[19:4] from UDH                                        ; R1 = EEDB.PE-ID[19:4]");
        /*12*/ INSTR( CE_NOP                                                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))      , "---                                                              ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
        /*13*/ INSTR( CE_NOP                                                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))      , "---                                                              ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
        /*14*/ INSTR( CE_NOP                                                            , ALU_NOP                                                    , "---                                                              ; ---");
        /*15*/ INSTR( CE_LCOPY(PKT, R_OFST(3,0), R_SIZE(SZ,0), LFEM_ESI_LSB)            , ALU_NOP                                                    , "Try to add ESI-label[15:0]                                       ; ---");
        /*16*/ INSTR( CE_COPY(PKT, R_OFST(3,-1), R_SIZE(SZ,0))                          , ALU_SUB( CNST(2), REG_OP(SZ), REG_OP(SZ) )                , "Try to add ESI-label[31:16]                                      ; Invert RSZ");
        /* copy IML and LSP */
        /*17*/ INSTR( CE_LCOPY(GEN, R_OFST(2,0), R_SIZE(SZ,0), LFEM_ZERO_BIT8)          , ALU_NOP                                                    , "Try to add IML[15:0] BOS bit cleared                             ; ---");
        /*18*/ INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                           , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ))                 , "If RSZ != 0 (After invert), add the 2 LSbytes of the IML label   ; RSZ = R2 - R0");
        /*19*/ INSTR( CE_NOP                                                            , ALU_NOP                                                    , "---                                                              ; ---");
        /*20*/ INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(SZ,-2))                         , ALU_NOP                                                    , "Copy IML MSBytes and LSP                                         ; ---");
        /* copy LL */
        /*21*/ INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                            , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
        /*22*/ INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))                         , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
        /*23*/ INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                            , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))                   , "Copy SA                                                          ; ---");
        /*24*/ INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))                          , ALU_NOP                                                   , "Copy DA                                                          ; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_BRIDGE_ESI_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Too many LFEMs to manage */
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* copy network header */
        /* 0*/ INSTR( CE_NOP                                                            ,ALU_SUB(REG_OP(3),REG_OP(2),REG_OP(SZ))                    ,"---                                                               ; RSZ = R3 - R2");
        /* 1*/ INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)                 , ALU_NOP                                                   ,"Read System header size                                          ; ---");
        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                           ,ALU_SUB(REG_OP(SZ),CNST(16),REG_OP(SZ))                    ,"copy network header                                               ; RSZ -= 16");
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))                        ,ALU_ADD( FEM, CNST(user_header_size), REG_OP(1))           ,"copy network header                                               ; R1 = System header LSB (UDH LSB)");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(SZ,0))                         ,ALU_SUB(REG_OP(SZ),CNST(16),REG_OP(SZ))                    ,"copy network header                                               ; RSZ -= 16");
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-48), R_SIZE(SZ,-8))                        , ALU_NOP                                                   , "copy network header                                              ; ---");
        /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-64), R_SIZE(SZ,0))                         , ALU_NOP                                                   , "copy network header                                              ; ---");
        /* 7*/ INSTR(CE_COPY(GEN, R_OFST(3,-80), R_SIZE(SZ,-8))                         ,ALU_NOP                                                    ,"copy network header                                               ; ---");
        /* check and copy ESI, prepare FRR[15:0] */
        /* 8*/ INSTR( CE_FREAD(PrgeDataFieldEesData2, 0)                                , ALU_ADD(REG_OP(1),CNST(0),REG_OP(3))                      , "Read PE-ID[15:0] from EEDB data                                  ; R3 = R1");
        /* 9*/ INSTR( CE_FREAD(PrgeDataFieldEesData2, -1)                               , ALU_SET( 0x0002, REG_OP(SZ) )                             , "Read PE-ID[19:4] from EEDB data                                 ; RSZ = 2");
        /*10*/ INSTR( CE_READ(PKT, R_OFST(3,-5))                                        , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Read PE-ID[15:0] from UDH                                        ; R1 = EEDB.PE-ID[15:0]");
        /*11*/ INSTR( CE_READ(PKT, R_OFST(3,-6))                                        , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "Read PE-ID[19:4] from UDH                                        ; R1 = EEDB.PE-ID[19:4]");
        /*12*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)                    , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))      , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label                      ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
        /*13*/ INSTR( CE_NOP                                                            , ALU_SET_IF(FEM, NEQ, REG_OP(1), CNST(0), REG_OP(SZ))      , "---                                                              ; UDH.PE-ID != EEDB.PE-ID ? RSZ = 0");
        /*14*/ INSTR( CE_NOP                                                            , ALU_SUB( FEM, CNST(0), REG_OP(1) )                        , "---                                                              ; R1 = EXP[2:0],S,TTL[7:0]");
        /*15*/ INSTR( CE_LCOPY(PKT, R_OFST(3,0), R_SIZE(SZ,0), LFEM_ESI_LSB)            , ALU_NOP                                                   , "Try to add ESI-label[15:0]                                      ; ---");
        /*16*/ INSTR( CE_COPY(PKT, R_OFST(3,-1), R_SIZE(SZ,0))                          , ALU_SUB( CNST(2), REG_OP(SZ), REG_OP(SZ) )                , "Try to add ESI-label[31:16]                                      ; Invert RSZ");
        /* copy IML, LSP, FRR */
        /*17*/ INSTR( CE_LCOPY(GEN, R_OFST(2,0), R_SIZE(SZ,0), LFEM_ZERO_BIT8)          , ALU_NOP                                                    , "Try to add IML[15:0] BOS bit cleared                            ; ---");
        if (SOC_IS_JERICHO_PLUS(unit)) {
            /*18*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5, LFEM_LSHIFT_12)          , ALU_NOP                                                    , "FEM = {FRR-label[3:0],12'h0} from Eesdata2                      ; ---");
        } else {
            /*18*/ INSTR( CE_LREAD(GEN, C_OFST(32), LFEM_LSHIFT_12)                     , ALU_NOP                                                    , "FEM = {FRR-label[3:0],12'h0} from vlan tag                      ; ---");
        }
        /*19*/ INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                           , ALU_SUB(REG_OP(2), REG_OP(0), REG_OP(SZ))                 , "If RSZ != 0 (After invert), add the 2 LSbytes of the IML label   ; RSZ = R2 - R0");
        /*20*/ INSTR( CE_NOP                                                            , ALU_ADD( FEM, REG_OP(1), REG_OP(1))                       , "---                                                              ; R1 += FEM [== {Label[3:0],EXP[2:0],0,TTL[7:0]}]");
        /*21*/ INSTR( CE_COPY(GEN, R_OFST(2,-4), R_SIZE(SZ,-2))                         , ALU_NOP                                                   , "Copy IML MSBytes and LSP                                         ; ---");
        if (SOC_IS_JERICHO_PLUS(unit)) {            
            /*22*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(0), CNST(12), REG_OP(3))                 , " Add FRR[15:0]                                                     ; R3 = R0 - 12 == Size to copy before {DA,SA}");
            /*23*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))                , ALU_NOP                                                   , "Add FRR[31:16] from EesData2                                     ; ---");
        } else {
            /*22*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                       , ALU_SUB(REG_OP(0), CNST(16), REG_OP(3))                 , " Add FRR[15:0]                                                     ; R3 = R0 - 16 == Size to copy before {DA,SA,OuterVLAN}");
            /*23*/ INSTR( CE_COPY(GEN, C_OFST(31), C_SIZE(2))                           , ALU_NOP                                                   , "Add FRR[31:16] from candidate                                    ; ---");
        }
        /* copy LL */
        /*24*/ INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(3,0))                            , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
        /*25*/ INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(3,-8))                         , ALU_NOP                                                   , "Copy Eth-Type,InnerVLAN?,OuterVLAN?                              ; ---");
        /*26*/ INSTR( CE_COPY(GEN, C_OFST(24), C_SIZE(6))                               , ALU_NOP                                                   , "Copy SA                                                          ; ---");
        /*27*/ INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                               , ALU_NOP                                                   , "Copy DA                                                          ; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    /* same instruction set will be performed for ARAD_EGR_PROG_EDITOR_PROG_MPLS_OVER_UDP as well */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get( unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPV4_OVER_UDP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Too many LFEMs to manage */
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*00*/ INSTR( CE_LREAD(GEN, R_OFST(0,20),LFEM_8_LSBS)               , ALU_SET( 17, REG_OP(SZ))                                    , "Reed IPv4.protocol into FEM    ; RSZ = 17");
        /*01*/ INSTR( CE_NOP                                                 , ALU_SUB( REG_OP(3), REG_OP(1), REG_OP(SZ))                 , "---                            ; RSZ = R3 - R1");
        /*02*/ INSTR( CE_NOP                                                , ALU_JMP_IF(FEM, EQ, REG_OP(SZ), BRANCH_IP_OVER_UDP, JUMP_POINT_IP_OVER_UDP) ,"---            ; jump if UDP and action needed");
        /*03*/ INSTR( CE_NOP                                                 , ALU_NOP                                                     , "---                           ; ---");
        /*04*/ INSTR( CE_NOP                                                 , ALU_NOP                                                     , "---                           ; ---");
        /*05*/ INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "---                           ; RSZ -= 16 (Prepare for PP-Copy loop with seperate size register)");
        /* Instruction 6-27 : copy all candidate headers */
        for (j = 0; j < 11; j++) {
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                        , "copy all candidate headers ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))          , ALU_NOP                                                        , "copy all candidate headers ; ---");
        }
        
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        res = arad_egr_prge_mgmt_build_branch_start(unit, ARAD_EGR_PROG_EDITOR_BRANCH_IP_OVER_UDP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        res = arad_egr_prge_mgmt_branch_usage_add(unit, ARAD_EGR_PROG_EDITOR_JUMP_POINT_IP_OVER_UDP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 6-13 : copy till UDP header with offset + 8B */
        for (j = 0; j < 4; j++) {
            INSTR( CE_COPY(GEN, R_OFST(3,16), R_SIZE(SZ,0))              , ALU_SUB( REG_OP(3), CNST(16), REG_OP(3))                  , "Copy till UDP header with offset + 8B ;  R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,8))              , ALU_SUB( REG_OP(SZ), CNST(16), REG_OP(SZ))                , "Copy till UDP header with offset + 8B ; RSZ -= 16");
        }

        /*14*/ INSTR( CE_READ(GEN, R_OFST(1,-4))                            , ALU_NOP                                                   , "Read UDP.length                      ; ---");
        /*15*/ INSTR( CE_NOP                                                , ALU_SUB( REG_OP(1), CNST(6), REG_OP(1) )                  , "---                                  ; R1 -= 6");
        /*16*/ INSTR( CE_COPY(GEN, R_OFST(1,0), C_SIZE(2))                   , ALU_SUB( FEM, CNST(8), REG_OP(3))                        , "Copy UDP.checksun                    ; R3 = UDP.length - 8");
        /*17*/ INSTR( CE_NOP                                                 , ALU_NOP                                                   , "---                                 ; ---");
        /*18*/ INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))               , ALU_NOP                                                   , "Copy UDP.length                      ; ---");
        /*19*/ INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))          , ALU_NOP                                                   , "Copy UDP.dest_port                   ; ---");

        /* Instruction 20-27 : copy rest of UDP, IP, ETH */
        for (j = 0; j < 4; j++) {
            INSTR( CE_COPY(GEN, R_OFST(1,0), R_SIZE(1,0))             , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))                        , "copy all candidate headers ; R1 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(1,-16), R_SIZE(1,-8))          , ALU_NOP                                                        , "copy all candidate headers ; ---");
        }

        res = arad_egr_prge_mgmt_build_branch_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_EVPN_ROO_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_JERICHO_PLUS(unit)) {
            /* 0*/ INSTR( CE_NOP                                                , ALU_SUB(REG_OP(3) ,REG_OP(0) , REG_OP(SZ))    , " ---                                         ; Rsz = R3-R0 (calc native IP length + ETH + Enc)");
            /* 1*/ INSTR( CE_NOP                                                , ALU_NOP                                       , " ---                                         ; ---");
            /* 2*/ INSTR( CE_NOP                                                , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "---                                          ; Rsz -= 16 (Prepare for PP-Copy loop with seperate size register)");
            /* Instruction 3-14 : copy IP/ETH/Enc hdrs */
            for (i = 0; i < 6; i++) {
                INSTR( CE_COPY( GEN, R_OFST(3, 0) , R_SIZE(SZ, 0) )             , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "copy IP/ETH/Enc hdrs ");
                INSTR( CE_COPY( GEN, R_OFST(3,-16), R_SIZE(SZ, 8) )             , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "copy IP/ETH/Enc hdrs ");
            }

            /*15*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)       , ALU_NOP                                       , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label   ; ---");
            /*16*/ INSTR( CE_NOP                                                , ALU_NOP                                       , "---                                          ; ---");
            /*17*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5, LFEM_LSHIFT_12) , ALU_SUB(FEM, CNST(0), REG_OP(3))             , "FEM = {FRR-label[3:0],12'h0}                 ; R3 = {EXP[2:0],S,TTL[7:0]}");
            /*18*/ INSTR( CE_NOP                                                , ALU_NOP                                       , "---                                          ; ---");   
            /*19*/ INSTR( CE_NOP                                                , ALU_ADD(FEM, REG_OP(3), REG_OP(3))            , "---                                          ; R3 += FEM [== {Label[3:0],EXP[2:0],S,TTL[7:0]}]");
            /*20*/ INSTR( CE_NOP                                                , ALU_NOP                                       , "---                                          ; ---");
            /*21*/ INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))               , ALU_NOP                                       , "Adding FRR[15:0]                         ; ---");
            /*22*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))        , ALU_NOP                                       , "Adding FRR[31:16] from EesData2          ; ---");

            /* copy link layer */
            /*23*/ INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "copy link layer");
            /*24*/ INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))             , ALU_NOP                                       , "copy link layer");
            /*25*/ INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "copy link layer");
            /*26*/ INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))             , ALU_NOP                                       , "copy link layer");
            /*27*/ INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))                , ALU_NOP                                       , "copy link layer");
        }else {
            /* 0*/ INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(3) , REG_OP(2)  , REG_OP(SZ) ), " ---                                             ;Rsz = R3-R2 (calc native IP length)");
            /* 1*/ INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(2) , REG_OP(0)  , REG_OP(1)  ), " ---                                             ;R1 = R2-R0 (calc Overlay length)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3                           ; R3 = R3-16 (calc next size)");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))      , ALU_SUB(   REG_OP(SZ), CNST(24)   , REG_OP(SZ) ), "Copy 8B from offset R3-16                        ; rsz=rsz-24");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy Remainder from offset R3 (updated in instr2); r3=r3-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_NOP                                         , "Copy 8B from offset R3-16. size rsz              ; ---");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))      , ALU_SET(         100              , REG_OP(SZ) ), "Copy 8B from offset R3-16. size rsz-8            ; RSZ=100 (offset to inner VLAN)");
            /* 7*/ INSTR( CE_FLREAD(PrgeDataFieldEesData3, 0, LFEM_4_LSBS), ALU_SET(         104              , REG_OP(3)  ), "extract ees-data3[3:0] -> vlan_tag_size          ; R3 = 101");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))        , ALU_SUB(   REG_OP(0) , CNST(16)   , REG_OP(0)  ), "Copy 8B from Native Eth @ offset R0              ; Calc next size R0=R0-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))       , ALU_SUB(   FEM       , CNST(0)    , REG_OP(0)  ), "Copy 8B from Native Eth @ offset R0-16           ; R0 = Tag-Size");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(0,0))        , ALU_SUB(   REG_OP(2) , REG_OP(1)  , REG_OP(2)  ), "Copy Remainder bytes from Native Eth @ offset R0 ; r2 = offset to overlay MSB");
            /*11*/ INSTR( CE_COPY(GEN, R_OFST(2,0)  , R_SIZE(1,0))        , ALU_NOP                                         , "Copy 8B from offset R2 (Overlay)                 ; ---");
            /*12*/ INSTR( CE_LREAD(GEN, R_OFST(2,6), LFEM_FRR_EXP_S_TTL)  , ALU_NOP                                         , "FEM = EXP[2:0],0,TTL[7:0] for the FRR label      ; ---");
            /*13*/ INSTR( CE_NOP                                          , ALU_NOP                                         , "---                                               ; ---");
            /*14*/ INSTR( CE_LREAD(RES, R_OFST(SZ,0), LFEM_LSHIFT_12)     , ALU_SUB(   FEM       , CNST(0)    , REG_OP(2)  ), "FEM = {FRR-label[3:0],12'h0}                     ; R2 = {EXP[2:0],S,TTL[7:0]}");
            /*15*/ INSTR( CE_NOP                                          , ALU_NOP                                         , "---                                               ; ---");
            /*16*/ INSTR( CE_NOP                                          , ALU_ADD(   FEM       , REG_OP(2)  , REG_OP(2)  ), "---                                              ; R2 += FEM [== {Label[3:0],EXP[2:0],S,TTL[7:0]}]");
            /*17*/ INSTR( CE_NOP                                          , ALU_NOP                                         , "---                                              ; ---");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldR2, 0, C_SIZE(2))         , ALU_NOP                                         , "Add FRR[15:0]                                    ; ---");
            /*19*/ INSTR( CE_COPY(RES, R_OFST(SZ,-1), C_SIZE(2))          , ALU_NOP                                         , "Add FRR[31:16]                                   ; ---");
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))   , ALU_NOP                                         , "copy from ees_data1[15:0] ether-type             ; ---");
            /*21*/ INSTR( CE_COPY(RES, R_OFST(3,0) , R_SIZE(0,-4))        , ALU_NOP                                         , "copy from ees_data3 vlan tag with size r0-4(vlan_tag size), offset r3 ; ---");
            /*22*/ INSTR( CE_FCOPY(PrgeDataFieldEesData1, -4, C_SIZE(5))  , ALU_NOP                                         , "copy from ees_data1[55:16] SA 5 LSbytes          ; ---");
            /*23*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, 0, C_SIZE(7))   , ALU_NOP                                         , "copy from ees_data2[55:0] DA 6bytes, SA 1MSbyte  ; ---");
        }
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Copy all the L3 data from the candidate header */
        /* 0*/ INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(3) , REG_OP(0)  , REG_OP(SZ) ), " --- ;Rsz = R3-R0 (calc native + mpls size)");
        /* 1*/ INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))      , ALU_SUB(   REG_OP(SZ), CNST(24)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-24");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");
        /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
        /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");
        /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)   , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
        /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)   , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");

        /* Build FRR label */
        /*10*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)  , ALU_NOP                                         , "FEM = EXP[2:0],S,TTL[7:0] for the FRR label ; ---");
        /*11*/ INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        /*12*/ INSTR( CE_LREAD(GEN, C_OFST(32), LFEM_LSHIFT_12)       , ALU_SUB(   FEM       , CNST(0)    , REG_OP(3)  ), "FEM = {FRR-label[3:0],12'h0} from vlan tag ; R3 = EXP[2:0],S,TTL[7:0]");
        /*13*/ INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(0) , CNST(16)   , REG_OP(2)  ), "--- ; R2 = size of {InnerVLAN?,Eth-type}");
        /*14*/ INSTR( CE_NOP                                          , ALU_ADD(   FEM       , REG_OP(3)  , REG_OP(3)  ), "--- ; R3 += FEM [== {Label[3:0],EXP[2:0],0,TTL[7:0]}]");
        /*15*/ INSTR( CE_NOP                                          , ALU_NOP                                         , "NOP");
        /*16*/ INSTR( CE_FCOPY(PrgeDataFieldR3,0, C_SIZE(2))          , ALU_NOP                                         , "Add FRR[15:0] ; ---");
        /*17*/ INSTR( CE_COPY(GEN, C_OFST(31), C_SIZE(2))             , ALU_NOP                                         , "Add FRR[31:16] ; ---");

        /* Copy L2 from the candidate header */
        /*18*/ INSTR( CE_COPY(GEN, R_OFST(0,0)  , R_SIZE(2,0))        , ALU_NOP                                         , "Copy Eth-Type and InnerVLAN?");
        /*19*/ INSTR( CE_COPY(GEN, C_OFST(24)   , C_SIZE(6)  )        , ALU_NOP                                         , "Copy SA; ---");
        /*20*/ INSTR( CE_COPY(GEN, C_OFST(12)   , C_SIZE(6)  )        , ALU_NOP                                         , "Copy DA; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_ELI_JER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Copy fwd header from the candidate header */
        /* 0*/ INSTR( CE_NOP                                          , ALU_SUB(   REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ;Rsz = R3-R2 (calc native + mpls size)");
        /* 1*/ INSTR( CE_NOP                                          , ALU_NOP                                           , "NOP");
        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,-8))      , ALU_SUB(   REG_OP(SZ), CNST(24)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-24");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))       , ALU_SUB(   REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; rsz=rsz-16");
        /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-16))     , ALU_SUB(   REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3 ; R3 = R3-16"   );

        /* Copy EL and create ELI */
        /* 7*/ INSTR( CE_LREAD(GEN, R_OFST(2,-8), LFEM_12_LSBS)       , ALU_SUB(   REG_OP(2) , CNST(4)      , REG_OP(2)  ), "FEM=MPLS[11:0] ; R2-=4");
        /* 8*/ INSTR( CE_COPY(GEN, R_OFST(2,0) , C_SIZE(4))           , ALU_NOP                                           , "Copy EL");
        /* 9*/ INSTR( CE_NOP                                          , ALU_ADD(   FEM       , CNST(0x7000) , REG_OP(1)  ), "R1 = {4?h7,MPLS[11:0]}");
        /*10*/ INSTR( CE_NOP                                          , ALU_NOP                                           , "NOP");
        /*11*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))         , ALU_NOP                                           , "Add ELI 2LSB");
        /*12*/ INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))    , ALU_NOP                                           , "Add ELI 2MSB");

        /* Copy the rest */
        for (i = 0; i < 4; i++) {
            /*13,15,17,19*/INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))                        , "Copy 8B from offset R2 ; r2 -= 16");
            /*14,16,18,20*/INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(2,-8))          , ALU_NOP                                                        , "Copy 8B from offset R2-16 ; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_ELI_JER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Copy fwd header from the candidate header */
        /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
        /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");

        /* Copy EL and create ELI */
        /* 6*/ INSTR( CE_LREAD(GEN, R_OFST(2,-8), LFEM_12_LSBS)                 , ALU_SUB( REG_OP(2) , CNST(4)      , REG_OP(2)  ), "FEM=MPLS[11:0] ; R2-=4");
        /* 7*/ INSTR( CE_COPY(GEN, R_OFST(2,0) , C_SIZE(4))                     , ALU_NOP                                           , "Copy EL");
        /* 8*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , CNST(0x7000) , REG_OP(1)  ), "R1 = {4'h7,MPLS[11:0]}");
        /* 9*/ INSTR( CE_NOP                                                    , ALU_NOP                                           , "NOP");
        /*10*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB( REG_OP(2) , REG_OP(0)    , REG_OP(SZ) ), "Add ELI 2LSB ; RSZ = R2 - R0 (MPLS size)");
        /*11*/ INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))              , ALU_NOP                                         , "Add ELI 2MSB");

        /* Copy MPLS   */
        /*12*/ INSTR( CE_COPY(GEN, R_OFST(2,0)  , R_SIZE(SZ,0))                 , ALU_NOP                                         , "Copy up to 8B from offset R2"   );
        /*13*/ INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8))                , ALU_NOP                                         , "Copy up to 8B from offset R2"   );

        /* Add more MPLS labels from EES-Data2   */
        /*14*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_12_LSBS)                  , ALU_NOP                                         , "Read MPLS EXP,S,TTL");
        /*15*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_NOP                                         , "Read ExtLabel2-Valid");
        /*16*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
        /*17*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
        /*18*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
        /*19*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
        /*20*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
        /*21*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
        /*22*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2LSB");
        /*23*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, R_SIZE(SZ,0))         , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2MSB");

        /* Copy ETH   */
        /*24*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
        /*25*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
        /*26*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
        /*27*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_BASIC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Copy candidate header except Link layer */
        /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(1)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding haeder + second mpls header)");
        /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");

        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
        /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );

        /* Add more MPLS labels from EES-Data2   */
        /*10*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
        /*11*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M) , ALU_SUB(REG_OP(1) , CNST(0),REG_OP(2))                           , "Read ExtLabel1-Valid, R2=R1");
        /*12*/ INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
        /*13*/ INSTR( CE_NOP                                                                                                 , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
        /*14*/ INSTR(  CE_FLREAD(PrgeDataFieldEesData2, 0 , LFEM_LSHIFT_12)        , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of DataLabel1");
        /*14*/ INSTR(  CE_NOP        ,                                                                                           ALU_NOP, " --- ; R1 = 2LSB of DataLabel1");
        /*15*/ INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                                                  , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
        /*16*/ INSTR( CE_FCOPY(PrgeDataFieldEesData1, -5, C_SIZE(2))                   ,ALU_SUB(REG_OP(2) , REG_OP(0),REG_OP(3) ) , "Copy DataLabel1 2LSB, R3=R2-R0");
        /*17*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)            , ALU_NOP, "Copy DataLabel1 2MSB");
     
        /*18*/ INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                   ,ALU_SET(2,REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, R2=2");
        /*19*/ INSTR( CE_NOP                                                                             , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "Copy DataLabel1 2MSB");     
        /*20*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
        /*21*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
      
        /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
        /*23*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        /* Inject COE Tag */
        /*24*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
        /*25*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
        /*26*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
        /*27*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
    
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_BOS);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            /*Too many LFEM used*/
            res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                    SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);
    
        /* Copy candidate header except Link layer */
        /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding haeder + second mpls header)");
        /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");

        /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
        /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
        /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
        /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
        /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );

        /*10*/ INSTR( CE_LREAD(GEN, R_OFST(2,0), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
        /*11*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M)      , ALU_NOP   ,                                       "Read ExtLabel1-Valid,----");
        /*12*/ INSTR( CE_COPY(GEN, R_OFST(2,0), C_SIZE(0))                      , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "----- ; R3 = {EXP,BOS=1,TTL}");
        /*13*/ INSTR(   CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(4))    ,       ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), " Copy  Datalabel 4 Bytes ; RSZ=extLabel size");
        /*14*/ INSTR( CE_NOP          ,                                                                                     ALU_SUB( FEM       , CNST(0X100)      , REG_OP(1) ), " --- ; R1 = 2LSB of Gen mpls label + bos=1");
        /*15*/ INSTR(CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     ,  ALU_SUB(REG_OP(2),REG_OP(0),REG_OP(1))      , "Copy DataLabel1 2LSB, R1= R2");
        /*16*/ INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                 ,  ALU_NOP      , "Copy Gen Label 2LSB,------");
        /*17*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)      , REG_OP(1) ), "Copy Coe flag, R1=extLabel 2LSB + R3");
        /*18*/ INSTR(  CE_COPY(GEN, R_OFST(2,-4), R_SIZE(1,-2))                 , ALU_SET(2,REG_OP(2))    , "Copy Rest of Gen mpls label, R2=2");
        /*19*/ INSTR( CE_NOP                                                                                         ,      ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "If (!CoE)  R2=0");
        /*20*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
        /*21*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP , "Copy ExtLabel1 2MSB");

        /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
        /*23*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        /* Inject COE Tag */
        /*24*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
        /*25*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
        /*26*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
        /*27*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }


        res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS, &prog_used);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
        if (prog_used != -1) {
        
            res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_NONBOS);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /* Copy candidate header except Link layer */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (forwarding haeder + second mpls header)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
        
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16"   );
            /* Add more MPLS labels from EES-Data2   */
            /*10*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
            /*11*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M)      , ALU_SUB(REG_OP(2) , CNST(0),REG_OP(2))                           , "Read ExtLabel1-Valid, R2=R1");
            /*12*/ INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4  , LFEM_LSHIFT_12)    , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
            /*13*/ INSTR( CE_NOP                                                    , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
            /*14*/ INSTR(  CE_FLREAD(PrgeDataFieldEesData2, 0 , LFEM_LSHIFT_12)     , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of DataLabel1");
            /*14*/ INSTR(  CE_NOP                                                   , ALU_NOP, " --- ; R1 = 2LSB of DataLabel1");
            /*15*/ INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                  , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
            /*16*/ INSTR( CE_FCOPY(PrgeDataFieldEesData1, -5, C_SIZE(2))            , ALU_SUB(REG_OP(2) , REG_OP(0),REG_OP(3) ) , "Copy DataLabel1 2LSB, R3=R2-R0");
            /*17*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_NOP, "Copy DataLabel1 2MSB");
    
            /*18*/ INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                    , ALU_SET(2,REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, R2=2");
            /*19*/ INSTR( CE_NOP                                                    , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "Copy DataLabel1 2MSB");     
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
            /*21*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
          
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
            /*23*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
            /* Inject COE Tag */
            /*24*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
            /*25*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
            /*26*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
            /*27*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      
        
            res = arad_egr_prge_mgmt_build_program_end(unit);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        }
        



    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_FOUR_ENCAP_DATA_TUNNEL_ACT_SWAP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        /*Too many LFEM used*/
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
                SOC_SAND_CHECK_FUNC_RESULT(res, 371, exit);

        /* Copy candidate header except Link layer and mpls tunnel */
        /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(2)    , REG_OP(SZ) ), " --- ; Rsz = R3-R1 (forwarding header)");
        /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(SZ) , CNST(4)      , REG_OP(SZ)  ), " --- ; R3 -= 4 (Adjust offset)");
        /* 2*/ INSTR( CE_NOP                                                    , ALU_NOP  , " ---,----");

        /*For forwardindg code mpls, copy 16 Bytes is enough*/  
        /* 3*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
        /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16"   );
        /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");

        /* Add more MPLS labels from EES-Data2   */
        /*6*/ INSTR( CE_LREAD(GEN, R_OFST(2,8), LFEM_MPLS_EXP_BOS_TTL)          , ALU_NOP                                         , "Read MPLS EXP,S,TTL");
        /*7*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BITS_0_M)       , ALU_NOP                           , "Read ExtLabel1-Valid, ");
        /*8*/ INSTR( CE_FLREAD(PrgeDataFieldEesData1, -4  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(1)      , REG_OP(3)  ), "Read DataLabel1[3:0]<<12 ; R3 = {EXP,S,TTL-1}");
        /*9*/ INSTR( CE_NOP                                                     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel1-Valid ? 2 : 0");
        /*10*/ INSTR(  CE_FLREAD(PrgeDataFieldEesData2, 0 , LFEM_LSHIFT_12)     , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of DataLabel1");
        /*11*/ INSTR(  CE_NOP                                                   , ALU_NOP, " --- ; ");
        /*12*/ INSTR(  CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                  , ALU_ADD( FEM       , CNST(0)    , REG_OP(1)  ), " copy datalabel 2LSB ; R1 = 2LSB of ExtLabel2");
        /*13*/ INSTR( CE_FCOPY(PrgeDataFieldEesData1, -5, C_SIZE(2))            , ALU_SUB(REG_OP(2) , REG_OP(0),REG_OP(3) ) , "Copy dataLabel 2MSB, R3=R2-R0");
        /*14*/ INSTR(     CE_NOP                                                , ALU_NOP, "------------");
        /*15*/ INSTR( CE_LREAD(GEN, R_OFST(2,0), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
        /*16*/ INSTR(  CE_NOP                                                   , ALU_NOP, " --- ; ");
        /*17*/ INSTR(  CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)        , ALU_ADD( FEM       , REG_OP(1)    , REG_OP(1)  ), " --- ; R1 = extlabel 2LSB + (exp,ttl)");

        /*18*/ INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(3,0))                    , ALU_SET(2,REG_OP(2)), "Copy  mpls header from 2nd mpls tunnel, R2=2");
        /*19*/ INSTR( CE_NOP                                                    , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2))                                         , "if(!coe), R2=0");     
        /*20*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel1 2LSB, RSZ=R0-12");
        /*21*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, R_SIZE(SZ,0))         , ALU_NOP                                         , "Copy ExtLabel1 2MSB");

        /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
        /*23*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
        /* Inject COE Tag */
        /*24*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
        /*25*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
        /*26*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
        /*27*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            /* Copy fwd header from the candidate header */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");

            /* Add more MPLS labels from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
            /*12*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_NOP                                         , "Read ExtLabel2-Valid");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
            /*15*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
            /*19*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2LSB");
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, R_SIZE(SZ,0))         , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2MSB");

            /* Copy ETH   */
            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
            /*23*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH ; R0 -= 16");
            /*24*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH");
        } else {
            /* Copy candidate header except Link layer */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " --- ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " --- ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3    ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3    ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16 ; RSZ = RSZ-16");

            /* Add more MPLS labels from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL");
            /*12*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -10, LFEM_BIT1_CLR_BIT0) , ALU_SET(2, REG_OP(2))                           , "Read ExtLabel2-Valid, R2=2");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12 ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(SZ) ), "Read ExtLabel1[3:0]<<12 ; RSZ = ExtLabel2-Valid ? 2 : 0");
            /*15*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " --- ; R1 = 2LSB of ExtLabel2");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
            /*19*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(SZ,0))                , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "If (RSZ==2) Copy ExtLabel2 2LSB, R1=0x8100");
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, R_SIZE(SZ,0))         , ALU_NOP                                         , "If (RSZ==2) Copy ExtLabel2 2MSB, RSZ=R0-12");

            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH ; R1=0X8100");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH ; ");
            /* Inject COE Tag */
            /*23*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)");
            /*24*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)");
            /*25*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH");
            /*26*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH");      
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            /* Copy fwd header from the candidate header */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            /* Add MPLS label from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
            /*12*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), " ---                           ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , "Read ExtLabel1[3:0]<<12        ; ---");
            /*15*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                           ; ---");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB            ; ---");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB            ; ---");

            /* Copy ETH   */
            /*19*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
            /*20*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
        } else {
            /* Copy candidate header except Link layer */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            /* Add MPLS label from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
            /*12*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
            /*15*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " Read ProgVar                  ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB            ; ---");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB            ; ---");
            /*19*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), " ---                            ; RSZ=R0-12");
            /*20*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");

            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH                       ; R1=0X8100");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH                       ; ");
            /* Inject COE Tag */
            /*23*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)  ; ---");
            /*24*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)              ; ---");
            /*25*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH                       ; ---");
            /*26*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH                       ; ---");      
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            /* Copy fwd header from the candidate header */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            /* Add FRR label from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)            , ALU_NOP                                         , "Read MPLS EXP,S(set to 0), set TTL=255  ; ---");
            /*12*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                           ; ---");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_NOP                                                    , ALU_NOP                                          , " ---                           ; ---");
            /*15*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                           ; ---");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy FRR ExtLabel1 2LSB        ; ---");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel1 2MSB        ; --");

            /* Copy ETH   */
            /*19*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
            /*20*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
        } else {
            /* Copy candidate header except Link layer */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                            ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " ---                            ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            /* Add FRR label from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)        , ALU_NOP                                         , "Read MPLS EXP,S(set to 0), set TTL=255  ; ---");
            /*12*/ INSTR( CE_NOP                                                    , ALU_SET(2, REG_OP(2))                           , " ---                            ; R2=2");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , "Read ExtLabel1[3:0]<<12        ; ---");
            /*15*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                            ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                            ; ---");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy FRR ExtLabel1 2LSB        ; ---");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel1 2MSB        ; ---");
            /*19*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), " ---                            ; RSZ=R0-12");
            /*20*/ INSTR( CE_NOP                                                    , ALU_NOP                                         , " ---                             ; --- ");

            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH                       ; R1=0X8100");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH                       ; ---");
            /* Inject COE Tag */
            /*23*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)  ; ---");
            /*24*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)              ; ---");
            /*25*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH                       ; ---");
            /*26*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH                       ; ---");
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MPLS_EXTENDED_JER_PLUS_MPLS_FRR);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "mpls_extend_over_coe", 0) == 0) {
            /* Copy fwd header from the candidate header */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) ,  CNST(8)     , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            /* Add  MPLS and FRR labels from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
            /*12*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)            , ALU_NOP                                         , "Read MPLS EXP,S(set to 0), set TTL=255  ; ---");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL=255}");
            /*15*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel2");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy ExtLabel1 2LSB            ; ---");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB            ; ---");
            /*19*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_NOP                                         , "Copy FRR ExtLabel2 2LSB        ; ---");
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel2 2MSB        ; ---");

            /* Copy ETH   */
            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
            /*23*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(0,0))                   , ALU_SUB( REG_OP(0) , CNST(16)     , REG_OP(0))  , "Copy ETH                       ; R0 -= 16");
            /*24*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(0,-8))                , ALU_NOP                                         , "Copy ETH                       ; ---");
        } else {
            /* Copy candidate header except Link layer */
            /* 0*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , REG_OP(0)    , REG_OP(SZ) ), " ---                           ; Rsz = R3-R2 (calc native + mpls size)");
            /* 1*/ INSTR( CE_NOP                                                    , ALU_SUB( REG_OP(3) , CNST(8)      , REG_OP(3)  ), " ---                           ; R3 -= 8 (Adjust offset)");
            /* 2*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3         ; RSZ = RSZ-16");
            /* 3*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 4*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 5*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 6*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 7*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /* 8*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");
            /* 9*/ INSTR( CE_COPY(GEN, R_OFST(3,0)  , R_SIZE(SZ,-8))                , ALU_SUB( REG_OP(3) , CNST(16)     , REG_OP(3)  ), "Copy 8B from offset R3         ; R3 = R3-16");
            /*10*/ INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                 , ALU_SUB( REG_OP(SZ), CNST(16)     , REG_OP(SZ) ), "Copy 8B from offset R3-16      ; RSZ = RSZ-16");

            /* Add  MPLS and FRR labels from EES-Data2   */
            /*11*/ INSTR( CE_LREAD(GEN, R_OFST(0,8), LFEM_MPLS_EXP_TTL)             , ALU_NOP                                         , "Read MPLS EXP,S(set to 0),TTL  ; ---");
            /*12*/ INSTR( CE_LREAD(GEN, R_OFST(0,6), LFEM_FRR_EXP_S_TTL)            , ALU_SET(2, REG_OP(2))                           , "Read MPLS EXP,S(set to 0), set TTL=255 ; R2=2");
            /*13*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, 0  , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12        ; R3 = {EXP,S,TTL}");
            /*14*/ INSTR( CE_FLREAD(PrgeDataFieldEesData2, -5 , LFEM_LSHIFT_12)     , ALU_SUB( FEM       , CNST(0)      , REG_OP(3)  ), "Read ExtLabel1[3:0]<<12       ; R3 = {EXP,S,TTL=255}");
            /*15*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_2_LSBS)         , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel1");
            /*16*/ INSTR( CE_NOP                                                    , ALU_ADD( FEM       , REG_OP(3)    , REG_OP(1)  ), " ---                           ; R1 = 2LSB of ExtLabel2");
            /*17*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SET_IF(FEM, EQ, CNST(0), CNST(0), REG_OP(2)), "Copy ExtLabel1 2LSB");
            /*18*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -1, C_SIZE(2))            , ALU_NOP                                         , "Copy ExtLabel1 2MSB");
            /*19*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, C_SIZE(2))                   , ALU_SUB( REG_OP(0) , CNST(12)     , REG_OP(SZ) ), "Copy FRR ExtLabel2 2LSB        ; RSZ=R0-12");
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldEesData2, -6, C_SIZE(2))            , ALU_NOP                                         , "Copy FRR ExtLabel2 2LSB        ; ---");

            /*21*/ INSTR( CE_COPY( GEN, R_OFST(0,0), R_SIZE(SZ,0))                  , ALU_SET(0x8100, REG_OP(1))                      , "Copy ETH                       ; R1=0X8100");
            /*22*/ INSTR( CE_COPY( GEN, R_OFST(0,-16), R_SIZE(SZ,-8))               , ALU_NOP                                         , "Copy ETH                       ; ---");
            /* Inject COE Tag */
            /*23*/ INSTR( CE_FCOPY(PrgeDataFieldPpPortVar, 0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy PP-Port-Variable(2bytes)  ; ---");
            /*24*/ INSTR( CE_FCOPY(PrgeDataFieldR1,        0, R_SIZE(2, 0))         , ALU_NOP                                         , "Copy TPID(2bytes)              ; ---");
            /*25*/ INSTR( CE_COPY( GEN, C_OFST(24), C_SIZE(8))                      , ALU_NOP                                         , "Copy ETH                       ; ---");
            /*26*/ INSTR( CE_COPY( GEN, C_OFST(8), C_SIZE(4))                       , ALU_NOP                                         , "Copy ETH                       ; ---");      
            
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {
        uint32 replace_bsa = ARAD_EGR_PRGE_MIM_BSA_REPLACE_LSB;

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_BRIDGE_TO_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Copy Native-ETH and PBB tags (BTAG, ITAG) leaving only BSA and BDA to be copied */
        /*00*/INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(12), REG_OP(SZ))                         , "---                                 ; RSZ = R3 - 12 (candidate-size - |BDA,BSA|)");
        /*01*/INSTR( CE_NOP                                           , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))                          , "---                                 ; R3 -= 8");
        /*02*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))          , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                         , "Copy ETH                            ; RSZ -= 16");
        /*03*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                          , "Copy ETH                            ; R3 -= 16");
        /*04*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                         , "Copy ETH                            ; RSZ -= 16");
        /*05*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))                          , "Copy ETH                            ; R3 -= 16");
        /*06*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                         , "Copy ETH                            ; RSZ -= 16");
        /*07*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))         , ALU_SET(6, REG_OP(1))                                             , "Copy PBB except BDA,BSA             ; R1 = 6");
        /*08*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))        , ALU_SET(0, REG_OP(SZ))                                            , "Copy PBB except BDA,BSA             ; RSZ = 0");

        /* If BSA[7:0]==ARAD_EGR_PRGE_MIM_BSA_REPLACE_LSB, use BSA from the program-var, else, copy generated BSA
           if BDA[40]==1 (MC indication), Stamp ISID[23:0] over BDA[23:0], else, copy generated BDA */
        /*09*/INSTR( CE_LREAD(GEN, C_OFST(12*2), LFEM_8_LSBS)         , ALU_SET_IF(REG_OP(0), NEQ, CNST(0), REG_OP(1), REG_OP(SZ))        , "FEM = BSA[7:0]                      ; if (R0 != 0) RSZ = R1 (reset RSZ)");
        /*10*/INSTR( CE_NOP                                           , ALU_SET(0, REG_OP(SZ))                                            , "---                                 ; RSZ = 0");
        /*11*/INSTR( CE_NOP                                           , ALU_SET_IF(FEM, EQ, CNST(replace_bsa), REG_OP(SZ), REG_OP(SZ))    , "---                                 ; if (FEM == const) RSZ = RSZ (override previous instr)");
        /*12*/INSTR( CE_NOP                                           , ALU_SET(3, REG_OP(1))                                               , "---                                  ; R1 = 3");
        /*13*/INSTR( CE_LREAD(GEN, C_OFST(1*2), LFEM_BIT_0)           , ALU_SUB(CNST(6), REG_OP(SZ), REG_OP(SZ))                          , "FEM = BDA[40]                       ; RSZ = 6 - RSZ");
        /*14*/INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, R_SIZE(SZ,0))  , ALU_SET(0, REG_OP(2))                                             , "BSA Copy attempt from prog var      ; R2 = 0");
        /*15*/INSTR( CE_COPY(GEN, C_OFST(12*2), R_SIZE(SZ,0))         , ALU_SET_IF(FEM, EQ, CNST(1), REG_OP(1), REG_OP(2))                , "BSA Copy attempt from candidate     ; if (FEM == 1) R2 = R1");
        /*16*/INSTR( CE_NOP                                           , ALU_SET_IF(REG_OP(0), EQ, CNST(0), CNST(0), REG_OP(2))           , "---                                  ; if (R0 == 0) R2 = 0 (reset R2)");
        /*17*/INSTR( CE_NOP                                           , ALU_NOP                                                           , "---                                  ; ---");
        /*18*/INSTR( CE_NOP                                           , ALU_SUB(CNST(3), REG_OP(2), REG_OP(2))                            , "---                                 ; R2 = 3 - R2");
        /*19*/INSTR( CE_COPY(GEN, C_OFST(22*2), R_SIZE(2,0))          , ALU_NOP                                                           , "BDA LSB copy attempt from ISID      ; ---");
        /*20*/INSTR( CE_COPY(GEN, C_OFST(6*2), R_SIZE(2,0))           , ALU_NOP                                                           , "BDA LSB copy attempt from candidate ; ---");
        /*21*/INSTR( CE_COPY(GEN, C_OFST(3*2), C_SIZE(3))             , ALU_NOP                                                           , "Copy BDA MSB                        ; ---");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_UC_ROUTE_TO_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (SOC_IS_JERICHO_PLUS(unit)) {
            /* Copy Native-L3 */
            INSTR( CE_FLREAD(PrgeDataFieldNativeLLSize, 0, LFEM_8_LSBS)         , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "Extract Native LL size                   ; RSZ = R3 - R2 (candidate-size - |BDA,BSA|)");
            INSTR( CE_FLREAD(PrgeDataFieldNativeLLSize, 0, LFEM_8_LSBS)         , ALU_NOP                                       , "---                                      ; ---");
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(SZ), FEM, REG_OP(SZ))          , "---                                      ; RSZ = RSZ - FEM");
            INSTR( CE_NOP                                                       , ALU_ADD(REG_OP(2), FEM, REG_OP(2))            , "---                                      ; R2 += FEM (eth-type)");
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))      , "---                                      ; R3 -= 8");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                      , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                           ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                           ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                           ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                           ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                           ; RSZ -= 16");

            /* according to special rif == OUT-RIF we decide wither RSZ=2,R1=6 or RSZ=0,R1=0 */
            INSTR( CE_FREAD(PrgeDataFieldProgVar, -12)                           , ALU_SET(outrif_range_lower_limit, REG_OP(3))         , "");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SET(2, REG_OP(SZ))                               , "");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SUB(FEM, CNST(0), REG_OP(3))                     , "Extract out-rif from pph");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, LT, REG_OP(3), CNST(0), REG_OP(SZ))  , "Extract out-rif from pph");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, GT, REG_OP(3), CNST(0), REG_OP(SZ))  , "");
            INSTR( CE_NOP                                                        , ALU_SET(6, REG_OP(3))                                , "");

            /* C-ETH: {BDA(48),CSA=48'd0,CTPID,CVID=16'd0,ETH-Type} */
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                      , ALU_NOP                                                   , "Copy ETH-Type         ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(SZ,0))                        , ALU_SET_IF(REG_OP(SZ), EQ, CNST(0), CNST(0), REG_OP(3))   , "Copy CVID [=16'd0]    ; ---");
            INSTR( CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,0))                     , ALU_SUB(REG_OP(2), REG_OP(1), REG_OP(SZ))                 , "Copy CTPID            ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(3,0))                         , ALU_SET_IF(REG_OP(SZ), NEQ, CNST(0), CNST(0), REG_OP(SZ)) , "Copy CSA [=48'd0]     ; ---");
            INSTR( CE_COPY(GEN, C_OFST(12), R_SIZE(3,0))                        , ALU_NOP                                                   , "Copy BDA              ; ---");

            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,0))   , ALU_SUB(REG_OP(2),  CNST(16), REG_OP(2))  , "Copy 8B from generated offset R2, Size RSZ; ALU: R2 = R2-16 (calc next generated reference)");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "Copy 8B from offset R2-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,-16)) , ALU_NOP                                   , "Copy 8B from offset R2, Size RSZ-16; ALU: R2 = R2-16 (calc next generated reference)");

            /* BTAG, ... , ISID */
            INSTR( CE_COPY(GEN, R_OFST(1,0), C_SIZE(3))                         , ALU_NOP                                       , "Copy ISID[23:0]                          ; ---");
            INSTR( CE_COPY(GEN, C_OFST(38), C_SIZE(7))                          , ALU_NOP                                       , "Copy BTAG,...,PBB                                ; ---");

            /* BSA from program-var and BDA */
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(6))                 , ALU_NOP                                       , "Copy BSA from progream-var               ; ---");
            INSTR( CE_COPY(GEN, C_OFST(12), C_SIZE(6))                          , ALU_NOP                                       , "Copy BDA (again)                         ; ---");
        }else {
            /* Copy Native-L3 */
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "---                                     ; RSZ = R3 - 12 (candidate-size - |BDA,BSA|)");
            INSTR( CE_NOP                                                       , ALU_SUB(REG_OP(3),  CNST(8) , REG_OP(3))      , "---                                     ; R3 -= 8");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,0))                      , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                          ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                          ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                          ; RSZ -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(SZ,-8))                     , ALU_SUB(REG_OP(3),  CNST(16), REG_OP(3))      , "Copy Native-L3                          ; R3 -= 16");
            INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,0))                    , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))     , "Copy Native-L3                          ; RSZ -= 16");

            /* according to special rif == OUT-RIF we decide wither RSZ=2,R1=6 or RSZ=0,R1=0 */
            INSTR( CE_FREAD(PrgeDataFieldProgVar, -12)                           , ALU_SET(outrif_range_lower_limit, REG_OP(3))         , "");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SET(2, REG_OP(SZ))                               , "");
            INSTR( CE_LREAD(PKT, C_OFST((ftmh_size<<1)+10), LFEM_NPH_PPH_VSI)    , ALU_SUB(FEM, CNST(0), REG_OP(3))                     , "Extract out-rif from pph");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, LT, REG_OP(3), CNST(0), REG_OP(SZ))  , "Extract out-rif from pph");
            INSTR( CE_NOP                                                        , ALU_SET_IF(FEM, GT, REG_OP(3), CNST(0), REG_OP(SZ))  , "");
            INSTR( CE_NOP                                                        , ALU_SET(6, REG_OP(3))                                , "");

            /* C-ETH: {BDA(48),CSA=48'd0,CTPID,CVID=16'd0,ETH-Type} */
            INSTR( CE_COPY(GEN, R_OFST(2,0), R_SIZE(SZ,0))                ,  ALU_NOP                                                      , "Copy ETH-Type             ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(SZ,0))                  ,  ALU_SET_IF(REG_OP(SZ), EQ, CNST(0), CNST(0), REG_OP(3))      , "Copy CVID [=16'd0]        ; ---");
            INSTR( CE_COPY(GEN, R_OFST(2,-8), R_SIZE(SZ,0))               ,  ALU_SUB(REG_OP(2), CNST(0), REG_OP(SZ))                      , "Copy CTPID                ; ---");
            INSTR( CE_COPY(GEN, C_OFST(0), R_SIZE(3,0))                   ,  ALU_SET_IF(REG_OP(SZ), NEQ, CNST(0), CNST(0), REG_OP(SZ))    , "Copy CSA [=48'd0]         ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, R_SIZE(3,0))       ,  ALU_NOP                                                      , "Copy BDA from EES-Data2   ; ---");


            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,0))   , ALU_SUB(REG_OP(2),  CNST(16), REG_OP(2))  , "Copy 8B from generated offset R2, Size RSZ; ALU: R2 = R2-16 (calc next generated reference)");
            INSTR( CE_COPY(GEN, R_OFST(2,-16), R_SIZE(SZ,-8)) , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ)) , "Copy 8B from offset R2-8B(16NB), size RZS -8; ALU: RSZ = RSZ-16 (calc left generated size)");
            INSTR( CE_COPY(GEN, R_OFST(2,0),  R_SIZE(SZ,-16)) , ALU_NOP                                   , "Copy 8B from offset R2, Size RSZ-16; ALU: R2 = R2-16 (calc next generated reference)");

            /* BTAG, ... , ISID laid out like ROO linker-layer Eth-type and VLANs on EES-Data1,2,3 */
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))                , ALU_NOP                                   , "Copy ISID[15:0] from EES-Data1          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(8))               , ALU_NOP                                   , "Copy BTAG,...,ISID[23:8] from EES-Data3 ; ---");

            /* BSA from program-var and BDA from EES-Data2*/
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(6))                 , ALU_NOP                                   , "Copy BSA from progream-var              ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -2, C_SIZE(6))               , ALU_NOP                                   , "Copy BDA (again) from EES-Data2         ; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_MIM_SPB_MC_ROUTE_TO_OVERLAY);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        if (SOC_IS_JERICHO_PLUS(unit)) {
            /*01*/ INSTR( CE_NOP                                                 , ALU_SUB( REG_OP(3), CNST(12), REG_OP(SZ))                 , "---                            ; RSZ = R3 - 12");
            /*04*/ INSTR( CE_NOP                                                 , ALU_NOP                                                     , "---                           ; ---");
            /*05*/ INSTR( CE_NOP                                                 , ALU_SUB(REG_OP(SZ), CNST(16), REG_OP(SZ))                   , "---                           ; RSZ -= 16 (Prepare for PP-Copy loop with seperate size register including BTAG, ... , ISID)");

            /* Instruction 06-19 : Copy Native-L3 + Native ETH, BTAG, ... , ISID */
            for (i = 0; i < 7; i++) {
                INSTR( CE_COPY(GEN, R_OFST(3, 0), R_SIZE(SZ, 0))         , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))                  , "Copy Natives                             ; R3 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(SZ,8))        , ALU_SUB( REG_OP(SZ), CNST(16), REG_OP(SZ))               , "Copy Natives                             ; RSZ -= 16");
            }

            /* BDA,BSA = {BDA[47:24],ISID[23:0],BDA[47:24],24'hffffff} */
            /*20*/ INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(3))         , ALU_NOP                                   , "Copy 0xffffff from progream-var	        ; ---");
            /*21*/ INSTR( CE_COPY(GEN, C_OFST(6), C_SIZE(3))                   , ALU_NOP                                   , "Copy BDA[47:24]                          ; ---");
            /*22*/ INSTR( CE_COPY(GEN, R_OFST(0, 0), C_SIZE(3))                 , ALU_NOP                                  , "Copy ISID[23:0]                          ; ---");
            /*23*/ INSTR( CE_COPY(GEN, C_OFST(6), C_SIZE(3))                   , ALU_NOP                                   , "Copy BDA[47:24] (again)                  ; ---");
        }else {
            /* Copy Native-L3 + Native ETH */
            for (i = 0; i < 4; i++) {
                INSTR( CE_COPY(GEN, R_OFST(3, 0), R_SIZE(3, 0))         , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))	, "Copy Natives                             ; R3 -= 16");
                INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))        , ALU_NOP                                   , "Copy Natives                             ; ---");
            }

            /* BTAG, ... , ISID laid out like ROO linker-layer Eth-type and VLANs on EES-Data1,2,3 */
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))        , ALU_NOP                                   , "Copy ISID[15:0] from EES-Data1           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(8))       , ALU_NOP                                   , "Copy BTAG,...,ISID[23:8] from EES-Data3  ; ---");

            /* BDA,BSA = {BDA[47:24],ISID[23:0],BDA[47:24],24'hffffff} */
            INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(3))         , ALU_NOP                                   , "Copy 0xffffff from progream-var          ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -8, C_SIZE(3))       , ALU_NOP                                   , "Copy BDA[47:24] from EES-Data2           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData1, 0, C_SIZE(2))        , ALU_NOP                                   , "Copy ISID[15:0] from EES-Data1           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData3, -2, C_SIZE(1))       , ALU_NOP                                   , "Copy ISID[23:8] from EES-Data3           ; ---");
            INSTR( CE_FCOPY(PrgeDataFieldEesData2, -8, C_SIZE(3))       , ALU_NOP                                   , "Copy BDA[47:24] (again) from EES-Data2   ; ---");
        }

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    }
    /* Define Program instructions for timestamp and SSP */
    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 400, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_TIMESTAMP_AND_SSP);
        SOC_SAND_CHECK_FUNC_RESULT(res, 401, exit);

        /* Too many LFEMs to manage */
        res = arad_egr_prge_mgmt_current_program_load_only_set(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 372, exit);

          /* 1*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "1: copy generated header"                     );
          /* 2*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "2: copy generated header"                     );
          /* 3*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "3: copy generated header"                     );
          /* 4*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "4: copy generated header"                     );
          /* 5*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "5: copy generated header"                     );
          /* 6*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "6: copy generated header"                     );
          /* 7*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "7: copy generated header"                     );
          /* 8*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                           , ALU_NOP                                         , "8: copy generated header"                     );
          /* 9*/INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(3,0))                              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))         , "9: copy generated header"                     );
          /* 10*/INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(3,-8))                          , ALU_NOP                                         , "10: copy generated header"                     );
          /*11*/ INSTR( CE_LREAD(PKT, C_OFST(18), LFEM_FTMH_EXTRACT_SHIFT_DSP_EXT)         , ALU_SET(ftmh_size + 1, REG_OP(2))               , "11: Extract DSP_EXT from FTMH ,the value can be 0 or 2 (which i will use as a size), ALU: R2 = ftmh_size + 1 (1 = to reach to OAM_TS[39:32])  ");
          /*12*/ INSTR( CE_FLREAD(PrgeDataFieldTod1588, -8, LFEM_RSHIFT_1_FIRST_BIT_ONLY)  , ALU_SET(unit, REG_OP(3))                        , "12: Extract TOD 1588[33] ,ALU : R3 = Unit");
          /*13*/ INSTR( CE_LREAD(PKT, R_OFST(2, 0),LFEM_RSHIFT_1_FIRST_BIT_ONLY)           , ALU_ADD(FEM, REG_OP(2), REG_OP(2))              , "13: Extract OAM_TS[33] ,ALU : R2 = ftmh size + 1 , FEM = DSP EXT (0 or 2B), R2 = R2 + FEM ");
          /*14*/ INSTR( CE_FLREAD(PrgeDataFieldTod1588, -8,LFEM_EXTRACT_FTMH_SIZE)         , ALU_SUB(FEM, CNST(0), REG_OP(0))                , "14: Extract Tod 1588[47:34] ,ALU: R0 = FEM = Tod_1588[33]");
          /*15*/ INSTR( CE_NOP                                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))               , "15: ,ALU : SZ = FEM = OAM[33]");                                                                                                    
          /*16*/ INSTR( CE_LREAD(PKT, R_OFST(2, 0),LFEM_OAM_TS_EXTRACT_TOD)                , ALU_SUB(FEM, CNST(0), REG_OP(1))                , "16: Extract OAM_TS[33:32],ALU : R1 = Tod 1588[47:34]");
          /*17*/ INSTR( CE_NOP                                                             , ALU_SUB(REG_OP(SZ), REG_OP(0), REG_OP(SZ))      , "17: ,ALU: RSZ = OAM[33] - R0 ,R0 = Tod_1588[33], if timestamp wrap then RSZ will be set ,in any other case it;s reset");
          /*18*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BITS_0_M)                , ALU_SUB(FEM, CNST(0), REG_OP(0))                , "18: Extract the first bit of the TmPortVar ,if it's set then SSP should be stamp in the header , ALU : R1 = R1 - SZ , R1 = TOD_1588[47:34] , SZ = OAM_TS[33] - Tod_1588[33]");
          /*19*/ INSTR( CE_FLREAD(PrgeDataFieldR1, 0, LFEM_LSHIFT_2)                       , ALU_SUB(REG_OP(1), REG_OP(SZ), REG_OP(1))       , "19: Extract Tod 1588[47:34] and shift the value by 2 bits left,ALU: R0 = OAM_TS[33:32] ");
          /*20*/ INSTR( CE_NOP                                                             , ALU_SUB(FEM, CNST(0), REG_OP(SZ))               , "20: ,ALU: SZ = TmPortVar - first - bit");
          /*21*/ INSTR( CE_FLREAD(PrgeDataFieldTmPortVar, 0, LFEM_BIT1_CLR_BIT0)           , ALU_SUB(FEM, CNST(0), REG_OP(1))                , "21: Extract the second bit of the TmPortVar ,if it's set then Timestamp should be stamp in the header,ALU : R1 = R1 + Tod 1588[47:34] shited by 2");
          /*22*/ INSTR( CE_FCOPY(PrgeDataFieldSrcSysPort, 0, R_SIZE(SZ, 0))                , ALU_NOP                                         , "22: Copy system port ,ALU : NOP");
          /*23*/ INSTR( CE_FCOPY(PrgeDataFieldR3, 0, R_SIZE(SZ, 0))                        , ALU_SUB(FEM, CNST(0), REG_OP(3))                , "23: copy unit,ALU: R3 = TmPortVar - Second - bit");
          /*24*/ INSTR( CE_NOP                                                             , ALU_SET(0, REG_OP(SZ))                          , "24: ,ALU: SZ = 0");
          /*25*/ INSTR( CE_COPY(PKT, R_OFST(2, 2 * 4), R_SIZE(3, 0))                       , ALU_ADD(REG_OP(1) , REG_OP(0) , REG_OP(1))      , "25: copy OAM_TS[15:0],ALU: R1 = TOD_1588[47:32] + R0 = OAM-TS[33:32]");
          /*26*/ INSTR( CE_COPY(PKT, R_OFST(2, 2 * 2), R_SIZE(3, 0))                       , ALU_NOP                                         , "26: copy OAM_TS[31:16],ALU: NOP");
          /*27*/ INSTR( CE_FCOPY(PrgeDataFieldR1, 0, R_SIZE(3, 0))                         , ALU_NOP                                         , "27: copy R1 -> Tod_1588[47:32] ,ALU: NOP");
          /*28*/ INSTR( CE_FCOPY(PrgeDataFieldTod1588, -12, R_SIZE(3, 0))                  , ALU_NOP                                         , "28: copy Tod_1588[63:48] ,ALU: NOP");

        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 402, exit);
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_IPSEC_ENC_DEC);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "Instruction  0: ---; rsz = r3-r2 (calc the size of fwd hdr)"         );
        INSTR( CE_FLREAD(PrgeDataFieldSysHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(3), REG_OP(0), REG_OP(2))      , "Instruction  1: extract sys hdr size; r2 = r3-r0 (calc the size of hdr up to link layer)");
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), CNST(8), REG_OP(3))        , "Instruction  2: ---; r3 = r3-8 "                                     );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,0))               , ALU_SUB(FEM, CNST(0), REG_OP(1))              , "Instruction  3: copy gen hdr size r2, pointer r3   ; store sys hdr size (fem) in r1");
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(2), CNST(24), REG_OP(2))       , "Instruction  4: copy gen hdr size r2-8, pointer r3; r2 = r2-24"      );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,-16))           , ALU_SUB(REG_OP(3), CNST(24), REG_OP(3))       , "Instruction  5: copy gen hdr size r2-16, pointer r3-16; r3 = r3-24"  );
        INSTR( CE_COPY(GEN, R_OFST(3,-32), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction  6: copy gen hdr size r2 , pointer r3-32; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction  7: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction  8: copy gen hdr size r2 , pointer r3-16; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction  9: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_COPY(GEN, R_OFST(3,-16), R_SIZE(2,0))             , ALU_SUB(REG_OP(2), CNST(16), REG_OP(2))       , "Instruction 10: copy gen hdr size r2 , pointer r3-16; r2 = r2-16"    );
        INSTR( CE_COPY(GEN, R_OFST(3,0), R_SIZE(2,-8))              , ALU_SUB(REG_OP(3), CNST(16), REG_OP(3))       , "Instruction 11: copy gen hdr size r2-8 , pointer r3; r3 = r3-16"     );
        INSTR( CE_FLREAD(PrgeDataFieldNwkHdrSize, 0, LFEM_8_LSBS)   , ALU_SUB(REG_OP(SZ), CNST(2), REG_OP(SZ))      , "Instruction 12: extract nwk hdr size; rsz -= 2"                      );
        INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_2_LSBS)                , ALU_NOP                                       , "Instruction 13: extract ftmh.tc; ---"                                );
        INSTR( CE_LREAD(PKT, C_OFST(4), LFEM_RSHIFT_2)              , ALU_SUB(FEM, REG_OP(SZ), REG_OP(2))           , "Instruction 14: extract ftmh.psize, r2 = fem-rsz"                    );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-2))              , ALU_SUB(FEM, CNST(0), REG_OP(3))              , "Instruction 15: copy the system headers, size/offset r1; r3=fem"     );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-10))           , ALU_SUB(FEM, REG_OP(2), REG_OP(2))            , "Instruction 16: copy the system headers, size/offset r1; r2=fem-r2"  );
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))       , "Instruction 17: --------; r1 = r1-16"                                );
        INSTR( CE_FLREAD(PrgeDataFieldR2, 0, LFEM_LSHIFT_2)         , ALU_NOP                                       , "Instruction 18: shift r2 ; ---"                                      );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-2))              , ALU_SUB(REG_OP(1), CNST(16), REG_OP(1))       , "Instruction 19: copy the system headers, size/offset r1;r1=r1-16"    );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-10))           , ALU_ADD(FEM, REG_OP(3), REG_OP(3))            , "Instruction 20: copy the system headers, size/offset r1, r3=r3+fem"  );
        INSTR( CE_COPY(PKT, R_OFST(1,0), R_SIZE(1,-2))              , ALU_NOP                                       , "Instruction 21: copy the system headers, size/offset r1"             );
        INSTR( CE_COPY(PKT, R_OFST(1,-16), R_SIZE(1,-10))           , ALU_NOP                                       , "Instruction 22: copy the system headers, size/offset r1, r3=r3+fem"  );
        INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))              , ALU_NOP                                       , "Instruction 23: copy r3 (ftmh.PSize,Ftmh.TC[2:1])"                   );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))               , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "Instruction 24: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "Instruction 25: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0,0))               , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "Instruction 26: copy the link layer, size/offset r0"                 );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "Instruction 27: copy the link layer, size/offset r0"                 );
    }

    res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, ARAD_EGR_PROG_EDITOR_PROG_LI, &prog_used);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
    if (prog_used != -1) {    
        /* Default value is 0x16 */
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_IPV4_SIZE_WITH_ETH_IP_KEYr(unit, REG_PORT_ANY, 0x12));

        res = arad_egr_prge_mgmt_build_program_start(unit, ARAD_EGR_PROG_EDITOR_PROG_LI);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);

        /* ETPP builds a VxLAN tunnel, EPNI_IPV4_SIZE_WITH_ETH_IP_KEY is set to 4B's less to create a correct IPv4 length */
        INSTR( CE_NOP                                               , ALU_SUB(REG_OP(3), REG_OP(2), REG_OP(SZ))     , "0: Copy 8B starts from 4B after R3"                                  );
        INSTR( CE_NOP                                               , ALU_NOP                                       , "1: Copy 8B from forwarding header"                                   );
        INSTR( CE_COPY(GEN, R_OFST(3,8), R_SIZE(SZ, 0))             , ALU_NOP                                       , "2: Copy 8B starts from 4B after R3"                                  );
        INSTR( CE_COPY(GEN, R_OFST(3,-8), R_SIZE(SZ, -8))           , ALU_NOP                                       , "3: Copy 8B from forwarding header"                                   );
        INSTR( CE_COPY(GEN, R_OFST(3,-24), R_SIZE(SZ, -16))         , ALU_SUB(REG_OP(SZ), CNST(24), REG_OP(SZ))     , "4: Copy forwarding header"                                           );
        INSTR( CE_READ(GEN, R_OFST(0,8))                            , ALU_NOP                                       , "5: Read IPv4 header length from generated header"                    );
        INSTR( CE_COPY(GEN, R_OFST(3,-40), R_SIZE(SZ, 0))           , ALU_NOP                                       , "6: Copy forwarding header"                                           );
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, -1, C_SIZE(4))       , ALU_SUB(FEM, CNST(20), REG_OP(3))             , "7: Copy Content ID from EES1"                                        );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 4, C_SIZE(2))         , ALU_NOP                                       , "8: Copy 2B zeros (checksum)"                                         );
        INSTR( CE_FCOPY(PrgeDataFieldR3, 0, C_SIZE(2))              , ALU_NOP                                       , "9: UDP length = IPv4 length - 20"                                    );
        INSTR( CE_FCOPY(PrgeDataFieldEesData1, -9, C_SIZE(2))       , ALU_NOP                                       , "10: Copy UDP dst port from EES1"                                      );
        INSTR( CE_FCOPY(PrgeDataFieldProgVar, 0, C_SIZE(2))         , ALU_NOP                                       , "11: Copy UDP src port from porgram var"                               );
        INSTR( CE_COPY(GEN, R_OFST(0,40), C_SIZE(8))                , ALU_NOP                                       , "12:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,24), C_SIZE(8))                , ALU_NOP                                       , "13:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,8), C_SIZE(8))                 , ALU_NOP                                       , "14:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,-8), R_SIZE(0, -4))            , ALU_SUB(REG_OP(0), CNST(20), REG_OP(0))       , "15:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,-24), R_SIZE(0,-12))           , ALU_NOP                                       , "16:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0, 0))              , ALU_SUB(REG_OP(0), CNST(16), REG_OP(0))       , "17:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,-16), R_SIZE(0,-8))            , ALU_NOP                                       , "18:Copy tunnel"                                                      );
        INSTR( CE_COPY(GEN, R_OFST(0,0), R_SIZE(0, 0))              , ALU_NOP                                       , "19:Copy tunnel"                                                      );
    
        res = arad_egr_prge_mgmt_build_program_end(unit);
        SOC_SAND_CHECK_FUNC_RESULT(res, 460, exit);
    }

    /* Try to load managed programs */
    res = arad_egr_prge_mgmt_program_management_main(unit);
    if (res != SOC_E_NONE) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("PRGE error - Could not load managed programs.\n\r")));
    }

    /* Load the necessary lfems */
    SOC_SAND_IF_ERR_EXIT(arad_egr_prog_editor_load_required_lfems(unit));

    SOC_REG_ABOVE_64_CLEAR(header_editing_size); 

    /* 0-6, 7-13, ... */
    header_editing_size[PP_FWD_CODE_ETHERNET] = ARAD_EGR_PROG_EDITOR_ETH_HEADER_EDITING_SIZE;
    header_editing_size[PP_FWD_CODE_IPV4_UC] = 20;
    header_editing_size[PP_FWD_CODE_IPV4_MC] = 20;
    header_editing_size[PP_FWD_CODE_IPV6_UC] = 16;
    header_editing_size[PP_FWD_CODE_IPV6_MC] = 16;
    header_editing_size[PP_FWD_CODE_MPLS] = 4;
    header_editing_size[PP_FWD_CODE_TRILL] = 6;
    header_editing_size[PP_FWD_CODE_ETHERNET_AFTER_TERMINATION] = 20;

    /* turn seperate 7b'numbers to a single 112b' number */
    header_editing_size_to_reg_val(header_editing_size, header_editing_size_val);

    SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_HEADER_EDITING_SIZEr(unit, REG_PORT_ANY, header_editing_size_val));

    /* set ETHERNET_HEADER_EDITING_SIZE, only for QAX */
    if (SOC_IS_JERICHO_PLUS(unit)) {
        /* each entry is 6 bits long
        *  set egress header editing size with value 24B for all cases to backward compatible with Jericho
        *  Value   Num-Of-Tags IPV4    size
        *  0       0           0       24
        *  1       0           1       24
        *  2       1           0       24
        *  3       1           1       24
        *  4       2           0       24
        *  5       2           1       24
        *  6       3/4         0       24
        *  7       3           1       24
        */
        COMPILER_64_SET(ethernet_header_editing_size_val, 0x00006186, 0x18618618);
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_ETHERNET_HEADER_EDITING_SIZEr(unit, ethernet_header_editing_size_val));
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_basic_epni_tm_config()",0,0);
}


uint32
  arad_egr_prog_editor_config_dut_by_queue_database(
    SOC_SAND_IN int unit
  ) 
{
  uint32    res;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  /* Configure the DUT */

  /* PRGE */

      res = arad_egr_prog_editor_basic_epni_tm_config(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

/* END Configure the DUT */

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in config_dut_by_queue_database()", 0, 0);
}

uint32 
  arad_egr_prog_editor_stacking_lfems_set(
    SOC_SAND_IN int unit,
    SOC_SAND_IN SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK tm_port_profile_stack,
    SOC_SAND_IN uint32 bitmap) 
{
    uint32
        res, 
        my_tm_domain, 
        local_bitmap = 0x0;
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  
        lfem_field_select_map_tbl_data;
    lfem_map 
        lfem_arr_0[16];
    int 
        i;
    uint64
        reg_val64;
  
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    /* FEM-0-8 : STACKING user defined no. 1, stamp my domain */
    if (((tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK1) || (tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK_ALL)) && 
        (lfem_stacking_8_index[unit] != -1)) {

        /* Get my doamin and stamp the Bitmap */
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, READ_IHB_LBP_GENERAL_CONFIG_0r(unit, REG_PORT_ANY, &reg_val64));
        my_tm_domain = soc_reg64_field32_get(unit, IHB_LBP_GENERAL_CONFIG_0r, reg_val64, TM_DOMAINf);
        if (my_tm_domain < 16) {
            local_bitmap = bitmap | (1 << my_tm_domain);
        } else {
            SOC_SAND_CHECK_FUNC_RESULT(SOC_SAND_GEN_ERR, 20, exit);
        }

        /* Load original lfem */
        for (i = 0 ; i < 16 ; i++) {
            /* lfem_actions[...][0] is the enumeration so start with lfem_actions[...][2*i+1 (== 1)] */
            lfem_arr_0[i].val1 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8][2*i+1]; 
            lfem_arr_0[i].val2 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8][2*i+2]; 
        }

        /* Configure the lfem according to the bitmap */
        for (i = 0 ; i < 16 ; i++) {
            if ((1 << i) & local_bitmap) {
                lfem_arr_0[15 - i].val1 = 1;
                lfem_arr_0[15 - i].val2 = 1;
            }
        }
        
        lfem_map_arr_to_lfem_field_select_map(lfem_arr_0, &lfem_field_select_map_tbl_data);
        res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, lfem_stacking_8_map[unit], lfem_stacking_8_index[unit], 
                                                             &lfem_field_select_map_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
    }

    /* FEM-0-10 : STACKING user defined no. 2, stamp next domain */
    if (((tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK2) || (tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK_ALL)) && 
        (lfem_stacking_10_index[unit] != -1)) {

        /* Get my doamin and stamp the Bitmap */
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 40, exit, READ_IHB_LBP_GENERAL_CONFIG_0r(unit, REG_PORT_ANY, &reg_val64));
        my_tm_domain = soc_reg64_field32_get(unit, IHB_LBP_GENERAL_CONFIG_0r, reg_val64, TM_DOMAINf);
        if (my_tm_domain < 16) {
            local_bitmap = bitmap | (1 << my_tm_domain);
        } else {
            SOC_SAND_CHECK_FUNC_RESULT(SOC_SAND_GEN_ERR, 50, exit);
        }   

        /* Load original lfem */
        for (i = 0 ; i < 16 ; i++) {
            /* lfem_actions[...][0] is the enumeration so start with lfem_actions[...][2*i+1 (== 1)] */
            lfem_arr_0[i].val1 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10][2*i+1]; 
            lfem_arr_0[i].val2 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10][2*i+2]; 
        }

        /* Configure the lfem according to the bitmap */
        for (i = 0 ; i < 16 ; i++) {
            if ((1 << i) & local_bitmap) {
                lfem_arr_0[15 - i].val1 = 1;
                lfem_arr_0[15 - i].val2 = 1;
            }
        }

        lfem_map_arr_to_lfem_field_select_map(lfem_arr_0, &lfem_field_select_map_tbl_data);
        res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, lfem_stacking_10_map[unit], lfem_stacking_10_index[unit], 
                                                             &lfem_field_select_map_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_stacking_lfems_set()", bitmap, local_bitmap);
}

/* The API will configure PRGE related variables for L2 encap to external CPU program */
uint32
arad_egr_prog_l2_encap_external_cpu_program_info_set(
   SOC_SAND_IN int unit,
   SOC_SAND_IN uint32 pp_port_var,
   SOC_SAND_IN uint64 prge_var
 )
{
    soc_port_t local_port;
    SOC_TMC_PORT_HEADER_TYPE header_type_out;
    uint32 is_valid, res = SOC_SAND_OK;
   
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (local_port = 0; local_port < ARAD_NOF_LOCAL_PORTS(unit); ++local_port) {

        res = soc_port_sw_db_is_valid_port_get(unit, local_port, &is_valid);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 15, exit);
        if (!is_valid) {
            continue;
        }
        res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.header_type_out.get(unit,local_port,&header_type_out);
        SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 25, exit);

        if(header_type_out==SOC_TMC_PORT_HEADER_TYPE_L2_ENCAP_EXTERNAL_CPU) {

            res = arad_egr_prog_editor_pp_pct_var_set(unit,local_port,pp_port_var);
            SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);
        }
    }

    res = arad_pp_prge_program_var_set(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, prge_var);
    SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);

exit:
   SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_l2_encap_external_cpu_program_info_set()", 0, 0);

}
/* The API will get PRGE related configuaration from L2 encap to external CPU program */
uint32
arad_egr_prog_l2_encap_external_cpu_program_info_get(
   SOC_SAND_IN int unit,
   SOC_SAND_OUT uint32 *pp_port_var,
   SOC_SAND_OUT uint64 *prge_var
 )
{
    soc_port_t local_port;
    int core;
    SOC_TMC_PORT_HEADER_TYPE header_type_out;
    uint32 port_ndx, is_valid, res = SOC_SAND_OK;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);


    for (local_port = 0; local_port < ARAD_NOF_LOCAL_PORTS(unit); ++local_port) {

        res = soc_port_sw_db_is_valid_port_get(unit, local_port, &is_valid);
        SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);
        if (!is_valid) {
            continue;
        }

        res = sw_state_access[unit].dpp.soc.arad.tm.logical_ports_info.header_type_out.get(unit,local_port,&header_type_out);
        SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

        if(header_type_out==SOC_TMC_PORT_HEADER_TYPE_L2_ENCAP_EXTERNAL_CPU) {
            
            res = soc_port_sw_db_local_to_pp_port_get(unit, local_port, &port_ndx, &core);
            SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);
            res = arad_egr_prog_editor_pp_pct_var_get(unit,port_ndx,pp_port_var);
            SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);

            break;    
        }
    }

    res = arad_pp_prge_program_var_get(unit, ARAD_EGR_PROG_EDITOR_PROG_L2_ENCAP_EXTERNAL_CPU, prge_var);
    SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);

exit:
   SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_l2_encap_external_cpu_program_info_get()", 0, 0);

}

uint32
arad_egr_prog_vxlan_program_info_set(
   SOC_SAND_IN int unit,
   SOC_SAND_IN uint16 udp_dest_port
 )
{
  ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA 
      prge_program_tbl_data;
  uint32 res = SOC_SAND_OK;
  uint32 entry_u32[2];
  int prog_used;

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  res = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
      unit, ARAD_EGR_PROG_EDITOR_PROG_VXLAN, &prog_used);
  SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);
  if (prog_used != -1) {
      res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

      entry_u32[0] = COMPILER_64_LO(prge_program_tbl_data.program_var);
      entry_u32[1] = COMPILER_64_HI(prge_program_tbl_data.program_var);

      /* update high msb */
      entry_u32[1] &= 0x0000FFFF;
      entry_u32[1] |= udp_dest_port << 16;

      COMPILER_64_SET(prge_program_tbl_data.program_var, entry_u32[1], entry_u32[0]);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }
exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_vxlan_program_info_set()", udp_dest_port, 0);
}

int
  arad_egr_prog_editor_program_pointer_get(
    SOC_SAND_IN   int                                 unit,
    SOC_SAND_IN   ARAD_EGR_PROG_EDITOR_PROGRAMS       program_id,
    SOC_SAND_OUT  uint32                              *program_pointer
  )
{
    int prog_used;
    SOCDNX_INIT_FUNC_DEFS;

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program_id, &prog_used));
    if (prog_used != -1) {
        SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(
            unit, program_id, program_pointer));
    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG("ARAD_EGR_PROG_EDITOR_PROGRAM_NOT_USED_ERR")));
    }

exit:
    SOCDNX_FUNC_RETURN;
}

int
  arad_egr_prog_editor_profile_get(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                     eg_tm_profile,
    SOC_SAND_OUT uint32                     *internal_profile
  )
{   
    int tm_profiles;
    SOCDNX_INIT_FUNC_DEFS;

    if (eg_tm_profile == ARAD_PRGE_TM_SELECT_NONE) {
        *internal_profile = ARAD_PRGE_TM_SELECT_NONE;
        SOC_EXIT;
    }
    else {
        SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, eg_tm_profile, &tm_profiles));
        if (tm_profiles != -1) {
            *internal_profile = tm_profiles;
            SOC_EXIT;
        }
    }
    /* This code is used for searching , and only used to return an error */
    SOCDNX_EXIT_WITH_ERR_NO_MSG(SOC_E_INTERNAL);

exit:
    SOCDNX_FUNC_RETURN;
}

uint32
  arad_egr_prog_editor_tm_profile_enum_get(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                        internal_profile,
    SOC_SAND_OUT uint32                         *eg_tm_profile
  )
{   
  uint32 tm_profile_idx;
  int tm_profiles;
  soc_error_t rv;
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  *eg_tm_profile = -1;
  for (tm_profile_idx = 0; tm_profile_idx<ARAD_PRGE_TM_SELECT_NOF_PROFILES ; tm_profile_idx++) {
      rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.tm_profiles.get(unit, tm_profile_idx, &tm_profiles);
      SOC_SAND_SOC_CHECK_FUNC_RESULT(rv, 10, exit);
      if (tm_profiles == internal_profile) {
          *eg_tm_profile = tm_profile_idx;
          break;
      }
  }
  if (*eg_tm_profile == -1) {
      SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - tm profile not exist. \n\r")));
  }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_tm_profile_enum_get()", internal_profile, 0);
}

uint32
  arad_egr_prog_editor_pp_pct_var_set(
    SOC_SAND_IN uint32 unit,
    SOC_SAND_IN uint32 port,
    SOC_SAND_IN uint32 value
  ) {
    ARAD_PP_EPNI_PP_PCT_TBL_DATA
      tbl_data;
    int
      res = SOC_SAND_OK;
	int core=0;
    uint32 pp_port;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    SOC_SAND_CHECK_DRIVER_AND_DEVICE;

    res = soc_port_sw_db_local_to_pp_port_get(unit, port, &pp_port, &core);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);    


    res = arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core,  pp_port, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

    tbl_data.prge_var = value;

    res = arad_pp_epni_pp_pct_tbl_set_unsafe(unit, core, pp_port, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 30, exit);

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in soc_ppd_eg_epni_pp_pct_prge_var_set()", port, value);
}

uint32
  arad_egr_prog_editor_pp_pct_var_get(
    SOC_SAND_IN uint32 unit,
    SOC_SAND_IN uint32 port,
    SOC_SAND_OUT uint32 *value
  ) {
    int
      res = SOC_SAND_OK;
    ARAD_PP_EPNI_PP_PCT_TBL_DATA
      tbl_data;
	int core=0;
    uint32 pp_port;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = soc_port_sw_db_local_to_pp_port_get(unit, port, &pp_port, &core);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit); 

    res = arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core, pp_port, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

    *value = tbl_data.prge_var;

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in soc_ppd_eg_epni_pp_pct_prge_var_get()", unit, port);
}


int
  arad_egr_prog_editor_profile_set(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  int                        core,
    SOC_SAND_IN  uint32                     q_pair,
    SOC_SAND_IN  uint32                     prog_editor_profile
  )
{   
    ARAD_EGQ_PCT_TBL_DATA        pct_tbl_data;
    soc_port_t port_ndx;
    soc_port_if_t interface;

    uint32 base_q_pair, nof_pairs, curr_q_pair;
    uint32 pp_port, tm_port;
    int core_tmp;
    uint32 tm_profile;

    ARAD_PP_EPNI_PP_PCT_TBL_DATA pp_pct_tbl_data;

    SOCDNX_INIT_FUNC_DEFS;
    
    if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "conn_to_np_enable", 0)) {
        port_ndx = q_pair;    
        
        SOCDNX_IF_ERR_EXIT(soc_port_sw_db_interface_type_get(unit, port_ndx, &interface));
        if ((prog_editor_profile != 0) && (interface == SOC_PORT_IF_RCY)) {
            /* set for rcy port */
            /* add pp profile to select prge program */ 
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_local_to_pp_port_get(unit, port_ndx, &pp_port, &core_tmp));
            SOCDNX_IF_ERR_EXIT(arad_pp_epni_pp_pct_tbl_get_unsafe(unit, core_tmp, pp_port, &pp_pct_tbl_data));
            pp_pct_tbl_data.prge_profile = ARAD_PRGE_PP_SELECT_CUSTOMER_CONN_TO_NP - 1;
            SOCDNX_IF_ERR_EXIT(arad_pp_epni_pp_pct_tbl_set_unsafe(unit, core_tmp, pp_port, &pp_pct_tbl_data));

            /* add tm profile to select prge program */
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_local_to_tm_port_get(unit, port_ndx, &tm_port, &core_tmp));
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_tm_port_to_base_q_pair_get(unit, core_tmp, tm_port, &base_q_pair));
            SOCDNX_IF_ERR_EXIT(soc_port_sw_db_tm_port_to_out_port_priority_get(unit, core_tmp, tm_port, &nof_pairs));
            SOCDNX_IF_ERR_EXIT(arad_egr_prog_editor_profile_get(unit, ARAD_PRGE_TM_SELECT_CUSTOMER_CONN_TO_NP, &tm_profile));

            for (curr_q_pair = base_q_pair; curr_q_pair < base_q_pair + nof_pairs; curr_q_pair++) {
                SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_get_unsafe(unit, core, curr_q_pair, &pct_tbl_data));
                /* add tm profile to select prge program */
                pct_tbl_data.prog_editor_profile = tm_profile;
                SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_set_unsafe(unit, core, curr_q_pair, &pct_tbl_data));
            }
        }
    } else {
        SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_get_unsafe(unit, core, q_pair, &pct_tbl_data));
        
        pct_tbl_data.prog_editor_profile  = prog_editor_profile; 
        
        SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_set_unsafe(unit, core, q_pair, &pct_tbl_data));
    }

exit:
    SOCDNX_FUNC_RETURN;
}

int
  arad_pp_prge_program_var_set(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   program,
     SOC_SAND_IN    uint64                          var
  )
{
    ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA      prge_program_tbl_data; 
    uint32 res = SOC_SAND_OK;
    uint32 entry_u32[2];
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;


    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {
        res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOCDNX_SAND_IF_ERR_EXIT(res);

        entry_u32[0] = COMPILER_64_LO(var);
        entry_u32[1] = COMPILER_64_HI(var); 

        COMPILER_64_SET(prge_program_tbl_data.program_var, entry_u32[1], entry_u32[0]);
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOCDNX_SAND_IF_ERR_EXIT(res);
    }

exit:
    SOCDNX_FUNC_RETURN;
}


int
  arad_pp_prge_program_var_get(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   program,
     SOC_SAND_OUT   uint64                          *var
  )
{
    ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA      prge_program_tbl_data; 
    uint32 res = SOC_SAND_OK;
    uint32 entry_u32[2];
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;


    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {
        res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, prog_used, &prge_program_tbl_data);
        SOCDNX_SAND_IF_ERR_EXIT(res);

        entry_u32[0] = COMPILER_64_LO(prge_program_tbl_data.program_var);
        entry_u32[1] = COMPILER_64_HI(prge_program_tbl_data.program_var); 

        COMPILER_64_SET(*var, entry_u32[1], entry_u32[0]);

    }


exit:
    SOCDNX_FUNC_RETURN;
}

uint32 _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(int unit,
                                                                  uint32 outlif_profile_index,
                                                                  uint32 profile_value,
                                                                  uint32 profile_mask,
                                                                  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA *tbl_data
  ) {
    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_UNAVAIL, (_BSL_SOCDNX_MSG("Error: Program selection by outlif profile is available in Jericho and above\n\r")));
    }

    switch (outlif_profile_index) {
    case 1:
        tbl_data->first_out_lif_profile |= profile_value;
        tbl_data->first_out_lif_profile_mask &= profile_mask;
        tbl_data->first_out_lif_profile_valid = 1;
        tbl_data->first_out_lif_profile_valid_mask = 0;
        break;
    case 2:
        tbl_data->second_out_lif_profile |= profile_value;
        tbl_data->second_out_lif_profile_mask &= profile_mask;
        tbl_data->second_out_lif_profile_valid = 1;
        tbl_data->second_out_lif_profile_valid_mask = 0;
        break;
    case 3:
        tbl_data->third_out_lif_profile |= profile_value;
        tbl_data->third_out_lif_profile_mask &= profile_mask;
        tbl_data->third_out_lif_profile_valid = 1;
        tbl_data->third_out_lif_profile_valid_mask = 0;
        break;
    case 4:
        tbl_data->forth_out_lif_profile |= profile_value;
        tbl_data->forth_out_lif_profile_mask &= profile_mask;
        tbl_data->forth_out_lif_profile_valid = 1;
        tbl_data->forth_out_lif_profile_valid_mask = 0;
        break;
    case 5:
        tbl_data->fifth_out_lif_profile |= profile_value;
        tbl_data->fifth_out_lif_profile_mask &= profile_mask;
        break;
    case 6:
        tbl_data->sixth_out_lif_profile |= profile_value;
        tbl_data->sixth_out_lif_profile_mask &= profile_mask;
        break;
    default:
        SOCDNX_EXIT_WITH_ERR(SOC_E_PARAM, (_BSL_SOCDNX_MSG("Error: Unrecognized outlif profile index %d. Valid range is 1-4\n\r")));
    }
exit:
    SOCDNX_FUNC_RETURN;
}

/*
 * Fixes the program selection of programs that need inlif profiles.
 * system header value1[7:6] must be the InLIF profile bits[1:0]
 */
uint32
  arad_egr_prog_editor_prog_sel_inlif_profile_set(int unit,
                                                   SOC_OCC_MGMT_INLIF_APP inlif_app,
                                                   ARAD_EGR_PROG_EDITOR_PROGRAMS program,
                                                   uint32 selection_value
  ) {

    uint32 res;
    uint32 tcam_line;
    uint32 profile_mask = 0;
    uint32 profile_value = 0;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA
        tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        return SOC_E_UNAVAIL;
    }

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {

        res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_INLIF, inlif_app, selection_value,
                                             &profile_value, NULL, &profile_mask);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: inlif profile not defined\n\r")));
        }

    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r")));
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        /* Get line */
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            /* line needs fixing, Modify */
            tbl_data.value_1 |= profile_value << 6;
            tbl_data.value_1_mask &= (profile_mask << 6) | 0x3F;

            /* Set modified line */
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}


/*
 * Fixes the program selection of programs that need outlif profiles.
 * Necessary since outlif profile database is initialized after the egress editor is.
 */
uint32
  arad_egr_prog_editor_prog_sel_outlif_profile_set(int unit,
                                                   SOC_OCC_MGMT_OUTLIF_APP outlif_app,
                                                   ARAD_EGR_PROG_EDITOR_PROGRAMS program,
                                                   uint32 selection_value,
                                                   uint32 outlif_profile_index
  ) {

    uint32 res;
    uint32 tcam_line;
    uint32 profile_mask = 0;
    uint32 profile_value = 0;

    int    special_case_prog = 0;
    uint32 profile_mask_alt  = 0;
    uint32 profile_value_alt = 0;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA
        tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_WARM_BOOT(unit)) {
        /* HW should already be set with the outlif profiles during WB */
        LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Warning: outlif profile for egress editing is not reinserted during warm boot.\n")));
        goto exit;
    }

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_UNAVAIL, (_BSL_SOCDNX_MSG("Error: Program selection by outlif profile is available in Jericho and above\n\r")));
    }

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {

        res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_OUTLIF, outlif_app, selection_value,
                                             &profile_value, NULL, &profile_mask);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: outlif profile not defined\n\r")));
        }

        if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0)) {
            res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_OUTLIF, SOC_OCC_MGMT_OUTLIF_APP_CUSTOM_P_TAGGED_TYPE, ARAD_EGR_PROG_EDITOR_OUTLIF_TYPE_1,
                                                 &profile_value_alt, NULL, &profile_mask_alt);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: outlif profile not defined\n\r")));
            }
        }

    } else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r"))); 
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        /* Get line */
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            /* line needs fixing, Modify */
            res = _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(unit, outlif_profile_index, profile_value, profile_mask, &tbl_data);
            SOCDNX_IF_ERR_EXIT(res);


            if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "prge_ptagged_load", 0)) {
                SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
                                       unit, ARAD_EGR_PROG_EDITOR_PROG_SERVICE_MODE_PTAGGED, &special_case_prog));

                if ((tbl_data.program == special_case_prog) && (tbl_data.learn_ext_exist_mask == 0x0) && (tbl_data.learn_ext_exist == 0x1)) {
                    if (outlif_profile_index == 1) {
                        tbl_data.first_out_lif_profile      = profile_value_alt;
                        tbl_data.first_out_lif_profile_mask = profile_mask_alt;
                    } else {
                        tbl_data.third_out_lif_profile      = profile_value_alt;
                        tbl_data.third_out_lif_profile_mask = profile_mask_alt;
                    }
                    /*res = _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(unit, outlif_profile_index, profile_value_alt, profile_mask_alt, &tbl_data);*/
                    SOCDNX_IF_ERR_EXIT(res); 
                }
            }
            /* Set modified line */
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}

/*
 * arad_egr_prog_editor_prog_sel_outlif_profile_single_entry_set
 * Sets an outlif-profile bit(s) in a specific program selection entry.
 * Instead of setting all the entries selecting a certain program, this
 * Function sets only the 'selection_entry'-th entry. This can be used
 * when, for example, several selection entries are necessary to specify
 * each outlif profile.
 * Note: At least 'selection_entry' entries must be allocated when the program is loaded.
 *
 * outlif_app - the occupation manager application for outlif profiles
 * program - the egress PRGE program
 * selection_entry - the entry that would be modified (the only one)
 * selection_value - the outlif-profile partial value (the value in the application bits) that selects the PRGE program.
 * outlif_profile_index - 1-4 for outlif-profile-1 through outlif-profile-4 (JER/QAX). only 1 can be selected.
 */
uint32
  arad_egr_prog_editor_prog_sel_outlif_profile_single_entry_set(int unit,
                                                                SOC_OCC_MGMT_OUTLIF_APP outlif_app,
                                                                ARAD_EGR_PROG_EDITOR_PROGRAMS program,
                                                                uint32 selection_entry,
                                                                uint32 selection_value,
                                                                uint32 outlif_profile_index
  ) {

    uint32 res;
    uint32 tcam_line;
    uint32 profile_mask = 0;
    uint32 profile_value = 0;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA
        tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    if (SOC_IS_ARADPLUS_AND_BELOW(unit)) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_UNAVAIL, (_BSL_SOCDNX_MSG("Error: Program selection by outlif profile is available in Jericho and above\n\r")));
    }

    if (SOC_WARM_BOOT(unit)) {
        /* HW should already be set with the outlif profiles during WB */
        LOG_WARN(BSL_LS_SOC_EGRESS,(BSL_META_U(unit,"Warning: outlif profile for egress editing is not reinserted during warm boot.\n")));
        goto exit;
    }

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
        unit, program, &prog_used));
    if (prog_used != -1) {

        res = arad_pp_occ_mgmt_tcam_args_get(unit, SOC_OCC_MGMT_TYPE_OUTLIF, outlif_app, selection_value,
                                             &profile_value, NULL, &profile_mask);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: outlif profile not defined\n\r")));
        }

    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r")));
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        /* Get line */
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            if ((--selection_entry) == 0) {
                /* line needs fixing, Modify */
                res = _arad_egr_prog_editor_prog_sel_outlif_profile_set_by_index(unit, outlif_profile_index, profile_value, profile_mask, &tbl_data);
                SOCDNX_IF_ERR_EXIT(res);

                /* Set modified line */
                res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
                if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                    SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
                }
                break;
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}


uint32 arad_egr_prog_editor_prog_sel_value1_set(int unit, ARAD_EGR_PROG_EDITOR_PROGRAMS program, uint32 value1)
{
    uint32 res;
    uint32 tcam_line;

    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA tbl_data;
    int prog_used;

    SOCDNX_INIT_FUNC_DEFS;

    SOCDNX_IF_ERR_EXIT(sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(unit, program, &prog_used));
    if (prog_used == -1) {
        SOCDNX_EXIT_WITH_ERR(SOC_E_CONFIG, (_BSL_SOCDNX_MSG("Error: Program is not enabled\n\r")));
    }

    for (tcam_line = 0; tcam_line <= ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE(unit); tcam_line++) {

        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(unit, &tbl_data);

        /* Get line */
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, tcam_line, &tbl_data);
        if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
            SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not get TCAM line\n\r")));
        }

        if (tbl_data.program == prog_used) {
            tbl_data.value_1 = value1;
            /* Set modified line */
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &tbl_data);
            if (soc_sand_get_error_code_from_error_word(res) != SOC_SAND_OK) {
                SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG(" Error: Could not set TCAM line\n\r")));
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;

}

/* ******
   Diags
   ****** */

uint32
  arad_egr_prog_editor_program_by_name_find(
    SOC_SAND_IN  int                            unit,
    SOC_SAND_IN  char                          *prog_name,
    SOC_SAND_OUT ARAD_EGR_PROG_EDITOR_PROGRAMS *prog
  ){

    char* next_prog_name;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    SOC_SAND_CHECK_NULL_INPUT(prog_name);
    SOC_SAND_CHECK_NULL_INPUT(prog);

    for (*prog = 0; *prog < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; (*prog)++) {
        arad_egr_prog_editor_prog_name_get_by_id(*prog, &next_prog_name);
        if (!sal_strncasecmp(prog_name, next_prog_name, sal_strlen(prog_name))) {
            SOC_SAND_EXIT_NO_ERROR;
        }
    }

    SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error - Program %s not found. \n\r"), prog_name));

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_program_by_name_find()", 0, 0);
}

int
  arad_egr_prog_editor_print_all_programs_data(int unit)
{
    int program_id, lfem_map, lfem_idx;
    ARAD_EGR_PROG_EDITOR_LFEM lfem;
    char* prog_name;
    char* lfem_name;
    uint32 program_pointer;
    int prog_used;
    soc_error_t rv;

    SOCDNX_INIT_FUNC_DEFS;

    for (program_id = 0; program_id < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; program_id++) {
        arad_egr_prog_editor_prog_name_get_by_id(program_id, &prog_name);
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.prog_used.get(
            unit, program_id, &prog_used);
        SOCDNX_IF_ERR_EXIT(rv);
        if (prog_used != -1) {
            LOG_CLI((BSL_META_U(unit,
                                "========================================================================\n")));
            LOG_CLI((BSL_META_U(unit,
                                "program %d: %s\n"), program_id, prog_name));
            LOG_CLI((BSL_META_U(unit,
                                "selected program: %d\n"), prog_used));
            rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
                program_id, &program_pointer);
            SOCDNX_IF_ERR_EXIT(rv);
            LOG_CLI((BSL_META_U(unit,
                                "entries used: %d, %d\n"), _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_EVEN(program_pointer), _ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer)));
            LOG_CLI((BSL_META_U(unit,
                                "LFEMS used:\n")));
            for (lfem_map = 0; lfem_map < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); lfem_map++) {
                for (lfem_idx = 0; lfem_idx < ARAD_PP_EG_PROG_NOF_FEM(unit); lfem_idx++) {
                    rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.lfem_bk.get(
                        unit, program_id, lfem_map, lfem_idx, &lfem);
                    SOCDNX_IF_ERR_EXIT(rv);
                    if (lfem < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                        /* Get LFEM name */
                        arad_egr_prog_editor_lfem_name_get_by_id(lfem, &lfem_name);

                        LOG_CLI((BSL_META_U(unit,
                                            "    Map: %d, Entry: %d, LFEM: %s\n"), lfem_map, lfem_idx, lfem_name));
                    }
                }
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}

int
  arad_egr_prog_editor_print_chosen_program(int unit, uint32 first_instruction, uint8 raw_output, char **prog_name, uint8 print_to_xml)
{
    int program_id;
    soc_error_t rv;
    uint32 program_pointer;
    

    SOCDNX_INIT_FUNC_DEFS;

    for (program_id = 0; program_id < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; program_id++) {
        rv = sw_state_access[unit].dpp.soc.arad.tm.egr_prog_editor.programs.program_pointer.get(unit,
            program_id, &program_pointer);
        SOCDNX_IF_ERR_EXIT(rv);
        if (_ARAD_EGR_PROG_EDITOR_PTR_TO_BRANCH_ENTRY_ODD(program_pointer) == first_instruction) {
            if (*prog_name!=NULL) {
                if (!print_to_xml) {
                    if (!raw_output) {
                        LOG_CLI((BSL_META_U(unit,
                                            "OR\n")));
                    }
                    else {
                        cli_out(",");
                    }
                }
            }
            arad_egr_prog_editor_prog_name_get_by_id(program_id, prog_name);
            if (prog_name!=NULL) {
                if (!print_to_xml) {
                    if (!raw_output) {
                        LOG_CLI((BSL_META_U(unit,
                                            "Program %s was selected\n"), *prog_name));
                    }
                    else {
                        cli_out("%s\n",*prog_name);
                    }
                }
            }     
        }
    }

    if (prog_name==NULL) {
        if (!print_to_xml) {
            if (!raw_output) {
                LOG_CLI((BSL_META_U(unit,
                                    "Default NULL program was selected\n")));
            }
            else {
                cli_out("Default(NOPs)\n");
            }
        }
    }

exit:
    SOCDNX_FUNC_RETURN;
}




/************ End of DE Diagnostics ****************/

#if ARAD_DEBUG_IS_LVL1

#endif /* ARAD_DEBUG_IS_LVL1 */

/* } */
#include <soc/dpp/SAND/Utils/sand_footer.h>


#endif /* of #if defined(BCM_88650_A0) */

#undef _ERR_MSG_MODULE_NAME
