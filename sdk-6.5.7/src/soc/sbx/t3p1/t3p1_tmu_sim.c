/*
 * $Id: tmu_c_ext_sim.stg,v 1.20 Broadcom SDK $
 * $Copyright: (c) 2016 Broadcom.
 * Broadcom Proprietary and Confidential. All rights reserved.$
 *
 * t3p1_tmu_sim.c: Guadalupe2k V1.3 TMU table manager & wrappers
 *
 * DO NOT EDIT THIS FILE!
 * This file is auto-generated from sdk/caladan_ucode/t3p1/src/t3p1_tmu_cfg.lrp.
 * Edits to this file will be lost when it is regenerated.
 *
 */
#include <shared/bsl.h>

#include <sal/core/libc.h> 
#include <soc/types.h>
#include <soc/drv.h>

#if defined(BCM_CALADAN3_SUPPORT) && defined(BCM_CALADAN3_T3P1_SUPPORT) 
#include <soc/sbx/t3p1/t3p1_int.h>
#include <soc/sbx/t3p1/t3p1_tmu.h>
#include <soc/sbx/t3p1/t3p1_tmu_sim.h>
#include <soc/sbx/caladan3/simintf.h>

static char send_buffer[MAX_BUFFER_SIZE];


int soc_sbx_t3p1_mac_add_ext_sim(int unit,  soc_sbx_t3p1_6_byte_t imac ,  int ivsi , soc_sbx_t3p1_mac_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu set lookup mac index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;

       
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac0 0x%02x ", imac[0]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac1 0x%02x ", imac[1]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac2 0x%02x ", imac[2]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac3 0x%02x ", imac[3]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac4 0x%02x ", imac[4]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac5 0x%02x ", imac[5]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;


    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vsi 0x%02x ", ivsi);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "result ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 

    
    


    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ageid 0x%x ", entry->ageid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "smac_hit 0x%x ", entry->smac_hit);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "sdrop 0x%x ", entry->sdrop);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "dontage 0x%x ", entry->dontage);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "sreserved 0x%x ", entry->sreserved);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "pending 0x%x ", entry->pending);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "poe 0x%x ", entry->poe);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "dmac_hit 0x%x ", entry->dmac_hit);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "dcopy 0x%x ", entry->dcopy);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ddrop 0x%x ", entry->ddrop);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "dreserved 0x%x ", entry->dreserved);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ftidx 0x%x ", entry->ftidx);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
            

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
        LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    return SOC_E_NONE;
}

int soc_sbx_t3p1_mac_delete_ext_sim(int unit,  soc_sbx_t3p1_6_byte_t imac ,  int ivsi )
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu remove lookup mac index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;  

       
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac0 0x%02x ", imac[0]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac1 0x%02x ", imac[1]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac2 0x%02x ", imac[2]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac3 0x%02x ", imac[3]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac4 0x%02x ", imac[4]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac5 0x%02x ", imac[5]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;


    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vsi 0x%02x ", ivsi);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
        LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    return SOC_E_NONE;
}

int soc_sbx_t3p1_mac_get_ext_sim(int unit,  soc_sbx_t3p1_6_byte_t imac ,  int ivsi , soc_sbx_t3p1_mac_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;    
    char *fieldName;
    char *fieldValue;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    sal_memset(entry, 0, sizeof(soc_sbx_t3p1_mac_t));

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu get lookup mac index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;   

       
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac0 0x%02x ", imac[0]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac1 0x%02x ", imac[1]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac2 0x%02x ", imac[2]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac3 0x%02x ", imac[3]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac4 0x%02x ", imac[4]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "mac5 0x%02x ", imac[5]);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;


    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vsi 0x%02x ", ivsi);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "result"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing result token\n")));
        return SOC_E_PARAM;
    }

    fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
    fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    while ((fieldName != NULL) && (fieldValue != NULL)) {       

        
        /* _shr_ctoi() is same as atoi() but available in all toochains */
            if (!sal_strcasecmp(fieldName, "ageid"))        { entry->ageid = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "smac_hit"))        { entry->smac_hit = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "sdrop"))        { entry->sdrop = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "dontage"))        { entry->dontage = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "sreserved"))        { entry->sreserved = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "pending"))        { entry->pending = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "poe"))        { entry->poe = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "dmac_hit"))        { entry->dmac_hit = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "dcopy"))        { entry->dcopy = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "ddrop"))        { entry->ddrop = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "dreserved"))        { entry->dreserved = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "ftidx"))        { entry->ftidx = _shr_ctoi(fieldValue); }    
        

      fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
      fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    }

    return SOC_E_NONE;
}
          

int soc_sbx_t3p1_age2mac_add_ext_sim(int unit,  int iageid , soc_sbx_t3p1_age2mac_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu set lookup age2mac index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ageid 0x%02x ", iageid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "result ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 

    
    


    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "reserved1 0x%x ", entry->reserved1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "smac2 0x%x ", entry->smac2);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vsi 0x%x ", entry->vsi);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "smac1 0x%x ", entry->smac1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
            

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
        LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    return SOC_E_NONE;
}

int soc_sbx_t3p1_age2mac_delete_ext_sim(int unit,  int iageid )
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu remove lookup age2mac index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;  

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ageid 0x%02x ", iageid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
        LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    return SOC_E_NONE;
}

int soc_sbx_t3p1_age2mac_get_ext_sim(int unit,  int iageid , soc_sbx_t3p1_age2mac_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;    
    char *fieldName;
    char *fieldValue;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    sal_memset(entry, 0, sizeof(soc_sbx_t3p1_age2mac_t));

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu get lookup age2mac index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;   

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ageid 0x%02x ", iageid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "result"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing result token\n")));
        return SOC_E_PARAM;
    }

    fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
    fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    while ((fieldName != NULL) && (fieldValue != NULL)) {       

        
        /* _shr_ctoi() is same as atoi() but available in all toochains */
            if (!sal_strcasecmp(fieldName, "reserved1"))        { entry->reserved1 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "smac2"))        { entry->smac2 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "vsi"))        { entry->vsi = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "smac1"))        { entry->smac1 = _shr_ctoi(fieldValue); }    
        

      fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
      fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    }

    return SOC_E_NONE;
}
          

int soc_sbx_t3p1_pvv2e_add_ext_sim(int unit,  int ivrf ,  int iport ,  int iovid ,  int iivid , soc_sbx_t3p1_pvv2e_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, skipsize;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu set lookup pvv2e index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vrf 0x%02x ", ivrf);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "port 0x%02x ", iport);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ovid 0x%02x ", iovid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ivid 0x%02x ", iivid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "result ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 

    
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "pvv2e_idx 0x%x ", entry->pvv2e_idx);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
            

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }
    rv = soc_sbx_caladan3_sim_status_decode(send_buffer, "status", &skipsize);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim set failed (%d)\n"), rv));
    }

    return rv;
}

int soc_sbx_t3p1_pvv2e_delete_ext_sim(int unit,  int ivrf ,  int iport ,  int iovid ,  int iivid )
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, skipsize;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu remove lookup pvv2e index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;  

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vrf 0x%02x ", ivrf);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "port 0x%02x ", iport);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ovid 0x%02x ", iovid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ivid 0x%02x ", iivid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }
    rv = soc_sbx_caladan3_sim_status_decode(send_buffer, "status", &skipsize);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim set failed (%d)\n"), rv));
    }

    return rv;
}
 
int soc_sbx_t3p1_pvv2e_get_ext_sim(int unit,  int ivrf ,  int iport ,  int iovid ,  int iivid , soc_sbx_t3p1_pvv2e_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;    
    char *fieldName;
    char *fieldValue;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    sal_memset(entry, 0, sizeof(soc_sbx_t3p1_pvv2e_t));

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu get table pvv2e index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;   

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "vrf 0x%02x ", ivrf);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "port 0x%02x ", iport);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ovid 0x%02x ", iovid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "ivid 0x%02x ", iivid);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    }
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }
        
    fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
    fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    while ((fieldName != NULL) && (fieldValue != NULL)) {       
    
        
        /* _shr_ctoi() is same as atoi() but available in all toochains */
            if (!sal_strcasecmp(fieldName, "pvv2e_idx"))        { entry->pvv2e_idx = _shr_ctoi(fieldValue); }    
        
      fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
      fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    }
    
    return SOC_E_NONE;
}
          

int soc_sbx_t3p1_emlfilter_add_ext_sim(int unit,  int iemlindex , soc_sbx_t3p1_emlfilter_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;
        
    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu set lookup emlfilter index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "emlindex 0x%02x ", iemlindex);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "result ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 

    
    


    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "reserved_0 0x%x ", entry->reserved_0);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "reserved_1 0x%x ", entry->reserved_1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "reserved_2 0x%x ", entry->reserved_2);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "reserved_3 0x%x ", entry->reserved_3);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
            

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
        LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    return SOC_E_NONE;
}

int soc_sbx_t3p1_emlfilter_delete_ext_sim(int unit,  int iemlindex )
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu remove lookup emlfilter index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;  

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "emlindex 0x%02x ", iemlindex);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	 LOG_ERROR(BSL_LS_SOC_COMMON,
                   (BSL_META_U(unit,
                               "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
        LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    return SOC_E_NONE;
}

int soc_sbx_t3p1_emlfilter_get_ext_sim(int unit,  int iemlindex , soc_sbx_t3p1_emlfilter_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;    
    char *fieldName;
    char *fieldValue;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    sal_memset(entry, 0, sizeof(soc_sbx_t3p1_emlfilter_t));

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu get lookup emlfilter index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;   

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "emlindex 0x%02x ", iemlindex);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "result"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing result token\n")));
        return SOC_E_PARAM;
    }

    fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
    fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    while ((fieldName != NULL) && (fieldValue != NULL)) {       

        
        /* _shr_ctoi() is same as atoi() but available in all toochains */
            if (!sal_strcasecmp(fieldName, "reserved_0"))        { entry->reserved_0 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "reserved_1"))        { entry->reserved_1 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "reserved_2"))        { entry->reserved_2 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "reserved_3"))        { entry->reserved_3 = _shr_ctoi(fieldValue); }    
        

      fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
      fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    }

    return SOC_E_NONE;
}
          

int soc_sbx_t3p1_sample_dm1_add_ext_sim(int unit,  int iindex_1 ,  int iindex_2 , soc_sbx_t3p1_sample_dm1_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, skipsize;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu set table sample_dm1 index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "index_1 0x%02x ", iindex_1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "index_2 0x%02x ", iindex_2);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "result ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 

    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "w0 0x%x ", entry->w0);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "w1 0x%x ", entry->w1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "w2 0x%x ", entry->w2);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
    
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "w3 0x%x ", entry->w3);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;
            

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }
    rv = soc_sbx_caladan3_sim_status_decode(send_buffer, "status", &skipsize);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim set failed (%d)\n"), rv));
    }

    return rv;
}

int soc_sbx_t3p1_sample_dm1_delete_ext_sim(int unit,  int iindex_1 ,  int iindex_2 )
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, skipsize;

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu remove table sample_dm1 index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;  

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "index_1 0x%02x ", iindex_1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "index_2 0x%02x ", iindex_2);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }
    rv = soc_sbx_caladan3_sim_status_decode(send_buffer, "status", &skipsize);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim set failed (%d)\n"), rv));
    }

    return rv;
}
 
int soc_sbx_t3p1_sample_dm1_get_ext_sim(int unit,  int iindex_1 ,  int iindex_2 , soc_sbx_t3p1_sample_dm1_t *entry)
{
    int nextPrintPos = 0;
    int bufferSizeRemain = MAX_BUFFER_SIZE;
    int numCharPrinted;
    int rv, status;    
    char *fieldName;
    char *fieldValue;
    char *token;
    char *delimiters = " \t";
    char *tokstr=NULL;

    sal_memset(entry, 0, sizeof(soc_sbx_t3p1_sample_dm1_t));

    numCharPrinted = sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "tmu get table sample_dm1 index ");
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;   

       
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "index_1 0x%02x ", iindex_1);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM; 
    numCharPrinted =  sal_snprintf(&send_buffer[nextPrintPos], bufferSizeRemain, "index_2 0x%02x ", iindex_2);
    nextPrintPos += numCharPrinted;
    bufferSizeRemain -= numCharPrinted;
    if (bufferSizeRemain == 0) return SOC_E_PARAM;     

    rv = soc_sbx_caladan3_sim_sendrcv(unit, send_buffer, &nextPrintPos);
    if (SOC_FAILURE(rv)) {
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "sim sendrcv failed (%d)\n"), rv));
        return rv;
    }

    token = sal_strtok_r(send_buffer, delimiters, &tokstr);
    if ((token == NULL) || (sal_strcasecmp(token, "status"))){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Recv format unrecognized: %s\n"), send_buffer));
        return SOC_E_PARAM;
    } 
    token = sal_strtok_r(NULL, delimiters, &tokstr);
    if (token == NULL){
    	LOG_ERROR(BSL_LS_SOC_COMMON,
                  (BSL_META_U(unit,
                              "Missing status value\n")));
        return SOC_E_PARAM;
    }    
    status = _shr_ctoi(token);
    if (status != 0) {
        return SOC_E_NOT_FOUND;
    }

    fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
    fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    while ((fieldName != NULL) && (fieldValue != NULL)) {       

        
        /* _shr_ctoi() is same as atoi() but available in all toochains */
            if (!sal_strcasecmp(fieldName, "w0"))        { entry->w0 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "w1"))        { entry->w1 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "w2"))        { entry->w2 = _shr_ctoi(fieldValue); }
            if (!sal_strcasecmp(fieldName, "w3"))        { entry->w3 = _shr_ctoi(fieldValue); }    
        
      fieldName = sal_strtok_r(NULL, delimiters, &tokstr);
      fieldValue = sal_strtok_r(NULL, delimiters, &tokstr);
    }

    return SOC_E_NONE;
}



#endif
