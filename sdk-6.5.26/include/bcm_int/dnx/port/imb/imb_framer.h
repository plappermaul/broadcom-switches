
/*
 *         
 * 
 * 
 * This license is set out in https://raw.githubusercontent.com/Broadcom-Network-Switching-Software/OpenBCM/master/Legal/LICENSE file.
 * 
 * Copyright 2007-2022 Broadcom Inc. All rights reserved.
 *     
 * DO NOT EDIT THIS FILE!
 *
 */

#ifndef _IMB_FRAMER_H__H_
#define _IMB_FRAMER_H__H_

#include <soc/portmod/portmod.h>
#include <bcm/port.h>
#include <bcm/cosq.h>
#include <bcm_int/dnx/port/imb/imb_diag.h>
#include <bcm_int/dnx/cosq/ingress/cosq_ingress_port.h>
#include <soc/dnxc/dnxc_port.h>
/*initialize an IMB.*/
int imb_framer_init(
    int unit,
    const imb_create_info_t * imb_info,
    imb_specific_create_info_t * imb_specific_info);

/*De-initialize an existing IMB.*/
int imb_framer_deinit(
    int unit,
    const imb_create_info_t * imb_info,
    imb_specific_create_info_t * imb_specific_info);

/*TX pad packets to the specified size. value less than 17 means pad is disabled. */
int imb_framer_port_pad_size_set(
    int unit,
    bcm_port_t port,
    int value);
int imb_framer_port_pad_size_get(
    int unit,
    bcm_port_t port,
    int *value);

/*Add new IMB (Interface Management Block) port*/
int imb_framer_port_attach(
    int unit,
    bcm_port_t port,
    uint32 flags);

/*Remove an existing IMB (Interface Management Block) port*/
int imb_framer_port_detach(
    int unit,
    bcm_port_t port);

/*Enable / disable a port*/
int imb_framer_port_enable_set(
    int unit,
    bcm_port_t port,
    uint32 flags,
    int enable);
int imb_framer_port_enable_get(
    int unit,
    bcm_port_t port,
    int *enable);

/*Enable / disable loopback on a port*/
int imb_framer_port_loopback_set(
    int unit,
    bcm_port_t port,
    int loopback);
int imb_framer_port_loopback_get(
    int unit,
    bcm_port_t port,
    int *loopback);

/*Set / get priority configuration for the port*/
int imb_framer_port_priority_config_set(
    int unit,
    bcm_port_t port,
    const bcm_port_prio_config_t * priority_config);
int imb_framer_port_priority_config_get(
    int unit,
    bcm_port_t port,
    bcm_port_prio_config_t * priority_config);

/*Get link status*/
int imb_framer_port_link_get(
    int unit,
    bcm_port_t port,
    int flags,
    int *link);

/*Filter packets bigger than the specified value*/
int imb_framer_port_max_packet_size_set(
    int unit,
    bcm_port_t port,
    int value);
int imb_framer_port_max_packet_size_get(
    int unit,
    bcm_port_t port,
    int *value);

/*Set/get Average inter-packet gap*/
int imb_framer_port_tx_average_ipg_set(
    int unit,
    bcm_port_t port,
    int ipg_value);
int imb_framer_port_tx_average_ipg_get(
    int unit,
    bcm_port_t port,
    int *ipg_value);

/*Config MIB counter max size.*/
int imb_framer_port_cntmaxsize_set(
    int unit,
    bcm_port_t port,
    int val);
int imb_framer_port_cntmaxsize_get(
    int unit,
    bcm_port_t port,
    int *val);

/*Local fault steatus get*/
int imb_framer_port_local_fault_status_get(
    int unit,
    bcm_port_t port,
    int *local_fault);

/*Clear Local fault steatus*/
int imb_framer_port_local_fault_status_clear(
    int unit,
    bcm_port_t port);

/*Remote fault status get*/
int imb_framer_port_remote_fault_status_get(
    int unit,
    bcm_port_t port,
    int *remote_fault);

/*Clear Remote fault status*/
int imb_framer_port_remote_fault_status_clear(
    int unit,
    bcm_port_t port);

/*local fault enable set/get*/
int imb_framer_port_local_fault_enable_set(
    int unit,
    bcm_port_t port,
    int enable);
int imb_framer_port_local_fault_enable_get(
    int unit,
    bcm_port_t port,
    int *enable);

/*remote fault enable set/get*/
int imb_framer_port_remote_fault_enable_set(
    int unit,
    bcm_port_t port,
    int enable);
int imb_framer_port_remote_fault_enable_get(
    int unit,
    bcm_port_t port,
    int *enable);

/*Get port local and emote faults status*/
int imb_framer_port_faults_status_get(
    int unit,
    bcm_port_t port,
    int *local_fault,
    int *remote_fault);

/*Get the Bandwidth for the CDU.*/
int imb_framer_bandwidth_get(
    int unit,
    bcm_port_t port,
    int is_port_include,
    int *bandwidth);

/*Get/set the Start TX threshold.*/
int imb_framer_port_tx_start_thr_set(
    int unit,
    bcm_port_t port,
    int speed,
    int start_tx_thr);
int imb_framer_port_tx_start_thr_get(
    int unit,
    bcm_port_t port,
    int *start_tx_thr);

/*Set/get the PRD Enable mode.*/
int imb_framer_prd_enable_set(
    int unit,
    bcm_port_t port,
    int enable_mode);
int imb_framer_prd_enable_get(
    int unit,
    bcm_port_t port,
    int *enable_mode);

/*Set/get PRD Properties.*/
int imb_framer_prd_properties_set(
    int unit,
    bcm_port_t port,
    imb_prd_properties_t property,
    uint32 val);
int imb_framer_prd_properties_get(
    int unit,
    bcm_port_t port,
    imb_prd_properties_t property,
    uint32 *val);

/*Set/get PRD Port Profile.*/
int imb_framer_prd_port_profile_map_set(
    int unit,
    bcm_port_t port,
    uint32 profile);
int imb_framer_prd_port_profile_map_get(
    int unit,
    bcm_port_t port,
    uint32 *profile);

/*Configure PRD priority maps.*/
int imb_framer_prd_map_set(
    int unit,
    bcm_port_t port,
    bcm_cosq_ingress_port_drop_map_t map,
    uint32 key,
    uint32 priority,
    uint32 is_tdm);
int imb_framer_prd_map_get(
    int unit,
    bcm_port_t port,
    bcm_cosq_ingress_port_drop_map_t map,
    uint32 key,
    uint32 *priority,
    uint32 *is_tdm);

/*Configure PRD thresholds.*/
int imb_framer_prd_threshold_set(
    int unit,
    bcm_port_t port,
    uint32 priority,
    uint32 threshold);
int imb_framer_prd_threshold_get(
    int unit,
    bcm_port_t port,
    uint32 priority,
    uint32 *threshold);

/*Get maximum PRD threshold value.*/
int imb_framer_prd_threshold_max_get(
    int unit,
    bcm_port_t port,
    uint32 *threshold);

/*Configure PRD TPIDs per port.*/
int imb_framer_prd_tpid_set(
    int unit,
    bcm_port_t port,
    uint32 tpid_index,
    uint32 tpid_value);
int imb_framer_prd_tpid_get(
    int unit,
    bcm_port_t port,
    uint32 tpid_index,
    uint32 *tpid_value);

/*Set/Get PRD Configurable Ether types.*/
int imb_framer_prd_custom_ether_type_set(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 ether_type_val);
int imb_framer_prd_custom_ether_type_get(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 *ether_type_val);

/*Set/Get PRD TCAM entries (for the soft stage).*/
int imb_framer_prd_flex_key_entry_set(
    int unit,
    bcm_port_t port,
    uint32 key_index,
    const dnx_cosq_prd_tcam_entry_info_t * entry_info);
int imb_framer_prd_flex_key_entry_get(
    int unit,
    bcm_port_t port,
    uint32 key_index,
    dnx_cosq_prd_tcam_entry_info_t * entry_info);

/*Set/Get PRD TCAM key size per Ether type (for the soft stage).*/
int imb_framer_prd_ether_type_size_set(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 ether_type_size);
int imb_framer_prd_ether_type_size_get(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 *ether_type_size);

/*Set/Get PRD TCAM key offset base per Ether type (for the soft stage).*/
int imb_framer_prd_tcam_entry_key_offset_base_set(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 offset_base);
int imb_framer_prd_tcam_entry_key_offset_base_get(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 *offset_base);

/*Set/Get PRD TCAM key offset value per Ether type (for the soft stage).*/
int imb_framer_prd_tcam_entry_key_offset_set(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 offset_index,
    uint32 offset_value);
int imb_framer_prd_tcam_entry_key_offset_get(
    int unit,
    bcm_port_t port,
    uint32 ether_type_code,
    uint32 offset_index,
    uint32 *offset_value);

/*Set/Get PRD Control Frame proeprties. if a packet is identified as control frame, it will automatically get the highest priority.*/
int imb_framer_prd_control_frame_set(
    int unit,
    bcm_port_t port,
    uint32 control_frame_index,
    const bcm_cosq_ingress_drop_control_frame_config_t * control_frame_config);
int imb_framer_prd_control_frame_get(
    int unit,
    bcm_port_t port,
    uint32 control_frame_index,
    bcm_cosq_ingress_drop_control_frame_config_t * control_frame_config);

/*Set/Get PRD MPLS special label proeprties. if a packet is identified as MPLS special label and the label value matches to one of the saved special labels, the priority and TDM indication will be taken from the label properties.*/
int imb_framer_prd_mpls_special_label_set(
    int unit,
    bcm_port_t port,
    uint32 label_index,
    const bcm_cosq_ingress_port_drop_mpls_special_label_config_t * label_config);
int imb_framer_prd_mpls_special_label_get(
    int unit,
    bcm_port_t port,
    uint32 label_index,
    bcm_cosq_ingress_port_drop_mpls_special_label_config_t * label_config);

/*Port speed configuration*/
int imb_framer_port_speed_config_set(
    int unit,
    bcm_port_t port,
    const portmod_speed_config_t * speed_config);

/*Get mib counter*/
int imb_framer_port_mib_counter_get(
    int unit,
    bcm_port_t port,
    int counter_type,
    uint64 *counter_val);

/*Set mib counter*/
int imb_framer_port_mib_counter_set(
    int unit,
    bcm_port_t port,
    int counter_type,
    const uint64 *counter_val);

/*Configure calendar for FlexE related ports*/
int imb_framer_calendar_set(
    int unit,
    bcm_port_t port,
    uint32 flags);

/*Configure FIFO resources for flexe client*/
int imb_framer_port_fifo_resource_set(
    int unit,
    bcm_port_t port,
    uint32 flags);

/*Get/set the link fault forcing.*/
int imb_framer_port_link_fault_force_set(
    int unit,
    bcm_port_t port,
    bcm_port_control_t type,
    int enable);
int imb_framer_port_link_fault_force_get(
    int unit,
    bcm_port_t port,
    bcm_port_control_t type,
    int *enable);

#endif /*_IMB_FRAMER_H_*/
